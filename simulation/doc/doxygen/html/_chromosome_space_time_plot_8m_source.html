<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Whole Cell Simulation: src/+edu/+stanford/+covert/+cell/+sim/+analysis/ChromosomeSpaceTimePlot.m Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Whole Cell Simulation
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_chromosome_space_time_plot_8m.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">src/+edu/+stanford/+covert/+cell/+sim/+analysis/ChromosomeSpaceTimePlot.m</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_chromosome_space_time_plot_8m.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 % ChromosomeSpaceTimePlot
<a name="l00002"></a>00002 % Plot space-time densities
<a name="l00003"></a>00003 %
<a name="l00004"></a>00004 % Author: Derek Macklin, macklin@stanford.edu
<a name="l00005"></a>00005 % Affiliation: Covert Lab, Department of Bioengineering, Stanford University
<a name="l00006"></a>00006 % Last Updated: 8/14/2011
<a name="l00007"></a>00007 classdef ChromosomeSpaceTimePlot
<a name="l00008"></a>00008     properties(Constant = true)
<a name="l00009"></a>00009         cmap = [...
<a name="l00010"></a>00010             1.0000    1.0000    1.0000
<a name="l00011"></a>00011             0.3059    0.3961    0.5804
<a name="l00012"></a>00012             0.2994    0.4013    0.5688
<a name="l00013"></a>00013             0.2928    0.4066    0.5572
<a name="l00014"></a>00014             0.2863    0.4118    0.5457
<a name="l00015"></a>00015             0.2797    0.4170    0.5341
<a name="l00016"></a>00016             0.2732    0.4222    0.5225
<a name="l00017"></a>00017             0.2667    0.4275    0.5109
<a name="l00018"></a>00018             0.2601    0.4327    0.4994
<a name="l00019"></a>00019             0.2536    0.4379    0.4878
<a name="l00020"></a>00020             0.2471    0.4432    0.4762
<a name="l00021"></a>00021             0.2405    0.4484    0.4646
<a name="l00022"></a>00022             0.2340    0.4536    0.4531
<a name="l00023"></a>00023             0.2274    0.4588    0.4415
<a name="l00024"></a>00024             0.2209    0.4641    0.4299
<a name="l00025"></a>00025             0.2144    0.4693    0.4183
<a name="l00026"></a>00026             0.2078    0.4745    0.4068
<a name="l00027"></a>00027             0.2013    0.4798    0.3952
<a name="l00028"></a>00028             0.1948    0.4850    0.3836
<a name="l00029"></a>00029             0.1882    0.4902    0.3720
<a name="l00030"></a>00030             0.1817    0.4954    0.3605
<a name="l00031"></a>00031             0.1751    0.5007    0.3489
<a name="l00032"></a>00032             0.1686    0.5059    0.3373
<a name="l00033"></a>00033             0.2043    0.4877    0.3195
<a name="l00034"></a>00034             0.2400    0.4696    0.3018
<a name="l00035"></a>00035             0.2757    0.4514    0.2840
<a name="l00036"></a>00036             0.3114    0.4332    0.2663
<a name="l00037"></a>00037             0.3472    0.4151    0.2485
<a name="l00038"></a>00038             0.3829    0.3969    0.2308
<a name="l00039"></a>00039             0.4186    0.3788    0.2130
<a name="l00040"></a>00040             0.4543    0.3606    0.1953
<a name="l00041"></a>00041             0.4900    0.3424    0.1775
<a name="l00042"></a>00042             0.5257    0.3243    0.1598
<a name="l00043"></a>00043             0.5614    0.3061    0.1420
<a name="l00044"></a>00044             0.5971    0.2879    0.1243
<a name="l00045"></a>00045             0.6328    0.2698    0.1065
<a name="l00046"></a>00046             0.6685    0.2516    0.0888
<a name="l00047"></a>00047             0.7043    0.2335    0.0710
<a name="l00048"></a>00048             0.7400    0.2153    0.0533
<a name="l00049"></a>00049             0.7757    0.1971    0.0355
<a name="l00050"></a>00050             0.8114    0.1790    0.0178
<a name="l00051"></a>00051             0.8471    0.1608         0
<a name="l00052"></a>00052             0.8486    0.1814         0
<a name="l00053"></a>00053             0.8500    0.2020         0
<a name="l00054"></a>00054             0.8515    0.2226         0
<a name="l00055"></a>00055             0.8530    0.2431         0
<a name="l00056"></a>00056             0.8544    0.2637         0
<a name="l00057"></a>00057             0.8559    0.2843         0
<a name="l00058"></a>00058             0.8574    0.3049         0
<a name="l00059"></a>00059             0.8589    0.3255         0
<a name="l00060"></a>00060             0.8603    0.3461         0
<a name="l00061"></a>00061             0.8618    0.3667         0
<a name="l00062"></a>00062             0.8633    0.3873         0
<a name="l00063"></a>00063             0.8647    0.4078         0
<a name="l00064"></a>00064             0.8662    0.4284         0
<a name="l00065"></a>00065             0.8677    0.4490         0
<a name="l00066"></a>00066             0.8691    0.4696         0
<a name="l00067"></a>00067             0.8706    0.4902         0
<a name="l00068"></a>00068             0.7255    0.4085         0
<a name="l00069"></a>00069             0.5804    0.3268         0
<a name="l00070"></a>00070             0.4353    0.2451         0
<a name="l00071"></a>00071             0.2902    0.1634         0
<a name="l00072"></a>00072             0.1451    0.0817         0
<a name="l00073"></a>00073             0         0         0
<a name="l00074"></a>00074             ];
<a name="l00075"></a>00075         
<a name="l00076"></a>00076         rings = <span class="keyword">struct</span>(...
<a name="l00077"></a>00077             <span class="stringliteral">&#39;RNAPolymerase&#39;</span>, 7, ...
<a name="l00078"></a>00078             <span class="stringliteral">&#39;SMC&#39;</span>, 2, ...
<a name="l00079"></a>00079             <span class="stringliteral">&#39;Helicase&#39;</span>, 1, ...
<a name="l00080"></a>00080             <span class="stringliteral">&#39;DnaA&#39;</span>, 4, ...
<a name="l00081"></a>00081             <span class="stringliteral">&#39;Gyrase&#39;</span>, 5, ...
<a name="l00082"></a>00082             <span class="stringliteral">&#39;TopoisomeraseIV&#39;</span>, 6, ...
<a name="l00083"></a>00083             <span class="stringliteral">&#39;Regulation&#39;</span>, 3);
<a name="l00084"></a>00084         
<a name="l00085"></a>00085         chromProteins = {...
<a name="l00086"></a>00086             % chromosome <span class="keyword">property</span>    whole cell ids               strands    color (rgb)               name
<a name="l00087"></a>00087             &#39;complexBoundSites&#39;,    {<span class="stringliteral">&#39;MG_213_214_298_6MER_ADP&#39;</span>},   1:2,     [0 1 0],                <span class="stringliteral">&#39;SMC&#39;</span>;
<a name="l00088"></a>00088             <span class="stringliteral">&#39;complexBoundSites&#39;</span>,    {<span class="stringliteral">&#39;MG_094_HEXAMER&#39;</span>},            1:4,     [0.6980 0.1333 0.1333], <span class="stringliteral">&#39;Helicase&#39;</span>;
<a name="l00089"></a>00089             <span class="stringliteral">&#39;complexBoundSites&#39;</span>,    {<span class="stringliteral">&#39;MG_469_1MER_ADP&#39;</span>, ...
<a name="l00090"></a>00090                                      <span class="stringliteral">&#39;MG_469_1MER_ATP&#39;</span>, ...
<a name="l00091"></a>00091                                      <span class="stringliteral">&#39;MG_469_2MER_ATP&#39;</span>, ...
<a name="l00092"></a>00092                                      <span class="stringliteral">&#39;MG_469_3MER_ATP&#39;</span>, ...
<a name="l00093"></a>00093                                      <span class="stringliteral">&#39;MG_469_4MER_ATP&#39;</span>, ...
<a name="l00094"></a>00094                                      <span class="stringliteral">&#39;MG_469_5MER_ATP&#39;</span>, ...
<a name="l00095"></a>00095                                      <span class="stringliteral">&#39;MG_469_6MER_ATP&#39;</span>, ...
<a name="l00096"></a>00096                                      <span class="stringliteral">&#39;MG_469_7MER_ATP&#39;</span>},           1:2,     [1.0000 0.6471 0],      <span class="stringliteral">&#39;DnaA&#39;</span>;
<a name="l00097"></a>00097             <span class="stringliteral">&#39;complexBoundSites&#39;</span>,     {<span class="stringliteral">&#39;MG_469_2MER_ATP&#39;</span>, ...
<a name="l00098"></a>00098                                      <span class="stringliteral">&#39;MG_469_3MER_ATP&#39;</span>, ...
<a name="l00099"></a>00099                                      <span class="stringliteral">&#39;MG_469_4MER_ATP&#39;</span>, ...
<a name="l00100"></a>00100                                      <span class="stringliteral">&#39;MG_469_5MER_ATP&#39;</span>, ...
<a name="l00101"></a>00101                                      <span class="stringliteral">&#39;MG_469_6MER_ATP&#39;</span>, ...
<a name="l00102"></a>00102                                      <span class="stringliteral">&#39;MG_469_7MER_ATP&#39;</span>},           1:2,     [1.0000 0.6471 0],      <span class="stringliteral">&#39;DnaA Complex&#39;</span>;
<a name="l00103"></a>00103             <span class="stringliteral">&#39;complexBoundSites&#39;</span>,    {<span class="stringliteral">&#39;DNA_GYRASE&#39;</span>},                1:2,     [0.9 0.9 0.9],          <span class="stringliteral">&#39;Gyrase&#39;</span>;
<a name="l00104"></a>00104             <span class="stringliteral">&#39;complexBoundSites&#39;</span>,    {<span class="stringliteral">&#39;MG_203_204_TETRAMER&#39;</span>},       1:2,     [0.6902 0.8784 0.9020], <span class="stringliteral">&#39;Topoisomerase IV&#39;</span>;
<a name="l00105"></a>00105             <span class="stringliteral">&#39;complexBoundSites&#39;</span>,    {<span class="stringliteral">&#39;MG_428_DIMER&#39;</span>},              1:2,     [1 1 0],                <span class="stringliteral">&#39;LuxR&#39;</span>;
<a name="l00106"></a>00106             <span class="stringliteral">&#39;monomerBoundSites&#39;</span>,    {<span class="stringliteral">&#39;MG_101_MONOMER&#39;</span>},            1:2,     [1 0.5 0],              <span class="stringliteral">&#39;HTH Regulator&#39;</span>;
<a name="l00107"></a>00107             <span class="stringliteral">&#39;monomerBoundSites&#39;</span>,    {<span class="stringliteral">&#39;MG_236_MONOMER&#39;</span>},            1:2,     [0.2 1 0.8],            <span class="stringliteral">&#39;Ferric uptake repressor&#39;</span>;
<a name="l00108"></a>00108             };
<a name="l00109"></a>00109         
<a name="l00110"></a>00110         regulationWIDs = {<span class="stringliteral">&#39;MG_428_DIMER&#39;</span> <span class="stringliteral">&#39;MG_101_MONOMER&#39;</span> <span class="stringliteral">&#39;MG_236_MONOMER&#39;</span>};        
<a name="l00111"></a>00111     end
<a name="l00112"></a>00112     
<a name="l00113"></a>00113     methods (Static = <span class="keyword">true</span>);
<a name="l00114"></a>00114         <span class="keyword">function</span> run(relSimPath, selectedTime, fileName)
<a name="l00115"></a>00115             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l00116"></a>00116             import edu.stanford.covert.cell.sim.util.DiskLogger;
<a name="l00117"></a>00117             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l00118"></a>00118             import edu.stanford.covert.cell.sim.analysis.ChromosomeSpaceTimePlot;
<a name="l00119"></a>00119             
<a name="l00120"></a>00120             if ~exist(&#39;relSimPath&#39;, &#39;var&#39;) || isempty(relSimPath)
<a name="l00121"></a>00121                 relSimPath = [SimulationDiskUtil.getLatestSimulationGroup() filesep &#39;1&#39;];
<a name="l00122"></a>00122             end
<a name="l00123"></a>00123             if ~exist(&#39;selectedTime&#39;, &#39;var&#39;) || isempty(selectedTime)
<a name="l00124"></a>00124                 selectedTime = 4 * 3600;
<a name="l00125"></a>00125             end
<a name="l00126"></a>00126             
<a name="l00127"></a>00127             [simDir, ~, sim] = SimulationDiskUtil.getSimulation(relSimPath);
<a name="l00128"></a>00128             
<a name="l00129"></a>00129             simIdx = num2str(SimulationDiskUtil.getSimulationIndex(simDir));
<a name="l00130"></a>00130             simTimeStamp = SimulationDiskUtil.getSimulationTimeStamp(simDir);
<a name="l00131"></a>00131             stateNames = {<span class="stringliteral">&#39;ProteinComplex&#39;</span> <span class="stringliteral">&#39;counts&#39;</span>
<a name="l00132"></a>00132                 <span class="stringliteral">&#39;Chromosome&#39;</span> <span class="stringliteral">&#39;complexBoundSites&#39;</span>
<a name="l00133"></a>00133                 <span class="stringliteral">&#39;Chromosome&#39;</span> <span class="stringliteral">&#39;monomerBoundSites&#39;</span>
<a name="l00134"></a>00134                 <span class="stringliteral">&#39;Chromosome&#39;</span> <span class="stringliteral">&#39;polymerizedRegions&#39;</span>
<a name="l00135"></a>00135                 <span class="stringliteral">&#39;RNAPolymerase&#39;</span> <span class="stringliteral">&#39;positionStrands&#39;</span>
<a name="l00136"></a>00136                 <span class="stringliteral">&#39;RNAPolymerase&#39;</span> <span class="stringliteral">&#39;states&#39;</span>
<a name="l00137"></a>00137                 <span class="stringliteral">&#39;RNAPolymerase&#39;</span> <span class="stringliteral">&#39;transcriptionFactorBindingProbFoldChange&#39;</span>
<a name="l00138"></a>00138                 <span class="stringliteral">&#39;Time&#39;</span> <span class="stringliteral">&#39;values&#39;</span>};
<a name="l00139"></a>00139             states = DiskLogger.load(simDir, stateNames, [], [], [], <span class="stringliteral">&#39;extract&#39;</span>);
<a name="l00140"></a>00140             
<a name="l00141"></a>00141             %% space-time density plots
<a name="l00142"></a>00142             
<a name="l00143"></a>00143             % Active <a class="code" href="class_r_n_a.html">RNA</a> Polymerase
<a name="l00144"></a>00144             RNAPSparseMat = ChromosomeSpaceTimePlot.makeRNAPSparseMat(states, sim);
<a name="l00145"></a>00145             
<a name="l00146"></a>00146             % Space-Time Overlay Plot
<a name="l00147"></a>00147             [ax1, figHandle1] = edu.stanford.covert.cell.sim.util.PlotUtil.newAxesHandle();
<a name="l00148"></a>00148             whatToShow = {<span class="stringliteral">&#39;Gyrase&#39;</span>, <span class="stringliteral">&#39;Topoisomerase IV&#39;</span>, <span class="stringliteral">&#39;DnaA Complex&#39;</span>, <span class="stringliteral">&#39;LuxR&#39;</span>, <span class="stringliteral">&#39;HTH Regulator&#39;</span>, <span class="stringliteral">&#39;Ferric uptake repressor&#39;</span>, <span class="stringliteral">&#39;Helicase&#39;</span>};
<a name="l00149"></a>00149             ChromosomeSpaceTimePlot.plotSpaceTimeOverlay(...
<a name="l00150"></a>00150                 ax1, sim, states, RNAPSparseMat, ...
<a name="l00151"></a>00151                 ChromosomeSpaceTimePlot.chromProteins, whatToShow, ...
<a name="l00152"></a>00152                 sprintf(<span class="stringliteral">&#39;Chromosome 1\nSimulation: %s #%s&#39;</span>, simTimeStamp, simIdx));
<a name="l00153"></a>00153             <span class="keywordflow">if</span> exist(<span class="stringliteral">&#39;fileName&#39;</span>, <span class="stringliteral">&#39;var&#39;</span>)
<a name="l00154"></a>00154                 saveas(figHandle1, [fileName &#39;-SpaceTimeOverlay.pdf&#39;]);
<a name="l00155"></a>00155                 close(figHandle1);
<a name="l00156"></a>00156             end
<a name="l00157"></a>00157             
<a name="l00158"></a>00158             % Circular Density Plot
<a name="l00159"></a>00159             [ax3, figHandle3] = edu.stanford.covert.cell.sim.util.PlotUtil.newAxesHandle();
<a name="l00160"></a>00160             set(figHandle3, &#39;Color&#39;, [1 1 1]);
<a name="l00161"></a>00161             [densityBEMatrix, maxTime, maxSpace] = ChromosomeSpaceTimePlot.getProteinBindingDensityMatrix(...
<a name="l00162"></a>00162                 sim, states, RNAPSparseMat, ...
<a name="l00163"></a>00163                 ChromosomeSpaceTimePlot.chromProteins, [], 1000, 1000);
<a name="l00164"></a>00164             ChromosomeSpaceTimePlot.plotCircularDensity(...
<a name="l00165"></a>00165                 ax3, densityBEMatrix, maxTime, sim, false, ...
<a name="l00166"></a>00166                 sprintf(&#39;Circular <a class="code" href="class_chromosome.html">Chromosome</a> Density Plot\nSimulation: %s <span class="preprocessor">#%s&#39;, simTimeStamp, simIdx));</span>
<a name="l00167"></a>00167 <span class="preprocessor"></span>            <span class="keywordflow">if</span> exist(<span class="stringliteral">&#39;fileName&#39;</span>, <span class="stringliteral">&#39;var&#39;</span>)
<a name="l00168"></a>00168                 saveas(figHandle3, [fileName &#39;-CircularDensity.pdf&#39;]);
<a name="l00169"></a>00169                 close(figHandle3);
<a name="l00170"></a>00170             end
<a name="l00171"></a>00171             
<a name="l00172"></a>00172             % Ring Plot with all proteins
<a name="l00173"></a>00173             [ax4, figHandle4] = edu.stanford.covert.cell.sim.util.PlotUtil.newAxesHandle();
<a name="l00174"></a>00174             ChromosomeSpaceTimePlot.makeRingPlot(...
<a name="l00175"></a>00175                 ax4, sim, states, RNAPSparseMat, ...
<a name="l00176"></a>00176                 ChromosomeSpaceTimePlot.chromProteins, [], selectedTime, ...
<a name="l00177"></a>00177                 maxSpace);
<a name="l00178"></a>00178             if exist(&#39;fileName&#39;, &#39;var&#39;)
<a name="l00179"></a>00179                 saveas(figHandle4, [fileName &#39;-Ring.pdf&#39;]);
<a name="l00180"></a>00180                 close(figHandle4);
<a name="l00181"></a>00181             end
<a name="l00182"></a>00182         end
<a name="l00183"></a>00183         
<a name="l00184"></a>00184         function [densityMatrix, pxWidth, pxHeight] = calcRnaPDensityMatrix(activePos, width, height, maxTime, maxSpace)
<a name="l00185"></a>00185             pxWidth = maxTime / width;
<a name="l00186"></a>00186             pxHeight = maxSpace / height;
<a name="l00187"></a>00187             densityMatrix = zeros(height, width);
<a name="l00188"></a>00188             for i = 1:height
<a name="l00189"></a>00189                 for j = 1:width
<a name="l00190"></a>00190                     densityMatrix(i, j) = size(...
<a name="l00191"></a>00191                         activePos(...
<a name="l00192"></a>00192                         activePos(:, round(pxWidth * (j-1) + 1) : round(pxWidth * j)) &gt; round(pxHeight * (i-1)) &amp; ...
<a name="l00193"></a>00193                         activePos(:, round(pxWidth * (j-1) + 1) : round(pxWidth * j)) &lt;= round(pxHeight * i)), ...
<a name="l00194"></a>00194                         1) / (pxWidth * pxHeight) * 3600;
<a name="l00195"></a>00195                 end
<a name="l00196"></a>00196             end
<a name="l00197"></a>00197         end
<a name="l00198"></a>00198         
<a name="l00199"></a>00199         function [densityMatrix, pxWidth, pxHeight] = calcChromBoundDensityMatrix(subs, width, height, maxTime, maxSpace)
<a name="l00200"></a>00200             pxWidth = maxTime / width;
<a name="l00201"></a>00201             pxHeight = maxSpace / height;
<a name="l00202"></a>00202             
<a name="l00203"></a>00203             w = round(pxWidth * (1:width));
<a name="l00204"></a>00204             h = round(pxHeight * (1:height));
<a name="l00205"></a>00205             
<a name="l00206"></a>00206             densityMatrix =  hist3(subs(:, [1 3]), &#39;Edges&#39;, {h w}) / (pxWidth * pxHeight) * 3600;
<a name="l00207"></a>00207         end
<a name="l00208"></a>00208         
<a name="l00209"></a>00209         <span class="keyword">function</span> plotSpaceTimeOverlay(ax, sim, states, RNAPSparseMat, chProteins, whatToShow, figTitle)
<a name="l00210"></a>00210             %% Initialization %%
<a name="l00211"></a>00211             <span class="keywordflow">if</span> exist(<span class="stringliteral">&#39;whatToShow&#39;</span>, <span class="stringliteral">&#39;var&#39;</span>) &amp;&amp; ~isempty(whatToShow)
<a name="l00212"></a>00212                 [~, inds] = ismember(whatToShow, chProteins(:, 5));
<a name="l00213"></a>00213                 chProteins = chProteins(inds(inds ~= 0), :);
<a name="l00214"></a>00214             end
<a name="l00215"></a>00215             
<a name="l00216"></a>00216             c = sim.state(<span class="stringliteral">&#39;Chromosome&#39;</span>);
<a name="l00217"></a>00217             hold(ax, <span class="stringliteral">&#39;on&#39;</span>);
<a name="l00218"></a>00218             
<a name="l00219"></a>00219             % Handle presence/absence of RNAPSparseMat (plot it or don<span class="stringliteral">&#39;t)</span>
<a name="l00220"></a>00220 <span class="stringliteral">            if exist(&#39;</span>RNAPSparseMat<span class="stringliteral">&#39;, &#39;</span>var<span class="stringliteral">&#39;) &amp;&amp; ~isempty(RNAPSparseMat)</span>
<a name="l00221"></a>00221 <span class="stringliteral">                pol = sim.state(&#39;</span>RNAPolymerase<span class="stringliteral">&#39;);</span>
<a name="l00222"></a>00222 <span class="stringliteral">                subs = find(RNAPSparseMat &gt;= pol.activelyTranscribingValue);</span>
<a name="l00223"></a>00223 <span class="stringliteral">                subs(subs(:, 2) &gt;= 3, :) = [];</span>
<a name="l00224"></a>00224 <span class="stringliteral">                </span>
<a name="l00225"></a>00225 <span class="stringliteral">                % Flip positions above/below the terC</span>
<a name="l00226"></a>00226 <span class="stringliteral">                subs_old = subs;</span>
<a name="l00227"></a>00227 <span class="stringliteral">                subs(subs_old(:, 1) &gt; c.terCPosition, 1) = subs_old(subs_old(:, 1) &gt; c.terCPosition, 1) - c.terCPosition;</span>
<a name="l00228"></a>00228 <span class="stringliteral">                subs(subs_old(:, 1) &lt;= c.terCPosition, 1) = subs_old(subs_old(:, 1) &lt;= c.terCPosition, 1) + c.terCPosition;</span>
<a name="l00229"></a>00229 <span class="stringliteral">                clear subs_old;</span>
<a name="l00230"></a>00230 <span class="stringliteral">               </span>
<a name="l00231"></a>00231 <span class="stringliteral">                handles = zeros(size(chProteins, 1) + 1, 1);</span>
<a name="l00232"></a>00232 <span class="stringliteral">                names = [&#39;</span><a class="code" href="class_r_n_a.html">RNA</a> Polymerase<span class="stringliteral">&#39;; chProteins(:, 5)];</span>
<a name="l00233"></a>00233 <span class="stringliteral">                handles(1) = patch([...</span>
<a name="l00234"></a>00234 <span class="stringliteral">                    1 / 3600 * subs(:, 3)&#39;</span>
<a name="l00235"></a>00235                     1 / 3600 * (subs(:, 3) + 1)<span class="stringliteral">&#39;</span>
<a name="l00236"></a>00236 <span class="stringliteral">                    1 / 3600 * (subs(:, 3) + 1)&#39;</span>
<a name="l00237"></a>00237                     1 / 3600 * subs(:, 3)<span class="stringliteral">&#39;</span>
<a name="l00238"></a>00238 <span class="stringliteral">                    ], [</span>
<a name="l00239"></a>00239 <span class="stringliteral">                    subs(:, 1)&#39;</span>
<a name="l00240"></a>00240                     subs(:, 1)<span class="stringliteral">&#39;</span>
<a name="l00241"></a>00241 <span class="stringliteral">                    subs(:, 1)&#39;</span> + 1
<a name="l00242"></a>00242                     subs(:, 1)<span class="stringliteral">&#39; + 1</span>
<a name="l00243"></a>00243 <span class="stringliteral">                    ], ones(1, size(subs, 1)), &#39;</span>Parent<span class="stringliteral">&#39;, ax, &#39;</span>EdgeColor<span class="stringliteral">&#39;, &#39;</span>b<span class="stringliteral">&#39;, &#39;</span>FaceColor<span class="stringliteral">&#39;, &#39;</span>b<span class="stringliteral">&#39;);</span>
<a name="l00244"></a>00244 <span class="stringliteral">                handle_offset = 1;</span>
<a name="l00245"></a>00245 <span class="stringliteral">            else</span>
<a name="l00246"></a>00246 <span class="stringliteral">                handles = zeros(size(chProteins, 1), 1);</span>
<a name="l00247"></a>00247 <span class="stringliteral">                names = chProteins(:, 5);</span>
<a name="l00248"></a>00248 <span class="stringliteral">                handle_offset = 0;</span>
<a name="l00249"></a>00249 <span class="stringliteral">            end</span>
<a name="l00250"></a>00250 <span class="stringliteral">            </span>
<a name="l00251"></a>00251 <span class="stringliteral">            %% Loop over chromosomal proteins %%</span>
<a name="l00252"></a>00252 <span class="stringliteral">            for i = 1:size(chProteins, 1)</span>
<a name="l00253"></a>00253 <span class="stringliteral">                chromProp = chProteins{i, 1};</span>
<a name="l00254"></a>00254 <span class="stringliteral">                wIDs = chProteins{i, 2};</span>
<a name="l00255"></a>00255 <span class="stringliteral">                strands = chProteins{i, 3};</span>
<a name="l00256"></a>00256 <span class="stringliteral">                color = chProteins{i, 4};</span>
<a name="l00257"></a>00257 <span class="stringliteral">                </span>
<a name="l00258"></a>00258 <span class="stringliteral">                % Determine if it&#39;</span>s a complex or monomer
<a name="l00259"></a>00259                 <span class="keywordflow">if</span> strcmp(chromProp, <span class="stringliteral">&#39;complexBoundSites&#39;</span>)
<a name="l00260"></a>00260                     mod = sim.state(<span class="stringliteral">&#39;ProteinComplex&#39;</span>);
<a name="l00261"></a>00261                 elseif strcmp(chromProp, <span class="stringliteral">&#39;monomerBoundSites&#39;</span>)
<a name="l00262"></a>00262                     mod = sim.state(&#39;<a class="code" href="class_protein_monomer.html">ProteinMonomer</a>&#39;);
<a name="l00263"></a>00263                 end
<a name="l00264"></a>00264                 
<a name="l00265"></a>00265                 idxs = find(ismember(mod.wholeCellModelIDs(mod.matureIndexs), wIDs));
<a name="l00266"></a>00266                 subs = [];
<a name="l00267"></a>00267                 
<a name="l00268"></a>00268                 % If we lump multiple proteins together to consider them as
<a name="l00269"></a>00269                 % one class of proteins (<a class="code" href="json_parse_8m.html#ac14d26badced2970320ee4d772ad0ae9">e</a>.g., DnaA), then get all subs
<a name="l00270"></a>00270                 for j = 1:numel(wIDs)
<a name="l00271"></a>00271                     subs = [subs; find(states.<a class="code" href="class_chromosome.html">Chromosome</a>.(chromProp) == idxs(j))]; %<span class="preprocessor">#ok&lt;AGROW&gt;</span>
<a name="l00272"></a>00272 <span class="preprocessor"></span>                end
<a name="l00273"></a>00273                 
<a name="l00274"></a>00274                 % Get rid of subs that aren<span class="stringliteral">&#39;t on the proper strand</span>
<a name="l00275"></a>00275 <span class="stringliteral">                subs = subs(ismember(subs(:, 2), strands), :);</span>
<a name="l00276"></a>00276 <span class="stringliteral">                </span>
<a name="l00277"></a>00277 <span class="stringliteral">                % Flip positions above/below the terC</span>
<a name="l00278"></a>00278 <span class="stringliteral">                subs_old = subs;</span>
<a name="l00279"></a>00279 <span class="stringliteral">                subs(subs_old(:, 1) &gt; c.terCPosition, 1) = subs_old(subs_old(:, 1) &gt; c.terCPosition, 1) - c.terCPosition;</span>
<a name="l00280"></a>00280 <span class="stringliteral">                subs(subs_old(:, 1) &lt;= c.terCPosition, 1) = subs_old(subs_old(:, 1) &lt;= c.terCPosition, 1) + c.terCPosition;</span>
<a name="l00281"></a>00281 <span class="stringliteral">                clear subs_old;</span>
<a name="l00282"></a>00282 <span class="stringliteral">                </span>
<a name="l00283"></a>00283 <span class="stringliteral">                % Plot</span>
<a name="l00284"></a>00284 <span class="stringliteral">                if isempty(subs)</span>
<a name="l00285"></a>00285 <span class="stringliteral">                    continue;</span>
<a name="l00286"></a>00286 <span class="stringliteral">                end</span>
<a name="l00287"></a>00287 <span class="stringliteral">                handles(i + handle_offset) = patch([...</span>
<a name="l00288"></a>00288 <span class="stringliteral">                    1 / 3600 * subs(:, 3)&#39;</span>
<a name="l00289"></a>00289                     1 / 3600 * (subs(:, 3) + 1)&#39;
<a name="l00290"></a>00290                     1 / 3600 * (subs(:, 3) + 1)&#39;
<a name="l00291"></a>00291                     1 / 3600 * subs(:, 3)&#39;
<a name="l00292"></a>00292                     ], [
<a name="l00293"></a>00293                     subs(:, 1)&#39;
<a name="l00294"></a>00294                     subs(:, 1)&#39;
<a name="l00295"></a>00295                     subs(:, 1)&#39; + 1
<a name="l00296"></a>00296                     subs(:, 1)&#39; + 1
<a name="l00297"></a>00297                     ], ones(1, size(subs, 1)), &#39;Parent&#39;, ax, &#39;EdgeColor&#39;, color, &#39;FaceColor&#39;, color);                
<a name="l00298"></a>00298             end
<a name="l00299"></a>00299             hold(ax, <span class="stringliteral">&#39;off&#39;</span>);
<a name="l00300"></a>00300             
<a name="l00301"></a>00301             % Legend formatting
<a name="l00302"></a>00302             lh = legend(handles(handles ~= 0), names(handles ~= 0), <span class="stringliteral">&#39;Location&#39;</span>, <span class="stringliteral">&#39;NorthEastOutside&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, 8);
<a name="l00303"></a>00303             c_lh = <span class="keyword">get</span>(lh, <span class="stringliteral">&#39;Children&#39;</span>);
<a name="l00304"></a>00304             <span class="keywordflow">for</span> i = 1:numel(c_lh)
<a name="l00305"></a>00305                 set(c_lh(i), &#39;LineStyle&#39;, &#39;-&#39;);
<a name="l00306"></a>00306             end
<a name="l00307"></a>00307             
<a name="l00308"></a>00308             % Labeling
<a name="l00309"></a>00309             xlabel(ax, &#39;Time (hr)&#39;, &#39;FontSize&#39;, 16);
<a name="l00310"></a>00310             set(ax, &#39;YTick&#39;, [1 c.sequenceLen/2 c.sequenceLen]);
<a name="l00311"></a>00311             set(ax, &#39;YTickLabel&#39;, {<span class="stringliteral">&#39;TerC&#39;</span>, <span class="stringliteral">&#39;OriC&#39;</span>, <span class="stringliteral">&#39;TerC&#39;</span>});
<a name="l00312"></a>00312             ylim(ax, [0.5 c.sequenceLen + 0.5]);
<a name="l00313"></a>00313             ylabel(ax, <span class="stringliteral">&#39;Position&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, 16)
<a name="l00314"></a>00314             set(ax, &#39;FontSize&#39;, 8);
<a name="l00315"></a>00315             xlim(ax, states.Time.values([1 end]) / 3600);
<a name="l00316"></a>00316         end
<a name="l00317"></a>00317         
<a name="l00318"></a>00318         function makeRingPlot(ax, sim, states, RNAPSparseMat, chProteins, whatToMake, time, maxSpace)
<a name="l00319"></a>00319             import edu.stanford.covert.cell.sim.analysis.ChromosomeSpaceTimePlot;
<a name="l00320"></a>00320             
<a name="l00321"></a>00321             if exist(&#39;whatToMake&#39;, &#39;var&#39;) &amp;&amp; ~isempty(whatToMake)
<a name="l00322"></a>00322                 [~, inds] = ismember(whatToMake, chProteins(:, 5));
<a name="l00323"></a>00323                 chProteins = chProteins(inds(inds ~= 0), :);
<a name="l00324"></a>00324             end
<a name="l00325"></a>00325             
<a name="l00326"></a>00326             if exist(&#39;RNAPSparseMat&#39;, &#39;var&#39;) &amp;&amp; ~isempty(RNAPSparseMat)
<a name="l00327"></a>00327                 pol = sim.state(&#39;RNAPolymerase&#39;);
<a name="l00328"></a>00328                 subs = find(RNAPSparseMat &gt;= pol.activelyTranscribingValue);
<a name="l00329"></a>00329                 subs(subs(:, 2) &gt;= 3, :) = [];
<a name="l00330"></a>00330                 pos = ChromosomeSpaceTimePlot.getPos(subs, time);
<a name="l00331"></a>00331                 lineHandles = zeros(size(chProteins, 1) + 1, 1);
<a name="l00332"></a>00332                 names = [&#39;<a class="code" href="class_r_n_a.html">RNA</a> Polymerase&#39;; chProteins(:, 5)];
<a name="l00333"></a>00333                 h = ChromosomeSpaceTimePlot.plotRing(ax, pos, maxSpace, [1 2], [0 0 1]);
<a name="l00334"></a>00334                 if ~isempty(h)
<a name="l00335"></a>00335                     lineHandles(1) = h(1);
<a name="l00336"></a>00336                 end
<a name="l00337"></a>00337                 lineHandle_offset = 1;
<a name="l00338"></a>00338             else
<a name="l00339"></a>00339                 lineHandles = zeros(size(chProteins, 1), 1);
<a name="l00340"></a>00340                 names = chProteins(:, 5);
<a name="l00341"></a>00341                 lineHandle_offset = 0;
<a name="l00342"></a>00342             end
<a name="l00343"></a>00343             
<a name="l00344"></a>00344             for i = 1:size(chProteins, 1)
<a name="l00345"></a>00345                 chromProp = chProteins{i, 1};
<a name="l00346"></a>00346                 wIDs = chProteins{i, 2};
<a name="l00347"></a>00347                 strands = chProteins{i, 3};
<a name="l00348"></a>00348                 color = chProteins{i, 4};
<a name="l00349"></a>00349                 <span class="keywordflow">if</span> strcmp(chromProp, <span class="stringliteral">&#39;complexBoundSites&#39;</span>)
<a name="l00350"></a>00350                     mod = sim.state(&#39;<a class="code" href="class_protein_complex.html">ProteinComplex</a>&#39;);
<a name="l00351"></a>00351                 elseif strcmp(chromProp, &#39;monomerBoundSites&#39;)
<a name="l00352"></a>00352                     mod = sim.state(&#39;ProteinMonomer&#39;);
<a name="l00353"></a>00353                 end
<a name="l00354"></a>00354                 idxs = find(ismember(mod.wholeCellModelIDs(mod.matureIndexs), wIDs));
<a name="l00355"></a>00355                 subs = [];
<a name="l00356"></a>00356                 for j = 1:numel(wIDs)
<a name="l00357"></a>00357                     subs = [subs; find(states.<a class="code" href="class_chromosome.html">Chromosome</a>.(chromProp) == idxs(j))]; %<span class="preprocessor">#ok&lt;AGROW&gt;</span>
<a name="l00358"></a>00358 <span class="preprocessor"></span>                end
<a name="l00359"></a>00359                 subs = subs(ismember(subs(:, 2), strands), :);
<a name="l00360"></a>00360                 
<a name="l00361"></a>00361                 pos = ChromosomeSpaceTimePlot.getPos(subs, time);
<a name="l00362"></a>00362                 h = ChromosomeSpaceTimePlot.plotRing(ax, pos, maxSpace, [1 2], color);
<a name="l00363"></a>00363                 <span class="keywordflow">if</span> ~isempty(h)
<a name="l00364"></a>00364                     lineHandles(i + lineHandle_offset) = h(1);
<a name="l00365"></a>00365                 end
<a name="l00366"></a>00366             end
<a name="l00367"></a>00367             
<a name="l00368"></a>00368             if any(lineHandles)
<a name="l00369"></a>00369                 legend(lineHandles, names, &#39;Location&#39;, &#39;NorthEastOutside&#39;);
<a name="l00370"></a>00370             end
<a name="l00371"></a>00371             
<a name="l00372"></a>00372             axis(ax, &#39;square&#39;);
<a name="l00373"></a>00373         end
<a name="l00374"></a>00374         
<a name="l00375"></a>00375         function plotSpaceTimeDensity(axesHandle, densityMatrix, maxTime, pxWidth, figTitle)
<a name="l00376"></a>00376             imagesc(densityMatrix, &#39;Parent&#39;, axesHandle);
<a name="l00377"></a>00377             hrPos = (0:ceil(maxTime / 3600)) * (3600 / pxWidth);
<a name="l00378"></a>00378             set(axesHandle, &#39;XTick&#39;, hrPos);
<a name="l00379"></a>00379             set(axesHandle, &#39;XTickLabel&#39;, hrPos * pxWidth/3600);
<a name="l00380"></a>00380             set(axesHandle, &#39;YTick&#39;, [0 size(densityMatrix, 1) / 2 size(densityMatrix, 1)]);
<a name="l00381"></a>00381             set(axesHandle, &#39;YTickLabel&#39;, {<span class="stringliteral">&#39;OriC&#39;</span>, <span class="stringliteral">&#39;TerC&#39;</span>, <span class="stringliteral">&#39;OriC&#39;</span>});
<a name="l00382"></a>00382             <span class="keyword">set</span>(axesHandle, <span class="stringliteral">&#39;YDir&#39;</span>, <span class="stringliteral">&#39;normal&#39;</span>);
<a name="l00383"></a>00383             axis(axesHandle, [0 size(densityMatrix, 2) 0 size(densityMatrix, 1)]);
<a name="l00384"></a>00384             xlabel(axesHandle, <span class="stringliteral">&#39;Time (hr)&#39;</span>);
<a name="l00385"></a>00385             ylabel(axesHandle, <span class="stringliteral">&#39;Position on Chromosome 1&#39;</span>);
<a name="l00386"></a>00386             colormap(axesHandle, edu.stanford.covert.cell.sim.analysis.ChromosomeSpaceTimePlot.cmap);
<a name="l00387"></a>00387             c_handle = colorbar(<span class="stringliteral">&#39;Peer&#39;</span>, axesHandle);
<a name="l00388"></a>00388             ylbl = <span class="keyword">get</span>(c_handle, <span class="stringliteral">&#39;YLabel&#39;</span>);
<a name="l00389"></a>00389             <span class="keyword">set</span>(ylbl, <span class="stringliteral">&#39;String&#39;</span>, <span class="stringliteral">&#39;Density (Proteins/bp/hr)&#39;</span>);
<a name="l00390"></a>00390             title(figTitle, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00391"></a>00391             xlim(axesHandle, [0 maxTime] / 3600);
<a name="l00392"></a>00392             box(<span class="stringliteral">&#39;off&#39;</span>);
<a name="l00393"></a>00393         end
<a name="l00394"></a>00394         
<a name="l00395"></a>00395         <span class="keyword">function</span> [lineHandles, circleHandles] = plotRing(axesHandle, pos, maxPos, radii, color)
<a name="l00396"></a>00396             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l00397"></a>00397             
<a name="l00398"></a>00398             lineHandles = zeros(size(pos));
<a name="l00399"></a>00399             circleHandles = zeros(2, 1);
<a name="l00400"></a>00400             
<a name="l00401"></a>00401             theta = ((pos / maxPos) * (2 * pi)) + (pi / 2);
<a name="l00402"></a>00402             
<a name="l00403"></a>00403             for i = 1:size(pos, 1)
<a name="l00404"></a>00404                 lineXData = radii .* cos(theta(i));
<a name="l00405"></a>00405                 lineYData = radii .* sin(theta(i));
<a name="l00406"></a>00406                 lineHandles(i) = line(lineXData, lineYData, &#39;Color&#39;, color, &#39;Parent&#39;, axesHandle);
<a name="l00407"></a>00407             end
<a name="l00408"></a>00408             
<a name="l00409"></a>00409             circleHandles(1) = PlotUtil.drawCircle(0, 0, radii(1), axesHandle);
<a name="l00410"></a>00410             circleHandles(2) = PlotUtil.drawCircle(0, 0, radii(2), axesHandle);
<a name="l00411"></a>00411             set(axesHandle, &#39;Visible&#39;, &#39;off&#39;);
<a name="l00412"></a>00412         end
<a name="l00413"></a>00413         
<a name="l00414"></a>00414         % Plot circular density
<a name="l00415"></a>00415         % TODO: Use loops rather than spaghetti code!
<a name="l00416"></a>00416         function plotCircularDensity(axesHandle, densityBEMatrix, maxTime, simulation, indepRingNormalize, figTitle)
<a name="l00417"></a>00417             import edu.stanford.covert.cell.sim.analysis.ChromosomeSpaceTimePlot;
<a name="l00418"></a>00418             
<a name="l00419"></a>00419             ids = simulation.gene.wholeCellModelIDs;
<a name="l00420"></a>00420             colormap(flipud(colormap(&#39;bone&#39;)));
<a name="l00421"></a>00421             if indepRingNormalize
<a name="l00422"></a>00422                 h = bullseye(log10((densityBEMatrix - repmat(min(densityBEMatrix, [], 1), [size(densityBEMatrix, 1) 1])) ./ repmat(range(densityBEMatrix, 1), [size(densityBEMatrix, 1) 1])), &#39;N&#39;, 10, &#39;tht0&#39;, 180, &#39;axesHandle&#39;, axesHandle);
<a name="l00423"></a>00423                 colorbar_label = &#39;Relative <a class="code" href="class_protein.html">Protein</a> Count On Each Ring&#39;;
<a name="l00424"></a>00424                 c_handle = colorbar();
<a name="l00425"></a>00425             else
<a name="l00426"></a>00426                 scaleFactor = 1000;
<a name="l00427"></a>00427                 h = bullseye(log10(scaleFactor * densityBEMatrix * (maxTime/3600) + 1), &#39;N&#39;, 10, &#39;tht0&#39;, 180, &#39;axesHandle&#39;, axesHandle);
<a name="l00428"></a>00428                 colorbar_label = &#39;<a class="code" href="class_protein.html">Protein</a> / nt / cell cycle&#39;;
<a name="l00429"></a>00429                 c_handle = colorbar();
<a name="l00430"></a>00430                 yticks = get(c_handle, &#39;YTick&#39;);
<a name="l00431"></a>00431                 yticklabels = ((10 .^ yticks) - 1) / (scaleFactor);
<a name="l00432"></a>00432                 yticklabels_str = cell(size(yticklabels));
<a name="l00433"></a>00433                 for i = 1:numel(yticklabels_str)
<a name="l00434"></a>00434                     yticklabels_str{i} = sprintf(<span class="stringliteral">&#39;%0.02g&#39;</span>, yticklabels(i));
<a name="l00435"></a>00435                 end
<a name="l00436"></a>00436                 <span class="keyword">set</span>(c_handle, <span class="stringliteral">&#39;YTickLabel&#39;</span>, yticklabels_str);
<a name="l00437"></a>00437             end
<a name="l00438"></a>00438             <span class="keyword">set</span>(h, <span class="stringliteral">&#39;ButtonDownFcn&#39;</span>, <span class="stringliteral">&#39;edu.stanford.covert.cell.sim.analysis.ChromosomeSpaceTimePlot.getClickPos(maxSpace)&#39;</span>);
<a name="l00439"></a>00439             ylbl = <span class="keyword">get</span>(c_handle, <span class="stringliteral">&#39;YLabel&#39;</span>);
<a name="l00440"></a>00440             <span class="keyword">set</span>(ylbl, <span class="stringliteral">&#39;String&#39;</span>, colorbar_label);
<a name="l00441"></a>00441             line([0 0], [5 5.1], <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>, <span class="stringliteral">&#39;LineWidth&#39;</span>, 1, <span class="stringliteral">&#39;LineStyle&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00442"></a>00442             text(0, 5.15, <span class="stringliteral">&#39;OriC&#39;</span>, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;right&#39;</span>, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;middle&#39;</span>, <span class="stringliteral">&#39;Rotation&#39;</span>, 270, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00443"></a>00443             line([0 0], [-5 -5.1], <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>, <span class="stringliteral">&#39;LineWidth&#39;</span>, 1, <span class="stringliteral">&#39;LineStyle&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00444"></a>00444             text(0, -5.15, <span class="stringliteral">&#39;TerC&#39;</span>, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;left&#39;</span>, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;middle&#39;</span>, <span class="stringliteral">&#39;Rotation&#39;</span>, 270, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00445"></a>00445             
<a name="l00446"></a>00446             thisIdx = 297;
<a name="l00447"></a>00447             theta = (pi / 2) + simulation.gene.startCoordinates(thisIdx) / 580076 * 2 * pi;
<a name="l00448"></a>00448             [x, y] = pol2cart(theta, [5 5.1]);
<a name="l00449"></a>00449             line(x, y, <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>, <span class="stringliteral">&#39;LineWidth&#39;</span>, 1, <span class="stringliteral">&#39;LineStyle&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00450"></a>00450             [x, y] = pol2cart(theta, 5.15);
<a name="l00451"></a>00451             halign = <span class="stringliteral">&#39;left&#39;</span>;
<a name="l00452"></a>00452             <span class="keywordflow">if</span> theta &gt;= (pi / 2) &amp;&amp; theta &lt; 3 * (pi / 2)
<a name="l00453"></a>00453                 theta = theta + pi;
<a name="l00454"></a>00454                 halign = <span class="stringliteral">&#39;right&#39;</span>;
<a name="l00455"></a>00455             end
<a name="l00456"></a>00456             text(x, y, ids{thisIdx}, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, halign, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;middle&#39;</span>, <span class="stringliteral">&#39;Interpreter&#39;</span>, <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;Rotation&#39;</span>, theta * 180 / pi, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00457"></a>00457             
<a name="l00458"></a>00458             thisIdx = 302;
<a name="l00459"></a>00459             theta = (pi / 2) + simulation.gene.startCoordinates(thisIdx) / 580076 * 2 * pi;
<a name="l00460"></a>00460             [x, y] = pol2cart(theta, [5 5.1]);
<a name="l00461"></a>00461             line(x, y, <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>, <span class="stringliteral">&#39;LineWidth&#39;</span>, 1, <span class="stringliteral">&#39;LineStyle&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00462"></a>00462             [x, y] = pol2cart(theta, 5.15);
<a name="l00463"></a>00463             halign = <span class="stringliteral">&#39;left&#39;</span>;
<a name="l00464"></a>00464             <span class="keywordflow">if</span> theta &gt;= (pi / 2) &amp;&amp; theta &lt; 3 * (pi / 2)
<a name="l00465"></a>00465                 theta = theta + pi;
<a name="l00466"></a>00466                 halign = <span class="stringliteral">&#39;right&#39;</span>;
<a name="l00467"></a>00467             end
<a name="l00468"></a>00468             text(x, y, ids{thisIdx}, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, halign, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;middle&#39;</span>, <span class="stringliteral">&#39;Interpreter&#39;</span>, <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;Rotation&#39;</span>, theta * 180 / pi, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00469"></a>00469             
<a name="l00470"></a>00470             thisIdx = [229 236];
<a name="l00471"></a>00471             theta = (pi / 2) + simulation.gene.startCoordinates(thisIdx(1)) / 580076 * 2 * pi;
<a name="l00472"></a>00472             [x, y] = pol2cart(theta, [5 5.1]);
<a name="l00473"></a>00473             line(x, y, <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>, <span class="stringliteral">&#39;LineWidth&#39;</span>, 1, <span class="stringliteral">&#39;LineStyle&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00474"></a>00474             [x, y] = pol2cart(theta, 5.15);
<a name="l00475"></a>00475             halign = <span class="stringliteral">&#39;left&#39;</span>;
<a name="l00476"></a>00476             <span class="keywordflow">if</span> theta &gt;= (pi / 2) &amp;&amp; theta &lt; 3 * (pi / 2)
<a name="l00477"></a>00477                 theta = theta + pi;
<a name="l00478"></a>00478                 halign = <span class="stringliteral">&#39;right&#39;</span>;
<a name="l00479"></a>00479             end
<a name="l00480"></a>00480             text(x, y, [ids{thisIdx(1)} <span class="charliteral">&#39;-&#39;</span> ids{thisIdx(2)}], <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, halign, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;middle&#39;</span>, <span class="stringliteral">&#39;Interpreter&#39;</span>, <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;Rotation&#39;</span>, theta * 180 / pi, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00481"></a>00481             
<a name="l00482"></a>00482             thisIdx = [144 148];
<a name="l00483"></a>00483             theta = (pi / 2) + simulation.gene.startCoordinates(thisIdx(1)) / 580076 * 2 * pi;
<a name="l00484"></a>00484             [x, y] = pol2cart(theta, [5 5.1]);
<a name="l00485"></a>00485             line(x, y, <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>, <span class="stringliteral">&#39;LineWidth&#39;</span>, 1, <span class="stringliteral">&#39;LineStyle&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00486"></a>00486             [x, y] = pol2cart(theta, 5.15);
<a name="l00487"></a>00487             halign = <span class="stringliteral">&#39;left&#39;</span>;
<a name="l00488"></a>00488             <span class="keywordflow">if</span> theta &gt;= (pi / 2) &amp;&amp; theta &lt; 3 * (pi / 2)
<a name="l00489"></a>00489                 theta = theta + pi;
<a name="l00490"></a>00490                 halign = <span class="stringliteral">&#39;right&#39;</span>;
<a name="l00491"></a>00491             end
<a name="l00492"></a>00492             text(x, y, [ids{thisIdx(1)} <span class="charliteral">&#39;-&#39;</span> ids{thisIdx(2)}], <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, halign, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;middle&#39;</span>, <span class="stringliteral">&#39;Interpreter&#39;</span>, <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;Rotation&#39;</span>, theta * 180 / pi, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00493"></a>00493             
<a name="l00494"></a>00494             thisIdx = 400;
<a name="l00495"></a>00495             theta = (pi / 2) + simulation.gene.startCoordinates(thisIdx) / 580076 * 2 * pi;
<a name="l00496"></a>00496             [x, y] = pol2cart(theta, [5 5.1]);
<a name="l00497"></a>00497             line(x, y, <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>, <span class="stringliteral">&#39;LineWidth&#39;</span>, 1, <span class="stringliteral">&#39;LineStyle&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00498"></a>00498             [x, y] = pol2cart(theta, 5.15);
<a name="l00499"></a>00499             halign = <span class="stringliteral">&#39;left&#39;</span>;
<a name="l00500"></a>00500             <span class="keywordflow">if</span> theta &gt;= (pi / 2) &amp;&amp; theta &lt; 3 * (pi / 2)
<a name="l00501"></a>00501                 theta = theta + pi;
<a name="l00502"></a>00502                 halign = <span class="stringliteral">&#39;right&#39;</span>;
<a name="l00503"></a>00503             end
<a name="l00504"></a>00504             text(x, y, ids{thisIdx}, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, halign, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;middle&#39;</span>, <span class="stringliteral">&#39;Interpreter&#39;</span>, <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;Rotation&#39;</span>, theta * 180 / pi, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00505"></a>00505             
<a name="l00506"></a>00506             thisIdx = 501;
<a name="l00507"></a>00507             theta = (pi / 2) + simulation.gene.startCoordinates(thisIdx) / 580076 * 2 * pi;
<a name="l00508"></a>00508             [x, y] = pol2cart(theta, [5 5.1]);
<a name="l00509"></a>00509             line(x, y, <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>, <span class="stringliteral">&#39;LineWidth&#39;</span>, 1, <span class="stringliteral">&#39;LineStyle&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00510"></a>00510             [x, y] = pol2cart(theta, 5.15);
<a name="l00511"></a>00511             halign = <span class="stringliteral">&#39;left&#39;</span>;
<a name="l00512"></a>00512             <span class="keywordflow">if</span> theta &gt;= (pi / 2) &amp;&amp; theta &lt; 3 * (pi / 2)
<a name="l00513"></a>00513                 theta = theta + pi;
<a name="l00514"></a>00514                 halign = <span class="stringliteral">&#39;right&#39;</span>;
<a name="l00515"></a>00515             end
<a name="l00516"></a>00516             text(x, y, ids{thisIdx}, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, halign, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;middle&#39;</span>, <span class="stringliteral">&#39;Interpreter&#39;</span>, <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;Rotation&#39;</span>, theta * 180 / pi, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00517"></a>00517             
<a name="l00518"></a>00518             thisIdx = [16 17];
<a name="l00519"></a>00519             theta = (pi / 2) + simulation.gene.startCoordinates(thisIdx(1)) / 580076 * 2 * pi;
<a name="l00520"></a>00520             [x, y] = pol2cart(theta, [5 5.1]);
<a name="l00521"></a>00521             line(x, y, <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>, <span class="stringliteral">&#39;LineWidth&#39;</span>, 1, <span class="stringliteral">&#39;LineStyle&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00522"></a>00522             [x, y] = pol2cart(theta, 5.15);
<a name="l00523"></a>00523             halign = <span class="stringliteral">&#39;left&#39;</span>;
<a name="l00524"></a>00524             <span class="keywordflow">if</span> theta &gt;= (pi / 2) &amp;&amp; theta &lt; 3 * (pi / 2)
<a name="l00525"></a>00525                 theta = theta + pi;
<a name="l00526"></a>00526                 halign = <span class="stringliteral">&#39;right&#39;</span>;
<a name="l00527"></a>00527             end
<a name="l00528"></a>00528             text(x, y, [ids{thisIdx(1)} <span class="charliteral">&#39;-&#39;</span> ids{thisIdx(2)}], <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, halign, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;middle&#39;</span>, <span class="stringliteral">&#39;Interpreter&#39;</span>, <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;Rotation&#39;</span>, theta * 180 / pi, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00529"></a>00529             
<a name="l00530"></a>00530             thisIdx = [104 106];
<a name="l00531"></a>00531             theta = (pi / 2) + simulation.gene.startCoordinates(thisIdx(1)) / 580076 * 2 * pi;
<a name="l00532"></a>00532             [x, y] = pol2cart(theta, [5 5.1]);
<a name="l00533"></a>00533             line(x, y, <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>, <span class="stringliteral">&#39;LineWidth&#39;</span>, 1, <span class="stringliteral">&#39;LineStyle&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00534"></a>00534             [x, y] = pol2cart(theta, 5.15);
<a name="l00535"></a>00535             halign = <span class="stringliteral">&#39;left&#39;</span>;
<a name="l00536"></a>00536             <span class="keywordflow">if</span> theta &gt;= (pi / 2) &amp;&amp; theta &lt; 3 * (pi / 2)
<a name="l00537"></a>00537                 theta = theta + pi;
<a name="l00538"></a>00538                 halign = <span class="stringliteral">&#39;right&#39;</span>;
<a name="l00539"></a>00539             end
<a name="l00540"></a>00540             text(x, y, [ids{thisIdx(1)} <span class="charliteral">&#39;-&#39;</span> ids{thisIdx(2)}], <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, halign, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;middle&#39;</span>, <span class="stringliteral">&#39;Interpreter&#39;</span>, <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;Rotation&#39;</span>, theta * 180 / pi, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00541"></a>00541             
<a name="l00542"></a>00542             thisIdx = 139;
<a name="l00543"></a>00543             theta = (pi / 2) + simulation.gene.startCoordinates(thisIdx) / 580076 * 2 * pi;
<a name="l00544"></a>00544             [x, y] = pol2cart(theta, [5 5.1]);
<a name="l00545"></a>00545             line(x, y, <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>, <span class="stringliteral">&#39;LineWidth&#39;</span>, 1, <span class="stringliteral">&#39;LineStyle&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00546"></a>00546             [x, y] = pol2cart(theta, 5.15);
<a name="l00547"></a>00547             halign = <span class="stringliteral">&#39;left&#39;</span>;
<a name="l00548"></a>00548             <span class="keywordflow">if</span> theta &gt;= (pi / 2) &amp;&amp; theta &lt; 3 * (pi / 2)
<a name="l00549"></a>00549                 theta = theta + pi;
<a name="l00550"></a>00550                 halign = <span class="stringliteral">&#39;right&#39;</span>;
<a name="l00551"></a>00551             end
<a name="l00552"></a>00552             text(x, y, ids{thisIdx}, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, halign, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;middle&#39;</span>, <span class="stringliteral">&#39;Interpreter&#39;</span>, <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;Rotation&#39;</span>, theta * 180 / pi, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00553"></a>00553             
<a name="l00554"></a>00554             r = ChromosomeSpaceTimePlot.rings;
<a name="l00555"></a>00555             text(0, 1 + (r.RNAPolymerase - 1) * (4 / 7), <span class="stringliteral">&#39;RNA Polymerase&#39;</span>, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;center&#39;</span>, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;bottom&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, 8, <span class="stringliteral">&#39;Color&#39;</span>, <span class="stringliteral">&#39;White&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00556"></a>00556             text(0, 1 + (r.SMC - 1) * (4 / 7), <span class="stringliteral">&#39;SMC&#39;</span>, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;center&#39;</span>, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;bottom&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, 8, <span class="stringliteral">&#39;Color&#39;</span>, <span class="stringliteral">&#39;White&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00557"></a>00557             text(0, 1 + (r.Helicase - 1) * (4 / 7), <span class="stringliteral">&#39;Helicase&#39;</span>, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;center&#39;</span>, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;bottom&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, 8, <span class="stringliteral">&#39;Color&#39;</span>, <span class="stringliteral">&#39;Black&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00558"></a>00558             text(0, 1 + (r.DnaA - 1) * (4 / 7), <span class="stringliteral">&#39;DnaA&#39;</span>, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;center&#39;</span>, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;bottom&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, 8, <span class="stringliteral">&#39;Color&#39;</span>, <span class="stringliteral">&#39;White&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00559"></a>00559             text(0, 1 + (r.Gyrase - 1) * (4 / 7), <span class="stringliteral">&#39;Gyrase&#39;</span>, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;center&#39;</span>, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;bottom&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, 8, <span class="stringliteral">&#39;Color&#39;</span>, <span class="stringliteral">&#39;White&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00560"></a>00560             text(0, 1 + (r.TopoisomeraseIV - 1) * (4 / 7), <span class="stringliteral">&#39;Topoisomerase IV&#39;</span>, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;center&#39;</span>, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;bottom&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, 8, <span class="stringliteral">&#39;Color&#39;</span>, <span class="stringliteral">&#39;Black&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00561"></a>00561             text(0, 1 + (r.Regulation - 1) * (4 / 7), <span class="stringliteral">&#39;Regulation&#39;</span>, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;center&#39;</span>, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;bottom&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, 8, <span class="stringliteral">&#39;Color&#39;</span>, <span class="stringliteral">&#39;Black&#39;</span>, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l00562"></a>00562             
<a name="l00563"></a>00563             title(axesHandle, figTitle);
<a name="l00564"></a>00564         end
<a name="l00565"></a>00565         
<a name="l00566"></a>00566         <span class="keyword">function</span> pos = getRnaPPos(activePos, time)
<a name="l00567"></a>00567             pos = activePos(:, time);
<a name="l00568"></a>00568             pos(isnan(pos)) = [];
<a name="l00569"></a>00569         end
<a name="l00570"></a>00570         
<a name="l00571"></a>00571         function pos = getPos(subs, time)
<a name="l00572"></a>00572             pos = subs(subs(:, 3) == time, 1);
<a name="l00573"></a>00573         end
<a name="l00574"></a>00574         
<a name="l00575"></a>00575         function getClickPos(maxVal)
<a name="l00576"></a>00576             pt = get(gca, &#39;CurrentPoint&#39;);
<a name="l00577"></a>00577             theta = cart2pol(pt(1, 1), pt(1, 2));
<a name="l00578"></a>00578             theta = theta - (pi / 2);
<a name="l00579"></a>00579             if theta &lt; 0
<a name="l00580"></a>00580                 theta = theta + (2 * pi);
<a name="l00581"></a>00581             elseif theta &gt; (2 * pi)
<a name="l00582"></a>00582                 theta = theta - (2 * pi);
<a name="l00583"></a>00583             end
<a name="l00584"></a>00584             fprintf(&#39;Clicked on nucleotide: %05g\n&#39;, (theta * maxVal / (2 * pi)));
<a name="l00585"></a>00585         end
<a name="l00586"></a>00586         
<a name="l00587"></a>00587         function RNAPSparseMat = makeRNAPSparseMat(states, sim)
<a name="l00588"></a>00588             c = sim.state(&#39;<a class="code" href="class_chromosome.html">Chromosome</a>&#39;);
<a name="l00589"></a>00589             
<a name="l00590"></a>00590             nTimePoints = size(states.RNAPolymerase.positionStrands, 3);
<a name="l00591"></a>00591             nRnaPol = size(states.RNAPolymerase.positionStrands, 1);
<a name="l00592"></a>00592             polStates = reshape(states.RNAPolymerase.states, [nRnaPol * nTimePoints 1]);
<a name="l00593"></a>00593             posStrndTimes = reshape(permute([states.RNAPolymerase.positionStrands repmat(permute(1:nTimePoints, [1 3 2]), [nRnaPol 1])], [1 3 2]), [nRnaPol * nTimePoints 3]);
<a name="l00594"></a>00594             
<a name="l00595"></a>00595             polStates = polStates(posStrndTimes(:, 1) ~= 0, :);
<a name="l00596"></a>00596             posStrndTimes = posStrndTimes(posStrndTimes(:, 1) ~= 0, :);
<a name="l00597"></a>00597             
<a name="l00598"></a>00598             RNAPSparseMat = edu.stanford.covert.util.<a class="code" href="class_circular_sparse_mat.html">CircularSparseMat</a>(posStrndTimes, polStates, [c.sequenceLen 4 nTimePoints], 1);
<a name="l00599"></a>00599         end
<a name="l00600"></a>00600         
<a name="l00601"></a>00601         function [ensemble, states, legendHandle] = plotSpaceTime(...
<a name="l00602"></a>00602                 axesHandle, simBatchDir, simNum, nRNAPols, ...
<a name="l00603"></a>00603                 nonSpecBoundPols, posSpan, showSingleDnaALine, showLegend, ...
<a name="l00604"></a>00604                 ensemble, states, ...
<a name="l00605"></a>00605                 dnaPolLineWidth, rnaPolLineWidth, showRNAPolDetails)
<a name="l00606"></a>00606             import edu.stanford.covert.cell.sim.analysis.ChromosomeSpaceTimePlot;
<a name="l00607"></a>00607             import edu.stanford.covert.cell.sim.util.DiskLogger;
<a name="l00608"></a>00608             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l00609"></a>00609             import edu.stanford.covert.cell.sim.util.SimulationEnsemble;
<a name="l00610"></a>00610             
<a name="l00611"></a>00611             [simDir, ~, sim] = SimulationDiskUtil.getSimulation([simBatchDir filesep num2str(simNum)]);
<a name="l00612"></a>00612             c = sim.state(&#39;Chromosome&#39;);
<a name="l00613"></a>00613             rnaPol = sim.state(&#39;RNAPolymerase&#39;);
<a name="l00614"></a>00614             
<a name="l00615"></a>00615             if nargin &lt; 10
<a name="l00616"></a>00616                 stateNames = {
<a name="l00617"></a>00617                     <span class="stringliteral">&#39;helicase1&#39;</span>         <span class="stringliteral">&#39;Helicase 1&#39;</span>
<a name="l00618"></a>00618                     <span class="stringliteral">&#39;helicase2&#39;</span>         <span class="stringliteral">&#39;Helicase 2&#39;</span>
<a name="l00619"></a>00619                     <span class="stringliteral">&#39;leadingPol1&#39;</span>       <span class="stringliteral">&#39;Leading Polymerase 1&#39;</span>
<a name="l00620"></a>00620                     <span class="stringliteral">&#39;leadingPol2&#39;</span>       <span class="stringliteral">&#39;Leading Polymerase 2&#39;</span>
<a name="l00621"></a>00621                     <span class="stringliteral">&#39;laggingPol1&#39;</span>       <span class="stringliteral">&#39;Lagging Polymerase 1&#39;</span>
<a name="l00622"></a>00622                     <span class="stringliteral">&#39;laggingPol2&#39;</span>       <span class="stringliteral">&#39;Lagging Polymerase 2&#39;</span>
<a name="l00623"></a>00623                     <span class="stringliteral">&#39;dnaA_box1&#39;</span>         <span class="stringliteral">&#39;DnaA Box R1&#39;</span>
<a name="l00624"></a>00624                     <span class="stringliteral">&#39;dnaA_box2&#39;</span>         <span class="stringliteral">&#39;DnaA Box R2&#39;</span>
<a name="l00625"></a>00625                     <span class="stringliteral">&#39;dnaA_box3&#39;</span>         <span class="stringliteral">&#39;DnaA Box R3&#39;</span>
<a name="l00626"></a>00626                     <span class="stringliteral">&#39;dnaA_box4&#39;</span>         <span class="stringliteral">&#39;DnaA Box R4&#39;</span>
<a name="l00627"></a>00627                     <span class="stringliteral">&#39;dnaA_box5&#39;</span>         <span class="stringliteral">&#39;DnaA Box R5&#39;</span>
<a name="l00628"></a>00628                     };
<a name="l00629"></a>00629                 ensemble = SimulationEnsemble(simBatchDir, stateNames, [], simNum);
<a name="l00630"></a>00630                 
<a name="l00631"></a>00631                 stateNames = {
<a name="l00632"></a>00632                     %<span class="stringliteral">&#39;Chromosome&#39;</span>         <span class="stringliteral">&#39;monomerBoundSites&#39;</span>
<a name="l00633"></a>00633                     %<span class="stringliteral">&#39;Chromosome&#39;</span>         <span class="stringliteral">&#39;complexBoundSites&#39;</span>
<a name="l00634"></a>00634                     <span class="stringliteral">&#39;RNAPolymerase&#39;</span>      <span class="stringliteral">&#39;states&#39;</span>
<a name="l00635"></a>00635                     <span class="stringliteral">&#39;RNAPolymerase&#39;</span>      <span class="stringliteral">&#39;positionStrands&#39;</span>
<a name="l00636"></a>00636                     <span class="stringliteral">&#39;Transcript&#39;</span>         <span class="stringliteral">&#39;boundTranscriptionUnits&#39;</span>
<a name="l00637"></a>00637                     <span class="stringliteral">&#39;Transcript&#39;</span>         <span class="stringliteral">&#39;boundTranscriptProgress&#39;</span>
<a name="l00638"></a>00638                     <span class="stringliteral">&#39;Transcript&#39;</span>         <span class="stringliteral">&#39;boundTranscriptChromosome&#39;</span>
<a name="l00639"></a>00639                     };
<a name="l00640"></a>00640                 states = DiskLogger.load(simDir, stateNames, [], [], [], <span class="stringliteral">&#39;extract&#39;</span>);
<a name="l00641"></a>00641             end
<a name="l00642"></a>00642             
<a name="l00643"></a>00643             time = ensemble.stateData.time / 3600;
<a name="l00644"></a>00644             replisome = [
<a name="l00645"></a>00645                 ensemble.stateData.values(ensemble.getPropertyIndices(&#39;helicase1&#39;), :, :, :)
<a name="l00646"></a>00646                 ensemble.stateData.values(ensemble.getPropertyIndices(&#39;helicase2&#39;), :, :, :)
<a name="l00647"></a>00647                 ensemble.stateData.values(ensemble.getPropertyIndices(&#39;leadingPol1&#39;), :, :, :)
<a name="l00648"></a>00648                 ensemble.stateData.values(ensemble.getPropertyIndices(&#39;leadingPol2&#39;), :, :, :)
<a name="l00649"></a>00649                 ensemble.stateData.values(ensemble.getPropertyIndices(&#39;laggingPol1&#39;), :, :, :)
<a name="l00650"></a>00650                 ensemble.stateData.values(ensemble.getPropertyIndices(&#39;laggingPol2&#39;), :, :, :)
<a name="l00651"></a>00651                 ];
<a name="l00652"></a>00652             
<a name="l00653"></a>00653             <span class="keywordflow">if</span> nargin &lt; 6 || isempty(posSpan)
<a name="l00654"></a>00654                 posSpan = [1 c.sequenceLen];
<a name="l00655"></a>00655                 set(axesHandle, &#39;YTick&#39;, [1 c.terCPosition c.sequenceLen]);
<a name="l00656"></a>00656                 set(axesHandle, &#39;YTickLabel&#39;, {<span class="stringliteral">&#39;terC&#39;</span>, <span class="stringliteral">&#39;oriC&#39;</span>, <span class="stringliteral">&#39;terC&#39;</span>});
<a name="l00657"></a>00657             <span class="keywordflow">else</span>
<a name="l00658"></a>00658                 yTick = [1; c.terCPosition; c.sequenceLen];
<a name="l00659"></a>00659                 yTickLabel = {<span class="stringliteral">&#39;oriC&#39;</span>; <span class="stringliteral">&#39;terC&#39;</span>; <span class="stringliteral">&#39;oriC&#39;</span>};
<a name="l00660"></a>00660                 <span class="keywordflow">if</span> posSpan(1) &gt; c.terCPosition
<a name="l00661"></a>00661                     yTick = [yTick; posSpan(1)];
<a name="l00662"></a>00662                     yTickLabel = [yTickLabel; sprintf(&#39;terC+%d&#39;, posSpan(1)-c.terCPosition)];
<a name="l00663"></a>00663                 elseif posSpan(1) &lt; c.terCPosition
<a name="l00664"></a>00664                     yTick = [yTick; posSpan(1)];
<a name="l00665"></a>00665                     yTickLabel = [yTickLabel; sprintf(&#39;terC-%d&#39;, c.terCPosition-posSpan(1))];
<a name="l00666"></a>00666                 end
<a name="l00667"></a>00667                 <span class="keywordflow">if</span> posSpan(2) &gt; c.terCPosition
<a name="l00668"></a>00668                     yTick = [yTick; posSpan(2)];
<a name="l00669"></a>00669                     yTickLabel = [yTickLabel; sprintf(&#39;terC+%d&#39;, posSpan(2)-c.terCPosition)];
<a name="l00670"></a>00670                 elseif posSpan(2) &lt; c.terCPosition
<a name="l00671"></a>00671                     yTick = [yTick; posSpan(2)];
<a name="l00672"></a>00672                     yTickLabel = [yTickLabel; sprintf(&#39;terC-%d&#39;, c.terCPosition-posSpan(2))];
<a name="l00673"></a>00673                 end
<a name="l00674"></a>00674                 
<a name="l00675"></a>00675                 [~, order] = unique(yTick);
<a name="l00676"></a>00676                 <span class="keyword">set</span>(axesHandle, <span class="stringliteral">&#39;YTick&#39;</span>, yTick(order));
<a name="l00677"></a>00677                 <span class="keyword">set</span>(axesHandle, <span class="stringliteral">&#39;YTickLabel&#39;</span>, yTickLabel(order));
<a name="l00678"></a>00678             end
<a name="l00679"></a>00679             
<a name="l00680"></a>00680             xlim(axesHandle, time([1 end]));
<a name="l00681"></a>00681             ylim(axesHandle, posSpan);
<a name="l00682"></a>00682             ylabel(axesHandle, <span class="stringliteral">&#39;Position&#39;</span>);
<a name="l00683"></a>00683             
<a name="l00684"></a>00684             %rna polymeraase
<a name="l00685"></a>00685             <span class="keywordflow">if</span> nargin &lt; 4 || isempty(nRNAPols)
<a name="l00686"></a>00686                 nRNAPols = size(states.RNAPolymerase.states, 1);
<a name="l00687"></a>00687             end
<a name="l00688"></a>00688             if nargin &lt; 12
<a name="l00689"></a>00689                 rnaPolLineWidth = 0.25;
<a name="l00690"></a>00690             end
<a name="l00691"></a>00691             for i = 1:nRNAPols
<a name="l00692"></a>00692                 %actively transcribing / specifically bound
<a name="l00693"></a>00693                 startIdxs = find(cat(3, ...
<a name="l00694"></a>00694                     (states.RNAPolymerase.states(i, :, 1) &gt;= rnaPol.activelyTranscribingValue | ...
<a name="l00695"></a>00695                     states.RNAPolymerase.states(i, :, 1) == rnaPol.specificallyBoundValue) &amp; ...
<a name="l00696"></a>00696                     states.Transcript.boundTranscriptChromosome(i, :, 1) == 1, ...
<a name="l00697"></a>00697                     diff((states.RNAPolymerase.states(i, :, :) &gt;= rnaPol.activelyTranscribingValue | ...
<a name="l00698"></a>00698                     states.RNAPolymerase.states(i, :, :) == rnaPol.specificallyBoundValue) &amp; ...
<a name="l00699"></a>00699                     states.Transcript.boundTranscriptChromosome(i, :, :) == 1, 1, 3) &gt; 0));
<a name="l00700"></a>00700                 endIdxs = find(cat(3, ...
<a name="l00701"></a>00701                     diff((states.RNAPolymerase.states(i, :, :) &gt;= rnaPol.activelyTranscribingValue | ...
<a name="l00702"></a>00702                     states.RNAPolymerase.states(i, :, :) == rnaPol.specificallyBoundValue) &amp; ...
<a name="l00703"></a>00703                     states.Transcript.boundTranscriptChromosome(i, :, :) == 1, 1, 3) &lt; 0, ...
<a name="l00704"></a>00704                     (states.RNAPolymerase.states(i, :, end) &gt;= rnaPol.activelyTranscribingValue | ...
<a name="l00705"></a>00705                     states.RNAPolymerase.states(i, :, end) == rnaPol.specificallyBoundValue) &amp; ...
<a name="l00706"></a>00706                     states.Transcript.boundTranscriptChromosome(i, :, end) == 1));
<a name="l00707"></a>00707                 tfs = ...
<a name="l00708"></a>00708                     (states.RNAPolymerase.positionStrands(i, 1, startIdxs) &gt;= posSpan(1) &amp; ...
<a name="l00709"></a>00709                     states.RNAPolymerase.positionStrands(i, 1, startIdxs) &lt;= posSpan(2)) |  ...
<a name="l00710"></a>00710                     (states.RNAPolymerase.positionStrands(i, 1, endIdxs) &gt;= posSpan(1) &amp;  ...
<a name="l00711"></a>00711                     states.RNAPolymerase.positionStrands(i, 1, endIdxs) &lt;= posSpan(2)) | ...
<a name="l00712"></a>00712                     (states.RNAPolymerase.positionStrands(i, 1, startIdxs) &lt;= posSpan(1) &amp;  ...
<a name="l00713"></a>00713                     states.RNAPolymerase.positionStrands(i, 1, endIdxs) &gt;= posSpan(2)) | ...
<a name="l00714"></a>00714                     (states.RNAPolymerase.positionStrands(i, 1, endIdxs) &lt;= posSpan(1) &amp;  ...
<a name="l00715"></a>00715                     states.RNAPolymerase.positionStrands(i, 1, startIdxs) &gt;= posSpan(2));
<a name="l00716"></a>00716                 if any(tfs)
<a name="l00717"></a>00717                     if nargin &gt;= 13 &amp;&amp; showRNAPolDetails
<a name="l00718"></a>00718                         tmpIdxs = find(tfs);
<a name="l00719"></a>00719                         for j = 1:numel(tmpIdxs)
<a name="l00720"></a>00720                             rnaATPolHandle = line((startIdxs(tmpIdxs(j)):endIdxs(tmpIdxs(j))) / 3600, mod(...
<a name="l00721"></a>00721                                 permute(states.RNAPolymerase.positionStrands(i, 1, startIdxs(tmpIdxs(j)):endIdxs(tmpIdxs(j))), [1 3 2]) ...
<a name="l00722"></a>00722                                 - c.sequenceLen/2 - 1, c.sequenceLen) + 1, ...
<a name="l00723"></a>00723                                 &#39;Color&#39;, &#39;b&#39;, &#39;Parent&#39;, axesHandle, &#39;LineWidth&#39;, rnaPolLineWidth);
<a name="l00724"></a>00724                         end
<a name="l00725"></a>00725                     else
<a name="l00726"></a>00726                         rnaATPolHandle = line([startIdxs(tfs) endIdxs(tfs)]&#39; / 3600, mod([...
<a name="l00727"></a>00727                             permute(states.RNAPolymerase.positionStrands(i, 1, startIdxs(tfs)), [1 3 2])
<a name="l00728"></a>00728                             permute(states.RNAPolymerase.positionStrands(i, 1, endIdxs(tfs)), [1 3 2])
<a name="l00729"></a>00729                             ] - c.sequenceLen/2 - 1, c.sequenceLen) + 1, ...
<a name="l00730"></a>00730                             &#39;Color&#39;, &#39;b&#39;, &#39;Parent&#39;, axesHandle, &#39;LineWidth&#39;, rnaPolLineWidth);
<a name="l00731"></a>00731                     end
<a name="l00732"></a>00732                 end
<a name="l00733"></a>00733                     
<a name="l00734"></a>00734                 %non-specifically bound
<a name="l00735"></a>00735                 if nargin &lt; 5 || nonSpecBoundPols
<a name="l00736"></a>00736                     startIdxs = find(states.RNAPolymerase.states(i, :, :) == rnaPol.nonSpecificallyBoundValue &amp; ...
<a name="l00737"></a>00737                         states.RNAPolymerase.positionStrands(i, 2, :) &lt;= 2 &amp; ...
<a name="l00738"></a>00738                         cat(3, true, diff(states.RNAPolymerase.positionStrands(i, 1, :), 1, 3)));
<a name="l00739"></a>00739                     endIdxs = find(states.RNAPolymerase.states(i, :, :) == rnaPol.nonSpecificallyBoundValue &amp; ...
<a name="l00740"></a>00740                         states.RNAPolymerase.positionStrands(i, 2, :) &lt;= 2 &amp; ...
<a name="l00741"></a>00741                         cat(3, diff(states.RNAPolymerase.positionStrands(i, 1, :), 1, 3), true));
<a name="l00742"></a>00742                     tfs = ...
<a name="l00743"></a>00743                         (states.RNAPolymerase.positionStrands(i, 1, startIdxs) &gt;= posSpan(1) &amp; ...
<a name="l00744"></a>00744                         states.RNAPolymerase.positionStrands(i, 1, startIdxs) &lt;= posSpan(2)) |  ...
<a name="l00745"></a>00745                         (states.RNAPolymerase.positionStrands(i, 1, endIdxs) &gt;= posSpan(1) &amp;  ...
<a name="l00746"></a>00746                         states.RNAPolymerase.positionStrands(i, 1, endIdxs) &lt;= posSpan(2));
<a name="l00747"></a>00747                     if any(tfs)
<a name="l00748"></a>00748                         if nargin &gt;= 13 &amp;&amp; showRNAPolDetails
<a name="l00749"></a>00749                             tmpIdxs = find(tfs);
<a name="l00750"></a>00750                             for j = 1:numel(tmpIdxs)
<a name="l00751"></a>00751                                 rnaNSBPolHandle = line((startIdxs(tmpIdxs(j)):endIdxs(tmpIdxs(j))) / 3600, mod(...
<a name="l00752"></a>00752                                     permute(states.RNAPolymerase.positionStrands(i, 1, startIdxs(tmpIdxs(j)):endIdxs(tmpIdxs(j))), [1 3 2]) ...
<a name="l00753"></a>00753                                     - c.sequenceLen/2 - 1, c.sequenceLen) + 1, ...
<a name="l00754"></a>00754                                     &#39;Color&#39;, &#39;c&#39;, &#39;Parent&#39;, axesHandle, rnaPolLineWidth);
<a name="l00755"></a>00755                             end
<a name="l00756"></a>00756                         else
<a name="l00757"></a>00757                             rnaNSBPolHandle = line([startIdxs(tfs) endIdxs(tfs)]&#39; / 3600, mod([...
<a name="l00758"></a>00758                                 permute(states.RNAPolymerase.positionStrands(i, 1, startIdxs(tfs)), [1 3 2])
<a name="l00759"></a>00759                                 permute(states.RNAPolymerase.positionStrands(i, 1, endIdxs(tfs)), [1 3 2])
<a name="l00760"></a>00760                                 ] - c.sequenceLen/2 - 1, c.sequenceLen) + 1, ...
<a name="l00761"></a>00761                                 &#39;Color&#39;, &#39;c&#39;, &#39;Parent&#39;, axesHandle, rnaPolLineWidth);
<a name="l00762"></a>00762                         end
<a name="l00763"></a>00763                     end
<a name="l00764"></a>00764                 end
<a name="l00765"></a>00765             end
<a name="l00766"></a>00766             
<a name="l00767"></a>00767             %DnaA
<a name="l00768"></a>00768             repInit = sim.process(&#39;ReplicationInitiation&#39;);
<a name="l00769"></a>00769             dnaABoxPos = mod(repInit.dnaABoxStartPositions(repInit.dnaABoxIndexs_R12345) - c.sequenceLen/2 - 1, c.sequenceLen) + 1;
<a name="l00770"></a>00770             dnaABoxMaxOccupancy = [7; 7; 7; 7; 1];
<a name="l00771"></a>00771             dnaA = [
<a name="l00772"></a>00772                 ensemble.stateData.values(ensemble.getPropertyIndices(&#39;dnaA_box1&#39;), :, :, :)
<a name="l00773"></a>00773                 ensemble.stateData.values(ensemble.getPropertyIndices(&#39;dnaA_box2&#39;), :, :, :)
<a name="l00774"></a>00774                 ensemble.stateData.values(ensemble.getPropertyIndices(&#39;dnaA_box3&#39;), :, :, :)
<a name="l00775"></a>00775                 ensemble.stateData.values(ensemble.getPropertyIndices(&#39;dnaA_box4&#39;), :, :, :)
<a name="l00776"></a>00776                 ensemble.stateData.values(ensemble.getPropertyIndices(&#39;dnaA_box5&#39;), :, :, :)
<a name="l00777"></a>00777                 ];
<a name="l00778"></a>00778             
<a name="l00779"></a>00779             if nargin &gt;= 7 &amp;&amp; showSingleDnaALine
<a name="l00780"></a>00780                 dnaABoxPos = mean(dnaABoxPos);
<a name="l00781"></a>00781                 dnaABoxMaxOccupancy = sum(dnaABoxMaxOccupancy);
<a name="l00782"></a>00782                 dnaA = sum(dnaA, 1);
<a name="l00783"></a>00783             end
<a name="l00784"></a>00784             
<a name="l00785"></a>00785             for i = 1:numel(dnaABoxPos)
<a name="l00786"></a>00786                 tmp = find(diff(dnaA(i, :, :)));
<a name="l00787"></a>00787                 for j = 1:numel(tmp)-1
<a name="l00788"></a>00788                     dnaAHandle = line([tmp(j)+1; tmp(j+1)+1] / 3600, dnaABoxPos([i i]), ...
<a name="l00789"></a>00789                         &#39;Parent&#39;, axesHandle, &#39;LineWidth&#39;, 2, &#39;Color&#39;, [
<a name="l00790"></a>00790                         1
<a name="l00791"></a>00791                         1-dnaA(i, :, tmp(j)+1)/dnaABoxMaxOccupancy(i)
<a name="l00792"></a>00792                         1-dnaA(i, :, tmp(j)+1)/dnaABoxMaxOccupancy(i)]);
<a name="l00793"></a>00793                 end
<a name="l00794"></a>00794             end
<a name="l00795"></a>00795             
<a name="l00796"></a>00796             %DNA polymerase
<a name="l00797"></a>00797             replisome(1:2:end, :) = replisome(1:2:end, :) - c.sequenceLen/2;
<a name="l00798"></a>00798             replisome(2:2:end, :) = replisome(2:2:end, :) + c.sequenceLen/2;
<a name="l00799"></a>00799             
<a name="l00800"></a>00800             idxs = [
<a name="l00801"></a>00801                 find(any(~isnan(replisome), 1), 1, &#39;first&#39;)
<a name="l00802"></a>00802                 find(any(~isnan(replisome), 1), 1, &#39;last&#39;)
<a name="l00803"></a>00803                 ];
<a name="l00804"></a>00804             green = [0 1 0];
<a name="l00805"></a>00805             if nargin &lt; 11
<a name="l00806"></a>00806                 dnaPolLineWidth = 0.5;
<a name="l00807"></a>00807             end
<a name="l00808"></a>00808             if ~isempty(idxs)
<a name="l00809"></a>00809                 line(time(:, idxs(1):idxs(2)), ...
<a name="l00810"></a>00810                     permute(replisome(3:4, :, idxs(1):idxs(2), :), [1 3 2 4]), ...
<a name="l00811"></a>00811                     &#39;Parent&#39;, axesHandle, &#39;Color&#39;, green, &#39;LineWidth&#39;, dnaPolLineWidth);
<a name="l00812"></a>00812                 
<a name="l00813"></a>00813                 tmpTime = time(:, idxs(1):idxs(2));
<a name="l00814"></a>00814                 tmp = permute(replisome(5, :, idxs(1):idxs(2), :), [1 3 2 4]);
<a name="l00815"></a>00815                 idxs = find(diff(tmp) &lt; 0);
<a name="l00816"></a>00816                 for i = numel(idxs):-1:1
<a name="l00817"></a>00817                     tmp = [tmp(1:idxs(i)) NaN tmp(idxs(i)+1:end)];
<a name="l00818"></a>00818                     tmpTime = [tmpTime(1:idxs(i)) NaN tmpTime(idxs(i)+1:end)];
<a name="l00819"></a>00819                 end
<a name="l00820"></a>00820                 line(tmpTime, tmp, &#39;Parent&#39;, axesHandle, &#39;Color&#39;, green, &#39;LineWidth&#39;, dnaPolLineWidth);
<a name="l00821"></a>00821                 
<a name="l00822"></a>00822                 tmpTime = time(:, idxs(1):idxs(2));
<a name="l00823"></a>00823                 tmp = permute(replisome(6, :, idxs(1):idxs(2), :), [1 3 2 4]);
<a name="l00824"></a>00824                 idxs = find(diff(tmp) &gt; 0);
<a name="l00825"></a>00825                 for i = numel(idxs):-1:1
<a name="l00826"></a>00826                     tmp = [tmp(1:idxs(i)) NaN tmp(idxs(i)+1:end)];
<a name="l00827"></a>00827                     tmpTime = [tmpTime(1:idxs(i)) NaN tmpTime(idxs(i)+1:end)];
<a name="l00828"></a>00828                 end
<a name="l00829"></a>00829                 dnaPolHandle = line(tmpTime, tmp, &#39;Parent&#39;, axesHandle, &#39;Color&#39;, green, &#39;LineWidth&#39;, dnaPolLineWidth);
<a name="l00830"></a>00830             end
<a name="l00831"></a>00831             
<a name="l00832"></a>00832             %legend
<a name="l00833"></a>00833             if nargin &gt;= 8 &amp;&amp; showLegend
<a name="l00834"></a>00834                 if exist(&#39;rnaNSBPolHandle&#39;, &#39;var&#39;)
<a name="l00835"></a>00835                     handles = [dnaAHandle(1) dnaPolHandle(1) rnaATPolHandle(1) rnaNSBPolHandle(1)];
<a name="l00836"></a>00836                     labels = {<span class="stringliteral">&#39;oriC DnaA&#39;</span>, <span class="stringliteral">&#39;DNA pol&#39;</span>, <span class="stringliteral">&#39;RNA pol - SB/AT&#39;</span>, <span class="stringliteral">&#39;RNA pol - NSB&#39;</span>};
<a name="l00837"></a>00837                 <span class="keywordflow">else</span>
<a name="l00838"></a>00838                     handles = [dnaAHandle(1) dnaPolHandle(1) rnaATPolHandle(1)];
<a name="l00839"></a>00839                     labels = {<span class="stringliteral">&#39;oriC DnaA&#39;</span>, <span class="stringliteral">&#39;DNA pol&#39;</span>, <span class="stringliteral">&#39;RNA pol&#39;</span>};
<a name="l00840"></a>00840                 end
<a name="l00841"></a>00841                 
<a name="l00842"></a>00842                 legendHandle = legend(handles, labels, <span class="stringliteral">&#39;FontSize&#39;</span>, 7, <span class="stringliteral">&#39;Location&#39;</span>, <span class="stringliteral">&#39;NorthWest&#39;</span>);
<a name="l00843"></a>00843 %                 ChromosomeSpaceTimePlot.formatSpaceTimeLegend(axesHandle);
<a name="l00844"></a>00844             <span class="keywordflow">else</span>
<a name="l00845"></a>00845                 legendHandle = 0;
<a name="l00846"></a>00846             end
<a name="l00847"></a>00847         end
<a name="l00848"></a>00848         
<a name="l00849"></a>00849         <span class="keyword">function</span> formatSpaceTimeLegend(axesHandle)
<a name="l00850"></a>00850             figChildren = get(get(axesHandle, &#39;parent&#39;), &#39;children&#39;);
<a name="l00851"></a>00851             legendHandle = figChildren(1);
<a name="l00852"></a>00852             set(legendHandle, &#39;Location&#39;, &#39;NorthWest&#39;);
<a name="l00853"></a>00853             legendChildren = get(legendHandle, &#39;children&#39;);
<a name="l00854"></a>00854             set(legendChildren(1:3:end), &#39;visible&#39;, &#39;off&#39;)
<a name="l00855"></a>00855             set(legendChildren(2:3:end), &#39;visible&#39;, &#39;on&#39;, &#39;LineWidth&#39;, 4)
<a name="l00856"></a>00856             set(legendChildren(2:3:end), &#39;XData&#39;, [0.085 0.2])
<a name="l00857"></a>00857             for i = 3:3:numel(legendChildren)
<a name="l00858"></a>00858                 pos = get(legendChildren(i), &#39;Position&#39;);
<a name="l00859"></a>00859                 set(legendChildren(i), &#39;Position&#39;, [0.25 pos(2) 0])
<a name="l00860"></a>00860             end
<a name="l00861"></a>00861             set(legendHandle, &#39;units&#39;, &#39;pixels&#39;);
<a name="l00862"></a>00862             legendPos = get(legendHandle, &#39;position&#39;);
<a name="l00863"></a>00863             set(legendHandle, &#39;position&#39;, [[1.4 1.42] .* legendPos(1:2) 0.57*legendPos(3) legendPos(4)]);
<a name="l00864"></a>00864         end
<a name="l00865"></a>00865         
<a name="l00866"></a>00866         function [densityBEMatrix, maxTime, maxSpace] = getProteinBindingDensityMatrix(...
<a name="l00867"></a>00867                 sim, states, RNAPSparseMat, chProteins, whatToMake, width, height)
<a name="l00868"></a>00868             import edu.stanford.covert.cell.sim.analysis.ChromosomeSpaceTimePlot;
<a name="l00869"></a>00869             
<a name="l00870"></a>00870             if exist(&#39;whatToMake&#39;, &#39;var&#39;) &amp;&amp; ~isempty(whatToMake)
<a name="l00871"></a>00871                 [~, inds] = ismember(whatToMake, chProteins(:, 5));
<a name="l00872"></a>00872                 chProteins = chProteins(inds(inds ~= 0), :);
<a name="l00873"></a>00873             end
<a name="l00874"></a>00874             
<a name="l00875"></a>00875             densityBEMatrix = zeros(height, 7);
<a name="l00876"></a>00876             
<a name="l00877"></a>00877             if exist(&#39;RNAPSparseMat&#39;, &#39;var&#39;) &amp;&amp; ~isempty(RNAPSparseMat)
<a name="l00878"></a>00878                 pol = sim.state(&#39;RNAPolymerase&#39;);
<a name="l00879"></a>00879                 subs = find(RNAPSparseMat &gt;= pol.activelyTranscribingValue);
<a name="l00880"></a>00880                 subs(subs(:, 2) &gt;= 3, :) = [];
<a name="l00881"></a>00881                 
<a name="l00882"></a>00882                 maxTime = size(RNAPSparseMat, 3);
<a name="l00883"></a>00883                 maxSpace = size(RNAPSparseMat, 1);
<a name="l00884"></a>00884                 ringName = &#39;RNAPolymerase&#39;;
<a name="l00885"></a>00885                 densityMatrix = ChromosomeSpaceTimePlot.calcChromBoundDensityMatrix(subs, width, height, maxTime, maxSpace);
<a name="l00886"></a>00886                 densityBEMatrix(:, ChromosomeSpaceTimePlot.rings.(ringName)) = ...
<a name="l00887"></a>00887                     densityBEMatrix(:, ChromosomeSpaceTimePlot.rings.(ringName)) + (sum(densityMatrix, 2) / size(densityMatrix, 2));
<a name="l00888"></a>00888             end
<a name="l00889"></a>00889             
<a name="l00890"></a>00890             for i = 1:size(chProteins, 1)
<a name="l00891"></a>00891                 chromProp = chProteins{i, 1};
<a name="l00892"></a>00892                 wIDs = chProteins{i, 2};
<a name="l00893"></a>00893                 strands = chProteins{i, 3};
<a name="l00894"></a>00894                 name = chProteins{i, 5};
<a name="l00895"></a>00895                 
<a name="l00896"></a>00896                 <span class="keywordflow">if</span> strcmp(chromProp, <span class="stringliteral">&#39;complexBoundSites&#39;</span>)
<a name="l00897"></a>00897                     mod = sim.state(&#39;ProteinComplex&#39;);
<a name="l00898"></a>00898                 elseif strcmp(chromProp, &#39;monomerBoundSites&#39;)
<a name="l00899"></a>00899                     mod = sim.state(&#39;ProteinMonomer&#39;);
<a name="l00900"></a>00900                 end
<a name="l00901"></a>00901                 [~, idxs] = ismember(wIDs, mod.wholeCellModelIDs(mod.matureIndexs));
<a name="l00902"></a>00902                 
<a name="l00903"></a>00903                 [subs, vals] = find(states.<a class="code" href="class_chromosome.html">Chromosome</a>.(chromProp));
<a name="l00904"></a>00904                 subs = subs(ismember(vals, idxs), :);
<a name="l00905"></a>00905                 subs = subs(ismember(subs(:, 2), strands), :);
<a name="l00906"></a>00906                 
<a name="l00907"></a>00907                 maxTime = size(states.<a class="code" href="class_chromosome.html">Chromosome</a>.complexBoundSites, 3);
<a name="l00908"></a>00908                 maxSpace = size(states.<a class="code" href="class_chromosome.html">Chromosome</a>.complexBoundSites, 1);
<a name="l00909"></a>00909                 densityMatrix = ChromosomeSpaceTimePlot.calcChromBoundDensityMatrix(subs, width, height, maxTime, maxSpace);
<a name="l00910"></a>00910                 
<a name="l00911"></a>00911                 if ismember(wIDs{1}, ChromosomeSpaceTimePlot.regulationWIDs)
<a name="l00912"></a>00912                     ringName = <span class="stringliteral">&#39;Regulation&#39;</span>;
<a name="l00913"></a>00913                 <span class="keywordflow">else</span>
<a name="l00914"></a>00914                     ringName = strrep(name, <span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l00915"></a>00915                 end
<a name="l00916"></a>00916                 
<a name="l00917"></a>00917                 <span class="keywordflow">if</span> isfield(ChromosomeSpaceTimePlot.rings, ringName)
<a name="l00918"></a>00918                     densityBEMatrix(:, ChromosomeSpaceTimePlot.rings.(ringName)) = ...
<a name="l00919"></a>00919                         densityBEMatrix(:, ChromosomeSpaceTimePlot.rings.(ringName)) + (sum(densityMatrix, 2) / size(densityMatrix, 2));
<a name="l00920"></a>00920                 end
<a name="l00921"></a>00921             end
<a name="l00922"></a>00922         end
<a name="l00923"></a>00923     end
<a name="l00924"></a>00924 end
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="_chromosome_space_time_plot_8m.html">ChromosomeSpaceTimePlot.m</a>      </li>

    <li class="footer">Generated on Wed Feb 8 2012 21:42:31 for Whole Cell Simulation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
