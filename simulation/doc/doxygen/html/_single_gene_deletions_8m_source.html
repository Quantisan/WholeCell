<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Whole Cell Simulation: src/+edu/+stanford/+covert/+cell/+sim/+analysis/SingleGeneDeletions.m Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Whole Cell Simulation
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_single_gene_deletions_8m.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">src/+edu/+stanford/+covert/+cell/+sim/+analysis/SingleGeneDeletions.m</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_single_gene_deletions_8m.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 %SingleGeneDeletions
<a name="l00002"></a>00002 %
<a name="l00003"></a>00003 % Author: Jonathan Karr, jkarr@stanford.edu
<a name="l00004"></a>00004 % Affiliation: Covert Lab, Department of Bioengineering, Stanford University
<a name="l00005"></a>00005 % Last Updated: 3/23/2011
<a name="l00006"></a>00006 classdef SingleGeneDeletions
<a name="l00007"></a>00007     <a class="code" href="json_parse_8m.html#a6e4256f69b751d3d7ec4ea52ff5a8dee">properties</a> (Constant = <span class="keyword">true</span>)
<a name="l00008"></a>00008         %A. Non-essential (NON_ESSENTIAL)
<a name="l00009"></a>00009         %B. Semi-essential
<a name="l00010"></a>00010         %   1. Slow growing (SLOW_GROWING)
<a name="l00011"></a>00011         %C. Essential
<a name="l00012"></a>00012         %   1. No growth
<a name="l00013"></a>00013         %      a. Macromolecule maintenance (NON_GROWING)
<a name="l00014"></a>00014         %      b. No macromolecule maintenance, toxic metabolite levels (DECOMPOSING)
<a name="l00015"></a>00015         %   2. Decaying growth
<a name="l00016"></a>00016         %      a. Non-<a class="code" href="class_r_n_a.html">RNA</a>, Non-protein synthesizing (DECAYING_GROWTH_NON_RNA_PROTEIN)
<a name="l00017"></a>00017         %         i.  Non-transcribing
<a name="l00018"></a>00018         %         ii. Non-maturing
<a name="l00019"></a>00019         %      b. Non-protein synthesizing (DECAYING_GROWTH_NON_PROTEIN)
<a name="l00020"></a>00020         %   3. Non-dividing
<a name="l00021"></a>00021         %      a. Non-replicative (NON_REPLICATIVE)
<a name="l00022"></a>00022         %      b. Non-fissive (NON_FISSIVE)
<a name="l00023"></a>00023         %   4. Unable to sustain division over many generations (NON_PERPETUATING)
<a name="l00024"></a>00024         %   5. No terminal organelle (NO_TERMINAL_ORGANELLE)
<a name="l00025"></a>00025         %   6. Toxin accumulation (TOXIN_ACCUMULATION)
<a name="l00026"></a>00026         DELETION_STRAIN_CLASSES = {
<a name="l00027"></a>00027             <span class="stringliteral">&#39;Non-essential&#39;</span>             <span class="stringliteral">&#39;Doesn&#39;</span><span class="stringliteral">&#39;t meet criterion of any of the other categories&#39;</span>
<a name="l00028"></a>00028             <span class="stringliteral">&#39;Decomposing&#39;</span>               <span class="stringliteral">&#39;No growth, no energy production, no macromolecule maintenance, toxic metabolite levels&#39;</span>
<a name="l00029"></a>00029             <span class="stringliteral">&#39;Non-growing&#39;</span>               <span class="stringliteral">&#39;No growth, energy production, macromolecule maintenance&#39;</span>
<a name="l00030"></a>00030             <span class="stringliteral">&#39;Non-RNA synthesizing&#39;</span>      <span class="stringliteral">&#39;Derivative of growth is negative, time to mass doubling is long, time to end of replication is long, cell cycle is elongated&#39;</span>
<a name="l00031"></a>00031             <span class="stringliteral">&#39;Non-protein synthesizing&#39;</span>  <span class="stringliteral">&#39;Derivative of growth is negative, time to mass doubling is long, time to end of replication is long, cell cycle is elongated&#39;</span>
<a name="l00032"></a>00032             <span class="stringliteral">&#39;Non-replicative&#39;</span>           <span class="stringliteral">&#39;End ploidy = 1, high dNTPs, no simulation finishes replication (rep end time = NaN)&#39;</span>
<a name="l00033"></a>00033             <span class="stringliteral">&#39;Non-fissive&#39;</span>               <span class="stringliteral">&#39;End ploidy = 2, but pinchedDiamter = diameter&#39;</span>
<a name="l00034"></a>00034             <span class="stringliteral">&#39;Slow growing&#39;</span>              <span class="stringliteral">&#39;Grows and divides, but slower than wild-type&#39;</span>
<a name="l00035"></a>00035             <span class="stringliteral">&#39;Toxin accumulation&#39;</span>        <span class="stringliteral">&#39;Accumulates toxic concentrations of metabolites&#39;</span>
<a name="l00036"></a>00036             <span class="stringliteral">&#39;Non-perpetuating&#39;</span>          <span class="stringliteral">&#39;Gene is essential, but cells will survive for several generations until gene products are sufficiently diluted among progeny&#39;</span>
<a name="l00037"></a>00037             <span class="stringliteral">&#39;No terminal organelle&#39;</span>     <span class="stringliteral">&#39;Lack terminal organelle&#39;</span>
<a name="l00038"></a>00038             <span class="stringliteral">&#39;Unobserved&#39;</span>                <span class="stringliteral">&#39;Simulation not yet run&#39;</span>
<a name="l00039"></a>00039             <span class="stringliteral">&#39;Wild-type&#39;</span>                 <span class="stringliteral">&#39;Wild-type simulation&#39;</span>
<a name="l00040"></a>00040             };
<a name="l00041"></a>00041         NON_ESSENTIAL                   = 1
<a name="l00042"></a>00042         DECOMPOSING                     = 2
<a name="l00043"></a>00043         NON_GROWING                     = 3
<a name="l00044"></a>00044         DECAYING_GROWTH_NON_RNA_PROTEIN = 4
<a name="l00045"></a>00045         DECAYING_GROWTH_NON_PROTEIN     = 5
<a name="l00046"></a>00046         NON_REPLICATIVE                 = 6
<a name="l00047"></a>00047         NON_FISSIVE                     = 7
<a name="l00048"></a>00048         SLOW_GROWING                    = 8
<a name="l00049"></a>00049         TOXIN_ACCUMULATION              = 9
<a name="l00050"></a>00050         NON_PERPETUATING                = 10
<a name="l00051"></a>00051         NO_TERMINAL_ORGANELLE           = 11
<a name="l00052"></a>00052         UNOBSERVED                      = 12
<a name="l00053"></a>00053         WILD_TYPE                       = 13
<a name="l00054"></a>00054         
<a name="l00055"></a>00055         COLORS = [
<a name="l00056"></a>00056             0 0 1 %blue
<a name="l00057"></a>00057             1 0 0 %red
<a name="l00058"></a>00058             0 1 0 %green
<a name="l00059"></a>00059             0 1 1 %cyan
<a name="l00060"></a>00060             1 0.5 0 %orange
<a name="l00061"></a>00061             0.5 0 0.5 %purple
<a name="l00062"></a>00062             1 0.84 0 %gold
<a name="l00063"></a>00063             0.25 0 0.5 %indigo
<a name="l00064"></a>00064             0 1 1 %aqua
<a name="l00065"></a>00065             0.5 1 0.8314 %aquamarine
<a name="l00066"></a>00066             0.329 0.525 0.043 %dark gold
<a name="l00067"></a>00067             1 0.753 0.795 %pink
<a name="l00068"></a>00068             0.25 0.25 0.25 %dark grey
<a name="l00069"></a>00069             ];
<a name="l00070"></a>00070         
<a name="l00071"></a>00071         nonPerpetuatingEssentialGenes = {
<a name="l00072"></a>00072             <span class="stringliteral">&#39;MG_0001&#39;</span>
<a name="l00073"></a>00073             <span class="stringliteral">&#39;MG_012&#39;</span>
<a name="l00074"></a>00074             <span class="stringliteral">&#39;MG_019&#39;</span>
<a name="l00075"></a>00075             <span class="stringliteral">&#39;MG_048&#39;</span>
<a name="l00076"></a>00076             <span class="stringliteral">&#39;MG_072&#39;</span>
<a name="l00077"></a>00077             <span class="stringliteral">&#39;MG_106&#39;</span>
<a name="l00078"></a>00078             <span class="stringliteral">&#39;MG_109&#39;</span>
<a name="l00079"></a>00079             <span class="stringliteral">&#39;MG_110&#39;</span>
<a name="l00080"></a>00080             <span class="stringliteral">&#39;MG_139&#39;</span>
<a name="l00081"></a>00081             <span class="stringliteral">&#39;MG_143&#39;</span>
<a name="l00082"></a>00082             <span class="stringliteral">&#39;MG_170&#39;</span>
<a name="l00083"></a>00083             <span class="stringliteral">&#39;MG_172&#39;</span>
<a name="l00084"></a>00084             <span class="stringliteral">&#39;MG_184&#39;</span>
<a name="l00085"></a>00085             <span class="stringliteral">&#39;MG_210&#39;</span>
<a name="l00086"></a>00086             <span class="stringliteral">&#39;MG_277&#39;</span>
<a name="l00087"></a>00087             <span class="stringliteral">&#39;MG_297&#39;</span>
<a name="l00088"></a>00088             <span class="stringliteral">&#39;MG_305&#39;</span>
<a name="l00089"></a>00089             <span class="stringliteral">&#39;MG_329&#39;</span>
<a name="l00090"></a>00090             <span class="stringliteral">&#39;MG_335&#39;</span>
<a name="l00091"></a>00091             <span class="stringliteral">&#39;MG_384&#39;</span>
<a name="l00092"></a>00092             <span class="stringliteral">&#39;MG_387&#39;</span>
<a name="l00093"></a>00093             <span class="stringliteral">&#39;MG_392&#39;</span>
<a name="l00094"></a>00094             <span class="stringliteral">&#39;MG_393&#39;</span>
<a name="l00095"></a>00095             <span class="stringliteral">&#39;MG_425&#39;</span>
<a name="l00096"></a>00096             <span class="stringliteral">&#39;MG_442&#39;</span>
<a name="l00097"></a>00097             <span class="stringliteral">&#39;MG_464&#39;</span>
<a name="l00098"></a>00098             <span class="stringliteral">&#39;MG_476&#39;</span>
<a name="l00099"></a>00099             };
<a name="l00100"></a>00100     end
<a name="l00101"></a>00101     
<a name="l00102"></a>00102     %printing
<a name="l00103"></a>00103     methods (Static)
<a name="l00104"></a>00104         function run(simBatchDir, useCachedData, iJob, nJobs)
<a name="l00105"></a>00105             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l00106"></a>00106             import edu.stanford.covert.cell.sim.util.CachedSimulationObjectUtil;
<a name="l00107"></a>00107             import edu.stanford.covert.cell.sim.util.PrintUtil;
<a name="l00108"></a>00108             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l00109"></a>00109             
<a name="l00110"></a>00110             if nargin &lt; 2
<a name="l00111"></a>00111                 useCachedData = false;
<a name="l00112"></a>00112             end
<a name="l00113"></a>00113             if nargin &lt; 4
<a name="l00114"></a>00114                 iJob = 1;
<a name="l00115"></a>00115                 nJobs = 1;
<a name="l00116"></a>00116             end
<a name="l00117"></a>00117             
<a name="l00118"></a>00118             %% constants
<a name="l00119"></a>00119             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l00120"></a>00120             sim = CachedSimulationObjectUtil.load();
<a name="l00121"></a>00121             
<a name="l00122"></a>00122             %% plot overview of each single gene deletion strain
<a name="l00123"></a>00123             SingleGeneDeletions.plotIndividualDeletionStrains(simBatchDir, useCachedData, iJob, nJobs);
<a name="l00124"></a>00124             
<a name="l00125"></a>00125             %% analyze specific single gene deletion strains
<a name="l00126"></a>00126             SingleGeneDeletions.analyzeSpecificDeletionStrains(useCachedData);
<a name="l00127"></a>00127             
<a name="l00128"></a>00128             %% calculate strain statistics and classify strains
<a name="l00129"></a>00129             SingleGeneDeletions.calcGeneDeletionStrainStats(useCachedData);
<a name="l00130"></a>00130             SingleGeneDeletions.classifyIndividualDeletionStrains(useCachedData);
<a name="l00131"></a>00131             
<a name="l00132"></a>00132             %% plot overview of all single gene deletion strains
<a name="l00133"></a>00133             SingleGeneDeletions.plotOverview();
<a name="l00134"></a>00134             SingleGeneDeletions.plotAllDeletionStrains();
<a name="l00135"></a>00135             
<a name="l00136"></a>00136             %% plot signature of each deletion strain class
<a name="l00137"></a>00137             SingleGeneDeletions.plotDeletionStrainClasses();
<a name="l00138"></a>00138             SingleGeneDeletions.plotDeletionStrainClassification();
<a name="l00139"></a>00139             SingleGeneDeletions.plotDeletionGrowthRateDistribution();
<a name="l00140"></a>00140             
<a name="l00141"></a>00141             %% Metabolic essentiality
<a name="l00142"></a>00142             [deletionMetabolicOutputs, wtMetabolicOutput] = SingleGeneDeletions.calculateSingleGeneDeletionMetabolicOutputs(sim);
<a name="l00143"></a>00143             
<a name="l00144"></a>00144             %% plot summary of model accuracy
<a name="l00145"></a>00145             load([baseDir &#39;wtStats.mat&#39;]);
<a name="l00146"></a>00146             load([baseDir &#39;deletionStats.mat&#39;]);
<a name="l00147"></a>00147             load([baseDir &#39;geneClasses.mat&#39;]);
<a name="l00148"></a>00148             
<a name="l00149"></a>00149             SingleGeneDeletions.plot(sim, deletionMetabolicOutputs, wtMetabolicOutput, deletionStats, wtStats, geneClasses, [baseDir &#39;summaryGrid.svg&#39;]);
<a name="l00150"></a>00150             [~, ~] = system(sprintf(&#39;inkscape &quot;%ssummaryGrid.svg&quot; --export-pdf=&quot;%ssummaryGrid.pdf&quot; --export-area-page&#39;, baseDir, baseDir));
<a name="l00151"></a>00151             
<a name="l00152"></a>00152             %% tables
<a name="l00153"></a>00153             if ispc &amp;&amp; exist([baseDir &#39;summary.xls&#39;], &#39;file&#39;)
<a name="l00154"></a>00154                 delete([baseDir &#39;summary.xls&#39;]);
<a name="l00155"></a>00155             end
<a name="l00156"></a>00156             
<a name="l00157"></a>00157             %classes
<a name="l00158"></a>00158             [classContent, classColLabels] = SingleGeneDeletions.printSingleGeneDeletionStrainClasses(sim, geneClasses);
<a name="l00159"></a>00159             PrintUtil.printToFile(classContent, classColLabels, [baseDir &#39;summary.xls&#39;], &#39;Strains Classes&#39;);
<a name="l00160"></a>00160             
<a name="l00161"></a>00161             %strains
<a name="l00162"></a>00162             [strainContent, strainColLabels] = SingleGeneDeletions.printSingleGeneDeletionStrains(sim, deletionMetabolicOutputs, wtMetabolicOutput, deletionStats, wtStats, geneClasses);
<a name="l00163"></a>00163             PrintUtil.printToFile(strainContent, strainColLabels, [baseDir &#39;summary.xls&#39;], &#39;Strains&#39;);
<a name="l00164"></a>00164         end
<a name="l00165"></a>00165         
<a name="l00166"></a>00166         function plotIndividualDeletionStrains(simBatchDir, useCachedData, iJob, nJobs)
<a name="l00167"></a>00167             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l00168"></a>00168             import edu.stanford.covert.cell.sim.util.CachedSimulationObjectUtil;
<a name="l00169"></a>00169             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l00170"></a>00170             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l00171"></a>00171             import edu.stanford.covert.util.<a class="code" href="class_pdf_util.html">PdfUtil</a>;
<a name="l00172"></a>00172             
<a name="l00173"></a>00173             if nargin &lt; 4
<a name="l00174"></a>00174                 iJob = 1;
<a name="l00175"></a>00175                 nJobs = 1;
<a name="l00176"></a>00176             end
<a name="l00177"></a>00177             
<a name="l00178"></a>00178             %% constants
<a name="l00179"></a>00179             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l00180"></a>00180             
<a name="l00181"></a>00181             simDir = SimulationDiskUtil.getSimulation([simBatchDir filesep &#39;1&#39;]);
<a name="l00182"></a>00182             idxs = find(simDir == &#39;/&#39; | simDir == &#39;\&#39;);
<a name="l00183"></a>00183             simBatch = simDir(idxs(end-1)+1:idxs(end)-1);
<a name="l00184"></a>00184             
<a name="l00185"></a>00185             sim = CachedSimulationObjectUtil.load();
<a name="l00186"></a>00186             g = sim.gene;
<a name="l00187"></a>00187             
<a name="l00188"></a>00188             %% overview of each single gene deletion strain
<a name="l00189"></a>00189             
<a name="l00190"></a>00190             %find simulation with single gene deletion data
<a name="l00191"></a>00191             [metaDataAll, options] = SimulationDiskUtil.getSimulations();
<a name="l00192"></a>00192             
<a name="l00193"></a>00193             tfKO = false(size(options));
<a name="l00194"></a>00194             geneticKnockouts = zeros(size(options));
<a name="l00195"></a>00195             for i = 1:numel(options)
<a name="l00196"></a>00196                 tfKO(i) = ...
<a name="l00197"></a>00197                     ~isempty(options(i).geneticKnockouts) &amp;&amp; ...
<a name="l00198"></a>00198                     isscalar(options(i).geneticKnockouts) &amp;&amp; ...
<a name="l00199"></a>00199                     isempty(options(i).media) &amp;&amp; ...
<a name="l00200"></a>00200                     isempty(options(i).stimulus);
<a name="l00201"></a>00201                 if tfKO(i)
<a name="l00202"></a>00202                     geneticKnockouts(i) = find(strcmp(options(i).geneticKnockouts{1}, g.wholeCellModelIDs), 1);
<a name="l00203"></a>00203                 end
<a name="l00204"></a>00204             end
<a name="l00205"></a>00205             
<a name="l00206"></a>00206             %find simulations with wild-type data and get data
<a name="l00207"></a>00207             tfWt = ~tfKO;
<a name="l00208"></a>00208             metaData = metaDataAll(tfWt);
<a name="l00209"></a>00209             
<a name="l00210"></a>00210             %<span class="keyword">get</span> wild-type data
<a name="l00211"></a>00211             if (nargin &gt;= 2 &amp;&amp; useCachedData) || ~any(strcmp({metaData.simGroup}, simBatch))
<a name="l00212"></a>00212                 %load cached data
<a name="l00213"></a>00213                 <span class="keywordflow">try</span> %#ok&lt;TRYNC&gt;
<a name="l00214"></a>00214                     wtData = load([baseDir <span class="stringliteral">&#39;WT.mat&#39;</span>]);
<a name="l00215"></a>00215                     metaData = wtData.metaData;
<a name="l00216"></a>00216                 end
<a name="l00217"></a>00217             end
<a name="l00218"></a>00218             
<a name="l00219"></a>00219             <span class="keywordflow">if</span> ~exist(<span class="stringliteral">&#39;wtData&#39;</span>, <span class="stringliteral">&#39;var&#39;</span>)
<a name="l00220"></a>00220                 %<span class="keyword">get</span> wild-type data
<a name="l00221"></a>00221                 [wtData, metaData] = SingleGeneDeletions.getSimulationData(sim, metaData);
<a name="l00222"></a>00222                 <span class="keywordflow">try</span> %#ok&lt;TRYNC&gt;
<a name="l00223"></a>00223                     save([baseDir <span class="stringliteral">&#39;WT.mat&#39;</span>], <span class="stringliteral">&#39;-struct&#39;</span>, <span class="stringliteral">&#39;wtData&#39;</span>);
<a name="l00224"></a>00224                     save([baseDir <span class="stringliteral">&#39;WT.mat&#39;</span>], <span class="stringliteral">&#39;-append&#39;</span>, <span class="stringliteral">&#39;metaData&#39;</span>);
<a name="l00225"></a>00225                 end
<a name="l00226"></a>00226             end
<a name="l00227"></a>00227             
<a name="l00228"></a>00228             %plot wild-type data
<a name="l00229"></a>00229             if any(strcmp({metaData.simGroup}, simBatch)) || ~exist([baseDir <span class="stringliteral">&#39;WT.pdf&#39;</span>], <span class="stringliteral">&#39;file&#39;</span>)
<a name="l00230"></a>00230                 [~, figHandle] = PlotUtil.newAxesHandle();
<a name="l00231"></a>00231                 SingleGeneDeletions.plotSingleGeneDeletion({wtData}, 1, {<span class="stringliteral">&#39;Wild-type&#39;</span>}, <span class="keyword">false</span>, figHandle);
<a name="l00232"></a>00232                 <span class="keywordflow">try</span> %#ok&lt;TRYNC&gt;
<a name="l00233"></a>00233                     saveas(figHandle, [baseDir <span class="stringliteral">&#39;WT.pdf&#39;</span>]);
<a name="l00234"></a>00234                 end
<a name="l00235"></a>00235                 close(figHandle);
<a name="l00236"></a>00236                 <a class="code" href="class_pdf_util.html">PdfUtil</a>.<a class="code" href="class_pdf_util.html#a4d2658a1e6e5cc2cf50a587d53ac4559">rotatePages</a>([baseDir <span class="stringliteral">&#39;WT.pdf&#39;</span>]);
<a name="l00237"></a>00237             end
<a name="l00238"></a>00238             
<a name="l00239"></a>00239             %<span class="keyword">get</span> and plot single-gene deletion data
<a name="l00240"></a>00240             geneIdxs = setdiff(unique(geneticKnockouts), 0);
<a name="l00241"></a>00241             <span class="keywordflow">for</span> i = iJob:nJobs:numel(geneIdxs)
<a name="l00242"></a>00242                 geneIdx = geneIdxs(i);
<a name="l00243"></a>00243                 geneID = g.wholeCellModelIDs{geneIdx};
<a name="l00244"></a>00244                 
<a name="l00245"></a>00245                 <span class="keywordflow">if</span> nargin &gt;= 2 &amp;&amp; useCachedData
<a name="l00246"></a>00246                     %load cached data
<a name="l00247"></a>00247                     <span class="keywordflow">try</span> %#ok&lt;TRYNC&gt;
<a name="l00248"></a>00248                         deletionData = load([baseDir geneID <span class="stringliteral">&#39;.mat&#39;</span>]);
<a name="l00249"></a>00249                         metaData = deletionData.metaData;
<a name="l00250"></a>00250                         <span class="keywordflow">if</span> ~any(strcmp({metaData.simGroup}, simBatch))
<a name="l00251"></a>00251                             continue;
<a name="l00252"></a>00252                         end
<a name="l00253"></a>00253                     end
<a name="l00254"></a>00254                 end
<a name="l00255"></a>00255                 if ~exist(&#39;deletionData&#39;, &#39;var&#39;)
<a name="l00256"></a>00256                     %find simulations
<a name="l00257"></a>00257                     simTfs = geneticKnockouts == geneIdx;
<a name="l00258"></a>00258                     metaData = metaDataAll(simTfs);
<a name="l00259"></a>00259                     if ~any(strcmp({metaData.simGroup}, simBatch))
<a name="l00260"></a>00260                         continue;
<a name="l00261"></a>00261                     end
<a name="l00262"></a>00262                     
<a name="l00263"></a>00263                     %load data
<a name="l00264"></a>00264                     [deletionData, metaData] = SingleGeneDeletions.getSimulationData(sim, metaData); %<span class="preprocessor">#ok&lt;NASGU&gt;</span>
<a name="l00265"></a>00265 <span class="preprocessor"></span>                    <span class="keywordflow">try</span> %#ok&lt;TRYNC&gt;
<a name="l00266"></a>00266                         save([baseDir geneID <span class="stringliteral">&#39;.mat&#39;</span>], <span class="stringliteral">&#39;-struct&#39;</span>, <span class="stringliteral">&#39;deletionData&#39;</span>);
<a name="l00267"></a>00267                         save([baseDir geneID <span class="stringliteral">&#39;.mat&#39;</span>], <span class="stringliteral">&#39;-append&#39;</span>, <span class="stringliteral">&#39;metaData&#39;</span>);
<a name="l00268"></a>00268                     end
<a name="l00269"></a>00269                 end
<a name="l00270"></a>00270                 
<a name="l00271"></a>00271                 [~, figHandle] = PlotUtil.newAxesHandle();
<a name="l00272"></a>00272                 SingleGeneDeletions.plotSingleGeneDeletion({deletionData; wtData}, [1; 2], {[&#39;{\Delta}&#39; strrep(geneID, &#39;_&#39;, &#39;\_&#39;)]; <span class="stringliteral">&#39;Wild-Type&#39;</span>}, [false; true], figHandle);
<a name="l00273"></a>00273                 <span class="keywordflow">try</span>
<a name="l00274"></a>00274                     saveas(figHandle, [baseDir geneID <span class="stringliteral">&#39;.pdf&#39;</span>]);
<a name="l00275"></a>00275                     <a class="code" href="class_pdf_util.html">PdfUtil</a>.<a class="code" href="class_pdf_util.html#a4d2658a1e6e5cc2cf50a587d53ac4559">rotatePages</a>([baseDir geneID <span class="stringliteral">&#39;.pdf&#39;</span>]);
<a name="l00276"></a>00276                 <span class="keywordflow">catch</span> exception
<a name="l00277"></a>00277                     warning(<span class="stringliteral">&#39;WholeCell:warning&#39;</span>, <span class="stringliteral">&#39;Unable to save %s plot:\n%s&#39;</span>, geneID, exception.getReport());
<a name="l00278"></a>00278                 end
<a name="l00279"></a>00279                 close(figHandle);
<a name="l00280"></a>00280                 
<a name="l00281"></a>00281                 clear deletionData;
<a name="l00282"></a>00282             end
<a name="l00283"></a>00283         end
<a name="l00284"></a>00284         
<a name="l00285"></a>00285         <span class="keyword">function</span> [deletionStats, wtStats] = calcGeneDeletionStrainStats(useCachedData, iJob, nJobs)
<a name="l00286"></a>00286             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l00287"></a>00287             import edu.stanford.covert.cell.sim.util.CachedSimulationObjectUtil;
<a name="l00288"></a>00288             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l00289"></a>00289             
<a name="l00290"></a>00290             if nargin &lt; 3
<a name="l00291"></a>00291                 iJob = 1;
<a name="l00292"></a>00292                 nJobs = 1;
<a name="l00293"></a>00293             end
<a name="l00294"></a>00294             
<a name="l00295"></a>00295             sim = CachedSimulationObjectUtil.load();
<a name="l00296"></a>00296             g = sim.gene;
<a name="l00297"></a>00297             
<a name="l00298"></a>00298             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l00299"></a>00299             
<a name="l00300"></a>00300             tmp = dir([baseDir filesep &#39;MG*.mat&#39;]);
<a name="l00301"></a>00301             [~, geneticKnockouts] = ismember(cellfun(@(str) str(1:end-4), {tmp.name}<span class="stringliteral">&#39;, &#39;</span>UniformOutput<span class="stringliteral">&#39;, false), g.wholeCellModelIDs);</span>
<a name="l00302"></a>00302 <span class="stringliteral">            geneIdxs = setdiff(unique(geneticKnockouts), 0);</span>
<a name="l00303"></a>00303 <span class="stringliteral">            </span>
<a name="l00304"></a>00304 <span class="stringliteral">            if nargin &gt;= 1 &amp;&amp; useCachedData &amp;&amp; exist([baseDir &#39;</span>deletionStats.mat<span class="stringliteral">&#39;], &#39;</span>file<span class="stringliteral">&#39;)</span>
<a name="l00305"></a>00305 <span class="stringliteral">                load([baseDir &#39;</span>deletionStats.mat<span class="stringliteral">&#39;]);</span>
<a name="l00306"></a>00306 <span class="stringliteral">                geneIdxs = intersect(geneIdxs, find(all(all(isnan(deletionStats), 2), 3))); %#ok&lt;NODEF&gt;</span>
<a name="l00307"></a>00307 <span class="stringliteral">            else</span>
<a name="l00308"></a>00308 <span class="stringliteral">                deletionStats = NaN(numel(g.wholeCellModelIDs), 19, 2);</span>
<a name="l00309"></a>00309 <span class="stringliteral">            end</span>
<a name="l00310"></a>00310 <span class="stringliteral">            for i = iJob:nJobs:numel(geneIdxs)</span>
<a name="l00311"></a>00311 <span class="stringliteral">                geneID = g.wholeCellModelIDs{geneIdxs(i)};</span>
<a name="l00312"></a>00312 <span class="stringliteral">                if useCachedData &amp;&amp; exist([baseDir geneID &#39;</span>-stats.mat&#39;], &#39;file&#39;)
<a name="l00313"></a>00313                     load([baseDir geneID &#39;-stats.mat&#39;]);
<a name="l00314"></a>00314                 <span class="keywordflow">else</span>
<a name="l00315"></a>00315                     tmp = SingleGeneDeletions.calcStrainStats(geneID);
<a name="l00316"></a>00316                     save([baseDir geneID <span class="stringliteral">&#39;-stats.mat&#39;</span>], <span class="stringliteral">&#39;tmp&#39;</span>);
<a name="l00317"></a>00317                 end
<a name="l00318"></a>00318                 deletionStats(geneIdxs(i), :, :) = tmp;
<a name="l00319"></a>00319             end
<a name="l00320"></a>00320             save([baseDir <span class="stringliteral">&#39;deletionStats.mat&#39;</span>], <span class="stringliteral">&#39;deletionStats&#39;</span>);
<a name="l00321"></a>00321             
<a name="l00322"></a>00322             <span class="keywordflow">if</span> nargin &lt; 0 || ~useCachedData || ~exist([baseDir <span class="stringliteral">&#39;wtStats.mat&#39;</span>], <span class="stringliteral">&#39;file&#39;</span>)
<a name="l00323"></a>00323                 wtStats = SingleGeneDeletions.calcStrainStats(&#39;WT&#39;);
<a name="l00324"></a>00324                 save([baseDir &#39;wtStats.mat&#39;], &#39;wtStats&#39;);
<a name="l00325"></a>00325             else
<a name="l00326"></a>00326                 load([baseDir &#39;wtStats.mat&#39;]);
<a name="l00327"></a>00327             end
<a name="l00328"></a>00328         end
<a name="l00329"></a>00329         
<a name="l00330"></a>00330         function stats = calcStrainStats(geneID)
<a name="l00331"></a>00331             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l00332"></a>00332             
<a name="l00333"></a>00333             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l00334"></a>00334             data = load([baseDir geneID &#39;.mat&#39;]);
<a name="l00335"></a>00335             
<a name="l00336"></a>00336             inds = sub2ind(size(data.growth), data.simEndTimes + 1, (1:numel(data.simEndTimes))&#39;);
<a name="l00337"></a>00337             dt = diff(data.time(find(~isnan(data.growth), 2, &#39;first&#39;)));
<a name="l00338"></a>00338             
<a name="l00339"></a>00339             stats = NaN(1, 19, 2);
<a name="l00340"></a>00340             stats(1,  1, :) = [nanmean(data.growth(inds)) nanstd(data.growth(inds))];
<a name="l00341"></a>00341             stats(1,  2, :) = [nanmean(data.atpProduction(inds)) nanstd(data.atpProduction(inds))];
<a name="l00342"></a>00342             stats(1,  3, :) = [nanmean(data.gtpProduction(inds)) nanstd(data.gtpProduction(inds))];
<a name="l00343"></a>00343             stats(1,  4, :) = [nanmean(data.repInitDuration) nanstd(data.repInitDuration)];
<a name="l00344"></a>00344             stats(1,  5, :) = [nanmean(data.repDuration) nanstd(data.repDuration)];
<a name="l00345"></a>00345             stats(1,  6, :) = [nanmean(data.cytokinesisDuration) nanstd(data.cytokinesisDuration)];
<a name="l00346"></a>00346             stats(1,  7, :) = [nanmean(data.cellCycleDuration) nanstd(data.cellCycleDuration)];
<a name="l00347"></a>00347             stats(1,  8, :) = [nanmean(data.massDoublingDuration) nanstd(data.massDoublingDuration)];
<a name="l00348"></a>00348             stats(1,  9, :) = [nanmean(nansum(data.atpUsage, 1) * dt, 2) nanstd(nansum(data.atpUsage, 1) * dt, [], 2)]; %atp usage
<a name="l00349"></a>00349             stats(1, 10, :) = [nanmean(nansum(data.gtpUsage, 1) * dt, 2) nanstd(nansum(data.gtpUsage, 1) * dt, [], 2)]; %gtp usage
<a name="l00350"></a>00350             stats(1, 11, :) = [nanmean(nanmean(data.dnaWt ./ data.cellWt, 1), 2) nanstd(nanmean(data.dnaWt ./ data.cellWt, 1), [], 2)]; %DNA content
<a name="l00351"></a>00351             stats(1, 12, :) = [nanmean(nanmean(data.rnaWt ./ data.cellWt, 1), 2) nanstd(nanmean(data.rnaWt ./ data.cellWt, 1), [], 2)]; %<a class="code" href="class_r_n_a.html">RNA</a> content
<a name="l00352"></a>00352             stats(1, 13, :) = [nanmean(nanmean(data.proteinWt ./ data.cellWt, 1), 2) nanstd(nanmean(data.proteinWt ./ data.cellWt, 1), [], 2)]; %<a class="code" href="class_protein.html">Protein</a> content
<a name="l00353"></a>00353             stats(1, 14, :) = [nanmean(nanmean(data.superhelicalDensity, 1), 2) nanstd(nanmean(data.superhelicalDensity, 1), [], 2)]; %superhelicity
<a name="l00354"></a>00354             
<a name="l00355"></a>00355             tau_rna = zeros(size(data.simEndTimes));
<a name="l00356"></a>00356             tau_protein = zeros(size(data.simEndTimes));
<a name="l00357"></a>00357             tau_damagedRna = zeros(size(data.simEndTimes));
<a name="l00358"></a>00358             tau_damagedProtein = zeros(size(data.simEndTimes));
<a name="l00359"></a>00359             adjrsquare_rna = zeros(size(data.simEndTimes));
<a name="l00360"></a>00360             adjrsquare_protein = zeros(size(data.simEndTimes));
<a name="l00361"></a>00361             adjrsquare_damagedRna = zeros(size(data.simEndTimes));
<a name="l00362"></a>00362             adjrsquare_damagedProtein = zeros(size(data.simEndTimes));
<a name="l00363"></a>00363             expFittype = fittype(&#39;a * exp(log(2) * t / tau)&#39;, ...
<a name="l00364"></a>00364                 &#39;independent&#39;, &#39;t&#39;, ...
<a name="l00365"></a>00365                 &#39;coefficients&#39;, {<span class="charliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;tau&#39;</span>});
<a name="l00366"></a>00366             <span class="keywordflow">for</span> i = 1:numel(data.simEndTimes)
<a name="l00367"></a>00367                 expFitOptions = fitoptions(...
<a name="l00368"></a>00368                     &#39;Method&#39;, &#39;NonlinearLeastSquares&#39;, ...
<a name="l00369"></a>00369                     &#39;Startpoint&#39;, [data.rnaWt(2, i) * 1e15  8.6], ...
<a name="l00370"></a>00370                     &#39;Lower&#39;, [0 -1e3 * (diff(data.rnaWt([2 data.simEndTimes(i)+1], i)) &lt; 0)], ...
<a name="l00371"></a>00371                     &#39;Upper&#39;, [max(data.rnaWt(:, i)) * 1e15 1e3]);
<a name="l00372"></a>00372                 [fitResult, gof] = fit(data.time(2:data.simEndTimes(i)+1, 1), data.rnaWt(2:data.simEndTimes(i)+1, i) * 1e15, expFittype, expFitOptions);
<a name="l00373"></a>00373                 tau_rna(i) = fitResult.tau;
<a name="l00374"></a>00374                 adjrsquare_rna(i) = gof.adjrsquare;
<a name="l00375"></a>00375                 if gof.adjrsquare &lt; 0.5
<a name="l00376"></a>00376                     tau_rna(i) = NaN;
<a name="l00377"></a>00377                 end
<a name="l00378"></a>00378                 
<a name="l00379"></a>00379                 expFitOptions = fitoptions(...
<a name="l00380"></a>00380                     &#39;Method&#39;, &#39;NonlinearLeastSquares&#39;, ...
<a name="l00381"></a>00381                     &#39;Startpoint&#39;, [data.proteinWt(2, i) * 1e15  8.6], ...
<a name="l00382"></a>00382                     &#39;Lower&#39;, [0 -1e3 * (diff(data.proteinWt([2 data.simEndTimes(i)+1], i)) &lt; 0)], ...
<a name="l00383"></a>00383                     &#39;Upper&#39;, [max(data.proteinWt(:, i)) * 1e15 1e3]);
<a name="l00384"></a>00384                 [fitResult, gof] = fit(data.time(2:data.simEndTimes(i)+1, 1), data.proteinWt(2:data.simEndTimes(i)+1, i) * 1e15, expFittype, expFitOptions);
<a name="l00385"></a>00385                 tau_protein(i) = fitResult.tau;
<a name="l00386"></a>00386                 adjrsquare_protein(i) = gof.adjrsquare;
<a name="l00387"></a>00387                 if gof.adjrsquare &lt; 0.5
<a name="l00388"></a>00388                     tau_protein(i) = NaN;
<a name="l00389"></a>00389                 end
<a name="l00390"></a>00390                 
<a name="l00391"></a>00391                 xdata = data.time(2:data.simEndTimes(i)+1, 1) / 3600;
<a name="l00392"></a>00392                 ydata = data.damagedRnas(2:data.simEndTimes(i)+1, i);
<a name="l00393"></a>00393                 xdata = xdata(~isnan(ydata));
<a name="l00394"></a>00394                 ydata = ydata(~isnan(ydata));
<a name="l00395"></a>00395                 expFitOptions = fitoptions(...
<a name="l00396"></a>00396                     &#39;Method&#39;, &#39;NonlinearLeastSquares&#39;, ...
<a name="l00397"></a>00397                     &#39;Startpoint&#39;, [ydata(2, 1)  8.6], ...
<a name="l00398"></a>00398                     &#39;Lower&#39;, [0 -1e3 * (diff(data.damagedRnas([2 data.simEndTimes(i)+1], i)) &lt; 0)], ...
<a name="l00399"></a>00399                     &#39;Upper&#39;, [max(max(data.damagedRnas(:, i)), 1) 1e3]);
<a name="l00400"></a>00400                 [fitResult, gof] = fit(xdata, ydata, expFittype, expFitOptions);
<a name="l00401"></a>00401                 tau_damagedRna(i) = fitResult.tau;
<a name="l00402"></a>00402                 adjrsquare_damagedRna(i) = gof.adjrsquare;
<a name="l00403"></a>00403                 if gof.adjrsquare &lt; 0.5
<a name="l00404"></a>00404                     tau_damagedRna(i) = NaN;
<a name="l00405"></a>00405                 end
<a name="l00406"></a>00406                 
<a name="l00407"></a>00407                 xdata = data.time(2:data.simEndTimes(i)+1, 1) / 3600;
<a name="l00408"></a>00408                 ydata = data.damagedProteins(2:data.simEndTimes(i)+1, i);
<a name="l00409"></a>00409                 xdata = xdata(~isnan(ydata));
<a name="l00410"></a>00410                 ydata = ydata(~isnan(ydata));
<a name="l00411"></a>00411                 expFitOptions = fitoptions(...
<a name="l00412"></a>00412                     &#39;Method&#39;, &#39;NonlinearLeastSquares&#39;, ...
<a name="l00413"></a>00413                     &#39;Startpoint&#39;, [ydata(2, 1)  8.6], ...
<a name="l00414"></a>00414                     &#39;Lower&#39;, [0 -1e3 * (diff(data.damagedProteins([2 data.simEndTimes(i)+1], i)) &lt; 0)], ...
<a name="l00415"></a>00415                     &#39;Upper&#39;, [max(max(data.damagedProteins(:, i)), 1) 1e3]);
<a name="l00416"></a>00416                 [fitResult, gof] = fit(xdata, ydata, expFittype, expFitOptions);
<a name="l00417"></a>00417                 tau_damagedProtein(i) = fitResult.tau;
<a name="l00418"></a>00418                 adjrsquare_damagedProtein(i) = gof.adjrsquare;
<a name="l00419"></a>00419                 if gof.adjrsquare &lt; 0.5
<a name="l00420"></a>00420                     tau_damagedProtein(i) = NaN;
<a name="l00421"></a>00421                 end
<a name="l00422"></a>00422             end
<a name="l00423"></a>00423             stats(1, 15, :) = [nanmean(tau_rna) nanstd(tau_rna)]; %rate of change of <a class="code" href="class_r_n_a.html">RNA</a> content
<a name="l00424"></a>00424             stats(1, 16, :) = [nanmean(tau_protein) nanstd(tau_protein)]; %rate of change of protein content
<a name="l00425"></a>00425             stats(1, 17, :) = [nanmean(tau_damagedRna) nanstd(tau_damagedRna)]; %rate of change of damaged <a class="code" href="class_r_n_a.html">RNA</a> content
<a name="l00426"></a>00426             stats(1, 18, :) = [nanmean(tau_damagedProtein) nanstd(tau_damagedProtein)]; %rate of change of damaged protein content
<a name="l00427"></a>00427             
<a name="l00428"></a>00428             stats(1, 19, :) = [nanmean(nanmean(data.antibiotics, 1), 2) nanstd(nanmean(data.antibiotics, 1), [], 2)]; %antibiotics count
<a name="l00429"></a>00429         end
<a name="l00430"></a>00430         
<a name="l00431"></a>00431         function geneClasses = classifyIndividualDeletionStrains(useCachedData)
<a name="l00432"></a>00432             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l00433"></a>00433             import edu.stanford.covert.cell.sim.util.CachedSimulationObjectUtil;
<a name="l00434"></a>00434             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l00435"></a>00435             
<a name="l00436"></a>00436             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l00437"></a>00437             sim = CachedSimulationObjectUtil.load();
<a name="l00438"></a>00438             g = sim.gene;
<a name="l00439"></a>00439             
<a name="l00440"></a>00440             wtData = load([baseDir &#39;WT.mat&#39;]);
<a name="l00441"></a>00441             tmp = dir([baseDir filesep &#39;MG*.mat&#39;]);
<a name="l00442"></a>00442             [~, geneticKnockouts] = ismember(cellfun(@(str) str(1:end-4), {tmp.name}<span class="stringliteral">&#39;, &#39;</span>UniformOutput<span class="stringliteral">&#39;, false), g.wholeCellModelIDs);</span>
<a name="l00443"></a>00443 <span class="stringliteral">            geneIdxs = setdiff(unique(geneticKnockouts), 0);</span>
<a name="l00444"></a>00444 <span class="stringliteral">            </span>
<a name="l00445"></a>00445 <span class="stringliteral">            if nargin &gt;= 1 &amp;&amp; useCachedData &amp;&amp; exist([baseDir &#39;</span>geneClasses.mat<span class="stringliteral">&#39;], &#39;</span>file<span class="stringliteral">&#39;)</span>
<a name="l00446"></a>00446 <span class="stringliteral">                load([baseDir &#39;</span>geneClasses.mat<span class="stringliteral">&#39;]);</span>
<a name="l00447"></a>00447 <span class="stringliteral">                geneIdxs = intersect(geneIdxs, find(geneClasses == SingleGeneDeletions.UNOBSERVED)); %#ok&lt;NODEF&gt;</span>
<a name="l00448"></a>00448 <span class="stringliteral">            else</span>
<a name="l00449"></a>00449 <span class="stringliteral">                geneClasses = repmat(SingleGeneDeletions.UNOBSERVED, size(g.wholeCellModelIDs));</span>
<a name="l00450"></a>00450 <span class="stringliteral">            end</span>
<a name="l00451"></a>00451 <span class="stringliteral">            </span>
<a name="l00452"></a>00452 <span class="stringliteral">            for i = 1:numel(geneIdxs)</span>
<a name="l00453"></a>00453 <span class="stringliteral">                geneIdx = geneIdxs(i);</span>
<a name="l00454"></a>00454 <span class="stringliteral">                geneID = g.wholeCellModelIDs{geneIdx};</span>
<a name="l00455"></a>00455 <span class="stringliteral">                geneClasses(geneIdx) = SingleGeneDeletions.classifyDeletionStrain(geneID, wtData);</span>
<a name="l00456"></a>00456 <span class="stringliteral">                clear deletionData;</span>
<a name="l00457"></a>00457 <span class="stringliteral">            end</span>
<a name="l00458"></a>00458 <span class="stringliteral">            </span>
<a name="l00459"></a>00459 <span class="stringliteral">            try %#ok&lt;TRYNC&gt;</span>
<a name="l00460"></a>00460 <span class="stringliteral">                save([baseDir &#39;</span>geneClasses.mat<span class="stringliteral">&#39;], &#39;</span>geneClasses<span class="stringliteral">&#39;);</span>
<a name="l00461"></a>00461 <span class="stringliteral">            end</span>
<a name="l00462"></a>00462 <span class="stringliteral">        end</span>
<a name="l00463"></a>00463 <span class="stringliteral">        </span>
<a name="l00464"></a>00464 <span class="stringliteral">        function analyzeSpecificDeletionStrains(useCachedData)</span>
<a name="l00465"></a>00465 <span class="stringliteral">            import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;</span>
<a name="l00466"></a>00466 <span class="stringliteral">            import edu.stanford.covert.cell.sim.util.PlotUtil;</span>
<a name="l00467"></a>00467 <span class="stringliteral">            import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;</span>
<a name="l00468"></a>00468 <span class="stringliteral">            </span>
<a name="l00469"></a>00469 <span class="stringliteral">            baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;</span>singleGeneDeletions<span class="stringliteral">&#39; filesep];</span>
<a name="l00470"></a>00470 <span class="stringliteral">            </span>
<a name="l00471"></a>00471 <span class="stringliteral">            wtData = load([baseDir &#39;</span>WT.mat<span class="stringliteral">&#39;]);</span>
<a name="l00472"></a>00472 <span class="stringliteral">            </span>
<a name="l00473"></a>00473 <span class="stringliteral">            md = meta.class.fromName(&#39;</span>edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions<span class="stringliteral">&#39;);</span>
<a name="l00474"></a>00474 <span class="stringliteral">            for i = 1:numel(md.Methods)</span>
<a name="l00475"></a>00475 <span class="stringliteral">                if length(md.Methods{i}.Name) &gt;= length(&#39;</span>analyzeSingleGeneDeletionStrain_<span class="stringliteral">&#39;) &amp;&amp; ...</span>
<a name="l00476"></a>00476 <span class="stringliteral">                        isequal(md.Methods{i}.Name(1:length(&#39;</span>analyzeSingleGeneDeletionStrain_<span class="stringliteral">&#39;)), &#39;</span>analyzeSingleGeneDeletionStrain_<span class="stringliteral">&#39;) &amp;&amp; ...</span>
<a name="l00477"></a>00477 <span class="stringliteral">                        isequal(md.Methods{i}.InputNames, {&#39;</span>figHandle<span class="stringliteral">&#39;; &#39;</span>geneID<span class="stringliteral">&#39;; &#39;</span>deletionData<span class="stringliteral">&#39;; &#39;</span>wtData<span class="stringliteral">&#39;; &#39;</span>figData<span class="stringliteral">&#39;})</span>
<a name="l00478"></a>00478 <span class="stringliteral">                    geneID = md.Methods{i}.Name(length(&#39;</span>analyzeSingleGeneDeletionStrain_<span class="stringliteral">&#39;)+1:end);</span>
<a name="l00479"></a>00479 <span class="stringliteral">                    if ~exist([baseDir geneID &#39;</span>.mat<span class="stringliteral">&#39;], &#39;</span>file<span class="stringliteral">&#39;)</span>
<a name="l00480"></a>00480 <span class="stringliteral">                        continue;</span>
<a name="l00481"></a>00481 <span class="stringliteral">                    end</span>
<a name="l00482"></a>00482 <span class="stringliteral">                    </span>
<a name="l00483"></a>00483 <span class="stringliteral">                    deletionData = load([baseDir geneID &#39;</span>.mat<span class="stringliteral">&#39;]);</span>
<a name="l00484"></a>00484 <span class="stringliteral">                    [~, figHandle] = PlotUtil.newAxesHandle();</span>
<a name="l00485"></a>00485 <span class="stringliteral">                    if useCachedData &amp;&amp; exist([baseDir geneID &#39;</span>-analysis.mat&#39;], &#39;file&#39;)
<a name="l00486"></a>00486                         figData = load([baseDir geneID &#39;-analysis.mat&#39;]);
<a name="l00487"></a>00487                         SingleGeneDeletions.(md.Methods{i}.Name)(figHandle, geneID, deletionData, wtData, figData);
<a name="l00488"></a>00488                     <span class="keywordflow">else</span>
<a name="l00489"></a>00489                         figData = SingleGeneDeletions.(md.Methods{i}.Name)(figHandle, geneID, deletionData, wtData); %#ok&lt;NASGU&gt;
<a name="l00490"></a>00490                         <span class="keywordflow">try</span> %#ok&lt;TRYNC&gt;
<a name="l00491"></a>00491                             save([baseDir geneID <span class="stringliteral">&#39;-analysis.mat&#39;</span>], <span class="stringliteral">&#39;-struct&#39;</span>, <span class="stringliteral">&#39;figData&#39;</span>);
<a name="l00492"></a>00492                         end
<a name="l00493"></a>00493                     end
<a name="l00494"></a>00494                     clear figData;
<a name="l00495"></a>00495                     
<a name="l00496"></a>00496                     <span class="keywordflow">try</span> %#ok&lt;TRYNC&gt;
<a name="l00497"></a>00497                         saveas(figHandle, [baseDir geneID <span class="stringliteral">&#39;-analysis.pdf&#39;</span>]);
<a name="l00498"></a>00498                     end
<a name="l00499"></a>00499                     close(figHandle);
<a name="l00500"></a>00500                 end
<a name="l00501"></a>00501             end
<a name="l00502"></a>00502         end
<a name="l00503"></a>00503         
<a name="l00504"></a>00504         <span class="keyword">function</span> plotAllDeletionStrains(iJob, nJobs)
<a name="l00505"></a>00505             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l00506"></a>00506             import edu.stanford.covert.cell.sim.util.CachedSimulationObjectUtil;
<a name="l00507"></a>00507             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l00508"></a>00508             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l00509"></a>00509             import edu.stanford.covert.util.<a class="code" href="class_pdf_util.html">PdfUtil</a>;
<a name="l00510"></a>00510             
<a name="l00511"></a>00511             if nargin &lt; 2
<a name="l00512"></a>00512                 iJob = 1;
<a name="l00513"></a>00513                 nJobs = 1;
<a name="l00514"></a>00514             end
<a name="l00515"></a>00515             
<a name="l00516"></a>00516             %% overview of all single gene deletion strains
<a name="l00517"></a>00517             sim = CachedSimulationObjectUtil.load();
<a name="l00518"></a>00518             g = sim.gene;
<a name="l00519"></a>00519             
<a name="l00520"></a>00520             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l00521"></a>00521             
<a name="l00522"></a>00522             load([baseDir &#39;geneClasses.mat&#39;]);
<a name="l00523"></a>00523             tmp = dir([baseDir filesep &#39;MG*.mat&#39;]);
<a name="l00524"></a>00524             [~, geneticKnockouts] = ismember(cellfun(@(str) str(1:end-4), {tmp.name}<span class="stringliteral">&#39;, &#39;</span>UniformOutput<span class="stringliteral">&#39;, false), g.wholeCellModelIDs);</span>
<a name="l00525"></a>00525 <span class="stringliteral">            geneIdxs = setdiff(unique(geneticKnockouts), 0);</span>
<a name="l00526"></a>00526 <span class="stringliteral">            </span>
<a name="l00527"></a>00527 <span class="stringliteral">            data = cell(numel(geneIdxs)+1, 1);</span>
<a name="l00528"></a>00528 <span class="stringliteral">            for i = 1:numel(geneIdxs)</span>
<a name="l00529"></a>00529 <span class="stringliteral">                geneID = g.wholeCellModelIDs{geneIdxs(i)};</span>
<a name="l00530"></a>00530 <span class="stringliteral">                tmp = load([baseDir geneID &#39;</span>.mat<span class="stringliteral">&#39;]);</span>
<a name="l00531"></a>00531 <span class="stringliteral">                if numel(tmp.simEndTimes) &gt; 1</span>
<a name="l00532"></a>00532 <span class="stringliteral">                    fields = setdiff(fieldnames(tmp), {&#39;</span>metaData<span class="stringliteral">&#39;, &#39;</span>time<span class="stringliteral">&#39;, &#39;</span>simEndTimes<span class="stringliteral">&#39;});</span>
<a name="l00533"></a>00533 <span class="stringliteral">                    simIdx = randperm(numel(tmp.simEndTimes));</span>
<a name="l00534"></a>00534 <span class="stringliteral">                    simIdx = simIdx(1);</span>
<a name="l00535"></a>00535 <span class="stringliteral">                    tmp.metaData = tmp.metaData(simIdx);</span>
<a name="l00536"></a>00536 <span class="stringliteral">                    tmp.simEndTimes = tmp.simEndTimes(simIdx);</span>
<a name="l00537"></a>00537 <span class="stringliteral">                    for k = 1:numel(fields)</span>
<a name="l00538"></a>00538 <span class="stringliteral">                        tmp.(fields{k}) = tmp.(fields{k})(:, simIdx);</span>
<a name="l00539"></a>00539 <span class="stringliteral">                    end</span>
<a name="l00540"></a>00540 <span class="stringliteral">                end</span>
<a name="l00541"></a>00541 <span class="stringliteral">                data{i} = tmp;</span>
<a name="l00542"></a>00542 <span class="stringliteral">            end</span>
<a name="l00543"></a>00543 <span class="stringliteral">            data{end} = load([baseDir &#39;</span>WT.mat<span class="stringliteral">&#39;]);</span>
<a name="l00544"></a>00544 <span class="stringliteral">            </span>
<a name="l00545"></a>00545 <span class="stringliteral">            classLabels = [</span>
<a name="l00546"></a>00546 <span class="stringliteral">                [SingleGeneDeletions.DELETION_STRAIN_CLASSES(geneClasses(geneIdxs)) ...</span>
<a name="l00547"></a>00547 <span class="stringliteral">                cellfun(@(geneIdx) [&#39;</span>{\Delta}<span class="stringliteral">&#39; strrep(g.wholeCellModelIDs{geneIdx}, &#39;</span>_<span class="stringliteral">&#39;, &#39;</span>\_<span class="stringliteral">&#39;)], num2cell(geneIdxs), &#39;</span>UniformOutput<span class="stringliteral">&#39;, false)];</span>
<a name="l00548"></a>00548 <span class="stringliteral">                {&#39;</span>Wild-Type&#39; []}];
<a name="l00549"></a>00549             
<a name="l00550"></a>00550             [~, figHandle] = PlotUtil.newAxesHandle();
<a name="l00551"></a>00551             nPlots = SingleGeneDeletions.plotSingleGeneDeletion(...
<a name="l00552"></a>00552                 data, ...
<a name="l00553"></a>00553                 [geneClasses(geneIdxs); SingleGeneDeletions.WILD_TYPE], ...
<a name="l00554"></a>00554                 classLabels, ...
<a name="l00555"></a>00555                 [false(numel(geneIdxs), 1); true], ...
<a name="l00556"></a>00556                 figHandle);
<a name="l00557"></a>00557             
<a name="l00558"></a>00558             <span class="keywordflow">try</span> %#ok&lt;TRYNC&gt;
<a name="l00559"></a>00559                 saveas(figHandle, [baseDir <span class="stringliteral">&#39;all.pdf&#39;</span>]);
<a name="l00560"></a>00560                 <a class="code" href="class_pdf_util.html">PdfUtil</a>.<a class="code" href="class_pdf_util.html#a4d2658a1e6e5cc2cf50a587d53ac4559">rotatePages</a>([baseDir <span class="stringliteral">&#39;all.pdf&#39;</span>]);
<a name="l00561"></a>00561             end
<a name="l00562"></a>00562             close(figHandle);
<a name="l00563"></a>00563             
<a name="l00564"></a>00564             <span class="keywordflow">for</span> i = iJob:nJobs:nPlots
<a name="l00565"></a>00565                 [~, figHandle] = PlotUtil.newAxesHandle();
<a name="l00566"></a>00566                 SingleGeneDeletions.plotSingleGeneDeletion(...
<a name="l00567"></a>00567                     data, ...
<a name="l00568"></a>00568                     [geneClasses(geneIdxs); SingleGeneDeletions.WILD_TYPE], ...
<a name="l00569"></a>00569                     classLabels, ...
<a name="l00570"></a>00570                     [false(numel(geneIdxs), 1); true], ...
<a name="l00571"></a>00571                     figHandle, i);
<a name="l00572"></a>00572                 <span class="keywordflow">try</span> %#ok&lt;TRYNC&gt;
<a name="l00573"></a>00573                     saveas(figHandle, [baseDir sprintf(<span class="stringliteral">&#39;all-%02d.pdf&#39;</span>, i)]);
<a name="l00574"></a>00574                 end
<a name="l00575"></a>00575                 close(figHandle);
<a name="l00576"></a>00576             end
<a name="l00577"></a>00577         end
<a name="l00578"></a>00578         
<a name="l00579"></a>00579         <span class="keyword">function</span> plotDeletionStrainClasses(classIdxs)
<a name="l00580"></a>00580             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l00581"></a>00581             import edu.stanford.covert.cell.sim.util.CachedSimulationObjectUtil;
<a name="l00582"></a>00582             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l00583"></a>00583             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l00584"></a>00584             import edu.stanford.covert.util.<a class="code" href="class_pdf_util.html">PdfUtil</a>;
<a name="l00585"></a>00585             
<a name="l00586"></a>00586             if nargin &lt; 1
<a name="l00587"></a>00587                 classIdxs = 1:size(SingleGeneDeletions.DELETION_STRAIN_CLASSES, 1) - 2;
<a name="l00588"></a>00588             end
<a name="l00589"></a>00589             
<a name="l00590"></a>00590             sim = CachedSimulationObjectUtil.load();
<a name="l00591"></a>00591             g = sim.gene;
<a name="l00592"></a>00592             
<a name="l00593"></a>00593             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l00594"></a>00594             load([baseDir &#39;geneClasses.mat&#39;]);
<a name="l00595"></a>00595             
<a name="l00596"></a>00596             for i = 1:numel(classIdxs)
<a name="l00597"></a>00597                 geneIdxs = find(geneClasses == classIdxs(i));
<a name="l00598"></a>00598                 
<a name="l00599"></a>00599                 data = cell(numel(geneIdxs) + 1, 1);
<a name="l00600"></a>00600                 for j = 1:numel(geneIdxs)
<a name="l00601"></a>00601                     tmp = load([baseDir g.wholeCellModelIDs{geneIdxs(j)} <span class="stringliteral">&#39;.mat&#39;</span>]);
<a name="l00602"></a>00602                     <span class="keywordflow">if</span> numel(tmp.simEndTimes) &gt; 1
<a name="l00603"></a>00603                         fields = setdiff(fieldnames(tmp), {<span class="stringliteral">&#39;metaData&#39;</span>, <span class="stringliteral">&#39;time&#39;</span>, <span class="stringliteral">&#39;simEndTimes&#39;</span>});
<a name="l00604"></a>00604                         simIdx = randperm(numel(tmp.simEndTimes));
<a name="l00605"></a>00605                         simIdx = simIdx(1);
<a name="l00606"></a>00606                         tmp.metaData = tmp.metaData(simIdx);
<a name="l00607"></a>00607                         tmp.simEndTimes = tmp.simEndTimes(simIdx);
<a name="l00608"></a>00608                         <span class="keywordflow">for</span> k = 1:numel(fields)
<a name="l00609"></a>00609                             tmp.(fields{k}) = tmp.(fields{k})(:, simIdx);
<a name="l00610"></a>00610                         end
<a name="l00611"></a>00611                     end
<a name="l00612"></a>00612                     data{j} = tmp;
<a name="l00613"></a>00613                 end
<a name="l00614"></a>00614                 data{end} = load([baseDir <span class="stringliteral">&#39;WT.mat&#39;</span>]);
<a name="l00615"></a>00615                 
<a name="l00616"></a>00616                 classLabels = [
<a name="l00617"></a>00617                     cellfun(@(geneIdx) [&#39;{\Delta}&#39; strrep(g.wholeCellModelIDs{geneIdx}, &#39;_&#39;, &#39;\_&#39;)], ...
<a name="l00618"></a>00618                     num2cell(geneIdxs), &#39;UniformOutput&#39;, false);
<a name="l00619"></a>00619                     {&#39;Wild-Type&#39;}];
<a name="l00620"></a>00620                 
<a name="l00621"></a>00621                 [~, figHandle] = PlotUtil.newAxesHandle();
<a name="l00622"></a>00622                 SingleGeneDeletions.plotSingleGeneDeletion(...
<a name="l00623"></a>00623                     data, ...
<a name="l00624"></a>00624                     1:numel(data), ...
<a name="l00625"></a>00625                     classLabels, ...
<a name="l00626"></a>00626                     [<span class="keyword">false</span>(numel(geneIdxs), 1); <span class="keyword">true</span>], ...
<a name="l00627"></a>00627                     figHandle, ...
<a name="l00628"></a>00628                     [], [PlotUtil.getRedGreenColorOrder(1:numel(geneIdxs)); 0 1 1]);
<a name="l00629"></a>00629                 <span class="keywordflow">if</span> nargin == 0
<a name="l00630"></a>00630                     <span class="keywordflow">try</span> %#ok&lt;TRYNC&gt;
<a name="l00631"></a>00631                         saveas(figHandle, sprintf(<span class="stringliteral">&#39;%sclass-%d.pdf&#39;</span>, baseDir, classIdxs(i)));
<a name="l00632"></a>00632                         <a class="code" href="class_pdf_util.html">PdfUtil</a>.<a class="code" href="class_pdf_util.html#a4d2658a1e6e5cc2cf50a587d53ac4559">rotatePages</a>(sprintf(<span class="stringliteral">&#39;%sclass-%d.pdf&#39;</span>, baseDir, classIdxs(i)));
<a name="l00633"></a>00633                     end
<a name="l00634"></a>00634                     close(figHandle);
<a name="l00635"></a>00635                 end
<a name="l00636"></a>00636                 
<a name="l00637"></a>00637                 clear data;
<a name="l00638"></a>00638             end
<a name="l00639"></a>00639         end
<a name="l00640"></a>00640         
<a name="l00641"></a>00641         <span class="keyword">function</span> plotDeletionStrainClassification()
<a name="l00642"></a>00642             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l00643"></a>00643             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l00644"></a>00644             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l00645"></a>00645             
<a name="l00646"></a>00646             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l00647"></a>00647             load([baseDir &#39;wtStats.mat&#39;]);
<a name="l00648"></a>00648             load([baseDir &#39;deletionStats.mat&#39;]);
<a name="l00649"></a>00649             load([baseDir &#39;geneClasses.mat&#39;]);
<a name="l00650"></a>00650             
<a name="l00651"></a>00651             %Decomposing, non-growing, slow growing, non-essential
<a name="l00652"></a>00652             SingleGeneDeletions.plotDeletionStrainClassificationHelper(...
<a name="l00653"></a>00653                 deletionStats(:, 1, 1), deletionStats(:, 9, 1) + deletionStats(:, 10, 1), ...
<a name="l00654"></a>00654                 &#39;Growth (fg h^-1)&#39;, &#39;Energy Usage&#39;, ...
<a name="l00655"></a>00655                 geneClasses, [
<a name="l00656"></a>00656                 SingleGeneDeletions.DECOMPOSING
<a name="l00657"></a>00657                 SingleGeneDeletions.NON_GROWING
<a name="l00658"></a>00658                 SingleGeneDeletions.NON_ESSENTIAL
<a name="l00659"></a>00659                 SingleGeneDeletions.SLOW_GROWING
<a name="l00660"></a>00660                 ], 1, &#39;SouthEast&#39;);
<a name="l00661"></a>00661             
<a name="l00662"></a>00662             %decaying growth
<a name="l00663"></a>00663             SingleGeneDeletions.plotDeletionStrainClassificationHelper(...
<a name="l00664"></a>00664                 deletionStats(:, 1, 1), deletionStats(:, 15, 1), ...
<a name="l00665"></a>00665                 &#39;Growth (fg h^-1)&#39;, &#39;<a class="code" href="class_r_n_a.html">RNA</a> Mass Decay Constant (h)&#39;, ...
<a name="l00666"></a>00666                 geneClasses, [
<a name="l00667"></a>00667                 SingleGeneDeletions.DECAYING_GROWTH_NON_RNA_PROTEIN
<a name="l00668"></a>00668                 SingleGeneDeletions.DECAYING_GROWTH_NON_PROTEIN
<a name="l00669"></a>00669                 ], 2, &#39;NorthEast&#39;);
<a name="l00670"></a>00670             
<a name="l00671"></a>00671             %non-replicative
<a name="l00672"></a>00672             SingleGeneDeletions.plotDeletionStrainClassificationHelper(...
<a name="l00673"></a>00673                 deletionStats(:, 1, 1), deletionStats(:, 11, 1), ...
<a name="l00674"></a>00674                 &#39;Growth (fg h^-1)&#39;, &#39;DNA Mass (fg)&#39;, ...
<a name="l00675"></a>00675                 geneClasses, [
<a name="l00676"></a>00676                 SingleGeneDeletions.NON_REPLICATIVE
<a name="l00677"></a>00677                 ], 3, &#39;SouthWest&#39;);
<a name="l00678"></a>00678             
<a name="l00679"></a>00679             %non-fissive
<a name="l00680"></a>00680             ydata = deletionStats(:, 7, 1);
<a name="l00681"></a>00681             ydata(isnan(ydata)) = max(ydata);
<a name="l00682"></a>00682             SingleGeneDeletions.plotDeletionStrainClassificationHelper(...
<a name="l00683"></a>00683                 deletionStats(:, 5, 1), ydata, ...
<a name="l00684"></a>00684                 &#39;<a class="code" href="class_replication.html">Replication</a> Time (h)&#39;, &#39;Cell Cycle Length (h)&#39;, ...
<a name="l00685"></a>00685                 geneClasses, [
<a name="l00686"></a>00686                 SingleGeneDeletions.NON_FISSIVE
<a name="l00687"></a>00687                 ], 4, &#39;SouthEast&#39;);
<a name="l00688"></a>00688             
<a name="l00689"></a>00689             %toxin accumulation
<a name="l00690"></a>00690             SingleGeneDeletions.plotDeletionStrainClassificationHelper(...
<a name="l00691"></a>00691                 deletionStats(:, 1, 1), deletionStats(:, 18, 1), ...
<a name="l00692"></a>00692                 &#39;Growth (fg h^-1)&#39;, &#39;Damaged <a class="code" href="class_protein.html">Protein</a> Mass Constant (h)&#39;, ...
<a name="l00693"></a>00693                 geneClasses, [
<a name="l00694"></a>00694                 SingleGeneDeletions.TOXIN_ACCUMULATION
<a name="l00695"></a>00695                 ], 5, &#39;NorthEast&#39;);
<a name="l00696"></a>00696         end
<a name="l00697"></a>00697         
<a name="l00698"></a>00698         function plotDeletionGrowthRateDistribution(wtGrowth, koGrowth, geneClasses, outputFile)
<a name="l00699"></a>00699             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l00700"></a>00700             import edu.stanford.covert.cell.sim.util.CachedSimulationObjectUtil;
<a name="l00701"></a>00701             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l00702"></a>00702             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l00703"></a>00703             
<a name="l00704"></a>00704             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l00705"></a>00705             sim = CachedSimulationObjectUtil.load();
<a name="l00706"></a>00706             
<a name="l00707"></a>00707             if nargin &lt; 4
<a name="l00708"></a>00708                 outputFile = [baseDir &#39;deletionGrowthRateDistribution.pdf&#39;];
<a name="l00709"></a>00709             end
<a name="l00710"></a>00710             
<a name="l00711"></a>00711             %% get data
<a name="l00712"></a>00712             if nargin &lt; 1
<a name="l00713"></a>00713                 wtData = load([baseDir &#39;WT.mat&#39;], &#39;simEndTimes&#39;, &#39;growth&#39;);
<a name="l00714"></a>00714                 wtGrowth = wtData.growth(sub2ind(size(wtData.growth), wtData.simEndTimes, (1:numel(wtData.simEndTimes))&#39;));
<a name="l00715"></a>00715             end
<a name="l00716"></a>00716             if nargin &lt; 2
<a name="l00717"></a>00717                 load([baseDir &#39;deletionStats.mat&#39;]);
<a name="l00718"></a>00718                 koGrowth = deletionStats(:, 1, 1); %<span class="preprocessor">#ok&lt;NODEF&gt;</span>
<a name="l00719"></a>00719 <span class="preprocessor"></span>            end
<a name="l00720"></a>00720             <span class="keywordflow">if</span> nargin &lt; 3
<a name="l00721"></a>00721                 load([baseDir <span class="stringliteral">&#39;geneClasses.mat&#39;</span>]);
<a name="l00722"></a>00722             end
<a name="l00723"></a>00723             
<a name="l00724"></a>00724             koNonEssGrowth = koGrowth(geneClasses == SingleGeneDeletions.NON_ESSENTIAL);
<a name="l00725"></a>00725             koSlowGrowth = koGrowth(geneClasses == SingleGeneDeletions.SLOW_GROWING);
<a name="l00726"></a>00726             koGrowthEssGrowth = koGrowth(ismember(geneClasses, [
<a name="l00727"></a>00727                 SingleGeneDeletions.DECOMPOSING;
<a name="l00728"></a>00728                 SingleGeneDeletions.NON_GROWING
<a name="l00729"></a>00729                 SingleGeneDeletions.DECAYING_GROWTH_NON_RNA_PROTEIN;
<a name="l00730"></a>00730                 SingleGeneDeletions.DECAYING_GROWTH_NON_PROTEIN
<a name="l00731"></a>00731                 ]));
<a name="l00732"></a>00732             koOtherEssGrowth = koGrowth(ismember(geneClasses, [
<a name="l00733"></a>00733                 SingleGeneDeletions.NON_REPLICATIVE;
<a name="l00734"></a>00734                 SingleGeneDeletions.NON_FISSIVE;
<a name="l00735"></a>00735                 SingleGeneDeletions.NON_PERPETUATING;
<a name="l00736"></a>00736                 SingleGeneDeletions.NO_TERMINAL_ORGANELLE
<a name="l00737"></a>00737                 SingleGeneDeletions.TOXIN_ACCUMULATION
<a name="l00738"></a>00738                 ]));
<a name="l00739"></a>00739             
<a name="l00740"></a>00740             wtGrowth =  ((wtGrowth*1<a class="code" href="json_parse_8m.html#ac14d26badced2970320ee4d772ad0ae9">e</a>-15)/2) / sim.state(&#39;Mass&#39;).cellInitialDryWeight / (1 - sim.state(&#39;Mass&#39;).fractionWetWeight);
<a name="l00741"></a>00741             koNonEssGrowth = ((koNonEssGrowth*1<a class="code" href="json_parse_8m.html#ac14d26badced2970320ee4d772ad0ae9">e</a>-15)/2) / sim.state(&#39;Mass&#39;).cellInitialDryWeight / (1 - sim.state(&#39;Mass&#39;).fractionWetWeight);
<a name="l00742"></a>00742             koSlowGrowth = ((koSlowGrowth*1<a class="code" href="json_parse_8m.html#ac14d26badced2970320ee4d772ad0ae9">e</a>-15)/2) / sim.state(&#39;Mass&#39;).cellInitialDryWeight / (1 - sim.state(&#39;Mass&#39;).fractionWetWeight);
<a name="l00743"></a>00743             koGrowthEssGrowth = ((koGrowthEssGrowth*1<a class="code" href="json_parse_8m.html#ac14d26badced2970320ee4d772ad0ae9">e</a>-15)/2) / sim.state(&#39;Mass&#39;).cellInitialDryWeight / (1 - sim.state(&#39;Mass&#39;).fractionWetWeight);
<a name="l00744"></a>00744             koOtherEssGrowth = ((koOtherEssGrowth*1<a class="code" href="json_parse_8m.html#ac14d26badced2970320ee4d772ad0ae9">e</a>-15)/2) / sim.state(&#39;Mass&#39;).cellInitialDryWeight / (1 - sim.state(&#39;Mass&#39;).fractionWetWeight);
<a name="l00745"></a>00745             
<a name="l00746"></a>00746             edges = linspace(0, max([wtGrowth; koGrowth]), 50);
<a name="l00747"></a>00747             freqWtGrowth = histc(wtGrowth, edges) / numel(wtGrowth);
<a name="l00748"></a>00748             freqKONonEssGrowth = histc(koNonEssGrowth, edges) / numel(koNonEssGrowth);
<a name="l00749"></a>00749             freqKOSlowGrowth = histc(koSlowGrowth, edges) / numel(koSlowGrowth);
<a name="l00750"></a>00750             freqKOGrowthEssGrowth = histc(koGrowthEssGrowth, edges) / numel(koGrowthEssGrowth);
<a name="l00751"></a>00751             freqKOOtherEssGrowth = histc(koOtherEssGrowth, edges) / numel(koOtherEssGrowth);
<a name="l00752"></a>00752             
<a name="l00753"></a>00753             freqWtGrowth(freqWtGrowth == 0) = NaN;
<a name="l00754"></a>00754             freqKONonEssGrowth(freqKONonEssGrowth == 0) = NaN;
<a name="l00755"></a>00755             freqKOSlowGrowth(freqKOSlowGrowth == 0) = NaN;
<a name="l00756"></a>00756             freqKOGrowthEssGrowth(freqKOGrowthEssGrowth == 0) = NaN;
<a name="l00757"></a>00757             freqKOOtherEssGrowth(freqKOOtherEssGrowth == 0) = NaN;
<a name="l00758"></a>00758             
<a name="l00759"></a>00759             %% plot
<a name="l00760"></a>00760             [~, figHandle] = PlotUtil.newAxesHandle();
<a name="l00761"></a>00761             clf(figHandle);
<a name="l00762"></a>00762             
<a name="l00763"></a>00763             w = 8;
<a name="l00764"></a>00764             h = 4;
<a name="l00765"></a>00765             <span class="keyword">set</span>(figHandle, <span class="stringliteral">&#39;PaperUnits&#39;</span>, <span class="stringliteral">&#39;centimeters&#39;</span>);
<a name="l00766"></a>00766             <span class="keyword">set</span>(figHandle, <span class="stringliteral">&#39;PaperSize&#39;</span>, [w h]); %6.5 in
<a name="l00767"></a>00767             <span class="keyword">set</span>(figHandle, <span class="stringliteral">&#39;PaperPositionMode&#39;</span>, <span class="stringliteral">&#39;manual&#39;</span>);
<a name="l00768"></a>00768             <span class="keyword">set</span>(figHandle, <span class="stringliteral">&#39;PaperPosition&#39;</span>, [0 0 get(figHandle, &#39;PaperSize&#39;)]);
<a name="l00769"></a>00769             figPos = <span class="keyword">get</span>(figHandle, <span class="stringliteral">&#39;Position&#39;</span>);
<a name="l00770"></a>00770             <span class="keyword">set</span>(figHandle, <span class="stringliteral">&#39;Position&#39;</span>, [figPos(1:2) figPos(3) figPos(3) * h / w]);
<a name="l00771"></a>00771             
<a name="l00772"></a>00772             axesHandle = subplot(<span class="stringliteral">&#39;Position&#39;</span>, [0.075 0.14 0.925 0.86], <span class="stringliteral">&#39;Parent&#39;</span>, figHandle);
<a name="l00773"></a>00773             hold(axesHandle, <span class="stringliteral">&#39;on&#39;</span>);
<a name="l00774"></a>00774             
<a name="l00775"></a>00775             barHandles = bar(axesHandle, edges, [freqKOGrowthEssGrowth freqKOSlowGrowth freqWtGrowth]);
<a name="l00776"></a>00776             <span class="keyword">set</span>(barHandles(1), <span class="stringliteral">&#39;FaceColor&#39;</span>, [0 1 0])
<a name="l00777"></a>00777             <span class="keyword">set</span>(barHandles(2), <span class="stringliteral">&#39;FaceColor&#39;</span>, [1 0 0])
<a name="l00778"></a>00778             <span class="keyword">set</span>(barHandles(3), <span class="stringliteral">&#39;FaceColor&#39;</span>, [0 0 1])
<a name="l00779"></a>00779             <span class="keyword">set</span>(barHandles, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;BarWidth&#39;</span>, 2);
<a name="l00780"></a>00780             xlim(axesHandle, [-0.05 1.2]);
<a name="l00781"></a>00781             ylim(axesHandle, [0 0.62]);
<a name="l00782"></a>00782             <span class="keyword">set</span>(axesHandle, <span class="stringliteral">&#39;XTick&#39;</span>, 0:0.25:1.5, <span class="stringliteral">&#39;XTickLabel&#39;</span>, {<span class="charliteral">&#39;0&#39;</span> <span class="stringliteral">&#39;&#39;</span> <span class="charliteral">&#39;1&#39;</span> <span class="stringliteral">&#39;&#39;</span> <span class="charliteral">&#39;2&#39;</span> <span class="stringliteral">&#39;&#39;</span> <span class="charliteral">&#39;3&#39;</span>});
<a name="l00783"></a>00783             <span class="keyword">set</span>(axesHandle, <span class="stringliteral">&#39;YTick&#39;</span>, 0:0.1:0.6);
<a name="l00784"></a>00784             <span class="keyword">set</span>(axesHandle, <span class="stringliteral">&#39;FontSize&#39;</span>, 5, <span class="stringliteral">&#39;TickDir&#39;</span>, <span class="stringliteral">&#39;out&#39;</span>);
<a name="l00785"></a>00785             
<a name="l00786"></a>00786             tick2text(axesHandle, <span class="stringliteral">&#39;axis&#39;</span>, <span class="stringliteral">&#39;xy&#39;</span>, <span class="stringliteral">&#39;xtickoffset&#39;</span>, 0.05, <span class="stringliteral">&#39;ytickoffset&#39;</span>, 0.028);
<a name="l00787"></a>00787             xTicks = getappdata(axesHandle, <span class="stringliteral">&#39;XTickText&#39;</span>);
<a name="l00788"></a>00788             yTicks = getappdata(axesHandle, <span class="stringliteral">&#39;YTickText&#39;</span>);
<a name="l00789"></a>00789             <span class="keyword">set</span>(xTicks, <span class="stringliteral">&#39;FontSize&#39;</span>, 5);
<a name="l00790"></a>00790             <span class="keyword">set</span>(yTicks, <span class="stringliteral">&#39;FontSize&#39;</span>, 5);
<a name="l00791"></a>00791             <span class="keyword">delete</span>(xTicks(2:2:end));
<a name="l00792"></a>00792             
<a name="l00793"></a>00793             text(0.87, 0.60, <span class="stringliteral">&#39;Wild type&#39;</span>, ...
<a name="l00794"></a>00794                 <span class="stringliteral">&#39;Color&#39;</span>, [0 0 1], <span class="stringliteral">&#39;HorizontalAlign&#39;</span>, <span class="stringliteral">&#39;center&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, 7, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle)
<a name="l00795"></a>00795             text(0.48, 0.60, &#39;Quasi-essential&#39;, ...
<a name="l00796"></a>00796                 &#39;Color&#39;, [1 0 0], &#39;HorizontalAlign&#39;, &#39;center&#39;, &#39;FontSize&#39;, 7, &#39;Parent&#39;, axesHandle)
<a name="l00797"></a>00797             text(0.09, 0.60, &#39;Essential&#39;, ...
<a name="l00798"></a>00798                 &#39;Color&#39;, [0 1 0], &#39;HorizontalAlign&#39;, &#39;center&#39;, &#39;FontSize&#39;, 7, &#39;Parent&#39;, axesHandle)
<a name="l00799"></a>00799             
<a name="l00800"></a>00800             xlabel(axesHandle, &#39;Growth rate constant (h^{-1})&#39;, &#39;FontSize&#39;, 7);
<a name="l00801"></a>00801             ylabel(axesHandle, <span class="stringliteral">&#39;Frequency&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, 7);
<a name="l00802"></a>00802             xlabelPos = <span class="keyword">get</span>(<span class="keyword">get</span>(axesHandle, <span class="stringliteral">&#39;xlabel&#39;</span>), <span class="stringliteral">&#39;position&#39;</span>);
<a name="l00803"></a>00803             ylabelPos = <span class="keyword">get</span>(<span class="keyword">get</span>(axesHandle, <span class="stringliteral">&#39;ylabel&#39;</span>), <span class="stringliteral">&#39;position&#39;</span>);
<a name="l00804"></a>00804             <span class="keyword">set</span>(<span class="keyword">get</span>(axesHandle, <span class="stringliteral">&#39;xlabel&#39;</span>), <span class="stringliteral">&#39;position&#39;</span>, [xlabelPos(1) -0.041 xlabelPos(end)]);
<a name="l00805"></a>00805             <span class="keyword">set</span>(<span class="keyword">get</span>(axesHandle, <span class="stringliteral">&#39;ylabel&#39;</span>), <span class="stringliteral">&#39;position&#39;</span>, [-0.110 ylabelPos(2:end)]);
<a name="l00806"></a>00806             
<a name="l00807"></a>00807             line(xlim(axesHandle), [0 0], <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle, <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>, <span class="stringliteral">&#39;LineWidth&#39;</span>, 0.5)
<a name="l00808"></a>00808             
<a name="l00809"></a>00809             print(figHandle, outputFile, &#39;-dpdf&#39;, &#39;-cmyk&#39;);
<a name="l00810"></a>00810             close(figHandle);
<a name="l00811"></a>00811         end
<a name="l00812"></a>00812         
<a name="l00813"></a>00813         function plotDeletionStrainClassificationHelper(xdata, ydata, xlabelStr, ylabelStr, geneClasses, classIdxs, plotIdx, legendLocation)
<a name="l00814"></a>00814             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l00815"></a>00815             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l00816"></a>00816             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l00817"></a>00817             
<a name="l00818"></a>00818             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l00819"></a>00819             
<a name="l00820"></a>00820             [axesHandle, figHandle] = PlotUtil.newAxesHandle();
<a name="l00821"></a>00821             hold(axesHandle, &#39;on&#39;);
<a name="l00822"></a>00822             h = zeros(size(SingleGeneDeletions.DELETION_STRAIN_CLASSES, 1), 1);
<a name="l00823"></a>00823             for i = 1:size(SingleGeneDeletions.DELETION_STRAIN_CLASSES, 1) - 2
<a name="l00824"></a>00824                 geneTfs = geneClasses == i;
<a name="l00825"></a>00825                 if ~any(geneTfs)
<a name="l00826"></a>00826                     continue;
<a name="l00827"></a>00827                 end
<a name="l00828"></a>00828                 h(i) = plot(axesHandle, xdata(geneTfs), ydata(geneTfs), ...
<a name="l00829"></a>00829                     &#39;Marker&#39;, &#39;.&#39;, ...
<a name="l00830"></a>00830                     &#39;LineStyle&#39;, &#39;none&#39;, ...
<a name="l00831"></a>00831                     &#39;Color&#39;, SingleGeneDeletions.COLORS(i, :));
<a name="l00832"></a>00832             end
<a name="l00833"></a>00833             classIdxs = intersect(classIdxs, find(h));
<a name="l00834"></a>00834             uistack(h(classIdxs), &#39;top&#39;)
<a name="l00835"></a>00835             set(h(classIdxs), &#39;MarkerSize&#39;, 12)
<a name="l00836"></a>00836             legend(h(classIdxs), SingleGeneDeletions.DELETION_STRAIN_CLASSES(classIdxs), ...
<a name="l00837"></a>00837                 &#39;Location&#39;, legendLocation);
<a name="l00838"></a>00838             if ~isnan(range(xdata)) &amp;&amp; range(xdata)
<a name="l00839"></a>00839                 xlim(axesHandle, [min(xdata) max(xdata)] + range(xdata) * [-0.05 0.05]);
<a name="l00840"></a>00840             end
<a name="l00841"></a>00841             if ~isnan(range(ydata)) &amp;&amp; range(ydata)
<a name="l00842"></a>00842                 ylim(axesHandle, [min(ydata) max(ydata)] + range(ydata) * [-0.05 0.05]);
<a name="l00843"></a>00843             end
<a name="l00844"></a>00844             xlabel(axesHandle, xlabelStr, &#39;FontSize&#39;, 14);
<a name="l00845"></a>00845             ylabel(axesHandle, ylabelStr, &#39;FontSize&#39;, 14);
<a name="l00846"></a>00846             saveas(figHandle, [baseDir &#39;classification-&#39; num2str(plotIdx) &#39;.pdf&#39;]);
<a name="l00847"></a>00847             close(figHandle);
<a name="l00848"></a>00848         end
<a name="l00849"></a>00849         
<a name="l00850"></a>00850         function plotOverview(outFileName_Figure, outFileName_Table, ...
<a name="l00851"></a>00851                 sim, geneClasses, wtData, koData, gridData, gridMetaData)
<a name="l00852"></a>00852             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l00853"></a>00853             import edu.stanford.covert.cell.sim.util.CachedSimulationObjectUtil;
<a name="l00854"></a>00854             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l00855"></a>00855             import edu.stanford.covert.cell.sim.util.PrintUtil;
<a name="l00856"></a>00856             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l00857"></a>00857             import edu.stanford.covert.util.<a class="code" href="class_constant_util.html">ConstantUtil</a>;
<a name="l00858"></a>00858             
<a name="l00859"></a>00859             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l00860"></a>00860             if nargin &lt; 1 || isempty(outFileName_Figure)
<a name="l00861"></a>00861                 outFileName_Figure = [baseDir filesep &#39;overview.pdf&#39;];
<a name="l00862"></a>00862             end
<a name="l00863"></a>00863             if nargin &lt; 2 || isempty(outFileName_Table)
<a name="l00864"></a>00864                 outFileName_Table = [baseDir &#39;overview.xls&#39;];
<a name="l00865"></a>00865             end
<a name="l00866"></a>00866             
<a name="l00867"></a>00867             %% initialize
<a name="l00868"></a>00868             [~, figHandle] = PlotUtil.newAxesHandle();
<a name="l00869"></a>00869             clf(figHandle);
<a name="l00870"></a>00870             set(figHandle, &#39;PaperUnits&#39;, &#39;centimeters&#39;);
<a name="l00871"></a>00871             set(figHandle, &#39;PaperSize&#39;, [18.3 7.3]); %Nature two column
<a name="l00872"></a>00872             set(figHandle, &#39;PaperPositionMode&#39;, &#39;manual&#39;);
<a name="l00873"></a>00873             set(figHandle, &#39;PaperPosition&#39;, [0 0 get(figHandle, &#39;PaperSize&#39;)]);
<a name="l00874"></a>00874             
<a name="l00875"></a>00875             %% get data
<a name="l00876"></a>00876             if nargin &lt; 3
<a name="l00877"></a>00877                 sim = CachedSimulationObjectUtil.load();
<a name="l00878"></a>00878             end
<a name="l00879"></a>00879             g = sim.gene;
<a name="l00880"></a>00880             isGeneImplemented = SingleGeneDeletions.getGeneImplementations(sim);
<a name="l00881"></a>00881             expEss = ismember(g.essential, {<span class="charliteral">&#39;Y&#39;</span>, <span class="stringliteral">&#39;&#39;</span>});
<a name="l00882"></a>00882             <span class="keywordflow">if</span> nargin &lt; 4
<a name="l00883"></a>00883                 load([baseDir <span class="stringliteral">&#39;geneClasses.mat&#39;</span>]);
<a name="l00884"></a>00884             end
<a name="l00885"></a>00885             modelEss = geneClasses ~= SingleGeneDeletions.NON_ESSENTIAL;
<a name="l00886"></a>00886             
<a name="l00887"></a>00887             %% fontsizes
<a name="l00888"></a>00888             fontSizeSubfigLabel = 8;
<a name="l00889"></a>00889             fontSizeLarge = 7;
<a name="l00890"></a>00890             fontSizeMed = 6;
<a name="l00891"></a>00891             fontSizeSmall = 5;
<a name="l00892"></a>00892             
<a name="l00893"></a>00893             %% part A -- deletion strain classes spark line matrix
<a name="l00894"></a>00894             figPos = get(figHandle, &#39;Position&#39;);
<a name="l00895"></a>00895             
<a name="l00896"></a>00896             PlotUtil.labelSubFigure(<span class="charliteral">&#39;a&#39;</span>, [0.05 1.015 -0.0286 -0.0690], figHandle, fontSizeSubfigLabel);
<a name="l00897"></a>00897             
<a name="l00898"></a>00898             catLabels = {
<a name="l00899"></a>00899                 <span class="stringliteral">&#39;WT&#39;</span>             SingleGeneDeletions.WILD_TYPE
<a name="l00900"></a>00900                 <span class="stringliteral">&#39;Energy&#39;</span>         SingleGeneDeletions.DECOMPOSING
<a name="l00901"></a>00901                 <span class="stringliteral">&#39;Metabolic&#39;</span>      SingleGeneDeletions.NON_GROWING
<a name="l00902"></a>00902                 <span class="stringliteral">&#39;RNA&#39;</span>            SingleGeneDeletions.DECAYING_GROWTH_NON_RNA_PROTEIN
<a name="l00903"></a>00903                 <span class="stringliteral">&#39;Protein&#39;</span>        SingleGeneDeletions.DECAYING_GROWTH_NON_PROTEIN
<a name="l00904"></a>00904                 <span class="stringliteral">&#39;Other&#39;</span>          SingleGeneDeletions.NON_PERPETUATING
<a name="l00905"></a>00905                 <span class="stringliteral">&#39;DNA&#39;</span>            SingleGeneDeletions.NON_REPLICATIVE
<a name="l00906"></a>00906                 <span class="stringliteral">&#39;Cytokinesis&#39;</span>    SingleGeneDeletions.NON_FISSIVE
<a name="l00907"></a>00907                 <span class="stringliteral">&#39;Term Org&#39;</span>       SingleGeneDeletions.NO_TERMINAL_ORGANELLE
<a name="l00908"></a>00908                 <span class="stringliteral">&#39;Damaged&#39;</span>        SingleGeneDeletions.TOXIN_ACCUMULATION
<a name="l00909"></a>00909                 <span class="stringliteral">&#39;Quasi-Ess&#39;</span>      SingleGeneDeletions.SLOW_GROWING
<a name="l00910"></a>00910                 <span class="stringliteral">&#39;Non-Ess&#39;</span>        SingleGeneDeletions.NON_ESSENTIAL
<a name="l00911"></a>00911                 };
<a name="l00912"></a>00912             propLabels = {
<a name="l00913"></a>00913                 {<span class="stringliteral">&#39;NTP&#39;</span>}                 <span class="stringliteral">&#39;ntps&#39;</span>
<a name="l00914"></a>00914                 {<span class="stringliteral">&#39;Growth (fg h^{-1})&#39;</span>}  <span class="stringliteral">&#39;growth&#39;</span>
<a name="l00915"></a>00915                 {<span class="stringliteral">&#39;Protein (fg)&#39;</span>}        <span class="stringliteral">&#39;proteinWt&#39;</span>
<a name="l00916"></a>00916                 {<span class="stringliteral">&#39;RNA (fg)&#39;</span>}            <span class="stringliteral">&#39;rnaWt&#39;</span>
<a name="l00917"></a>00917                 {<span class="stringliteral">&#39;DNA (fg)&#39;</span>}            <span class="stringliteral">&#39;dnaWt&#39;</span>
<a name="l00918"></a>00918                 {<span class="stringliteral">&#39;Septum (nm)&#39;</span>}         <span class="stringliteral">&#39;pinchedDiameter&#39;</span>
<a name="l00919"></a>00919                 {<span class="stringliteral">&#39;Term Org (fg)&#39;</span>}       <span class="stringliteral">&#39;terminalOrganelleWt&#39;</span>
<a name="l00920"></a>00920                 {<span class="stringliteral">&#39;Damaged&#39;</span> <span class="stringliteral">&#39;Prot&#39;</span>}      <span class="stringliteral">&#39;damagedProteins&#39;</span>
<a name="l00921"></a>00921                 };
<a name="l00922"></a>00922             highlightPlot = <span class="keyword">false</span>(size(propLabels, 1), size(catLabels, 1));
<a name="l00923"></a>00923             highlightPlot(1:8, 2) = <span class="keyword">true</span>;%energy
<a name="l00924"></a>00924             highlightPlot(2:7, 3) = <span class="keyword">true</span>;%metabolic
<a name="l00925"></a>00925             highlightPlot([1:4 6:7], 4) = <span class="keyword">true</span>;%<a class="code" href="class_r_n_a.html">RNA</a>
<a name="l00926"></a>00926             highlightPlot([2 3 6:7], 5) = <span class="keyword">true</span>;%<a class="code" href="class_protein.html">Protein</a>
<a name="l00927"></a>00927             highlightPlot(7, 6) = <span class="keyword">true</span>;%other synthetic
<a name="l00928"></a>00928             highlightPlot(5:6, 7) = <span class="keyword">true</span>;%DNA
<a name="l00929"></a>00929             highlightPlot(6, 8) = <span class="keyword">true</span>;%cytokinesis
<a name="l00930"></a>00930             highlightPlot(8, 10) = <span class="keyword">true</span>;%damaged
<a name="l00931"></a>00931             highlightPlot([2 3 7], 11) = <span class="keyword">true</span>;%Slow
<a name="l00932"></a>00932             
<a name="l00933"></a>00933             groupCats = (1:size(catLabels, 1))<span class="stringliteral">&#39;;</span>
<a name="l00934"></a>00934 <span class="stringliteral">            groupCats([2 9 10 12]) = [3 6 11 0];</span>
<a name="l00935"></a>00935 <span class="stringliteral">            showProps = (1:size(propLabels, 1))&#39;</span>;
<a name="l00936"></a>00936             showProps([1 7 8]) = <span class="keyword">false</span>;
<a name="l00937"></a>00937             
<a name="l00938"></a>00938             catIdxs = find(groupCats == (1:size(catLabels, 1))<span class="stringliteral">&#39;);</span>
<a name="l00939"></a>00939 <span class="stringliteral">            propIdxs = find(showProps);</span>
<a name="l00940"></a>00940 <span class="stringliteral">            </span>
<a name="l00941"></a>00941 <span class="stringliteral">            nCats = numel(catIdxs);</span>
<a name="l00942"></a>00942 <span class="stringliteral">            nProps = numel(propIdxs);</span>
<a name="l00943"></a>00943 <span class="stringliteral">            </span>
<a name="l00944"></a>00944 <span class="stringliteral">            time = (0:50000)&#39;</span> / 3600;
<a name="l00945"></a>00945             
<a name="l00946"></a>00946             <span class="keywordflow">if</span> nargin &gt;= 8
<a name="l00947"></a>00947             elseif exist([baseDir <span class="stringliteral">&#39;overview.mat&#39;</span>], <span class="stringliteral">&#39;file&#39;</span>)
<a name="l00948"></a>00948                 load([baseDir &#39;overview.mat&#39;]);
<a name="l00949"></a>00949             else
<a name="l00950"></a>00950                 [gridData, gridMetaData] = SingleGeneDeletions.calcOverviewData();
<a name="l00951"></a>00951                 save([baseDir &#39;overview.mat&#39;], &#39;gridData&#39;, &#39;gridMetaData&#39;);
<a name="l00952"></a>00952             end
<a name="l00953"></a>00953             
<a name="l00954"></a>00954             gridData(:, :, 1) = NaN;
<a name="l00955"></a>00955             
<a name="l00956"></a>00956             %layout
<a name="l00957"></a>00957             x = 0.1150;
<a name="l00958"></a>00958             y = 0.845;
<a name="l00959"></a>00959             W = 0.565;
<a name="l00960"></a>00960             H = 0.755;
<a name="l00961"></a>00961             w = W / nCats;
<a name="l00962"></a>00962             h = H / nProps;
<a name="l00963"></a>00963             y1 = y + 0.12;
<a name="l00964"></a>00964             y2 = y + 0.08;
<a name="l00965"></a>00965             y3 = y + 0.06;
<a name="l00966"></a>00966             yMargin = 0.13 / 2;
<a name="l00967"></a>00967             xMargin = (h * figPos(4)) / (w * figPos(3)) * yMargin;
<a name="l00968"></a>00968             xSpan = 1 - 2 * xMargin;
<a name="l00969"></a>00969             ySpan = 1 - 2 * yMargin;            
<a name="l00970"></a>00970             highlightColor = [255 230 230] / 255; %light red
<a name="l00971"></a>00971             nonhighlightColor = [1 1 1]; %white
<a name="l00972"></a>00972             
<a name="l00973"></a>00973             %data
<a name="l00974"></a>00974             xlims = [0 time(end)] + [-1 1] * (1/xSpan - 1)/2 * time(end);
<a name="l00975"></a>00975             for i = 1:nProps
<a name="l00976"></a>00976                 for j = 1:nCats
<a name="l00977"></a>00977                     axesHandle = subplot(&#39;Position&#39;, [x+(j-1)*w  y-(i)*h  w  h]);
<a name="l00978"></a>00978                     
<a name="l00979"></a>00979                     switch propLabels{propIdxs(i), 2}
<a name="l00980"></a>00980                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;ntps&#39;</span>
<a name="l00981"></a>00981                             yticks = [0 1e6];
<a name="l00982"></a>00982                             ytickLabels = {num2str(yticks(1))  <span class="stringliteral">&#39;10^6&#39;</span>};
<a name="l00983"></a>00983                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;growth&#39;</span>
<a name="l00984"></a>00984                             yticks = [0 2.5];
<a name="l00985"></a>00985                             ytickLabels = {num2str(yticks(1))  num2str(yticks(2))};
<a name="l00986"></a>00986                         case &#39;rnaWt&#39;
<a name="l00987"></a>00987                             yticks = [0 0.4] * 1<a class="code" href="json_parse_8m.html#ac14d26badced2970320ee4d772ad0ae9">e</a>-15;
<a name="l00988"></a>00988                             ytickLabels = {num2str(yticks(1)*1e15)  num2str(yticks(2)*1e15)};
<a name="l00989"></a>00989                         case &#39;proteinWt&#39;
<a name="l00990"></a>00990                             yticks = [2 7] * 1e-15;
<a name="l00991"></a>00991                             ytickLabels = {num2str(yticks(1)*1e15)  num2str(yticks(2)*1e15)};
<a name="l00992"></a>00992                         case &#39;dnaWt&#39;
<a name="l00993"></a>00993                             yticks = [0.6 1.2] * 1e-15;
<a name="l00994"></a>00994                             ytickLabels = {num2str(yticks(1)*1e15)  num2str(yticks(2)*1e15)};
<a name="l00995"></a>00995                         case &#39;pinchedDiameter&#39;
<a name="l00996"></a>00996                             yticks = [0 250e-9];
<a name="l00997"></a>00997                             ytickLabels = {num2str(yticks(1))  num2str(yticks(2) * 1e9)};
<a name="l00998"></a>00998                         case &#39;terminalOrganelleWt&#39;
<a name="l00999"></a>00999                             yticks = [0 0.1] * 1e-15;
<a name="l01000"></a>01000                             ytickLabels = {num2str(yticks(1) * 1e15)  num2str(yticks(2) * 1e15)};
<a name="l01001"></a>01001                         case &#39;damagedProteins&#39;
<a name="l01002"></a>01002                             yticks = [0 6000];
<a name="l01003"></a>01003                             ytickLabels = {num2str(yticks(1))  num2str(yticks(2))};
<a name="l01004"></a>01004                         otherwise
<a name="l01005"></a>01005                             throw(MException(&#39;SingleGeneDeletions:error&#39;, &#39;undefined property %s&#39;, propLabels{propIdxs(i), 2}))
<a name="l01006"></a>01006                     end
<a name="l01007"></a>01007                     ylims0 = [min(yticks(1), min(min(gridData(propIdxs(i), :, :))))  max(yticks(2), max(max(gridData(propIdxs(i), :, :))))];
<a name="l01008"></a>01008                     ylims = ylims0 + [-1 1] * (1/ySpan - 1)/2 * (ylims0(2) - ylims0(1));
<a name="l01009"></a>01009                     
<a name="l01010"></a>01010                     if highlightPlot(propIdxs(i), catIdxs(j))
<a name="l01011"></a>01011                         faceColor = highlightColor;
<a name="l01012"></a>01012                     else
<a name="l01013"></a>01013                         faceColor = nonhighlightColor;
<a name="l01014"></a>01014                     end
<a name="l01015"></a>01015                     if ~all(faceColor == 1)
<a name="l01016"></a>01016                         hold(axesHandle, &#39;on&#39;);
<a name="l01017"></a>01017                         rectangle(&#39;Parent&#39;, axesHandle, &#39;Position&#39;, [xlims(1) ylims(1) range(xlims) range(ylims)], &#39;EdgeColor&#39;, &#39;none&#39;, &#39;FaceColor&#39;, faceColor);
<a name="l01018"></a>01018                     end
<a name="l01019"></a>01019                     
<a name="l01020"></a>01020                     plot(axesHandle, time, squeeze(gridData(propIdxs(i), catIdxs(j), :)), &#39;Color&#39;, &#39;k&#39;);
<a name="l01021"></a>01021                     
<a name="l01022"></a>01022                     set(axesHandle, &#39;XTick&#39;, [], &#39;YTick&#39;, []);
<a name="l01023"></a>01023                     set(axesHandle, &#39;Color&#39;, &#39;none&#39;, &#39;Box&#39;, &#39;off&#39;, &#39;Visible&#39;, &#39;off&#39;);
<a name="l01024"></a>01024                     xlim(axesHandle, xlims);
<a name="l01025"></a>01025                     ylim(axesHandle, ylims);
<a name="l01026"></a>01026                     
<a name="l01027"></a>01027                     if j == 1
<a name="l01028"></a>01028                         ylims = ylim(axesHandle);
<a name="l01029"></a>01029                         for k = 1:numel(yticks)
<a name="l01030"></a>01030                             annotation(figHandle, &#39;textbox&#39;, [x-0.006 - xMargin*w  (y-i*h + h*(yticks(k)-ylims(1)) / (ylims(end)-ylims(1)))-0.005 0  0], ...
<a name="l01031"></a>01031                                 &#39;String&#39;, ytickLabels{k}, ...
<a name="l01032"></a>01032                                 <span class="stringliteral">&#39;FontSize&#39;</span>, fontSizeSmall, ...
<a name="l01033"></a>01033                                 <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, ...
<a name="l01034"></a>01034                                 <span class="stringliteral">&#39;Margin&#39;</span>, 0, ...
<a name="l01035"></a>01035                                 <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;Right&#39;</span>, ...
<a name="l01036"></a>01036                                 <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;Middle&#39;</span>);
<a name="l01037"></a>01037                             annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, [x  x-0.004] - xMargin*w, (y-i*h + h*(yticks(k)-ylims(1)) / (ylims(end)-ylims(1))) * [1 1] , <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01038"></a>01038                         end
<a name="l01039"></a>01039                         annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, [x; x] - xMargin*w, [
<a name="l01040"></a>01040                             y - i*h + yMargin*h + ySpan*h
<a name="l01041"></a>01041                             y - i*h + yMargin*h
<a name="l01042"></a>01042                             ] , &#39;Color&#39;, &#39;k&#39;);
<a name="l01043"></a>01043                     end
<a name="l01044"></a>01044                 end
<a name="l01045"></a>01045             end
<a name="l01046"></a>01046             
<a name="l01047"></a>01047             %time axis
<a name="l01048"></a>01048             axesHandle = subplot(<span class="stringliteral">&#39;Position&#39;</span>, [x+xMargin*w  y-H-yMargin*h  w*xSpan  1e-6]);
<a name="l01049"></a>01049             xlim(axesHandle, [0 time(end)]);
<a name="l01050"></a>01050             <span class="keyword">set</span>(axesHandle, <span class="stringliteral">&#39;XTick&#39;</span>, [0 10], <span class="stringliteral">&#39;YTick&#39;</span>, [], <span class="stringliteral">&#39;TickDir&#39;</span>, <span class="stringliteral">&#39;out&#39;</span>, <span class="stringliteral">&#39;TickLen&#39;</span>, [0.04 0.04], <span class="stringliteral">&#39;FontSize&#39;</span>, fontSizeSmall, <span class="stringliteral">&#39;YColor&#39;</span>, <span class="keyword">get</span>(figHandle, <span class="stringliteral">&#39;Color&#39;</span>));
<a name="l01051"></a>01051             xlabel(axesHandle, <span class="stringliteral">&#39;Time (h)&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, fontSizeLarge);
<a name="l01052"></a>01052             xlabelPos = <span class="keyword">get</span>(<span class="keyword">get</span>(axesHandle, <span class="stringliteral">&#39;xlabel&#39;</span>), <span class="stringliteral">&#39;position&#39;</span>);
<a name="l01053"></a>01053             <span class="keyword">set</span>(<span class="keyword">get</span>(axesHandle, <span class="stringliteral">&#39;xlabel&#39;</span>), <span class="stringliteral">&#39;position&#39;</span>, [xlabelPos(1) xlabelPos(2)-100 xlabelPos(3)]);
<a name="l01054"></a>01054             tick2text(axesHandle, <span class="stringliteral">&#39;axis&#39;</span>, <span class="charliteral">&#39;x&#39;</span>, <span class="stringliteral">&#39;xtickoffset&#39;</span>, 20);
<a name="l01055"></a>01055             xTicks = getappdata(axesHandle, <span class="stringliteral">&#39;XTickText&#39;</span>);
<a name="l01056"></a>01056             <span class="keyword">set</span>(xTicks, <span class="stringliteral">&#39;FontSize&#39;</span>, fontSizeMed, <span class="stringliteral">&#39;Interpreter&#39;</span>, <span class="stringliteral">&#39;tex&#39;</span>, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;center&#39;</span>, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;top&#39;</span>);
<a name="l01057"></a>01057             
<a name="l01058"></a>01058             %grid
<a name="l01059"></a>01059             <span class="keywordflow">for</span> i = 0:nProps
<a name="l01060"></a>01060                 <span class="keywordflow">if</span> i &gt; 0
<a name="l01061"></a>01061                     txtHandle = annotation(figHandle, <span class="stringliteral">&#39;textbox&#39;</span>, [x-0.1-0.008-0.025+0.02  y - (i - 1 / 2) * h .2 0], ...
<a name="l01062"></a>01062                         <span class="stringliteral">&#39;String&#39;</span>, strjoin(<span class="charliteral">&#39; &#39;</span>, propLabels{propIdxs(i), 1}{:}), ...
<a name="l01063"></a>01063                         <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;right&#39;</span>, ...
<a name="l01064"></a>01064                         <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;Middle&#39;</span>, ...
<a name="l01065"></a>01065                         <span class="stringliteral">&#39;FontSize&#39;</span>, fontSizeLarge, ...
<a name="l01066"></a>01066                         <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;Margin&#39;</span>, 0, ...
<a name="l01067"></a>01067                         <span class="stringliteral">&#39;Interpreter&#39;</span>, <span class="stringliteral">&#39;tex&#39;</span>);
<a name="l01068"></a>01068                     <span class="keyword">set</span>(txtHandle, <span class="stringliteral">&#39;Position&#39;</span>, [x-0.2-0.008-0.018  y - (i - 1 / 2) * h 0.2 0])
<a name="l01069"></a>01069                 end
<a name="l01070"></a>01070                 annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, x + [0 W], y - i * h * [1 1], <span class="stringliteral">&#39;Color&#39;</span>, [0.75 0.75 0.75]);
<a name="l01071"></a>01071             end
<a name="l01072"></a>01072             txtHandles = zeros(nCats, 1);
<a name="l01073"></a>01073             <span class="keywordflow">for</span> i = 0:nCats
<a name="l01074"></a>01074                 <span class="keywordflow">if</span> i &gt; 0
<a name="l01075"></a>01075                     txtHandles(i) = annotation(figHandle, <span class="stringliteral">&#39;textbox&#39;</span>, [x+(i-1/2)*w  y+0.03  0  0], ...
<a name="l01076"></a>01076                         <span class="stringliteral">&#39;String&#39;</span>, catLabels{catIdxs(i), 1}, ...
<a name="l01077"></a>01077                         <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;center&#39;</span>, ...
<a name="l01078"></a>01078                         <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;bottom&#39;</span>, ...
<a name="l01079"></a>01079                         <span class="stringliteral">&#39;FontSize&#39;</span>, fontSizeMed, ...
<a name="l01080"></a>01080                         <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, ...
<a name="l01081"></a>01081                         <span class="stringliteral">&#39;Margin&#39;</span>, 0, ...
<a name="l01082"></a>01082                         <span class="stringliteral">&#39;FitBoxToText&#39;</span>, <span class="stringliteral">&#39;on&#39;</span>);
<a name="l01083"></a>01083                 end
<a name="l01084"></a>01084                 <span class="keywordflow">if</span> i &gt; 0 &amp;&amp; catLabels{catIdxs(i), 2} ~= SingleGeneDeletions.WILD_TYPE
<a name="l01085"></a>01085                     nGenes = 0;
<a name="l01086"></a>01086                     nCorrect = 0;
<a name="l01087"></a>01087                     <span class="keywordflow">for</span> j = 1:numel(groupCats)
<a name="l01088"></a>01088                         if groupCats(j) == catIdxs(i)
<a name="l01089"></a>01089                             nGenes = nGenes + ...
<a name="l01090"></a>01090                                 sum(isGeneImplemented &amp; geneClasses == catLabels{j, 2});
<a name="l01091"></a>01091                             nCorrect = nCorrect + ...
<a name="l01092"></a>01092                                 sum(expEss == modelEss &amp; isGeneImplemented &amp; geneClasses == catLabels{j, 2});
<a name="l01093"></a>01093                         end
<a name="l01094"></a>01094                     end
<a name="l01095"></a>01095                     
<a name="l01096"></a>01096                     txtHandles(i) = annotation(figHandle, <span class="stringliteral">&#39;textbox&#39;</span>, [x+(i-1/2)*w  y+0.007  0  0], ...
<a name="l01097"></a>01097                         <span class="stringliteral">&#39;String&#39;</span>, sprintf(<span class="stringliteral">&#39;(%d)&#39;</span>, nGenes), ...
<a name="l01098"></a>01098                         <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;center&#39;</span>, ...
<a name="l01099"></a>01099                         <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;bottom&#39;</span>, ...
<a name="l01100"></a>01100                         <span class="stringliteral">&#39;FontSize&#39;</span>, fontSizeSmall, ...
<a name="l01101"></a>01101                         <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, ...
<a name="l01102"></a>01102                         <span class="stringliteral">&#39;Margin&#39;</span>, 0, ...
<a name="l01103"></a>01103                         <span class="stringliteral">&#39;FitBoxToText&#39;</span>, <span class="stringliteral">&#39;on&#39;</span>);
<a name="l01104"></a>01104                 end
<a name="l01105"></a>01105                 annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, x + i * w * [1 1], y - [0 H], <span class="stringliteral">&#39;Color&#39;</span>, [0.75 0.75 0.75]);
<a name="l01106"></a>01106             end
<a name="l01107"></a>01107             
<a name="l01108"></a>01108             %dendrogram
<a name="l01109"></a>01109             annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, x + ( 1.5) * w * [1 1] + [0 6*w], [y1 y1],  <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01110"></a>01110             annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, x + ( 1.5) * w * [1 1], [y1 y3],  <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01111"></a>01111             annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, x + ( 3.5) * w * [1 1], [y1 y2+0.03],  <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01112"></a>01112             annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, x + ( 6) * w * [1 1], [y1 y2+0.03],  <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01113"></a>01113             annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, x + (7.5) * w * [1 1], [y3 y1],  <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01114"></a>01114             
<a name="l01115"></a>01115             annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, x + ( 2.5) * w * [1 1], [y3 y2],  <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01116"></a>01116             annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, x + ( 2.5) * w * [1 1] + [0 2*w], [y2 y2],  <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01117"></a>01117             annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, x + ( 4.5) * w * [1 1], [y2 y3],  <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01118"></a>01118             
<a name="l01119"></a>01119             annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, x + (5.5) * w * [1 1], [y3 y2],  <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01120"></a>01120             annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, x + (5.5) * w * [1 1] + [0 w], [y2 y2],  <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01121"></a>01121             annotation(figHandle, <span class="stringliteral">&#39;line&#39;</span>, x + (6.5) * w * [1 1], [y2 y3],  <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01122"></a>01122             
<a name="l01123"></a>01123             txtBox = [
<a name="l01124"></a>01124                 annotation(figHandle, &#39;textbox&#39;, [x+4.5*w-0.15  y1+0.02 0.3 0], &#39;String&#39;, &#39;Essential&#39;)
<a name="l01125"></a>01125                 annotation(figHandle, &#39;textbox&#39;, [x+3.5*w-0.15  y2+0.02 0.3 0], &#39;String&#39;, &#39;Macromolecule synthesis&#39;)
<a name="l01126"></a>01126                 annotation(figHandle, &#39;textbox&#39;, [x+6*w-0.15  y2+0.02 0.3 0],   &#39;String&#39;, &#39;Cell cycle&#39;)
<a name="l01127"></a>01127                 ];
<a name="l01128"></a>01128             <span class="keyword">set</span>(txtBox, <span class="stringliteral">&#39;FontSize&#39;</span>, fontSizeLarge, <span class="stringliteral">&#39;HorizontalAlignment&#39;</span>, <span class="stringliteral">&#39;center&#39;</span>, <span class="stringliteral">&#39;VerticalAlignment&#39;</span>, <span class="stringliteral">&#39;middle&#39;</span>, <span class="stringliteral">&#39;Margin&#39;</span>, 0, <span class="stringliteral">&#39;EdgeColor&#39;</span>, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;FitBoxToText&#39;</span>, <span class="stringliteral">&#39;on&#39;</span>);
<a name="l01129"></a>01129             
<a name="l01130"></a>01130             %% part B -- methionine aminopeptidase, type I (MG_172)           
<a name="l01131"></a>01131             nGenerations = 10;
<a name="l01132"></a>01132             nSamples = 20;
<a name="l01133"></a>01133             <span class="keywordflow">if</span> exist([baseDir filesep <span class="stringliteral">&#39;MG_172-analysis2.mat&#39;</span>], <span class="stringliteral">&#39;file&#39;</span>)
<a name="l01134"></a>01134                 load([baseDir filesep &#39;MG_172-analysis2.mat&#39;])
<a name="l01135"></a>01135             else
<a name="l01136"></a>01136                 g = sim.gene;
<a name="l01137"></a>01137                 r = sim.state(&#39;Rna&#39;);
<a name="l01138"></a>01138                 pm = sim.state(&#39;<a class="code" href="class_protein_monomer.html">ProteinMonomer</a>&#39;);
<a name="l01139"></a>01139                 pc = sim.state(&#39;<a class="code" href="class_protein_complex.html">ProteinComplex</a>&#39;);
<a name="l01140"></a>01140                 mr = sim.state(&#39;<a class="code" href="class_metabolic_reaction.html">MetabolicReaction</a>&#39;);
<a name="l01141"></a>01141                 ppI = sim.process(&#39;ProteinProcessingI&#39;);
<a name="l01142"></a>01142                 met = sim.process(&#39;Metabolism&#39;);
<a name="l01143"></a>01143                 
<a name="l01144"></a>01144                 sim.setForTest(&#39;processesInInitOrder&#39;, sim.processesInInitOrder(~ismember(...
<a name="l01145"></a>01145                     cellfun(@(p) p.name, sim.processesInInitOrder, &#39;UniformOutput&#39;, false), {...
<a name="l01146"></a>01146                     <span class="stringliteral">&#39;Transcription&#39;</span>
<a name="l01147"></a>01147                     <span class="stringliteral">&#39;FtsZPolymerization&#39;</span>
<a name="l01148"></a>01148                     <span class="stringliteral">&#39;ChromosomeCondensation&#39;</span>
<a name="l01149"></a>01149                     <span class="stringliteral">&#39;Translation&#39;</span>
<a name="l01150"></a>01150                     <span class="stringliteral">&#39;DNASupercoiling&#39;</span>
<a name="l01151"></a>01151                     <span class="stringliteral">&#39;ReplicationInitiation&#39;</span>
<a name="l01152"></a>01152                     })));
<a name="l01153"></a>01153                 
<a name="l01154"></a>01154                 pcComp = sum(pc.proteinComplexComposition(g.mRNAIndexs, :, :), 3);
<a name="l01155"></a>01155                 monIdxs = ppI.nascentMonomerNTerminalMethionineCleavages;
<a name="l01156"></a>01156                 unprocessedMonIdxs = ~ppI.nascentMonomerNTerminalMethionineCleavages;
<a name="l01157"></a>01157                 cpxIdxs = find(any(pcComp(monIdxs, :), 1));
<a name="l01158"></a>01158                 
<a name="l01159"></a>01159                 rnaExp = r.expression;
<a name="l01160"></a>01160                 rnaDecayRates = r.decayRates;
<a name="l01161"></a>01161                 monDecayRates = pm.decayRates;
<a name="l01162"></a>01162                 cpxDecayRates = pc.decayRates;
<a name="l01163"></a>01163                 
<a name="l01164"></a>01164                 cleavedMonWt = zeros(nGenerations, 3);
<a name="l01165"></a>01165                 growths = zeros(nGenerations, 3);
<a name="l01166"></a>01166                 <span class="keywordflow">for</span> i = 1:nGenerations
<a name="l01167"></a>01167                     tmpCleavedMonWt = zeros(nSamples, 1);
<a name="l01168"></a>01168                     tmpGrowths = zeros(nSamples, 1);
<a name="l01169"></a>01169                     <span class="keywordflow">for</span> j = 1:nSamples
<a name="l01170"></a>01170                         r.expression = rnaExp;
<a name="l01171"></a>01171                         r.decayRates = rnaDecayRates;
<a name="l01172"></a>01172                         pm.decayRates = monDecayRates;
<a name="l01173"></a>01173                         pc.decayRates = cpxDecayRates;
<a name="l01174"></a>01174                         mr.initialGrowthFilterWidth = Inf;
<a name="l01175"></a>01175                         
<a name="l01176"></a>01176                         sim.applyOptions(<span class="stringliteral">&#39;seed&#39;</span>, i * nGenerations + j);
<a name="l01177"></a>01177                         sim.allocateMemoryForState(1);
<a name="l01178"></a>01178                         sim.initializeState();
<a name="l01179"></a>01179                         sim.applyPerturbations();
<a name="l01180"></a>01180                         
<a name="l01181"></a>01181                         mons = pm.counts;
<a name="l01182"></a>01182                         cpxs = pc.counts;
<a name="l01183"></a>01183                         
<a name="l01184"></a>01184                         pm.counts(pm.processedIIIndexs(monIdxs),    :) = pm.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pm.counts(pm.processedIIIndexs(monIdxs), :), 1 / (2.^(i - 1)));
<a name="l01185"></a>01185                         pm.counts(pm.signalSequenceIndexs(monIdxs), :) = pm.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pm.counts(pm.signalSequenceIndexs(monIdxs), :), 1 / (2.^(i - 1)));
<a name="l01186"></a>01186                         pm.counts(pm.foldedIndexs(monIdxs),         :) = pm.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pm.counts(pm.foldedIndexs(monIdxs), :), 1 / (2.^(i - 1)));
<a name="l01187"></a>01187                         pm.counts(pm.matureIndexs(monIdxs),         :) = pm.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pm.counts(pm.matureIndexs(monIdxs), :), 1 / (2.^(i - 1)));
<a name="l01188"></a>01188                         pm.counts(pm.inactivatedIndexs(monIdxs),    :) = pm.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pm.counts(pm.inactivatedIndexs(monIdxs), :), 1 / (2.^(i - 1)));
<a name="l01189"></a>01189                         pm.counts(pm.boundIndexs(monIdxs),          :) = pm.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pm.counts(pm.boundIndexs(monIdxs), :), 1 / (2.^(i - 1)));
<a name="l01190"></a>01190                         pm.counts(pm.misfoldedIndexs(monIdxs),      :) = pm.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pm.counts(pm.misfoldedIndexs(monIdxs), :), 1 / (2.^(i - 1)));
<a name="l01191"></a>01191                         pm.counts(pm.damagedIndexs(monIdxs),        :) = pm.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pm.counts(pm.damagedIndexs(monIdxs), :), 1 / (2.^(i - 1)));
<a name="l01192"></a>01192                         
<a name="l01193"></a>01193                         pc.counts(pc.nascentIndexs(cpxIdxs),     :) = pc.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pc.counts(pc.nascentIndexs(cpxIdxs), :), 1 / (2.^(i - 1)));
<a name="l01194"></a>01194                         pc.counts(pc.matureIndexs(cpxIdxs),      :) = pc.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pc.counts(pc.matureIndexs(cpxIdxs), :), 1 / (2.^(i - 1)));
<a name="l01195"></a>01195                         pc.counts(pc.inactivatedIndexs(cpxIdxs), :) = pc.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pc.counts(pc.inactivatedIndexs(cpxIdxs), :), 1 / (2.^(i - 1)));
<a name="l01196"></a>01196                         pc.counts(pc.boundIndexs(cpxIdxs),       :) = pc.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pc.counts(pc.boundIndexs(cpxIdxs), :), 1 / (2.^(i - 1)));
<a name="l01197"></a>01197                         pc.counts(pc.misfoldedIndexs(cpxIdxs),   :) = pc.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pc.counts(pc.misfoldedIndexs(cpxIdxs), :), 1 / (2.^(i - 1)));
<a name="l01198"></a>01198                         pc.counts(pc.damagedIndexs(cpxIdxs),     :) = pc.randStream.random(<span class="stringliteral">&#39;binomial&#39;</span>, pc.counts(pc.damagedIndexs(cpxIdxs), :), 1 / (2.^(i - 1)));
<a name="l01199"></a>01199                         
<a name="l01200"></a>01200                         diffMons = ...
<a name="l01201"></a>01201                             + mons(pm.processedIIIndexs,    :) - pm.counts(pm.processedIIIndexs, :) ...
<a name="l01202"></a>01202                             + mons(pm.signalSequenceIndexs, :) - pm.counts(pm.signalSequenceIndexs, :) ...
<a name="l01203"></a>01203                             + mons(pm.foldedIndexs,         :) - pm.counts(pm.foldedIndexs, :) ...
<a name="l01204"></a>01204                             + mons(pm.matureIndexs,         :) - pm.counts(pm.matureIndexs, :) ...
<a name="l01205"></a>01205                             + mons(pm.inactivatedIndexs,    :) - pm.counts(pm.inactivatedIndexs, :) ...
<a name="l01206"></a>01206                             + mons(pm.boundIndexs,          :) - pm.counts(pm.boundIndexs, :) ...
<a name="l01207"></a>01207                             + mons(pm.misfoldedIndexs,      :) - pm.counts(pm.misfoldedIndexs, :) ...
<a name="l01208"></a>01208                             + mons(pm.damagedIndexs,        :) - pm.counts(pm.damagedIndexs, :);
<a name="l01209"></a>01209                         diffCpxs = ...
<a name="l01210"></a>01210                             + cpxs(pc.nascentIndexs,     :) - pc.counts(pc.nascentIndexs, :) ...
<a name="l01211"></a>01211                             + cpxs(pc.matureIndexs,      :) - pc.counts(pc.matureIndexs, :) ...
<a name="l01212"></a>01212                             + cpxs(pc.inactivatedIndexs, :) - pc.counts(pc.inactivatedIndexs, :) ...
<a name="l01213"></a>01213                             + cpxs(pc.boundIndexs,       :) - pc.counts(pc.boundIndexs, :) ...
<a name="l01214"></a>01214                             + cpxs(pc.misfoldedIndexs,   :) - pc.counts(pc.misfoldedIndexs, :) ...
<a name="l01215"></a>01215                             + cpxs(pc.damagedIndexs,     :) - pc.counts(pc.damagedIndexs, :);
<a name="l01216"></a>01216                         pm.counts(pm.processedIIndexs, :) = ...
<a name="l01217"></a>01217                             + pm.counts(pm.processedIIndexs, :) ...
<a name="l01218"></a>01218                             + diffMons;
<a name="l01219"></a>01219                         pm.counts(pm.processedIIndexs(monIdxs), :) = ...
<a name="l01220"></a>01220                             + pm.counts(pm.processedIIndexs(monIdxs), :) ...
<a name="l01221"></a>01221                             + pcComp(monIdxs, :) * diffCpxs;
<a name="l01222"></a>01222                         pm.counts(pm.matureIndexs(unprocessedMonIdxs), :) = ...
<a name="l01223"></a>01223                             + pm.counts(pm.matureIndexs(unprocessedMonIdxs), :) ...
<a name="l01224"></a>01224                             + pcComp(unprocessedMonIdxs, :) * diffCpxs;
<a name="l01225"></a>01225                         
<a name="l01226"></a>01226                         pmCnts = sum(pm.counts, 2);
<a name="l01227"></a>01227                         pcCnts = sum(pc.counts, 2);
<a name="l01228"></a>01228                         totMons = ...
<a name="l01229"></a>01229                             + pmCnts(pm.matureIndexs) ...
<a name="l01230"></a>01230                             + pmCnts(pm.boundIndexs) ...
<a name="l01231"></a>01231                             + sum(pc.proteinComplexComposition(g.mRNAIndexs, :, :), 3) * (...
<a name="l01232"></a>01232                                 + pcCnts(pc.matureIndexs) ...
<a name="l01233"></a>01233                                 + pcCnts(pc.boundIndexs));
<a name="l01234"></a>01234                         tmpCleavedMonWt(j) = (totMons .* ppI.nascentMonomerNTerminalMethionineCleavages)<span class="stringliteral">&#39; * pm.molecularWeights(pm.matureIndexs) / ConstantUtil.nAvogadro * 1e15;</span>
<a name="l01235"></a>01235 <span class="stringliteral">                        </span>
<a name="l01236"></a>01236 <span class="stringliteral">                        processes = sim.processes;</span>
<a name="l01237"></a>01237 <span class="stringliteral">                        sim.setForTest(&#39;</span>processes<span class="stringliteral">&#39;, {met});</span>
<a name="l01238"></a>01238 <span class="stringliteral">                        sim.evolveState();</span>
<a name="l01239"></a>01239 <span class="stringliteral">                        sim.setForTest(&#39;</span>processes<span class="stringliteral">&#39;, processes);</span>
<a name="l01240"></a>01240 <span class="stringliteral">                        </span>
<a name="l01241"></a>01241 <span class="stringliteral">                        tmpGrowths(j) = mr.growth;</span>
<a name="l01242"></a>01242 <span class="stringliteral">                    end</span>
<a name="l01243"></a>01243 <span class="stringliteral">                    </span>
<a name="l01244"></a>01244 <span class="stringliteral">                    cleavedMonWt(i, 1) = mean(tmpCleavedMonWt);</span>
<a name="l01245"></a>01245 <span class="stringliteral">                    cleavedMonWt(i, 2:3) = quantile(tmpCleavedMonWt, [0.341 0.682]) - mean(tmpCleavedMonWt);</span>
<a name="l01246"></a>01246 <span class="stringliteral">                    </span>
<a name="l01247"></a>01247 <span class="stringliteral">                    growths(i, 1) = mean(tmpGrowths);</span>
<a name="l01248"></a>01248 <span class="stringliteral">                    growths(i, 2:3) = quantile(tmpGrowths, [0.341 0.682]) - mean(tmpGrowths);</span>
<a name="l01249"></a>01249 <span class="stringliteral">                end</span>
<a name="l01250"></a>01250 <span class="stringliteral">                </span>
<a name="l01251"></a>01251 <span class="stringliteral">                save([baseDir filesep &#39;</span>MG_172-analysis2.mat<span class="stringliteral">&#39;], &#39;</span>growths<span class="stringliteral">&#39;, &#39;</span>cleavedMonWt<span class="stringliteral">&#39;);</span>
<a name="l01252"></a>01252 <span class="stringliteral">            end</span>
<a name="l01253"></a>01253 <span class="stringliteral">            </span>
<a name="l01254"></a>01254 <span class="stringliteral">            growths = growths * 3600 * sim.state(&#39;</span>Mass<span class="stringliteral">&#39;).cellInitialDryWeight / (1 - sim.state(&#39;</span>Mass<span class="stringliteral">&#39;).fractionWetWeight) * 1e15;</span>
<a name="l01255"></a>01255 <span class="stringliteral">            </span>
<a name="l01256"></a>01256 <span class="stringliteral">            PlotUtil.labelSubFigure(&#39;</span>b<span class="stringliteral">&#39;, [0.76 1.015 -0.0286 -0.0690], figHandle, fontSizeSubfigLabel);</span>
<a name="l01257"></a>01257 <span class="stringliteral">            </span>
<a name="l01258"></a>01258 <span class="stringliteral">            axesHandle = subplot(&#39;</span>Position<span class="stringliteral">&#39;, [0.75 0.62 0.25 0.38]);</span>
<a name="l01259"></a>01259 <span class="stringliteral">            hold(axesHandle, &#39;</span>on<span class="stringliteral">&#39;);</span>
<a name="l01260"></a>01260 <span class="stringliteral">            errorbar((0:nGenerations-1)&#39;</span>, growths(ones(nGenerations, 1), 1), growths(ones(nGenerations, 1), 2), growths(ones(nGenerations, 1), 3), <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01261"></a>01261             errorbar((0:nGenerations-1)<span class="stringliteral">&#39;, growths(:, 1), growths(:, 2), growths(:, 3), &#39;</span>Color<span class="stringliteral">&#39;, [0 0 255] / 255);</span>
<a name="l01262"></a>01262 <span class="stringliteral">            xlabel(axesHandle, &#39;</span>Generation<span class="stringliteral">&#39;, &#39;</span>FontSize<span class="stringliteral">&#39;, fontSizeLarge);</span>
<a name="l01263"></a>01263 <span class="stringliteral">            ylabel(axesHandle, &#39;</span>Growth (fg h^{-1})&#39;, &#39;FontSize&#39;, fontSizeLarge);
<a name="l01264"></a>01264             xlim(axesHandle, [-0.25 8.25])
<a name="l01265"></a>01265             ylim(axesHandle, [-0.05 max(growths(:, 1) + growths(:, 3))])
<a name="l01266"></a>01266             set(axesHandle, &#39;XTick&#39;, [0 5])
<a name="l01267"></a>01267             set(axesHandle, &#39;YTick&#39;, 0:0.25:1)
<a name="l01268"></a>01268             set(axesHandle, &#39;FontSize&#39;, fontSizeMed)
<a name="l01269"></a>01269             text(8.25, 0.92, &#39;WT&#39;, ...
<a name="l01270"></a>01270                 &#39;Margin&#39;, 1e-6, ...
<a name="l01271"></a>01271                 &#39;FontSize&#39;, fontSizeLarge, ...
<a name="l01272"></a>01272                 &#39;Color&#39;, &#39;k&#39;, ...
<a name="l01273"></a>01273                 &#39;Parent&#39;, axesHandle, ...
<a name="l01274"></a>01274                 &#39;HorizontalAlignment&#39;, &#39;right&#39;, ...
<a name="l01275"></a>01275                 &#39;VerticalAlignment&#39;, &#39;Top&#39;)
<a name="l01276"></a>01276             text(8.25, 0, &#39;{\Delta}map<span class="stringliteral">&#39;, ...</span>
<a name="l01277"></a>01277 <span class="stringliteral">                &#39;</span>Margin<span class="stringliteral">&#39;, 1e-6, ...</span>
<a name="l01278"></a>01278 <span class="stringliteral">                &#39;</span>FontSize<span class="stringliteral">&#39;, fontSizeLarge, ...</span>
<a name="l01279"></a>01279 <span class="stringliteral">                &#39;</span>Color<span class="stringliteral">&#39;, [0 0 255] / 255, ...</span>
<a name="l01280"></a>01280 <span class="stringliteral">                &#39;</span>Parent<span class="stringliteral">&#39;, axesHandle, ...</span>
<a name="l01281"></a>01281 <span class="stringliteral">                &#39;</span>HorizontalAlignment<span class="stringliteral">&#39;, &#39;</span>right<span class="stringliteral">&#39;, ...</span>
<a name="l01282"></a>01282 <span class="stringliteral">                &#39;</span>VerticalAlignment<span class="stringliteral">&#39;, &#39;</span>Bottom<span class="stringliteral">&#39;);</span>
<a name="l01283"></a>01283 <span class="stringliteral">            set(axesHandle, &#39;</span>FontSize<span class="stringliteral">&#39;, fontSizeMed, &#39;</span>TickLen<span class="stringliteral">&#39;, [0.01 0.01], &#39;</span>TickDir<span class="stringliteral">&#39;, &#39;</span>out<span class="stringliteral">&#39;);</span>
<a name="l01284"></a>01284 <span class="stringliteral">            tick2text(axesHandle, &#39;</span>axis<span class="stringliteral">&#39;, &#39;</span>xy<span class="stringliteral">&#39;, &#39;</span>xtickoffset<span class="stringliteral">&#39;, 0.07, &#39;</span>ytickoffset<span class="stringliteral">&#39;, 0.02);</span>
<a name="l01285"></a>01285 <span class="stringliteral">            xTicks = getappdata(axesHandle, &#39;</span>XTickText<span class="stringliteral">&#39;);</span>
<a name="l01286"></a>01286 <span class="stringliteral">            yTicks = getappdata(axesHandle, &#39;</span>YTickText<span class="stringliteral">&#39;);</span>
<a name="l01287"></a>01287 <span class="stringliteral">            set(xTicks, ...</span>
<a name="l01288"></a>01288 <span class="stringliteral">                &#39;</span>FontSize<span class="stringliteral">&#39;, fontSizeMed, ...</span>
<a name="l01289"></a>01289 <span class="stringliteral">                &#39;</span>HorizontalAlignment<span class="stringliteral">&#39;, &#39;</span>Center<span class="stringliteral">&#39;, ...</span>
<a name="l01290"></a>01290 <span class="stringliteral">                &#39;</span>VerticalAlignment<span class="stringliteral">&#39;, &#39;</span>Middle<span class="stringliteral">&#39;);</span>
<a name="l01291"></a>01291 <span class="stringliteral">            set(yTicks, ...</span>
<a name="l01292"></a>01292 <span class="stringliteral">                &#39;</span>FontSize<span class="stringliteral">&#39;, fontSizeMed, ...</span>
<a name="l01293"></a>01293 <span class="stringliteral">                &#39;</span>HorizontalAlignment<span class="stringliteral">&#39;, &#39;</span>right<span class="stringliteral">&#39;, ...</span>
<a name="l01294"></a>01294 <span class="stringliteral">                &#39;</span>VerticalAlignment<span class="stringliteral">&#39;, &#39;</span>Middle<span class="stringliteral">&#39;);</span>
<a name="l01295"></a>01295 <span class="stringliteral">            delete(yTicks(2:end-1));</span>
<a name="l01296"></a>01296 <span class="stringliteral">            </span>
<a name="l01297"></a>01297 <span class="stringliteral">            xLabelPos = get(get(axesHandle, &#39;</span>xlabel<span class="stringliteral">&#39;), &#39;</span>Position<span class="stringliteral">&#39;);</span>
<a name="l01298"></a>01298 <span class="stringliteral">            set(get(axesHandle, &#39;</span>xlabel<span class="stringliteral">&#39;), &#39;</span>Position<span class="stringliteral">&#39;, [xLabelPos(1) -0.18 xLabelPos(3)]);</span>
<a name="l01299"></a>01299 <span class="stringliteral">            </span>
<a name="l01300"></a>01300 <span class="stringliteral">            yLabelPos = get(get(axesHandle, &#39;</span>ylabel<span class="stringliteral">&#39;), &#39;</span>Position<span class="stringliteral">&#39;);</span>
<a name="l01301"></a>01301 <span class="stringliteral">            set(get(axesHandle, &#39;</span>ylabel<span class="stringliteral">&#39;), &#39;</span>Position<span class="stringliteral">&#39;, [-0.6 yLabelPos(2:end)]);</span>
<a name="l01302"></a>01302 <span class="stringliteral">            </span>
<a name="l01303"></a>01303 <span class="stringliteral">            %% part C -- methionine aminopeptidase, type I (MG_172)</span>
<a name="l01304"></a>01304 <span class="stringliteral">            PlotUtil.labelSubFigure(&#39;</span>c<span class="stringliteral">&#39;, [0.76 0.475 -0.0286 -0.0690], figHandle, fontSizeSubfigLabel);</span>
<a name="l01305"></a>01305 <span class="stringliteral">            </span>
<a name="l01306"></a>01306 <span class="stringliteral">            axesHandle = subplot(&#39;</span>Position<span class="stringliteral">&#39;, [0.75 0.08 0.25 0.38]);</span>
<a name="l01307"></a>01307 <span class="stringliteral">            hold(axesHandle, &#39;</span>on<span class="stringliteral">&#39;);</span>
<a name="l01308"></a>01308 <span class="stringliteral">            errorbar((0:nGenerations-1)&#39;</span>, cleavedMonWt(ones(nGenerations, 1), 1), cleavedMonWt(ones(nGenerations, 1), 2), cleavedMonWt(ones(nGenerations, 1), 3), <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l01309"></a>01309             errorbar((0:nGenerations-1)<span class="stringliteral">&#39;, cleavedMonWt(:, 1), cleavedMonWt(:, 2), cleavedMonWt(:, 3), &#39;</span>Color<span class="stringliteral">&#39;, [0 0 255] / 255);</span>
<a name="l01310"></a>01310 <span class="stringliteral">            xlabel(axesHandle, &#39;</span>Generation<span class="stringliteral">&#39;, &#39;</span>FontSize<span class="stringliteral">&#39;, fontSizeLarge);</span>
<a name="l01311"></a>01311 <span class="stringliteral">            ylabel(axesHandle, {&#39;</span>N-terminal cleaved<span class="charliteral">&#39; &#39;</span>protein (fg)<span class="stringliteral">&#39;}, &#39;</span>FontSize<span class="stringliteral">&#39;, fontSizeLarge);</span>
<a name="l01312"></a>01312 <span class="stringliteral">            xlim(axesHandle, [-0.25 8.25])</span>
<a name="l01313"></a>01313 <span class="stringliteral">            ylim(axesHandle, [-0.01 max(cleavedMonWt(:, 1) + cleavedMonWt(:, 3))])</span>
<a name="l01314"></a>01314 <span class="stringliteral">            set(axesHandle, &#39;</span>XTick<span class="stringliteral">&#39;, [0 5])</span>
<a name="l01315"></a>01315 <span class="stringliteral">            set(axesHandle, &#39;</span>YTick<span class="stringliteral">&#39;, 0:0.1:0.3)</span>
<a name="l01316"></a>01316 <span class="stringliteral">            set(axesHandle, &#39;</span>FontSize<span class="stringliteral">&#39;, fontSizeMed)</span>
<a name="l01317"></a>01317 <span class="stringliteral">            text(8.25, 0.315, &#39;</span>WT<span class="stringliteral">&#39;, ...</span>
<a name="l01318"></a>01318 <span class="stringliteral">                &#39;</span>Margin<span class="stringliteral">&#39;, 1e-6, ...</span>
<a name="l01319"></a>01319 <span class="stringliteral">                &#39;</span>FontSize<span class="stringliteral">&#39;, fontSizeLarge, ...</span>
<a name="l01320"></a>01320 <span class="stringliteral">                &#39;</span>Color<span class="stringliteral">&#39;, &#39;</span>k<span class="stringliteral">&#39;, ...</span>
<a name="l01321"></a>01321 <span class="stringliteral">                &#39;</span>Parent<span class="stringliteral">&#39;, axesHandle, ...</span>
<a name="l01322"></a>01322 <span class="stringliteral">                &#39;</span>HorizontalAlignment<span class="stringliteral">&#39;, &#39;</span>right<span class="stringliteral">&#39;, ...</span>
<a name="l01323"></a>01323 <span class="stringliteral">                &#39;</span>VerticalAlignment<span class="stringliteral">&#39;, &#39;</span>Top<span class="stringliteral">&#39;)</span>
<a name="l01324"></a>01324 <span class="stringliteral">            text(8.25, 0, &#39;</span>{\Delta}map<span class="stringliteral">&#39;, ...</span>
<a name="l01325"></a>01325 <span class="stringliteral">                &#39;</span>Margin<span class="stringliteral">&#39;, 1e-6, ...</span>
<a name="l01326"></a>01326 <span class="stringliteral">                &#39;</span>FontSize<span class="stringliteral">&#39;, fontSizeLarge, ...</span>
<a name="l01327"></a>01327 <span class="stringliteral">                &#39;</span>Color<span class="stringliteral">&#39;, [0 0 255] / 255, ...</span>
<a name="l01328"></a>01328 <span class="stringliteral">                &#39;</span>Parent<span class="stringliteral">&#39;, axesHandle, ...</span>
<a name="l01329"></a>01329 <span class="stringliteral">                &#39;</span>HorizontalAlignment<span class="stringliteral">&#39;, &#39;</span>right<span class="stringliteral">&#39;, ...</span>
<a name="l01330"></a>01330 <span class="stringliteral">                &#39;</span>VerticalAlignment<span class="stringliteral">&#39;, &#39;</span>Bottom<span class="stringliteral">&#39;);</span>
<a name="l01331"></a>01331 <span class="stringliteral">            set(axesHandle, &#39;</span>FontSize<span class="stringliteral">&#39;, fontSizeMed, &#39;</span>TickLen<span class="stringliteral">&#39;, [0.01 0.01], &#39;</span>TickDir<span class="stringliteral">&#39;, &#39;</span>out<span class="stringliteral">&#39;);</span>
<a name="l01332"></a>01332 <span class="stringliteral">            tick2text(axesHandle, &#39;</span>axis<span class="stringliteral">&#39;, &#39;</span>xy<span class="stringliteral">&#39;, &#39;</span>xtickoffset<span class="stringliteral">&#39;, 0.07, &#39;</span>ytickoffset<span class="stringliteral">&#39;, 0.02);</span>
<a name="l01333"></a>01333 <span class="stringliteral">            xTicks = getappdata(axesHandle, &#39;</span>XTickText<span class="stringliteral">&#39;);</span>
<a name="l01334"></a>01334 <span class="stringliteral">            yTicks = getappdata(axesHandle, &#39;</span>YTickText<span class="stringliteral">&#39;);</span>
<a name="l01335"></a>01335 <span class="stringliteral">            set(xTicks, ...</span>
<a name="l01336"></a>01336 <span class="stringliteral">                &#39;</span>FontSize<span class="stringliteral">&#39;, fontSizeMed, ...</span>
<a name="l01337"></a>01337 <span class="stringliteral">                &#39;</span>HorizontalAlignment<span class="stringliteral">&#39;, &#39;</span>Center<span class="stringliteral">&#39;, ...</span>
<a name="l01338"></a>01338 <span class="stringliteral">                &#39;</span>VerticalAlignment<span class="stringliteral">&#39;, &#39;</span>Middle<span class="stringliteral">&#39;);</span>
<a name="l01339"></a>01339 <span class="stringliteral">            set(yTicks, ...</span>
<a name="l01340"></a>01340 <span class="stringliteral">                &#39;</span>FontSize<span class="stringliteral">&#39;, fontSizeMed, ...</span>
<a name="l01341"></a>01341 <span class="stringliteral">                &#39;</span>HorizontalAlignment<span class="stringliteral">&#39;, &#39;</span>right<span class="stringliteral">&#39;, ...</span>
<a name="l01342"></a>01342 <span class="stringliteral">                &#39;</span>VerticalAlignment<span class="stringliteral">&#39;, &#39;</span>Middle<span class="stringliteral">&#39;);</span>
<a name="l01343"></a>01343 <span class="stringliteral">            delete(yTicks(2:end-1));</span>
<a name="l01344"></a>01344 <span class="stringliteral">            </span>
<a name="l01345"></a>01345 <span class="stringliteral">            xLabelPos = get(get(axesHandle, &#39;</span>xlabel<span class="stringliteral">&#39;), &#39;</span>Position<span class="stringliteral">&#39;);</span>
<a name="l01346"></a>01346 <span class="stringliteral">            set(get(axesHandle, &#39;</span>xlabel<span class="stringliteral">&#39;), &#39;</span>Position<span class="stringliteral">&#39;, [xLabelPos(1) -0.055 xLabelPos(3)]);</span>
<a name="l01347"></a>01347 <span class="stringliteral">            </span>
<a name="l01348"></a>01348 <span class="stringliteral">            yLabelPos = get(get(axesHandle, &#39;</span>ylabel<span class="stringliteral">&#39;), &#39;</span>Position<span class="stringliteral">&#39;);</span>
<a name="l01349"></a>01349 <span class="stringliteral">            set(get(axesHandle, &#39;</span>ylabel<span class="stringliteral">&#39;), &#39;</span>Position<span class="stringliteral">&#39;, [-0.6 yLabelPos(2:end)]);</span>
<a name="l01350"></a>01350 <span class="stringliteral">            </span>
<a name="l01351"></a>01351 <span class="stringliteral">            %% standarize tick lengths</span>
<a name="l01352"></a>01352 <span class="stringliteral">            paperSize = get(figHandle, &#39;</span>PaperSize<span class="stringliteral">&#39;);</span>
<a name="l01353"></a>01353 <span class="stringliteral">            figW = paperSize(1);</span>
<a name="l01354"></a>01354 <span class="stringliteral">            figH = paperSize(2);</span>
<a name="l01355"></a>01355 <span class="stringliteral">            axesHandles = findobj(figHandle, &#39;</span>type<span class="stringliteral">&#39;, &#39;</span>axes<span class="stringliteral">&#39;, &#39;</span>-and&#39;, &#39;tag&#39;, &#39;&#39;);
<a name="l01356"></a>01356             axesPos = cell2mat(<span class="keyword">get</span>(axesHandles, <span class="stringliteral">&#39;position&#39;</span>));
<a name="l01357"></a>01357             tickLen = 0.0075 * max(max(axesPos(:, 3:4), [], 1) .* [figW figH]);
<a name="l01358"></a>01358             <span class="keywordflow">for</span> i = 1:numel(axesHandles)
<a name="l01359"></a>01359                 maxVal = max(axesPos(i, 3:4) .* [figW figH]);
<a name="l01360"></a>01360                 set(axesHandles(i), &#39;TickLen&#39;, [tickLen / maxVal  0.0250]);
<a name="l01361"></a>01361             end
<a name="l01362"></a>01362             
<a name="l01363"></a>01363             %% save figure
<a name="l01364"></a>01364             print(figHandle, outFileName_Figure, &#39;-dpdf&#39;, &#39;-cmyk&#39;);
<a name="l01365"></a>01365             close(figHandle);
<a name="l01366"></a>01366             
<a name="l01367"></a>01367             %% save
<a name="l01368"></a>01368             catIdxs = cell2mat(catLabels(:, 2));
<a name="l01369"></a>01369             
<a name="l01370"></a>01370             colLabels = {<span class="stringliteral">&#39;Class&#39;</span> <span class="stringliteral">&#39;Name&#39;</span> <span class="stringliteral">&#39;No Genes&#39;</span> <span class="stringliteral">&#39;No Simulations&#39;</span> <span class="stringliteral">&#39;Representative Gene&#39;</span> <span class="stringliteral">&#39;Representative Simulation Batch&#39;</span> <span class="stringliteral">&#39;Representative Simulation Index&#39;</span>};
<a name="l01371"></a>01371             content = [
<a name="l01372"></a>01372                 catLabels(:, 1) ...
<a name="l01373"></a>01373                 SingleGeneDeletions.DELETION_STRAIN_CLASSES(catIdxs, 1) ...
<a name="l01374"></a>01374                 {gridMetaData.nGenes}&#39; ...
<a name="l01375"></a>01375                 {gridMetaData.nSimulations}&#39; ...
<a name="l01376"></a>01376                 {gridMetaData.gene}&#39; ...
<a name="l01377"></a>01377                 {gridMetaData.simGroup}&#39; ...
<a name="l01378"></a>01378                 {gridMetaData.simIdx}&#39; ...
<a name="l01379"></a>01379                 ];
<a name="l01380"></a>01380             <span class="keywordflow">if</span> ispc &amp;&amp; exist(outFileName_Table, <span class="stringliteral">&#39;file&#39;</span>)
<a name="l01381"></a>01381                 delete(outFileName_Table)
<a name="l01382"></a>01382             end
<a name="l01383"></a>01383             PrintUtil.printToFile(content, colLabels, outFileName_Table, &#39;Single <a class="code" href="class_gene.html">Gene</a> Deletions&#39;);
<a name="l01384"></a>01384         end
<a name="l01385"></a>01385         
<a name="l01386"></a>01386         function [gridData, gridMetaData] = calcOverviewData(iJob, nJobs)
<a name="l01387"></a>01387             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l01388"></a>01388             import edu.stanford.covert.cell.sim.util.CachedSimulationObjectUtil;
<a name="l01389"></a>01389             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l01390"></a>01390             
<a name="l01391"></a>01391             if nargin &lt; 2
<a name="l01392"></a>01392                 iJob = 1;
<a name="l01393"></a>01393                 nJobs = 1;
<a name="l01394"></a>01394             end
<a name="l01395"></a>01395             
<a name="l01396"></a>01396             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l01397"></a>01397             load([baseDir &#39;geneClasses.mat&#39;]);
<a name="l01398"></a>01398             
<a name="l01399"></a>01399             sim = CachedSimulationObjectUtil.load();
<a name="l01400"></a>01400             g = sim.gene;
<a name="l01401"></a>01401             
<a name="l01402"></a>01402             isGeneImplemented = SingleGeneDeletions.getGeneImplementations(sim);
<a name="l01403"></a>01403             
<a name="l01404"></a>01404             nCats = size(SingleGeneDeletions.DELETION_STRAIN_CLASSES, 1) - 1;
<a name="l01405"></a>01405             nProps = 8;
<a name="l01406"></a>01406             nTime = 50001;
<a name="l01407"></a>01407             catLabels = {
<a name="l01408"></a>01408                 <span class="stringliteral">&#39;WT&#39;</span>             SingleGeneDeletions.WILD_TYPE                        <span class="stringliteral">&#39;growth&#39;</span>
<a name="l01409"></a>01409                 <span class="stringliteral">&#39;Energy&#39;</span>         SingleGeneDeletions.DECOMPOSING                      <span class="stringliteral">&#39;ntps&#39;</span>
<a name="l01410"></a>01410                 <span class="stringliteral">&#39;Metabolic&#39;</span>      SingleGeneDeletions.NON_GROWING                      <span class="stringliteral">&#39;growth&#39;</span>
<a name="l01411"></a>01411                 <span class="stringliteral">&#39;RNA&#39;</span>            SingleGeneDeletions.DECAYING_GROWTH_NON_RNA_PROTEIN  <span class="stringliteral">&#39;rnaWt&#39;</span>
<a name="l01412"></a>01412                 <span class="stringliteral">&#39;Protein&#39;</span>        SingleGeneDeletions.DECAYING_GROWTH_NON_PROTEIN      <span class="stringliteral">&#39;proteinWt&#39;</span>
<a name="l01413"></a>01413                 <span class="stringliteral">&#39;Other&#39;</span>          SingleGeneDeletions.NON_PERPETUATING                 <span class="stringliteral">&#39;proteinWt&#39;</span>
<a name="l01414"></a>01414                 <span class="stringliteral">&#39;DNA&#39;</span>            SingleGeneDeletions.NON_REPLICATIVE                  <span class="stringliteral">&#39;dnaWt&#39;</span>
<a name="l01415"></a>01415                 <span class="stringliteral">&#39;Cytokinesis&#39;</span>    SingleGeneDeletions.NON_FISSIVE                      <span class="stringliteral">&#39;growth&#39;</span>
<a name="l01416"></a>01416                 <span class="stringliteral">&#39;Term Org&#39;</span>       SingleGeneDeletions.NO_TERMINAL_ORGANELLE            <span class="stringliteral">&#39;terminalOrganelleWt&#39;</span>
<a name="l01417"></a>01417                 <span class="stringliteral">&#39;Damaged&#39;</span>        SingleGeneDeletions.TOXIN_ACCUMULATION               <span class="stringliteral">&#39;damagedProteins&#39;</span>
<a name="l01418"></a>01418                 <span class="stringliteral">&#39;Slow&#39;</span>           SingleGeneDeletions.SLOW_GROWING                     <span class="stringliteral">&#39;rnaWt&#39;</span>
<a name="l01419"></a>01419                 <span class="stringliteral">&#39;Non-Ess&#39;</span>        SingleGeneDeletions.NON_ESSENTIAL                    <span class="stringliteral">&#39;growth&#39;</span>
<a name="l01420"></a>01420                 };
<a name="l01421"></a>01421             propLabels = {
<a name="l01422"></a>01422                 {<span class="stringliteral">&#39;NTP&#39;</span>}                 <span class="stringliteral">&#39;ntps&#39;</span>
<a name="l01423"></a>01423                 {<span class="stringliteral">&#39;Growth (fg h^{-1})&#39;</span>}  <span class="stringliteral">&#39;growth&#39;</span>
<a name="l01424"></a>01424                 {<span class="stringliteral">&#39;Protein (fg)&#39;</span>}        <span class="stringliteral">&#39;proteinWt&#39;</span>
<a name="l01425"></a>01425                 {<span class="stringliteral">&#39;RNA (fg)&#39;</span>}            <span class="stringliteral">&#39;rnaWt&#39;</span>
<a name="l01426"></a>01426                 {<span class="stringliteral">&#39;DNA (fg)&#39;</span>}            <span class="stringliteral">&#39;dnaWt&#39;</span>
<a name="l01427"></a>01427                 {<span class="stringliteral">&#39;Septum (nm)&#39;</span>}         <span class="stringliteral">&#39;pinchedDiameter&#39;</span>
<a name="l01428"></a>01428                 {<span class="stringliteral">&#39;Term Org (fg)&#39;</span>}       <span class="stringliteral">&#39;terminalOrganelleWt&#39;</span>
<a name="l01429"></a>01429                 {<span class="stringliteral">&#39;Damaged&#39;</span> <span class="stringliteral">&#39;Prot&#39;</span>}      <span class="stringliteral">&#39;damagedProteins&#39;</span>
<a name="l01430"></a>01430                 };
<a name="l01431"></a>01431             
<a name="l01432"></a>01432             gridData = NaN(nProps, nCats, nTime);
<a name="l01433"></a>01433             gridMetaData = repmat(<span class="keyword">struct</span>(<span class="stringliteral">&#39;nSimulations&#39;</span>, [], <span class="stringliteral">&#39;nGenes&#39;</span>, [], <span class="stringliteral">&#39;gene&#39;</span>, [], <span class="stringliteral">&#39;simGroup&#39;</span>, [], <span class="stringliteral">&#39;simIdx&#39;</span>, []), nCats, 1);
<a name="l01434"></a>01434             <span class="keywordflow">for</span> i = iJob:nJobs:nCats
<a name="l01435"></a>01435                 <span class="keywordflow">if</span> exist([baseDir <span class="stringliteral">&#39;overview-&#39;</span> catLabels{i, 1} <span class="stringliteral">&#39;.mat&#39;</span>], <span class="stringliteral">&#39;file&#39;</span>)
<a name="l01436"></a>01436                     load([baseDir <span class="stringliteral">&#39;overview-&#39;</span> catLabels{i, 1} <span class="stringliteral">&#39;.mat&#39;</span>]);
<a name="l01437"></a>01437                 <span class="keywordflow">else</span>
<a name="l01438"></a>01438                     %<span class="keyword">get</span> data <span class="keywordflow">for</span> all simulations in category
<a name="l01439"></a>01439                     <span class="keywordflow">if</span> catLabels{i, 2} == SingleGeneDeletions.WILD_TYPE
<a name="l01440"></a>01440                         tmp2 = load([baseDir <span class="stringliteral">&#39;WT.mat&#39;</span>], <span class="stringliteral">&#39;metaData&#39;</span>, <span class="stringliteral">&#39;simEndTimes&#39;</span>, <span class="stringliteral">&#39;ntps&#39;</span>, <span class="stringliteral">&#39;growth&#39;</span>, <span class="stringliteral">&#39;rnaWt&#39;</span>, <span class="stringliteral">&#39;proteinWt&#39;</span>, <span class="stringliteral">&#39;dnaWt&#39;</span>, <span class="stringliteral">&#39;pinchedDiameter&#39;</span>, <span class="stringliteral">&#39;terminalOrganelleWt&#39;</span>, <span class="stringliteral">&#39;damagedProteins&#39;</span>);
<a name="l01441"></a>01441                         tmp = tmp2.growth(sub2ind(size(tmp2.growth), tmp2.simEndTimes, (1:numel(tmp2.simEndTimes))<span class="stringliteral">&#39;));</span>
<a name="l01442"></a>01442 <span class="stringliteral">                        for k = 1:nProps</span>
<a name="l01443"></a>01443 <span class="stringliteral">                            for l = 1:numel(tmp2.simEndTimes)</span>
<a name="l01444"></a>01444 <span class="stringliteral">                                if isnan(tmp(l)) || ~isfield(tmp2, propLabels{k, 2}) || any(isnan(tmp2.(propLabels{k, 2})(2:tmp2.simEndTimes(l), l)))</span>
<a name="l01445"></a>01445 <span class="stringliteral">                                    tmp(l) = NaN;</span>
<a name="l01446"></a>01446 <span class="stringliteral">                                end</span>
<a name="l01447"></a>01447 <span class="stringliteral">                            end</span>
<a name="l01448"></a>01448 <span class="stringliteral">                        end</span>
<a name="l01449"></a>01449 <span class="stringliteral">                        [~, idx] = min(abs(tmp - nanmedian(tmp)));</span>
<a name="l01450"></a>01450 <span class="stringliteral">                        </span>
<a name="l01451"></a>01451 <span class="stringliteral">                        tmpMetaData = struct(...</span>
<a name="l01452"></a>01452 <span class="stringliteral">                            &#39;</span>nSimulations<span class="stringliteral">&#39;, numel(tmp), ...</span>
<a name="l01453"></a>01453 <span class="stringliteral">                            &#39;</span>nGenes<span class="stringliteral">&#39;, [], ...</span>
<a name="l01454"></a>01454 <span class="stringliteral">                            &#39;</span>gene<span class="stringliteral">&#39;, [], ...</span>
<a name="l01455"></a>01455 <span class="stringliteral">                            &#39;</span>simGroup<span class="stringliteral">&#39;, tmp2.metaData(idx).simGroup, ...</span>
<a name="l01456"></a>01456 <span class="stringliteral">                            &#39;</span>simIdx<span class="stringliteral">&#39;, tmp2.metaData(idx).simIdx);</span>
<a name="l01457"></a>01457 <span class="stringliteral">                    else</span>
<a name="l01458"></a>01458 <span class="stringliteral">                        geneIdxs = find(geneClasses == catLabels{i, 2} &amp; isGeneImplemented);</span>
<a name="l01459"></a>01459 <span class="stringliteral">                        </span>
<a name="l01460"></a>01460 <span class="stringliteral">                        tmp = zeros(0, 1);</span>
<a name="l01461"></a>01461 <span class="stringliteral">                        genes = zeros(0, 1);</span>
<a name="l01462"></a>01462 <span class="stringliteral">                        simIdxs = zeros(0, 1);</span>
<a name="l01463"></a>01463 <span class="stringliteral">                        for j = 1:numel(geneIdxs)</span>
<a name="l01464"></a>01464 <span class="stringliteral">                            tmp2 = load([baseDir g.wholeCellModelIDs{geneIdxs(j)} &#39;</span>.mat<span class="stringliteral">&#39;], &#39;</span>simEndTimes<span class="stringliteral">&#39;, catLabels{i, 3});</span>
<a name="l01465"></a>01465 <span class="stringliteral">                            if ~isfield(tmp2, catLabels{i, 3})</span>
<a name="l01466"></a>01466 <span class="stringliteral">                                continue;</span>
<a name="l01467"></a>01467 <span class="stringliteral">                            end</span>
<a name="l01468"></a>01468 <span class="stringliteral">                            tmp = [tmp; tmp2.(catLabels{i, 3})(sub2ind(size(tmp2.(catLabels{i, 3})), tmp2.simEndTimes, (1:numel(tmp2.simEndTimes))&#39;</span>))];
<a name="l01469"></a>01469                             genes = [genes; repmat(geneIdxs(j), numel(tmp2.simEndTimes), 1)];
<a name="l01470"></a>01470                             simIdxs = [simIdxs; (1:numel(tmp2.simEndTimes))&#39;];
<a name="l01471"></a>01471                         end
<a name="l01472"></a>01472                         
<a name="l01473"></a>01473                         <span class="keywordflow">while</span> <span class="keyword">true</span>
<a name="l01474"></a>01474                             <span class="keywordflow">switch</span> catLabels{i, 2}
<a name="l01475"></a>01475                                 <span class="keywordflow">case</span> SingleGeneDeletions.NO_TERMINAL_ORGANELLE
<a name="l01476"></a>01476                                     [~, idx] = min(tmp);                                
<a name="l01477"></a>01477                                 otherwise
<a name="l01478"></a>01478                                     [~, idx] = min(abs(tmp - nanmedian(tmp)));
<a name="l01479"></a>01479                             end
<a name="l01480"></a>01480                             tmp2 = load([baseDir g.wholeCellModelIDs{genes(idx)} <span class="stringliteral">&#39;.mat&#39;</span>], <span class="stringliteral">&#39;metaData&#39;</span>, <span class="stringliteral">&#39;simEndTimes&#39;</span>, propLabels{:, 2});
<a name="l01481"></a>01481                             
<a name="l01482"></a>01482                             <span class="keywordflow">if</span> ~all(ismember(propLabels(:, 2), fieldnames(tmp2)))
<a name="l01483"></a>01483                                 tmp(idx) = NaN;
<a name="l01484"></a>01484                             end
<a name="l01485"></a>01485                             for k = 1:nProps
<a name="l01486"></a>01486                                 if ~isfield(tmp2, propLabels{k, 2}) || any(isnan(tmp2.(propLabels{k, 2})(2:tmp2.simEndTimes(simIdxs(idx)), simIdxs(idx))))
<a name="l01487"></a>01487                                     tmp(idx) = NaN;
<a name="l01488"></a>01488                                 end
<a name="l01489"></a>01489                             end
<a name="l01490"></a>01490                             
<a name="l01491"></a>01491                             <span class="keywordflow">if</span> catLabels{i, 2} == SingleGeneDeletions.NON_FISSIVE &amp;&amp; (...
<a name="l01492"></a>01492                                     isnan(range(tmp2.dnaWt(:, simIdxs(idx)))) || ~range(tmp2.dnaWt(:, simIdxs(idx))) || ...
<a name="l01493"></a>01493                                     isnan(tmp2.rnaWt(end-4*3600, simIdxs(idx))) || tmp2.rnaWt(end, simIdxs(idx)) &lt; tmp2.rnaWt(end-4*3600, simIdxs(idx)))
<a name="l01494"></a>01494                                 tmp(idx) = NaN;
<a name="l01495"></a>01495                             end
<a name="l01496"></a>01496                             
<a name="l01497"></a>01497                             <span class="keywordflow">if</span> ~isnan(tmp(idx))
<a name="l01498"></a>01498                                 break;
<a name="l01499"></a>01499                             end
<a name="l01500"></a>01500                         end
<a name="l01501"></a>01501                         
<a name="l01502"></a>01502                         tmpMetaData = struct(...
<a name="l01503"></a>01503                             &#39;nSimulations&#39;, numel(tmp), ...
<a name="l01504"></a>01504                             &#39;nGenes&#39;, numel(geneIdxs), ...
<a name="l01505"></a>01505                             &#39;gene&#39;, g.wholeCellModelIDs{genes(idx)}, ...
<a name="l01506"></a>01506                             <span class="stringliteral">&#39;simGroup&#39;</span>, tmp2.metaData(simIdxs(idx)).simGroup, ...
<a name="l01507"></a>01507                             <span class="stringliteral">&#39;simIdx&#39;</span>, tmp2.metaData(simIdxs(idx)).simIdx);
<a name="l01508"></a>01508                         
<a name="l01509"></a>01509                         idx = simIdxs(idx);
<a name="l01510"></a>01510                     end
<a name="l01511"></a>01511                     
<a name="l01512"></a>01512                     %<span class="keyword">get</span> data <span class="keywordflow">for</span> representative cell
<a name="l01513"></a>01513                     tmpData = <span class="keyword">struct</span>;
<a name="l01514"></a>01514                     <span class="keywordflow">for</span> k = 1:nProps
<a name="l01515"></a>01515                         tmpData.(propLabels{k, 2}) = tmp2.(propLabels{k, 2})(:, idx);
<a name="l01516"></a>01516                     end
<a name="l01517"></a>01517                     
<a name="l01518"></a>01518                     %save
<a name="l01519"></a>01519                     save([baseDir <span class="stringliteral">&#39;overview-&#39;</span> catLabels{i, 1} <span class="stringliteral">&#39;.mat&#39;</span>], <span class="stringliteral">&#39;tmpMetaData&#39;</span>, <span class="stringliteral">&#39;tmpData&#39;</span>);
<a name="l01520"></a>01520                     
<a name="l01521"></a>01521                     %cleanup
<a name="l01522"></a>01522                     clear tmp2;
<a name="l01523"></a>01523                 end
<a name="l01524"></a>01524                 
<a name="l01525"></a>01525                 gridMetaData(i) = tmpMetaData;
<a name="l01526"></a>01526                 <span class="keywordflow">for</span> j = 1:nProps
<a name="l01527"></a>01527                     gridData(j, i, 1:numel(tmpData.(propLabels{j, 2}))) = tmpData.(propLabels{j, 2});
<a name="l01528"></a>01528                 end
<a name="l01529"></a>01529             end
<a name="l01530"></a>01530         end
<a name="l01531"></a>01531     end
<a name="l01532"></a>01532     
<a name="l01533"></a>01533     %metabolic simulations of single gene deletions
<a name="l01534"></a>01534     methods (Static)
<a name="l01535"></a>01535         function [deletionMetabolicOutputs, wtMetabolicOutput] = calculateSingleGeneDeletionMetabolicOutputs(sim)
<a name="l01536"></a>01536             %constants
<a name="l01537"></a>01537             g = sim.gene;
<a name="l01538"></a>01538             comp = sim.compartment;
<a name="l01539"></a>01539             met = sim.process(&#39;Metabolism&#39;);
<a name="l01540"></a>01540             nGenes = size(g.wholeCellModelIDs, 1);
<a name="l01541"></a>01541             ntpIdxs = met.substrateIndexs({<span class="stringliteral">&#39;ATP&#39;</span>; <span class="stringliteral">&#39;GTP&#39;</span>});
<a name="l01542"></a>01542             energyProductionRxnIdxs = met.fbaReactionIndexs_metaboliteInternalExchange(...
<a name="l01543"></a>01543                 ismember(...
<a name="l01544"></a>01544                 met.substrateIndexs_internalExchangedMetabolites, ...
<a name="l01545"></a>01545                 sub2ind(size(met.substrates), ntpIdxs, repmat(comp.cytosolIndexs, size(ntpIdxs))) ...
<a name="l01546"></a>01546                 ) ...
<a name="l01547"></a>01547                 );
<a name="l01548"></a>01548             
<a name="l01549"></a>01549             %setup substrates so that NMPs, NDPs are available to be
<a name="l01550"></a>01550             %recycled and energy can be produced
<a name="l01551"></a>01551             sim.initializeState();
<a name="l01552"></a>01552             
<a name="l01553"></a>01553             %calculate wild-type metabolic output: growth rate and energy
<a name="l01554"></a>01554             %production
<a name="l01555"></a>01555             wtMetabolicOutput = zeros(1, 3);
<a name="l01556"></a>01556             [wtMetabolicOutput(1, 1), ~, fbaReactionFluxs] = met.calcGrowthRate(met.calcFluxBounds(met.substrates, met.enzymes, met.fbaReactionBounds, met.fbaEnzymeBounds));
<a name="l01557"></a>01557             wtMetabolicOutput(1, 2:3) = fbaReactionFluxs(energyProductionRxnIdxs);
<a name="l01558"></a>01558             
<a name="l01559"></a>01559             %calculate single gene deletion metabolic output: growth rate
<a name="l01560"></a>01560             %and energy production
<a name="l01561"></a>01561             deletionMetabolicOutputs = zeros(nGenes,3);
<a name="l01562"></a>01562             deletionMetabolicOutputs(~any(met.enzymeGeneComposition, 2) &amp; ~any(met.substrateGeneComposition, 2), :) = NaN;
<a name="l01563"></a>01563             enzGeneComp = met.enzymeGeneComposition();
<a name="l01564"></a>01564             subGeneComp = met.substrateGeneComposition();
<a name="l01565"></a>01565             <span class="keywordflow">for</span> i = 1:nGenes
<a name="l01566"></a>01566                 enzIdxs = find(enzGeneComp(i, :));
<a name="l01567"></a>01567                 subIdxs = find(subGeneComp(i, :));
<a name="l01568"></a>01568                 <span class="keywordflow">if</span> isempty(enzIdxs) &amp;&amp; isempty(subIdxs)
<a name="l01569"></a>01569                     continue;
<a name="l01570"></a>01570                 end
<a name="l01571"></a>01571                 
<a name="l01572"></a>01572                 enzymes = met.enzymes;
<a name="l01573"></a>01573                 substrates = met.substrates;
<a name="l01574"></a>01574                 enzymes(enzIdxs, :) = 0;
<a name="l01575"></a>01575                 substrates(subIdxs, :) = 0;
<a name="l01576"></a>01576                 [deletionMetabolicOutputs(i, 1), ~, fbaReactionFluxs] = met.calcGrowthRate(met.calcFluxBounds(substrates, enzymes, met.fbaReactionBounds, met.fbaEnzymeBounds));
<a name="l01577"></a>01577                 deletionMetabolicOutputs(i, 2:3) = fbaReactionFluxs(energyProductionRxnIdxs);
<a name="l01578"></a>01578             end
<a name="l01579"></a>01579         end
<a name="l01580"></a>01580     end
<a name="l01581"></a>01581     
<a name="l01582"></a>01582     %summary of all single gene deletion strains and simulations
<a name="l01583"></a>01583     methods (Static)
<a name="l01584"></a>01584         function [content, colLabels] = printSingleGeneDeletionStrains(sim, deletionMetabolicOutputs, wtMetabolicOutput, deletionStats, wtStats, geneClasses)
<a name="l01585"></a>01585             %import classes
<a name="l01586"></a>01586             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l01587"></a>01587             import edu.stanford.covert.cell.sim.Simulation;
<a name="l01588"></a>01588             import edu.stanford.covert.util.<a class="code" href="class_constant_util.html">ConstantUtil</a>;
<a name="l01589"></a>01589             
<a name="l01590"></a>01590             g = sim.gene;
<a name="l01591"></a>01591             rna = sim.state(&#39;Rna&#39;);
<a name="l01592"></a>01592             [~, geneImplementedMolecules, geneImplementedProcesses] = SingleGeneDeletions.getGeneImplementations(sim);
<a name="l01593"></a>01593             geneImplementedMolecules = cellfun(@(molecules) strjoin(&#39;, &#39;, molecules{:}), geneImplementedMolecules, <span class="stringliteral">&#39;UniformOutput&#39;</span>, <span class="keyword">false</span>);
<a name="l01594"></a>01594             geneImplementedProcesses = cellfun(@(processes) strjoin(<span class="stringliteral">&#39;, &#39;</span>, processes{:}), geneImplementedProcesses, <span class="stringliteral">&#39;UniformOutput&#39;</span>, <span class="keyword">false</span>);
<a name="l01595"></a>01595             
<a name="l01596"></a>01596             colLabels = {
<a name="l01597"></a>01597                 <span class="stringliteral">&#39;Gene&#39;</span>
<a name="l01598"></a>01598                 <span class="stringliteral">&#39;Name&#39;</span>
<a name="l01599"></a>01599                 <span class="stringliteral">&#39;Transcription Unit&#39;</span>
<a name="l01600"></a>01600                 <span class="stringliteral">&#39;Transcription Unit Name&#39;</span>
<a name="l01601"></a>01601                 <span class="stringliteral">&#39;Implementation Molecule&#39;</span>
<a name="l01602"></a>01602                 <span class="stringliteral">&#39;Implementation Process&#39;</span>
<a name="l01603"></a>01603                 <span class="stringliteral">&#39;Model Class&#39;</span>
<a name="l01604"></a>01604                 <span class="stringliteral">&#39;Model Essentiality&#39;</span>
<a name="l01605"></a>01605                 <span class="stringliteral">&#39;Mean Model Growth (fg h^-1)&#39;</span>
<a name="l01606"></a>01606                 <span class="stringliteral">&#39;Std Model Growth (fg h^-1)&#39;</span>
<a name="l01607"></a>01607                 <span class="stringliteral">&#39;Mean Model ATP Production (molecules s^-1)&#39;</span>
<a name="l01608"></a>01608                 <span class="stringliteral">&#39;Std Model ATP Production (molecules s^-1)&#39;</span>
<a name="l01609"></a>01609                 <span class="stringliteral">&#39;Mean Model GTP Production (molecules s^-1)&#39;</span>
<a name="l01610"></a>01610                 <span class="stringliteral">&#39;Std Model GTP Production (molecules s^-1)&#39;</span>
<a name="l01611"></a>01611                 <span class="stringliteral">&#39;Mean Model Replication Initiation Duration (h)&#39;</span>
<a name="l01612"></a>01612                 <span class="stringliteral">&#39;Std Model Replication Initiation Duration (h)&#39;</span>
<a name="l01613"></a>01613                 <span class="stringliteral">&#39;Mean Model Replication Duration (h)&#39;</span>
<a name="l01614"></a>01614                 <span class="stringliteral">&#39;Std Model Replication Duration (h)&#39;</span>
<a name="l01615"></a>01615                 <span class="stringliteral">&#39;Mean Model Cytokinesis Duration (h)&#39;</span>
<a name="l01616"></a>01616                 <span class="stringliteral">&#39;Std Model Cytokinesis Duration (h)&#39;</span>
<a name="l01617"></a>01617                 <span class="stringliteral">&#39;Mean Model Cell Cycle Duration (h)&#39;</span>
<a name="l01618"></a>01618                 <span class="stringliteral">&#39;Std Model Cell Cycle Duration (h)&#39;</span>
<a name="l01619"></a>01619                 <span class="stringliteral">&#39;Mean Model Mass Doubling Duration (h)&#39;</span>
<a name="l01620"></a>01620                 <span class="stringliteral">&#39;Std Model Mass Doubling Duration (h)&#39;</span>
<a name="l01621"></a>01621                 <span class="stringliteral">&#39;Mean Cumulative ATP Usage (molecules)&#39;</span>
<a name="l01622"></a>01622                 <span class="stringliteral">&#39;Std Cumulative ATP Usage (molecules)&#39;</span>
<a name="l01623"></a>01623                 <span class="stringliteral">&#39;Mean Cumulative GTP Usage (molecules)&#39;</span>
<a name="l01624"></a>01624                 <span class="stringliteral">&#39;Std Cumulative GTP Usage (molecules)&#39;</span>
<a name="l01625"></a>01625                 <span class="stringliteral">&#39;Mean Cell Weight Fraction DNA (%)&#39;</span>
<a name="l01626"></a>01626                 <span class="stringliteral">&#39;Std Cell Weight Fraction DNA (%)&#39;</span>
<a name="l01627"></a>01627                 <span class="stringliteral">&#39;Mean Cell Weight Fraction RNA (%)&#39;</span>
<a name="l01628"></a>01628                 <span class="stringliteral">&#39;Std Cell Weight Fraction RNA (%)&#39;</span>
<a name="l01629"></a>01629                 <span class="stringliteral">&#39;Mean Cell Weight Fraction Protein (%)&#39;</span>
<a name="l01630"></a>01630                 <span class="stringliteral">&#39;Std Cell Weight Fraction Protein (%)&#39;</span>
<a name="l01631"></a>01631                 <span class="stringliteral">&#39;Mean Superhelicity&#39;</span>
<a name="l01632"></a>01632                 <span class="stringliteral">&#39;Std Superhelicity&#39;</span>
<a name="l01633"></a>01633                 <span class="stringliteral">&#39;Mean Exponential Rate RNA growth (h^-1)&#39;</span>
<a name="l01634"></a>01634                 <span class="stringliteral">&#39;Std Exponential Rate RNA growth (h^-1)&#39;</span>
<a name="l01635"></a>01635                 <span class="stringliteral">&#39;Mean Exponential Rate Protein growth (h^-1)&#39;</span>
<a name="l01636"></a>01636                 <span class="stringliteral">&#39;Std Exponential Rate Protein growth (h^-1)&#39;</span>
<a name="l01637"></a>01637                 <span class="stringliteral">&#39;Mean Exponential Rate Damaged RNA growth (h^-1)&#39;</span>
<a name="l01638"></a>01638                 <span class="stringliteral">&#39;Std Exponential Rate Damaged RNA growth (h^-1)&#39;</span>
<a name="l01639"></a>01639                 <span class="stringliteral">&#39;Mean Exponential Rate Damaged Protein growth (h^-1)&#39;</span>
<a name="l01640"></a>01640                 <span class="stringliteral">&#39;Std Exponential Rate Damaged Protein growth (h^-1)&#39;</span>
<a name="l01641"></a>01641                 <span class="stringliteral">&#39;Mean Antibiotics (molecules)&#39;</span>
<a name="l01642"></a>01642                 <span class="stringliteral">&#39;Std Antibiotics (molecules)&#39;</span>
<a name="l01643"></a>01643                 <span class="stringliteral">&#39;FBA Growth (fg h^-1)&#39;</span>
<a name="l01644"></a>01644                 <span class="stringliteral">&#39;FBA ATP Production (molecules s^-1)&#39;</span>
<a name="l01645"></a>01645                 <span class="stringliteral">&#39;FBA GTP Production (molecules s^-1)&#39;</span>
<a name="l01646"></a>01646                 <span class="stringliteral">&#39;Mean Experimental Mass Doubling Time (h)&#39;</span>
<a name="l01647"></a>01647                 <span class="stringliteral">&#39;Std Experimental Mass Doubling Time (h)&#39;</span>
<a name="l01648"></a>01648                 <span class="stringliteral">&#39;Experimental No. Replicates&#39;</span>
<a name="l01649"></a>01649                 <span class="stringliteral">&#39;FBA Essentiality&#39;</span>
<a name="l01650"></a>01650                 <span class="stringliteral">&#39;Experiment Essentiality&#39;</span>
<a name="l01651"></a>01651                 <span class="stringliteral">&#39;Model Agree&#39;</span>
<a name="l01652"></a>01652                 <span class="stringliteral">&#39;FBA Agree&#39;</span>
<a name="l01653"></a>01653                 }<span class="stringliteral">&#39;;</span>
<a name="l01654"></a>01654 <span class="stringliteral">            content = cell(0, numel(colLabels));</span>
<a name="l01655"></a>01655 <span class="stringliteral">            </span>
<a name="l01656"></a>01656 <span class="stringliteral">            %content</span>
<a name="l01657"></a>01657 <span class="stringliteral">            deletionGrowthRates = deletionMetabolicOutputs(:, 1);</span>
<a name="l01658"></a>01658 <span class="stringliteral">            wtGrowthRate = wtMetabolicOutput(:, 1);</span>
<a name="l01659"></a>01659 <span class="stringliteral">            deletionEnergyProductions = deletionMetabolicOutputs(:, 2:3);</span>
<a name="l01660"></a>01660 <span class="stringliteral">            wtEnergyProduction = wtMetabolicOutput(:, 2:3);</span>
<a name="l01661"></a>01661 <span class="stringliteral">            </span>
<a name="l01662"></a>01662 <span class="stringliteral">            [deletionDoublingTimesExperimental, wtDoublingTimeExperimental] = SingleGeneDeletions.getExperimentalDoublingTimes();</span>
<a name="l01663"></a>01663 <span class="stringliteral">            wtGrowthRateExperimental = log(2) ./ wtDoublingTimeExperimental(:, 1);</span>
<a name="l01664"></a>01664 <span class="stringliteral">            deletionGrowthRatesExperimental = wtGrowthRateExperimental * (~ismember(g.essential, {&#39;</span>Y<span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;}));</span>
<a name="l01665"></a>01665 <span class="stringliteral">            essThresh = 0.2 * wtGrowthRateExperimental;</span>
<a name="l01666"></a>01666 <span class="stringliteral">            </span>
<a name="l01667"></a>01667 <span class="stringliteral">            ynChar = {&#39;</span>N<span class="stringliteral">&#39;; &#39;</span>Y<span class="stringliteral">&#39;; &#39;</span><span class="stringliteral">&#39;};</span>
<a name="l01668"></a>01668 <span class="stringliteral">            agStr = {&#39;</span>Correct<span class="stringliteral">&#39;; &#39;</span>False Essential<span class="stringliteral">&#39;; &#39;</span>False Non-Essential&#39;; <span class="stringliteral">&#39;Not Predicted&#39;</span>};
<a name="l01669"></a>01669             
<a name="l01670"></a>01670             modelEss = 2 * ones(size(deletionGrowthRates));
<a name="l01671"></a>01671             modelEss(geneClasses == SingleGeneDeletions.NON_ESSENTIAL) = 1;
<a name="l01672"></a>01672             modelEss(geneClasses == SingleGeneDeletions.UNOBSERVED) = 3;
<a name="l01673"></a>01673             
<a name="l01674"></a>01674             fbaEss = ones(size(deletionGrowthRates));
<a name="l01675"></a>01675             fbaEss(deletionGrowthRates &gt;= essThresh) = 1;
<a name="l01676"></a>01676             fbaEss(deletionGrowthRates &lt; essThresh) = 2;
<a name="l01677"></a>01677             fbaEss(isnan(deletionGrowthRates)) = 3;
<a name="l01678"></a>01678             
<a name="l01679"></a>01679             expEss = ones(size(deletionGrowthRatesExperimental));
<a name="l01680"></a>01680             expEss(deletionGrowthRatesExperimental &gt;= essThresh) = 1;
<a name="l01681"></a>01681             expEss(deletionGrowthRatesExperimental &lt; essThresh) = 2;
<a name="l01682"></a>01682             expEss(isnan(deletionGrowthRatesExperimental)) = 3;
<a name="l01683"></a>01683             
<a name="l01684"></a>01684             modelAgrees = ones(size(deletionGrowthRates));
<a name="l01685"></a>01685             modelAgrees(((geneClasses == SingleGeneDeletions.NON_ESSENTIAL) == (deletionGrowthRatesExperimental &gt; essThresh))) = 1;
<a name="l01686"></a>01686             modelAgrees(((geneClasses ~= SingleGeneDeletions.NON_ESSENTIAL) &amp; (deletionGrowthRatesExperimental &gt; essThresh))) = 2;
<a name="l01687"></a>01687             modelAgrees(((geneClasses == SingleGeneDeletions.NON_ESSENTIAL) &amp; (deletionGrowthRatesExperimental &lt; essThresh))) = 3;
<a name="l01688"></a>01688             modelAgrees(geneClasses == SingleGeneDeletions.UNOBSERVED) = 4;
<a name="l01689"></a>01689             
<a name="l01690"></a>01690             fbaAgrees = ones(size(deletionGrowthRates));
<a name="l01691"></a>01691             fbaAgrees(((deletionGrowthRates &gt; essThresh) == (deletionGrowthRatesExperimental &gt; essThresh))) = 1;
<a name="l01692"></a>01692             fbaAgrees(((deletionGrowthRates &lt; essThresh) &amp; (deletionGrowthRatesExperimental &gt; essThresh))) = 2;
<a name="l01693"></a>01693             fbaAgrees(((deletionGrowthRates &gt; essThresh) &amp; (deletionGrowthRatesExperimental &lt; essThresh))) = 3;
<a name="l01694"></a>01694             fbaAgrees(isnan(deletionGrowthRates)) = 4;
<a name="l01695"></a>01695             
<a name="l01696"></a>01696             geneClassNames = cell(size(geneClasses));
<a name="l01697"></a>01697             <span class="keywordflow">for</span> i = 1:size(SingleGeneDeletions.DELETION_STRAIN_CLASSES, 1)
<a name="l01698"></a>01698                 geneClassNames(geneClasses == i) = SingleGeneDeletions.DELETION_STRAIN_CLASSES(i);
<a name="l01699"></a>01699             end
<a name="l01700"></a>01700             wtGrowthRate = wtGrowthRate * 3600 * sim.state(&#39;Mass&#39;).cellInitialDryWeight / (1 - sim.state(&#39;Mass&#39;).fractionWetWeight) * 1e15;
<a name="l01701"></a>01701             deletionGrowthRates = deletionGrowthRates * 3600 * sim.state(&#39;Mass&#39;).cellInitialDryWeight / (1 - sim.state(&#39;Mass&#39;).fractionWetWeight) * 1e15;
<a name="l01702"></a>01702             
<a name="l01703"></a>01703             content = [content; {
<a name="l01704"></a>01704                 <span class="stringliteral">&#39;WT&#39;</span> ...
<a name="l01705"></a>01705                 <span class="stringliteral">&#39;Wild-type&#39;</span> ...
<a name="l01706"></a>01706                 <span class="stringliteral">&#39;&#39;</span> ...
<a name="l01707"></a>01707                 <span class="stringliteral">&#39;&#39;</span> ...
<a name="l01708"></a>01708                 <span class="stringliteral">&#39;&#39;</span> ...
<a name="l01709"></a>01709                 <span class="stringliteral">&#39;&#39;</span> ...
<a name="l01710"></a>01710                 <span class="stringliteral">&#39;Wild-type&#39;</span> ...
<a name="l01711"></a>01711                 <span class="stringliteral">&#39;&#39;</span> ...
<a name="l01712"></a>01712                 } ...
<a name="l01713"></a>01713                 num2cell(reshape(permute(wtStats, [3 2 1]), [], size(wtStats, 1))<span class="stringliteral">&#39;) ...</span>
<a name="l01714"></a>01714 <span class="stringliteral">                num2cell(wtGrowthRate) ...</span>
<a name="l01715"></a>01715 <span class="stringliteral">                num2cell(wtEnergyProduction) ...</span>
<a name="l01716"></a>01716 <span class="stringliteral">                num2cell(wtDoublingTimeExperimental) ...</span>
<a name="l01717"></a>01717 <span class="stringliteral">                { ...</span>
<a name="l01718"></a>01718 <span class="stringliteral">                &#39;</span><span class="stringliteral">&#39; ...</span>
<a name="l01719"></a>01719 <span class="stringliteral">                &#39;</span><span class="stringliteral">&#39; ...</span>
<a name="l01720"></a>01720 <span class="stringliteral">                &#39;</span><span class="stringliteral">&#39; ...</span>
<a name="l01721"></a>01721 <span class="stringliteral">                &#39;</span><span class="stringliteral">&#39; ...</span>
<a name="l01722"></a>01722 <span class="stringliteral">                }];</span>
<a name="l01723"></a>01723 <span class="stringliteral">            </span>
<a name="l01724"></a>01724 <span class="stringliteral">            [i, j] = find(rna.nascentRNAGeneComposition);</span>
<a name="l01725"></a>01725 <span class="stringliteral">            tuIDs = cell(size(g.wholeCellModelIDs));</span>
<a name="l01726"></a>01726 <span class="stringliteral">            tuNames = cell(size(g.wholeCellModelIDs));</span>
<a name="l01727"></a>01727 <span class="stringliteral">            tuIDs(i) = rna.wholeCellModelIDs(rna.nascentIndexs(j));</span>
<a name="l01728"></a>01728 <span class="stringliteral">            tuNames(i) = rna.names(rna.nascentIndexs(j));</span>
<a name="l01729"></a>01729 <span class="stringliteral">            </span>
<a name="l01730"></a>01730 <span class="stringliteral">            content = [content;</span>
<a name="l01731"></a>01731 <span class="stringliteral">                g.wholeCellModelIDs ...</span>
<a name="l01732"></a>01732 <span class="stringliteral">                g.names ...</span>
<a name="l01733"></a>01733 <span class="stringliteral">                tuIDs ...</span>
<a name="l01734"></a>01734 <span class="stringliteral">                tuNames ...</span>
<a name="l01735"></a>01735 <span class="stringliteral">                geneImplementedMolecules ...</span>
<a name="l01736"></a>01736 <span class="stringliteral">                geneImplementedProcesses ...</span>
<a name="l01737"></a>01737 <span class="stringliteral">                geneClassNames ...</span>
<a name="l01738"></a>01738 <span class="stringliteral">                ynChar(modelEss) ...</span>
<a name="l01739"></a>01739 <span class="stringliteral">                num2cell(reshape(permute(deletionStats, [3 2 1]), [], size(deletionStats, 1))&#39;</span>) ...
<a name="l01740"></a>01740                 num2cell(deletionGrowthRates) ...
<a name="l01741"></a>01741                 num2cell(deletionEnergyProductions) ...
<a name="l01742"></a>01742                 num2cell(deletionDoublingTimesExperimental) ...
<a name="l01743"></a>01743                 ynChar(fbaEss)  ...
<a name="l01744"></a>01744                 ynChar(expEss) ...
<a name="l01745"></a>01745                 agStr(modelAgrees) ...
<a name="l01746"></a>01746                 agStr(fbaAgrees)
<a name="l01747"></a>01747                 ];
<a name="l01748"></a>01748             content(cellfun(@(x) ~isempty(x) &amp;&amp; all(isnumeric(x)) &amp;&amp; all(isnan(x)), content)) = {[]};
<a name="l01749"></a>01749         end
<a name="l01750"></a>01750         
<a name="l01751"></a>01751         <span class="keyword">function</span> [content, colLabels] = printSingleGeneDeletionStrainClasses(sim, geneClasses)
<a name="l01752"></a>01752             %<span class="keyword">import</span> classes
<a name="l01753"></a>01753             <span class="keyword">import</span> edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l01754"></a>01754             <span class="keyword">import</span> edu.stanford.covert.cell.sim.Simulation;
<a name="l01755"></a>01755             <span class="keyword">import</span> edu.stanford.covert.util.ConstantUtil;
<a name="l01756"></a>01756             
<a name="l01757"></a>01757             %constants
<a name="l01758"></a>01758             g = sim.gene;
<a name="l01759"></a>01759             isGeneImplemented = SingleGeneDeletions.getGeneImplementations(sim);
<a name="l01760"></a>01760             
<a name="l01761"></a>01761             %content
<a name="l01762"></a>01762             expEss = ismember(g.essential, {<span class="charliteral">&#39;Y&#39;</span>, <span class="stringliteral">&#39;&#39;</span>});
<a name="l01763"></a>01763             modelEss = geneClasses ~= SingleGeneDeletions.NON_ESSENTIAL;
<a name="l01764"></a>01764             
<a name="l01765"></a>01765             %overall p-value versus random model of implemented genes. that
<a name="l01766"></a>01766             %is p-value that model isn&#39;t random model which
<a name="l01767"></a>01767             %- Randomly guesses that implemented genes are essential with
<a name="l01768"></a>01768             %  probability = sum(tfModelEss &amp; tfImplemented) / nImplemented
<a name="l01769"></a>01769             %- Deterministically reports that all non-implemented genes are
<a name="l01770"></a>01770             %  non-essential
<a name="l01771"></a>01771             nImplemented = sum(isGeneImplemented);
<a name="l01772"></a>01772             nCorrectImplemented = sum(modelEss == expEss &amp; isGeneImplemented);
<a name="l01773"></a>01773             pCorrectGivenImplemented = ...
<a name="l01774"></a>01774                 + sum( modelEss &amp; isGeneImplemented) / nImplemented * sum( expEss &amp; isGeneImplemented) / nImplemented  ...
<a name="l01775"></a>01775                 + sum(~modelEss &amp; isGeneImplemented) / nImplemented * sum(~expEss &amp; isGeneImplemented) / nImplemented;
<a name="l01776"></a>01776             totalPValue = 1 - binocdf(nCorrectImplemented - 1, nImplemented, pCorrectGivenImplemented);
<a name="l01777"></a>01777             
<a name="l01778"></a>01778             %ROC analysis
<a name="l01779"></a>01779             rocAnalysis = zeros(size(SingleGeneDeletions.DELETION_STRAIN_CLASSES, 1), 15);
<a name="l01780"></a>01780             pValues = zeros(size(SingleGeneDeletions.DELETION_STRAIN_CLASSES, 1), 1);
<a name="l01781"></a>01781             <span class="keywordflow">for</span> i = 1:size(SingleGeneDeletions.DELETION_STRAIN_CLASSES, 1)
<a name="l01782"></a>01782                 tfs = geneClasses == i;
<a name="l01783"></a>01783                 rocAnalysis(i, 1) = sum(tfs);
<a name="l01784"></a>01784                 rocAnalysis(i, 2:5) = sum([
<a name="l01785"></a>01785                     modelEss(tfs) &amp;  expEss(tfs) ...
<a name="l01786"></a>01786                     ~modelEss(tfs) &amp; ~expEss(tfs) ...
<a name="l01787"></a>01787                     modelEss(tfs) &amp; ~expEss(tfs) ...
<a name="l01788"></a>01788                     ~modelEss(tfs) &amp;  expEss(tfs) ...
<a name="l01789"></a>01789                     ], 1);
<a name="l01790"></a>01790                 
<a name="l01791"></a>01791                 tfs = geneClasses == i  &amp;  isGeneImplemented;
<a name="l01792"></a>01792                 rocAnalysis(i, 6) = sum(tfs);
<a name="l01793"></a>01793                 rocAnalysis(i, 7:10) = sum([
<a name="l01794"></a>01794                     modelEss(tfs) &amp;  expEss(tfs) ...
<a name="l01795"></a>01795                     ~modelEss(tfs) &amp; ~expEss(tfs) ...
<a name="l01796"></a>01796                     modelEss(tfs) &amp; ~expEss(tfs) ...
<a name="l01797"></a>01797                     ~modelEss(tfs) &amp;  expEss(tfs) ...
<a name="l01798"></a>01798                     ], 1);
<a name="l01799"></a>01799                 
<a name="l01800"></a>01800                 tfs = geneClasses == i  &amp;  ~isGeneImplemented;
<a name="l01801"></a>01801                 rocAnalysis(i, 11) = sum(tfs);
<a name="l01802"></a>01802                 rocAnalysis(i, 12:15) = sum([
<a name="l01803"></a>01803                     modelEss(tfs) &amp;  expEss(tfs) ...
<a name="l01804"></a>01804                     ~modelEss(tfs) &amp; ~expEss(tfs) ...
<a name="l01805"></a>01805                     modelEss(tfs) &amp; ~expEss(tfs) ...
<a name="l01806"></a>01806                     ~modelEss(tfs) &amp;  expEss(tfs) ...
<a name="l01807"></a>01807                     ], 1);
<a name="l01808"></a>01808                 
<a name="l01809"></a>01809                 % p-value versus random model of implemented genes
<a name="l01810"></a>01810                 tfs = geneClasses == i  &amp;  isGeneImplemented;
<a name="l01811"></a>01811                 nImplemented = sum(isGeneImplemented(tfs));
<a name="l01812"></a>01812                 nCorrectImplemented = sum(modelEss(tfs) == expEss(tfs) &amp; isGeneImplemented(tfs));
<a name="l01813"></a>01813                 if nImplemented == 0
<a name="l01814"></a>01814                     pValues(i) = NaN;
<a name="l01815"></a>01815                 else
<a name="l01816"></a>01816                     pValues(i) = 1 - binocdf(nCorrectImplemented - 1, nImplemented, pCorrectGivenImplemented);
<a name="l01817"></a>01817                 end
<a name="l01818"></a>01818             end
<a name="l01819"></a>01819             
<a name="l01820"></a>01820             %format output
<a name="l01821"></a>01821             colLabels = {
<a name="l01822"></a>01822                 <span class="stringliteral">&#39;Class&#39;</span>  ...
<a name="l01823"></a>01823                 <span class="stringliteral">&#39;Total-Count&#39;</span>  <span class="stringliteral">&#39;Total-True Essential&#39;</span>  <span class="stringliteral">&#39;Total-True Non-Essential&#39;</span>  <span class="stringliteral">&#39;Total-False Essential&#39;</span>  <span class="stringliteral">&#39;Total-False Non-Essential&#39;</span> ...
<a name="l01824"></a>01824                 <span class="stringliteral">&#39;Implemented-Count&#39;</span>  <span class="stringliteral">&#39;Implemented-True Essential&#39;</span>  <span class="stringliteral">&#39;Implemented-True Non-Essential&#39;</span>  <span class="stringliteral">&#39;Implemented-False Essential&#39;</span>  <span class="stringliteral">&#39;Implemented-False Non-Essential&#39;</span> ...
<a name="l01825"></a>01825                 <span class="stringliteral">&#39;Unimplemented-Count&#39;</span>  <span class="stringliteral">&#39;Unimplemented-True Essential&#39;</span>  <span class="stringliteral">&#39;Unimplemented-True Non-Essential&#39;</span>  <span class="stringliteral">&#39;Unimplemented-False Essential&#39;</span>  <span class="stringliteral">&#39;Unimplemented-False Non-Essential&#39;</span> ...
<a name="l01826"></a>01826                 <span class="stringliteral">&#39;p-Value&#39;</span> ...
<a name="l01827"></a>01827                 };
<a name="l01828"></a>01828             content = [
<a name="l01829"></a>01829                 SingleGeneDeletions.DELETION_STRAIN_CLASSES(1:end-1, 1)  num2cell([rocAnalysis(1:end-1, 1)     rocAnalysis(1:end-1, 2:5) ./ rocAnalysis(1:end-1, ones(4, 1))   rocAnalysis(1:end-1, 6)     rocAnalysis(1:end-1, 7:10) ./ rocAnalysis(1:end-1, 6*ones(4, 1))    rocAnalysis(1:end-1, 11)     rocAnalysis(1:end-1, 12:15) ./ rocAnalysis(1:end-1, 11*ones(4, 1))  pValues(1:end-1, :)])
<a name="l01830"></a>01830                 &#39;Total&#39;                                                  num2cell([sum(rocAnalysis(:, 1), 1)   sum(rocAnalysis(:, 2:5), 1) / sum(rocAnalysis(:, 1), 1)         sum(rocAnalysis(:, 6), 1)   sum(rocAnalysis(:, 7:10), 1) / sum(rocAnalysis(:, 6), 1)            sum(rocAnalysis(:, 11), 1)   sum(rocAnalysis(:, 12:15), 1) / sum(rocAnalysis(:, 11), 1)          totalPValue])
<a name="l01831"></a>01831                 ];
<a name="l01832"></a>01832             content(cellfun(@(el) any(isnan(el)), content)) = {[]};
<a name="l01833"></a>01833         end
<a name="l01834"></a>01834         
<a name="l01835"></a>01835         <span class="keyword">function</span> plot(sim, deletionMetabolicOutputs, wtMetabolicOutput, deletionStats, wtStats, geneClasses, fileName)
<a name="l01836"></a>01836             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l01837"></a>01837             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l01838"></a>01838             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l01839"></a>01839             
<a name="l01840"></a>01840             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l01841"></a>01841             
<a name="l01842"></a>01842             %categories, IDs
<a name="l01843"></a>01843             [content, colLabels] = SingleGeneDeletions.printSingleGeneDeletionStrains(sim, deletionMetabolicOutputs, wtMetabolicOutput, deletionStats, wtStats, geneClasses);
<a name="l01844"></a>01844             geneIDs = content(2:end, ismember(colLabels, &#39;<a class="code" href="class_gene.html">Gene</a>&#39;));
<a name="l01845"></a>01845             geneCats = content(2:end, ismember(colLabels, &#39;Model Agree&#39;));
<a name="l01846"></a>01846             geneProcesses = content(2:end, ismember(colLabels, &#39;Implementation <a class="code" href="class_process.html">Process</a>&#39;));
<a name="l01847"></a>01847             wtGrowthRateModel = cell2mat(content(1, ismember(colLabels, &#39;<a class="code" href="class_f_b_a.html">FBA</a> Growth (fg h^-1)&#39;)));
<a name="l01848"></a>01848             wtDoublingTimeModel = cell2mat(content(1, ismember(colLabels, &#39;Mean Model Mass Doubling Duration (h)&#39;)));
<a name="l01849"></a>01849             wtCellCycleTimeModel = cell2mat(content(1, ismember(colLabels, &#39;Mean Model Cell Cycle Duration (h)&#39;)));
<a name="l01850"></a>01850             wtDoublingTimeExp = cell2mat(content(1, ismember(colLabels, &#39;Mean Experimental Mass Doubling Time (h)&#39;)));
<a name="l01851"></a>01851             geneGrowthRatesModel = content(2:end, ismember(colLabels, &#39;<a class="code" href="class_f_b_a.html">FBA</a> Growth (fg h^-1)&#39;));
<a name="l01852"></a>01852             geneDoublingTimesModel = content(2:end, ismember(colLabels, &#39;Mean Model Mass Doubling Duration (h)&#39;));
<a name="l01853"></a>01853             geneCellCycleTimesModel = content(2:end, ismember(colLabels, &#39;Mean Model Cell Cycle Duration (h)&#39;));
<a name="l01854"></a>01854             geneDoublingTimesExp = content(2:end, ismember(colLabels, &#39;Mean Experimental Mass Doubling Time (h)&#39;));
<a name="l01855"></a>01855             
<a name="l01856"></a>01856             geneGrowthRatesModel(cellfun(@isempty, geneGrowthRatesModel)) = {NaN};
<a name="l01857"></a>01857             geneDoublingTimesModel(cellfun(@isempty, geneDoublingTimesModel)) = {NaN};
<a name="l01858"></a>01858             geneCellCycleTimesModel(cellfun(@isempty, geneCellCycleTimesModel)) = {NaN};
<a name="l01859"></a>01859             geneDoublingTimesExp(cellfun(@isempty, geneDoublingTimesExp)) = {NaN};
<a name="l01860"></a>01860             
<a name="l01861"></a>01861             geneGrowthRatesModel = cell2mat(geneGrowthRatesModel);
<a name="l01862"></a>01862             geneDoublingTimesModel = cell2mat(geneDoublingTimesModel);
<a name="l01863"></a>01863             geneCellCycleTimesModel = cell2mat(geneCellCycleTimesModel);
<a name="l01864"></a>01864             geneDoublingTimesExp = cell2mat(geneDoublingTimesExp);
<a name="l01865"></a>01865             
<a name="l01866"></a>01866             geneTfsModelImputed = isnan(geneDoublingTimesModel) &amp; ~isnan(geneGrowthRatesModel);
<a name="l01867"></a>01867             geneDoublingTimesModel(isnan(geneDoublingTimesModel)) = wtDoublingTimeModel * ...
<a name="l01868"></a>01868                 wtGrowthRateModel ./ geneGrowthRatesModel(isnan(geneDoublingTimesModel));
<a name="l01869"></a>01869             geneCellCycleTimesModel(isnan(geneCellCycleTimesModel)) = wtCellCycleTimeModel * ...
<a name="l01870"></a>01870                 wtGrowthRateModel ./ geneGrowthRatesModel(isnan(geneCellCycleTimesModel));
<a name="l01871"></a>01871             
<a name="l01872"></a>01872             %sort
<a name="l01873"></a>01873             geneCats(cellfun(@isempty, geneProcesses)) = {<span class="stringliteral">&#39;Uncharacterized&#39;</span>};
<a name="l01874"></a>01874             [~, idxs] = sort(geneCats);
<a name="l01875"></a>01875             geneIDs = geneIDs(idxs);
<a name="l01876"></a>01876             geneCats = geneCats(idxs);
<a name="l01877"></a>01877             
<a name="l01878"></a>01878             %write svg grid
<a name="l01879"></a>01879             categories = unique([geneCats; {<span class="stringliteral">&#39;Correct&#39;</span>; <span class="stringliteral">&#39;False Essential&#39;</span>; <span class="stringliteral">&#39;False Non-Essential&#39;</span>; <span class="stringliteral">&#39;Uncharacterized&#39;</span>}]);
<a name="l01880"></a>01880             colors = [
<a name="l01881"></a>01881                 149 179 215
<a name="l01882"></a>01882                 217 150 148
<a name="l01883"></a>01883                 195 214 155
<a name="l01884"></a>01884                 255 255 255];
<a name="l01885"></a>01885             fid = fopen(fileName, <span class="charliteral">&#39;w&#39;</span>);
<a name="l01886"></a>01886             fwrite(fid, SingleGeneDeletions.plotGrid(categories, geneIDs, geneCats, 720, 450, 11, 16, colors));
<a name="l01887"></a>01887             fclose(fid);
<a name="l01888"></a>01888             
<a name="l01889"></a>01889             %% plot experimental observations vs model predictions
<a name="l01890"></a>01890             
<a name="l01891"></a>01891             geneTfs = geneDoublingTimesModel &gt; 0 | geneDoublingTimesExp &gt; 0;
<a name="l01892"></a>01892             geneTfsExpImputed = geneTfs &amp; geneDoublingTimesExp == wtDoublingTimeExp;
<a name="l01893"></a>01893             geneTfsExpObserved = geneTfs &amp; ~geneTfsExpImputed;
<a name="l01894"></a>01894             
<a name="l01895"></a>01895             labels = {<span class="stringliteral">&#39;Imputed&#39;</span>, <span class="stringliteral">&#39;Model Imputed&#39;</span>, <span class="stringliteral">&#39;Experiment Imputed&#39;</span>, <span class="stringliteral">&#39;Observed&#39;</span>};
<a name="l01896"></a>01896             
<a name="l01897"></a>01897             %doubling time vs doubling time
<a name="l01898"></a>01898             [axesHandle, figHandle] = PlotUtil.newAxesHandle();
<a name="l01899"></a>01899             hold(axesHandle, <span class="stringliteral">&#39;on&#39;</span>);
<a name="l01900"></a>01900             h = zeros(4, 1);
<a name="l01901"></a>01901             <span class="keywordflow">if</span> any(geneTfsModelImputed &amp; geneTfsExpImputed)
<a name="l01902"></a>01902                 h(1) = plot(axesHandle, geneDoublingTimesExp(geneTfsModelImputed &amp; geneTfsExpImputed), geneDoublingTimesModel(geneTfsModelImputed &amp; geneTfsExpImputed), <span class="charliteral">&#39;.&#39;</span>, <span class="stringliteral">&#39;MarkerSize&#39;</span>, 8, <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;r&#39;</span>);
<a name="l01903"></a>01903             end
<a name="l01904"></a>01904             <span class="keywordflow">if</span> any(geneTfsModelImputed &amp; geneTfsExpObserved)
<a name="l01905"></a>01905                 h(2) = plot(axesHandle, geneDoublingTimesExp(geneTfsModelImputed &amp; geneTfsExpObserved), geneDoublingTimesModel(geneTfsModelImputed &amp; geneTfsExpObserved), <span class="charliteral">&#39;.&#39;</span>, <span class="stringliteral">&#39;MarkerSize&#39;</span>, 8, <span class="stringliteral">&#39;Color&#39;</span>, [0 0.5 0.5]);
<a name="l01906"></a>01906             end
<a name="l01907"></a>01907             <span class="keywordflow">if</span> any(~geneTfsModelImputed &amp; geneTfsExpImputed)
<a name="l01908"></a>01908                 h(3) = plot(axesHandle, geneDoublingTimesExp(~geneTfsModelImputed &amp; geneTfsExpImputed), geneDoublingTimesModel(~geneTfsModelImputed &amp; geneTfsExpImputed), <span class="charliteral">&#39;.&#39;</span>, <span class="stringliteral">&#39;MarkerSize&#39;</span>, 8, <span class="stringliteral">&#39;Color&#39;</span>, [0.5 0 0.5]);
<a name="l01909"></a>01909             end
<a name="l01910"></a>01910             <span class="keywordflow">if</span> any(~geneTfsModelImputed &amp; geneTfsExpObserved)
<a name="l01911"></a>01911                 h(4) = plot(axesHandle, geneDoublingTimesExp(~geneTfsModelImputed &amp; geneTfsExpObserved), geneDoublingTimesModel(~geneTfsModelImputed &amp; geneTfsExpObserved), <span class="charliteral">&#39;.&#39;</span>, <span class="stringliteral">&#39;MarkerSize&#39;</span>, 8, <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;b&#39;</span>);
<a name="l01912"></a>01912             end
<a name="l01913"></a>01913             labels = labels(h ~= 0);
<a name="l01914"></a>01914             h = h(h ~= 0);
<a name="l01915"></a>01915             legend(h(end:-1:1), labels(end:-1:1), <span class="stringliteral">&#39;Location&#39;</span>, <span class="stringliteral">&#39;SouthEast&#39;</span>);
<a name="l01916"></a>01916             box(axesHandle, <span class="stringliteral">&#39;on&#39;</span>);
<a name="l01917"></a>01917             xlim(axesHandle, [6 20]);
<a name="l01918"></a>01918             ylim(axesHandle, [6 20]);
<a name="l01919"></a>01919             xlabel(axesHandle, <span class="stringliteral">&#39;Observed Mass Doubling Time (h)&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, 14);
<a name="l01920"></a>01920             ylabel(axesHandle, <span class="stringliteral">&#39;Predicted Mass Doubling Time (h)&#39;</span>, <span class="stringliteral">&#39;FontSize&#39;</span>, 14);
<a name="l01921"></a>01921             saveas(figHandle, [baseDir <span class="stringliteral">&#39;ModelDoublingTimeVsExperimentDoublingTime.pdf&#39;</span>]);
<a name="l01922"></a>01922             close(figHandle);
<a name="l01923"></a>01923             
<a name="l01924"></a>01924             %cell cycle length vs doubling time
<a name="l01925"></a>01925             [axesHandle, figHandle] = PlotUtil.newAxesHandle();
<a name="l01926"></a>01926             hold(axesHandle, <span class="stringliteral">&#39;on&#39;</span>);
<a name="l01927"></a>01927             h = zeros(4, 1);
<a name="l01928"></a>01928             <span class="keywordflow">if</span> any(geneTfsModelImputed &amp; geneTfsExpImputed)
<a name="l01929"></a>01929                 plot(axesHandle, geneDoublingTimesExp(geneTfsModelImputed &amp; geneTfsExpImputed), geneCellCycleTimesModel(geneTfsModelImputed &amp; geneTfsExpImputed), <span class="charliteral">&#39;.&#39;</span>, <span class="stringliteral">&#39;MarkerSize&#39;</span>, 8, <span class="stringliteral">&#39;Color&#39;</span>, <span class="charliteral">&#39;r&#39;</span>)
<a name="l01930"></a>01930             end
<a name="l01931"></a>01931             if any(geneTfsModelImputed &amp; geneTfsExpObserved)
<a name="l01932"></a>01932                 plot(axesHandle, geneDoublingTimesExp(geneTfsModelImputed &amp; geneTfsExpObserved), geneCellCycleTimesModel(geneTfsModelImputed &amp; geneTfsExpObserved), &#39;.&#39;, &#39;MarkerSize&#39;, 8, &#39;Color&#39;, [0 0.5 0.5])
<a name="l01933"></a>01933             end
<a name="l01934"></a>01934             if any(~geneTfsModelImputed &amp; geneTfsExpImputed)
<a name="l01935"></a>01935                 plot(axesHandle, geneDoublingTimesExp(~geneTfsModelImputed &amp; geneTfsExpImputed), geneCellCycleTimesModel(~geneTfsModelImputed &amp; geneTfsExpImputed), &#39;.&#39;, &#39;MarkerSize&#39;, 8, &#39;Color&#39;, [0.5 0 0.5])
<a name="l01936"></a>01936             end
<a name="l01937"></a>01937             if any(~geneTfsModelImputed &amp; geneTfsExpObserved)
<a name="l01938"></a>01938                 plot(axesHandle, geneDoublingTimesExp(~geneTfsModelImputed &amp; geneTfsExpObserved), geneCellCycleTimesModel(~geneTfsModelImputed &amp; geneTfsExpObserved), &#39;.&#39;, &#39;MarkerSize&#39;, 8, &#39;Color&#39;, &#39;b&#39;)
<a name="l01939"></a>01939             end
<a name="l01940"></a>01940             labels = labels(h ~= 0);
<a name="l01941"></a>01941             h = h(h ~= 0);
<a name="l01942"></a>01942             legend(h(end:-1:1), labels(end:-1:1), &#39;Location&#39;, &#39;SouthEast&#39;);
<a name="l01943"></a>01943             box(axesHandle, &#39;on&#39;);
<a name="l01944"></a>01944             xlim(axesHandle, [6 20]);
<a name="l01945"></a>01945             ylim(axesHandle, [6 20]);
<a name="l01946"></a>01946             xlabel(axesHandle, &#39;Observed Mass Doubling Time (h)&#39;, &#39;FontSize&#39;, 14);
<a name="l01947"></a>01947             ylabel(axesHandle, &#39;Predicted Cell Cycle Length (h)&#39;, &#39;FontSize&#39;, 14);
<a name="l01948"></a>01948             saveas(figHandle, [baseDir &#39;ModelCellCycleLengthVsExperimentDoublingTime.pdf&#39;]);
<a name="l01949"></a>01949             close(figHandle);
<a name="l01950"></a>01950         end
<a name="l01951"></a>01951         
<a name="l01952"></a>01952         function svg = plotGrid(categories, cellIDs, cellCats, width, height, gridFontSize, legendFontSize, colors)
<a name="l01953"></a>01953             %layout grid
<a name="l01954"></a>01954             gridWidth = width - 220;
<a name="l01955"></a>01955             area = gridWidth * height / numel(cellIDs);
<a name="l01956"></a>01956             cols = ceil(gridWidth / sqrt(area));
<a name="l01957"></a>01957             cellWidth = gridWidth / cols;
<a name="l01958"></a>01958             cellHeight = cellWidth;
<a name="l01959"></a>01959             rows = min(floor(height / cellHeight), ceil(numel(cellIDs) / cols));
<a name="l01960"></a>01960             
<a name="l01961"></a>01961             <a class="code" href="json_parse_8m.html#ad2fc293e8080616c8c1e2ffbd7b86742">while</a> rows * cols &lt; numel(cellIDs)
<a name="l01962"></a>01962                 cols = cols + 1;
<a name="l01963"></a>01963                 cellWidth = gridWidth / cols;
<a name="l01964"></a>01964                 cellHeight = cellWidth;
<a name="l01965"></a>01965                 rows = min(floor(height / cellHeight), ceil(numel(cellIDs) / cols));
<a name="l01966"></a>01966             end
<a name="l01967"></a>01967             
<a name="l01968"></a>01968             %grid
<a name="l01969"></a>01969             grid = [];
<a name="l01970"></a>01970             grid = [grid sprintf(&#39;\t&lt;g tansform=&quot;translate(0,0)&quot;&gt;\n&#39;)];
<a name="l01971"></a>01971             for i = 1:numel(cellIDs)
<a name="l01972"></a>01972                 j = floor((i-1) / cols);
<a name="l01973"></a>01973                 k = mod((i-1), cols);
<a name="l01974"></a>01974                 category = regexprep(cellCats{i}, <span class="charliteral">&#39;\W&#39;</span>, <span class="charliteral">&#39;_&#39;</span>);
<a name="l01975"></a>01975                 cellID = regexprep(regexprep(cellIDs{i}, <span class="stringliteral">&#39;MG_*&#39;</span>, <span class="stringliteral">&#39;&#39;</span>), <span class="stringliteral">&#39;rrnA&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l01976"></a>01976                 grid = [grid sprintf(&#39;\t\t&lt;g transform=&quot;translate(%f,%f)&quot;&gt;&lt;rect transform=&quot;translate(%f,%f)&quot; width=&quot;%f&quot; height=&quot;%f&quot; class=&quot;%s&quot;/&gt;&lt;text transform=&quot;translate(%f,%f)&quot; class=&quot;grid %s&quot;&gt;%s&lt;/text&gt;&lt;/g&gt;\n&#39;, ...
<a name="l01977"></a>01977                     k * cellWidth, j * cellHeight, 0, 0, cellWidth, cellHeight, category, cellWidth / 2, cellHeight / 2 + 0.4 * gridFontSize, category, cellID)]; %#ok&lt;*AGROW&gt;
<a name="l01978"></a>01978             end
<a name="l01979"></a>01979             grid = [grid sprintf(&#39;\t&lt;/g&gt;&#39;)];
<a name="l01980"></a>01980             
<a name="l01981"></a>01981             %styles, legend
<a name="l01982"></a>01982             styles = [];
<a name="l01983"></a>01983             legend = sprintf(<span class="stringliteral">&#39;\t&lt;g transform=&quot;translate(%f,%f)&quot;&gt;\n&#39;</span>, cellWidth * cols + 10, 0);
<a name="l01984"></a>01984             <span class="keywordflow">for</span> i = 1:numel(categories)
<a name="l01985"></a>01985                 category = regexprep(categories{i}, <span class="charliteral">&#39;\W&#39;</span>, <span class="charliteral">&#39;_&#39;</span>);
<a name="l01986"></a>01986                 r = colors(mod(i-1, size(colors, 1))+1, 1);
<a name="l01987"></a>01987                 g = colors(mod(i-1, size(colors, 1))+1, 2);
<a name="l01988"></a>01988                 b = colors(mod(i-1, size(colors, 1))+1, 3);
<a name="l01989"></a>01989                 
<a name="l01990"></a>01990                 cellCount = sum(strcmp(cellCats, categories{i}));
<a name="l01991"></a>01991                 
<a name="l01992"></a>01992                 <span class="keywordflow">if</span> mean(colors(i, :)) &lt; 255 / 2
<a name="l01993"></a>01993                     textAlpha = 255;
<a name="l01994"></a>01994                 <span class="keywordflow">else</span>
<a name="l01995"></a>01995                     textAlpha = 0;
<a name="l01996"></a>01996                 end
<a name="l01997"></a>01997                 styles = [styles sprintf(&#39;\t\trect.%s{\n\t\t\tfill:rgb(%d,%d,%d);\n\t\t}\n&#39;, category, r, g, b)];
<a name="l01998"></a>01998                 styles = [styles sprintf(&#39;\t\ttext.%s{\n\t\t\tfill:rgb(%d,%d,%d);\n\t\t}\n&#39;, category, textAlpha, textAlpha, textAlpha)];
<a name="l01999"></a>01999                 
<a name="l02000"></a>02000                 legend = [legend sprintf(&#39;\t\t&lt;g transform=&quot;translate(%f,%f)&quot;&gt;\n&#39;, ...
<a name="l02001"></a>02001                     0, (i-1) * (legendFontSize * 1.5))];
<a name="l02002"></a>02002                 legend = [legend sprintf(&#39;\t\t\t&lt;rect transform=&quot;translate(%f,%f)&quot; width=&quot;%f&quot; height=&quot;%f&quot; class=&quot;%s grid legend&quot; /&gt;\n&#39;, ...
<a name="l02003"></a>02003                     0, 0, legendFontSize, legendFontSize, category)];
<a name="l02004"></a>02004                 legend = [legend sprintf(&#39;\t\t\t&lt;text transform=&quot;translate(%f,%f)&quot; class=&quot;legend&quot;&gt;%s (%d)&lt;/text&gt;\n&#39;, ...
<a name="l02005"></a>02005                     legendFontSize * 1.25, legendFontSize / 2 + 0.4 * legendFontSize, categories{i}, cellCount)];
<a name="l02006"></a>02006                 legend = [legend sprintf(&#39;\t\t&lt;/g&gt;\n&#39;)];
<a name="l02007"></a>02007             end
<a name="l02008"></a>02008             legend = [legend sprintf(&#39;\t&lt;/g&gt;\n&#39;)];
<a name="l02009"></a>02009             
<a name="l02010"></a>02010             %grid lines
<a name="l02011"></a>02011             gridLines = [];
<a name="l02012"></a>02012             gridLines = [gridLines sprintf(&#39;\t&lt;g&gt;\n&#39;)];
<a name="l02013"></a>02013             gridLines = [gridLines sprintf(&#39;\t\t&lt;g&gt;\n&#39;)];
<a name="l02014"></a>02014             <span class="keywordflow">for</span> i = 0:rows
<a name="l02015"></a>02015                 <span class="keywordflow">if</span> i == rows
<a name="l02016"></a>02016                     c = numel(cellIDs) - (rows - 1) * cols;
<a name="l02017"></a>02017                 <span class="keywordflow">else</span>
<a name="l02018"></a>02018                     c = cols;
<a name="l02019"></a>02019                 end
<a name="l02020"></a>02020                 <span class="keywordflow">if</span> i == 0 || i == rows
<a name="l02021"></a>02021                     style = <span class="stringliteral">&#39;outter&#39;</span>;
<a name="l02022"></a>02022                 <span class="keywordflow">else</span>
<a name="l02023"></a>02023                     style = <span class="stringliteral">&#39;inner&#39;</span>;
<a name="l02024"></a>02024                 end
<a name="l02025"></a>02025                 gridLines = [gridLines sprintf(&#39;\t\t\t&lt;line x1=&quot;%f&quot; y1=&quot;%f&quot; x2=&quot;%f&quot; y2=&quot;%f&quot; class=&quot;grid_%s&quot;/&gt;\n&#39;, 0, i * cellHeight, cellWidth * c, i * cellHeight, style)];
<a name="l02026"></a>02026                 <span class="keywordflow">if</span> i == rows - 1 &amp;&amp; rows * cols ~= numel(cellIDs)
<a name="l02027"></a>02027                     c = mod(numel(cellIDs), cols);
<a name="l02028"></a>02028                     gridLines = [gridLines sprintf(&#39;\t\t\t&lt;line x1=&quot;%f&quot; y1=&quot;%f&quot; x2=&quot;%f&quot; y2=&quot;%f&quot; class=&quot;grid_outter&quot;/&gt;\n&#39;, cellWidth * c, i * cellHeight, cellWidth * cols, i * cellHeight)];
<a name="l02029"></a>02029                 end
<a name="l02030"></a>02030             end
<a name="l02031"></a>02031             
<a name="l02032"></a>02032             gridLines = [gridLines sprintf(&#39;\t\t&lt;/g&gt;\n&#39;)];
<a name="l02033"></a>02033             gridLines = [gridLines sprintf(&#39;\t\t&lt;g&gt;\n&#39;)];
<a name="l02034"></a>02034             <span class="keywordflow">for</span> i = 0:cols
<a name="l02035"></a>02035                 <span class="keywordflow">if</span> (rows - 1) * cols + i &gt; numel(cellIDs)
<a name="l02036"></a>02036                     r = rows - 1;
<a name="l02037"></a>02037                 <span class="keywordflow">else</span>
<a name="l02038"></a>02038                     r = rows;
<a name="l02039"></a>02039                 end
<a name="l02040"></a>02040                 <span class="keywordflow">if</span> i == 0 || i == cols
<a name="l02041"></a>02041                     style = <span class="stringliteral">&#39;outter&#39;</span>;
<a name="l02042"></a>02042                 <span class="keywordflow">else</span>
<a name="l02043"></a>02043                     style = <span class="stringliteral">&#39;inner&#39;</span>;
<a name="l02044"></a>02044                 end
<a name="l02045"></a>02045                 gridLines = [gridLines sprintf(&#39;\t\t\t&lt;line x1=&quot;%f&quot; y1=&quot;%f&quot; x2=&quot;%f&quot; y2=&quot;%f&quot; class=&quot;grid_%s&quot;/&gt;\n&#39;, i * cellWidth, 0, i * cellWidth, cellHeight * r, style)];
<a name="l02046"></a>02046                 <span class="keywordflow">if</span> (rows - 1) * cols + i == numel(cellIDs) &amp;&amp; rows * cols ~= numel(cellIDs)
<a name="l02047"></a>02047                     gridLines = [gridLines sprintf(&#39;\t\t\t&lt;line x1=&quot;%f&quot; y1=&quot;%f&quot; x2=&quot;%f&quot; y2=&quot;%f&quot; class=&quot;grid_outter&quot;/&gt;\n&#39;, i * cellWidth, cellHeight * (rows-1), i * cellWidth, cellHeight * rows)];
<a name="l02048"></a>02048                 end
<a name="l02049"></a>02049             end
<a name="l02050"></a>02050             gridLines = [gridLines sprintf(&#39;\t\t&lt;/g&gt;\n&#39;)];
<a name="l02051"></a>02051             gridLines = [gridLines sprintf(&#39;\t&lt;/g&gt;\n&#39;)];
<a name="l02052"></a>02052             
<a name="l02053"></a>02053             %svg
<a name="l02054"></a>02054             svg = [];
<a name="l02055"></a>02055             svg = [svg sprintf(&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&#39;)];
<a name="l02056"></a>02056             svg = [svg sprintf(&#39;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot;\n&#39;)];
<a name="l02057"></a>02057             svg = [svg sprintf(&#39;        viewBox=&quot;-1 -1 %d %d&quot; width=&quot;%d&quot; height=&quot;%d&quot;&gt;\n&#39;, width-1, height-1, width, height)];
<a name="l02058"></a>02058             svg = [svg sprintf(&#39;        &lt;style type=&quot;text/css&quot;&gt;\n&#39;)];
<a name="l02059"></a>02059             svg = [svg sprintf(&#39;                text{\n&#39;)];
<a name="l02060"></a>02060             svg = [svg sprintf(&#39;                        font-family:Helvetica,Helvetica;\n&#39;)];
<a name="l02061"></a>02061             svg = [svg sprintf(&#39;                        fill:rgb(0,0,0);\n&#39;)];
<a name="l02062"></a>02062             svg = [svg sprintf(&#39;                }\n&#39;)];
<a name="l02063"></a>02063             svg = [svg sprintf(&#39;                line.grid_outter{\n&#39;)];
<a name="l02064"></a>02064             svg = [svg sprintf(&#39;                        stroke-width:2px;\n&#39;)];
<a name="l02065"></a>02065             svg = [svg sprintf(&#39;                        stroke:rgb(0,0,0);\n&#39;)];
<a name="l02066"></a>02066             svg = [svg sprintf(&#39;                }\n&#39;)];
<a name="l02067"></a>02067             svg = [svg sprintf(&#39;                line.grid_inner{\n&#39;)];
<a name="l02068"></a>02068             svg = [svg sprintf(&#39;                        stroke-width:0.5px;\n&#39;)];
<a name="l02069"></a>02069             svg = [svg sprintf(&#39;                        stroke:rgb(0,0,0);\n&#39;)];
<a name="l02070"></a>02070             svg = [svg sprintf(&#39;                }\n&#39;)];
<a name="l02071"></a>02071             svg = [svg sprintf(&#39;                text.legend{\n&#39;)];
<a name="l02072"></a>02072             svg = [svg sprintf(&#39;                        font-size:%dpx;\n&#39;, legendFontSize)];
<a name="l02073"></a>02073             svg = [svg sprintf(&#39;                        text-anchor:start;\n&#39;)];
<a name="l02074"></a>02074             svg = [svg sprintf(&#39;                }\n&#39;)];
<a name="l02075"></a>02075             svg = [svg sprintf(&#39;                text.grid{\n&#39;)];
<a name="l02076"></a>02076             svg = [svg sprintf(&#39;                        font-size:%dpx;\n&#39;, gridFontSize)];
<a name="l02077"></a>02077             svg = [svg sprintf(&#39;                        text-anchor:middle;\n&#39;)];
<a name="l02078"></a>02078             svg = [svg sprintf(&#39;                }\n&#39;)];
<a name="l02079"></a>02079             svg = [svg sprintf(&#39;                rect{\n&#39;)];
<a name="l02080"></a>02080             svg = [svg sprintf(&#39;                        fill:none;\n&#39;)];
<a name="l02081"></a>02081             svg = [svg sprintf(&#39;                        stroke-width:0px;\n&#39;)];
<a name="l02082"></a>02082             svg = [svg sprintf(&#39;                        stroke:none;\n&#39;)];
<a name="l02083"></a>02083             svg = [svg sprintf(&#39;                }\n&#39;)];
<a name="l02084"></a>02084             svg = [svg sprintf(&#39;                rect.legend{\n&#39;)];
<a name="l02085"></a>02085             svg = [svg sprintf(&#39;                        stroke-width:2px;\n&#39;)];
<a name="l02086"></a>02086             svg = [svg sprintf(&#39;                        stroke:rgb(0,0,0);\n&#39;)];
<a name="l02087"></a>02087             svg = [svg sprintf(&#39;                }\n&#39;)];
<a name="l02088"></a>02088             svg = [svg sprintf(&#39;%s\n&#39;, styles)];
<a name="l02089"></a>02089             svg = [svg sprintf(&#39;        &lt;/style&gt;\n\n&#39;)];
<a name="l02090"></a>02090             svg = [svg sprintf(&#39;&lt;!-- Grid --&gt;\n&#39;)];
<a name="l02091"></a>02091             svg = [svg sprintf(&#39;%s\n\n&#39;, grid)];
<a name="l02092"></a>02092             svg = [svg sprintf(&#39;&lt;!-- Grid lines --&gt;\n&#39;)];
<a name="l02093"></a>02093             svg = [svg sprintf(&#39;%s\n\n&#39;, gridLines)];
<a name="l02094"></a>02094             svg = [svg sprintf(&#39;&lt;!-- Legend --&gt;\n&#39;)];
<a name="l02095"></a>02095             svg = [svg sprintf(&#39;%s\n\n&#39;, legend)];
<a name="l02096"></a>02096             svg = [svg sprintf(&#39;&lt;/svg&gt;\n&#39;)];
<a name="l02097"></a>02097         end
<a name="l02098"></a>02098     end
<a name="l02099"></a>02099     
<a name="l02100"></a>02100     %overview of each single gene deletion strain
<a name="l02101"></a>02101     methods (Static)
<a name="l02102"></a>02102         function [data, simMetaData, validSims] = getSimulationData(sim, simMetaData)
<a name="l02103"></a>02103             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l02104"></a>02104             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l02105"></a>02105             import edu.stanford.covert.cell.sim.util.SimulationEnsemble;
<a name="l02106"></a>02106             import edu.stanford.covert.cell.sim.util.SummaryLogger;
<a name="l02107"></a>02107             
<a name="l02108"></a>02108             nSims = numel(simMetaData);
<a name="l02109"></a>02109             simEndTimes = [simMetaData.lengthSec]&#39;;
<a name="l02110"></a>02110             simBatchIDs = {simMetaData.simGroup}<span class="stringliteral">&#39;;</span>
<a name="l02111"></a>02111 <span class="stringliteral">            simBatchIdxs = [simMetaData.simIdx]&#39;</span>;
<a name="l02112"></a>02112             
<a name="l02113"></a>02113             termOrgIdxs = [
<a name="l02114"></a>02114                 sim.compartment.terminalOrganelleCytosolIndexs
<a name="l02115"></a>02115                 sim.compartment.terminalOrganelleMembraneIndexs
<a name="l02116"></a>02116                 ];
<a name="l02117"></a>02117             
<a name="l02118"></a>02118             %% <span class="keyword">get</span> data
<a name="l02119"></a>02119             nTimePoints = max(simEndTimes)+1;
<a name="l02120"></a>02120             time = (0:nTimePoints-1)&#39; / 3600;
<a name="l02121"></a>02121             
<a name="l02122"></a>02122             ensembleStateNames = {
<a name="l02123"></a>02123                 <span class="stringliteral">&#39;mass&#39;</span>
<a name="l02124"></a>02124                 <span class="stringliteral">&#39;growth_rate&#39;</span>
<a name="l02125"></a>02125                 <span class="stringliteral">&#39;ploidy&#39;</span>
<a name="l02126"></a>02126                 <span class="stringliteral">&#39;superhelicity&#39;</span>
<a name="l02127"></a>02127                 <span class="stringliteral">&#39;dntps&#39;</span>
<a name="l02128"></a>02128                 <span class="stringliteral">&#39;ntps&#39;</span>
<a name="l02129"></a>02129                 <span class="stringliteral">&#39;amino_acids&#39;</span>
<a name="l02130"></a>02130                 <span class="stringliteral">&#39;antibiotics&#39;</span>
<a name="l02131"></a>02131                 <span class="stringliteral">&#39;mrnas&#39;</span>
<a name="l02132"></a>02132                 <span class="stringliteral">&#39;rrnas&#39;</span>
<a name="l02133"></a>02133                 <span class="stringliteral">&#39;srnas&#39;</span>
<a name="l02134"></a>02134                 <span class="stringliteral">&#39;trnas&#39;</span>
<a name="l02135"></a>02135                 <span class="stringliteral">&#39;matureMonomers&#39;</span>
<a name="l02136"></a>02136                 <span class="stringliteral">&#39;matureComplexs&#39;</span>
<a name="l02137"></a>02137                 <span class="stringliteral">&#39;damagedRnas&#39;</span>
<a name="l02138"></a>02138                 <span class="stringliteral">&#39;damagedProteins&#39;</span>
<a name="l02139"></a>02139                 <span class="stringliteral">&#39;atpUsage&#39;</span>
<a name="l02140"></a>02140                 <span class="stringliteral">&#39;gtpUsage&#39;</span>
<a name="l02141"></a>02141                 <span class="stringliteral">&#39;atpProduction&#39;</span>
<a name="l02142"></a>02142                 <span class="stringliteral">&#39;gtpProduction&#39;</span>
<a name="l02143"></a>02143                 <span class="stringliteral">&#39;pinchedDiameter&#39;</span>
<a name="l02144"></a>02144                 };
<a name="l02145"></a>02145             
<a name="l02146"></a>02146             stateNames = {
<a name="l02147"></a>02147                 <span class="stringliteral">&#39;Mass&#39;</span> <span class="stringliteral">&#39;cell&#39;</span>       <span class="charliteral">&#39;:&#39;</span>  <span class="charliteral">&#39;:&#39;</span>
<a name="l02148"></a>02148                 <span class="stringliteral">&#39;Mass&#39;</span> <span class="stringliteral">&#39;dnaWt&#39;</span>      <span class="charliteral">&#39;:&#39;</span>  <span class="stringliteral">&#39;-sum&#39;</span>
<a name="l02149"></a>02149                 <span class="stringliteral">&#39;Mass&#39;</span> <span class="stringliteral">&#39;rnaWt&#39;</span>      <span class="charliteral">&#39;:&#39;</span>  <span class="stringliteral">&#39;-sum&#39;</span>
<a name="l02150"></a>02150                 <span class="stringliteral">&#39;Mass&#39;</span> <span class="stringliteral">&#39;proteinWt&#39;</span>  <span class="charliteral">&#39;:&#39;</span>  <span class="stringliteral">&#39;-sum&#39;</span>
<a name="l02151"></a>02151                 <span class="stringliteral">&#39;Geometry&#39;</span> <span class="stringliteral">&#39;totalLength&#39;</span> <span class="charliteral">&#39;:&#39;</span> <span class="charliteral">&#39;:&#39;</span>
<a name="l02152"></a>02152                 <span class="stringliteral">&#39;Host&#39;</span> <span class="stringliteral">&#39;isBacteriumAdherent&#39;</span> <span class="charliteral">&#39;:&#39;</span> <span class="charliteral">&#39;:&#39;</span>
<a name="l02153"></a>02153                 };
<a name="l02154"></a>02154             
<a name="l02155"></a>02155             mass = NaN(nTimePoints, nSims);
<a name="l02156"></a>02156             growth = NaN(nTimePoints, nSims);
<a name="l02157"></a>02157             atpUsage = NaN(nTimePoints, nSims);
<a name="l02158"></a>02158             gtpUsage = NaN(nTimePoints, nSims);
<a name="l02159"></a>02159             atpProduction = NaN(nTimePoints, nSims);
<a name="l02160"></a>02160             gtpProduction = NaN(nTimePoints, nSims);
<a name="l02161"></a>02161             ploidy = NaN(nTimePoints, nSims);
<a name="l02162"></a>02162             superhelicalDensity = NaN(nTimePoints, nSims);
<a name="l02163"></a>02163             rnas = NaN(nTimePoints, nSims);
<a name="l02164"></a>02164             prots = NaN(nTimePoints, nSims);
<a name="l02165"></a>02165             dntps = NaN(nTimePoints, nSims);
<a name="l02166"></a>02166             ntps = NaN(nTimePoints, nSims);
<a name="l02167"></a>02167             aminoAcids = NaN(nTimePoints, nSims);
<a name="l02168"></a>02168             damagedRnas = NaN(nTimePoints, nSims);
<a name="l02169"></a>02169             damagedProteins = NaN(nTimePoints, nSims);
<a name="l02170"></a>02170             antibiotics = NaN(nTimePoints, nSims);
<a name="l02171"></a>02171             repInitDuration = NaN(1, nSims);
<a name="l02172"></a>02172             repDuration = NaN(1, nSims);
<a name="l02173"></a>02173             cytokinesisDuration = NaN(1, nSims);
<a name="l02174"></a>02174             massDoublingDuration = NaN(1, nSims);
<a name="l02175"></a>02175             cellCycleDuration = NaN(1, nSims);
<a name="l02176"></a>02176             cellWt = NaN(nTimePoints, nSims);
<a name="l02177"></a>02177             dnaWt = NaN(nTimePoints, nSims);
<a name="l02178"></a>02178             rnaWt = NaN(nTimePoints, nSims);
<a name="l02179"></a>02179             proteinWt = NaN(nTimePoints, nSims);
<a name="l02180"></a>02180             terminalOrganelleWt = NaN(nTimePoints, nSims);
<a name="l02181"></a>02181             pinchedDiameter = NaN(nTimePoints, nSims);
<a name="l02182"></a>02182             totalLength = NaN(nTimePoints, nSims);
<a name="l02183"></a>02183             isBacteriumAdherent = NaN(nTimePoints, nSims);
<a name="l02184"></a>02184             
<a name="l02185"></a>02185             validSims = <span class="keyword">false</span>(nSims, 1);
<a name="l02186"></a>02186             <span class="keywordflow">for</span> i = 1:nSims
<a name="l02187"></a>02187                 <span class="keywordflow">try</span>
<a name="l02188"></a>02188                     %summary statistics
<a name="l02189"></a>02189                     simStats = SummaryLogger.getSimulationStatistics([SimulationDiskUtil.getBaseDir() filesep simBatchIDs{i}], simBatchIdxs(i)) / 3600;
<a name="l02190"></a>02190                     repInitDuration(i) = simStats(SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME);
<a name="l02191"></a>02191                     repDuration(i) = simStats(SummaryLogger.SIM_STATUS_INDEX_REP_TIME) - simStats(SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME);
<a name="l02192"></a>02192                     cytokinesisDuration(i) = simStats(SummaryLogger.SIM_STATUS_INDEX_CYTOKINESIS_TIME) - simStats(SummaryLogger.SIM_STATUS_INDEX_REP_TIME);
<a name="l02193"></a>02193                     massDoublingDuration(i) = simStats(SummaryLogger.SIM_STATUS_INDEX_MASS_DOUBLING_TIME);
<a name="l02194"></a>02194                     cellCycleDuration(i) = simStats(SummaryLogger.SIM_STATUS_INDEX_CYTOKINESIS_TIME);
<a name="l02195"></a>02195                     
<a name="l02196"></a>02196                     clear simStats;
<a name="l02197"></a>02197                     
<a name="l02198"></a>02198                     %summary data
<a name="l02199"></a>02199                     ensemble = SimulationEnsemble(simBatchIDs{i}, ensembleStateNames, [], simBatchIdxs(i));
<a name="l02200"></a>02200                     dt = ensemble.stateData.downsampleStepSec;
<a name="l02201"></a>02201                     timeIdxs = 1:dt:dt * floor(simEndTimes(i) / dt) + 1;
<a name="l02202"></a>02202                     <span class="keywordflow">if</span> timeIdxs(end) ~= simEndTimes(i)+1
<a name="l02203"></a>02203                         timeIdxs = [timeIdxs  simEndTimes(i)+1];
<a name="l02204"></a>02204                     end
<a name="l02205"></a>02205                     <span class="keywordflow">if</span> ensemble.stateData.time(end) &gt; simEndTimes(i)
<a name="l02206"></a>02206                         time = (0:ensemble.stateData.time(end))&#39; / 3600;
<a name="l02207"></a>02207                     end
<a name="l02208"></a>02208                     mass(timeIdxs, i) = permute(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;mass&#39;), :, :), [3 1 2]);
<a name="l02209"></a>02209                     growth(timeIdxs, i) = permute(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;growth_rate&#39;), :, :), [3 1 2]);
<a name="l02210"></a>02210                     ploidy(timeIdxs, i) = permute(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;ploidy&#39;), :, :), [3 1 2]);
<a name="l02211"></a>02211                     superhelicalDensity(timeIdxs, i) = permute(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;superhelicity&#39;), :, :), [3 1 2]);
<a name="l02212"></a>02212                     dntps(timeIdxs, i) = permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;dntps&#39;), :, :), 1), [3 1 2]);
<a name="l02213"></a>02213                     ntps(timeIdxs, i) = permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;ntps&#39;), :, :), 1), [3 1 2]);
<a name="l02214"></a>02214                     aminoAcids(timeIdxs, i) = permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;amino_acids&#39;), :, :), 1), [3 1 2]);
<a name="l02215"></a>02215                     antibiotics(timeIdxs, i) = permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;antibiotics&#39;), :, :), 1), [3 1 2]);
<a name="l02216"></a>02216                     damagedRnas(timeIdxs, i) = permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;damagedRnas&#39;), :, :), 1), [3 1 2]);
<a name="l02217"></a>02217                     damagedProteins(timeIdxs, i) = permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;damagedProteins&#39;), :, :), 1), [3 1 2]);
<a name="l02218"></a>02218                     rnas(timeIdxs, i) = ...
<a name="l02219"></a>02219                         + permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;mrnas&#39;), :, :), 1), [3 1 2]) ...
<a name="l02220"></a>02220                         + permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;rrnas&#39;), :, :), 1), [3 1 2]) ...
<a name="l02221"></a>02221                         + permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;srnas&#39;), :, :), 1), [3 1 2]) ...
<a name="l02222"></a>02222                         + permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;trnas&#39;), :, :), 1), [3 1 2]);
<a name="l02223"></a>02223                     prots(timeIdxs, i) = ...
<a name="l02224"></a>02224                         + permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;matureMonomers&#39;), :, :), 1), [3 1 2]) ...
<a name="l02225"></a>02225                         + permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;matureComplexs&#39;), :, :), 1), [3 1 2]);
<a name="l02226"></a>02226                     atpUsage(timeIdxs, i) = permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;atpUsage&#39;), :, :), 1), [3 1 2]);
<a name="l02227"></a>02227                     gtpUsage(timeIdxs, i) = permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;gtpUsage&#39;), :, :), 1), [3 1 2]);
<a name="l02228"></a>02228                     atpProduction(timeIdxs, i) = permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;atpProduction&#39;), :, :), 1), [3 1 2]);
<a name="l02229"></a>02229                     gtpProduction(timeIdxs, i) = permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;gtpProduction&#39;), :, :), 1), [3 1 2]);
<a name="l02230"></a>02230                     pinchedDiameter(timeIdxs, i) = permute(sum(ensemble.stateData.values(ensemble.getPropertyIndices(&#39;pinchedDiameter&#39;), :, :), 1), [3 1 2]);
<a name="l02231"></a>02231                     
<a name="l02232"></a>02232                     clear ensemble;
<a name="l02233"></a>02233                     
<a name="l02234"></a>02234                     states = SimulationEnsemble.load(simBatchIDs{i}, stateNames, [], [], 1, <span class="stringliteral">&#39;extract&#39;</span>, simBatchIdxs(i));
<a name="l02235"></a>02235                     
<a name="l02236"></a>02236                     cellWt(2:simEndTimes(i)+1, i) = permute(sum(states.Mass.cell, 2), [3 1 2]);
<a name="l02237"></a>02237                     dnaWt(2:simEndTimes(i)+1, i) = permute(states.Mass.dnaWt, [3 1 2]);
<a name="l02238"></a>02238                     rnaWt(2:simEndTimes(i)+1, i) = permute(states.Mass.rnaWt, [3 1 2]);
<a name="l02239"></a>02239                     proteinWt(2:simEndTimes(i)+1, i) = permute(states.Mass.proteinWt, [3 1 2]);
<a name="l02240"></a>02240                     terminalOrganelleWt(2:simEndTimes(i)+1, i) = permute(sum(states.Mass.cell(:, termOrgIdxs, :), 2), [3 1 2]);
<a name="l02241"></a>02241                     totalLength(2:simEndTimes(i)+1, i) = permute(states.Geometry.totalLength, [3 1 2]);
<a name="l02242"></a>02242                     isBacteriumAdherent(2:simEndTimes(i)+1, i) = permute(states.Host.isBacteriumAdherent, [3 1 2]);
<a name="l02243"></a>02243                     
<a name="l02244"></a>02244                     clear states;
<a name="l02245"></a>02245                     
<a name="l02246"></a>02246                     validSims(i) = <span class="keyword">true</span>;
<a name="l02247"></a>02247                 <span class="keywordflow">catch</span> exception
<a name="l02248"></a>02248                     <span class="keywordflow">if</span> exist(<span class="stringliteral">&#39;simStats&#39;</span>, <span class="stringliteral">&#39;var&#39;</span>)
<a name="l02249"></a>02249                         clear simStats;
<a name="l02250"></a>02250                     end
<a name="l02251"></a>02251                     if exist(&#39;ensemble&#39;, &#39;var&#39;)
<a name="l02252"></a>02252                         clear ensemble;
<a name="l02253"></a>02253                     end
<a name="l02254"></a>02254                     warning(&#39;WholeCell:warning:loadSingleGeneDeletion&#39;, &#39;Unable to read simulation %s:%d\n%s&#39;, simBatchIDs{i}, simBatchIdxs(i), exception.getReport());
<a name="l02255"></a>02255                 end
<a name="l02256"></a>02256             end
<a name="l02257"></a>02257             
<a name="l02258"></a>02258             <span class="keywordflow">if</span> nSims &gt; 0 &amp;&amp; ~any(validSims)
<a name="l02259"></a>02259                 exception.addCause(MException(&#39;SingleGeneDeletions:error&#39;, &#39;No valid Simulations&#39;)).rethrow();
<a name="l02260"></a>02260             end
<a name="l02261"></a>02261             
<a name="l02262"></a>02262             simEndTimes = simEndTimes(validSims, :);
<a name="l02263"></a>02263             mass = mass(:, validSims);
<a name="l02264"></a>02264             growth = growth(:, validSims);
<a name="l02265"></a>02265             atpUsage = atpUsage(:, validSims);
<a name="l02266"></a>02266             gtpUsage = gtpUsage(:, validSims);
<a name="l02267"></a>02267             atpProduction = atpProduction(:, validSims);
<a name="l02268"></a>02268             gtpProduction = gtpProduction(:, validSims);
<a name="l02269"></a>02269             ploidy = ploidy(:, validSims);
<a name="l02270"></a>02270             superhelicalDensity = superhelicalDensity(:, validSims);
<a name="l02271"></a>02271             rnas = rnas(:, validSims);
<a name="l02272"></a>02272             prots = prots(:, validSims);
<a name="l02273"></a>02273             dntps = dntps(:, validSims);
<a name="l02274"></a>02274             ntps = ntps(:, validSims);
<a name="l02275"></a>02275             aminoAcids = aminoAcids(:, validSims);
<a name="l02276"></a>02276             damagedRnas = damagedRnas(:, validSims);
<a name="l02277"></a>02277             damagedProteins = damagedProteins(:, validSims);
<a name="l02278"></a>02278             antibiotics = antibiotics(:, validSims);
<a name="l02279"></a>02279             repInitDuration = repInitDuration(:, validSims);
<a name="l02280"></a>02280             repDuration = repDuration(:, validSims);
<a name="l02281"></a>02281             cytokinesisDuration = cytokinesisDuration(:, validSims);
<a name="l02282"></a>02282             massDoublingDuration = massDoublingDuration(:, validSims);
<a name="l02283"></a>02283             cellCycleDuration = cellCycleDuration(:, validSims);
<a name="l02284"></a>02284             cellWt = cellWt(:, validSims);
<a name="l02285"></a>02285             dnaWt = dnaWt(:, validSims);
<a name="l02286"></a>02286             rnaWt = rnaWt(:, validSims);
<a name="l02287"></a>02287             proteinWt = proteinWt(:, validSims);
<a name="l02288"></a>02288             terminalOrganelleWt = terminalOrganelleWt(:, validSims);
<a name="l02289"></a>02289             pinchedDiameter = pinchedDiameter(:, validSims);
<a name="l02290"></a>02290             totalLength = totalLength(:, validSims);
<a name="l02291"></a>02291             isBacteriumAdherent = isBacteriumAdherent(:, validSims);
<a name="l02292"></a>02292             
<a name="l02293"></a>02293             mass = mass * sim.state(&#39;Mass&#39;).cellInitialDryWeight / (1 - sim.state(&#39;Mass&#39;).fractionWetWeight) * 1e15;
<a name="l02294"></a>02294             growth = growth * 3600 * sim.state(&#39;Mass&#39;).cellInitialDryWeight / (1 - sim.state(&#39;Mass&#39;).fractionWetWeight) * 1e15;
<a name="l02295"></a>02295             
<a name="l02296"></a>02296             %% figure data
<a name="l02297"></a>02297             data = struct;
<a name="l02298"></a>02298             data.simEndTimes = simEndTimes;
<a name="l02299"></a>02299             data.time = time;
<a name="l02300"></a>02300             data.mass = mass;
<a name="l02301"></a>02301             data.growth = growth;
<a name="l02302"></a>02302             data.atpUsage = atpUsage;
<a name="l02303"></a>02303             data.gtpUsage = gtpUsage;
<a name="l02304"></a>02304             data.atpProduction = atpProduction;
<a name="l02305"></a>02305             data.gtpProduction = gtpProduction;
<a name="l02306"></a>02306             data.ploidy = ploidy;
<a name="l02307"></a>02307             data.superhelicalDensity = superhelicalDensity;
<a name="l02308"></a>02308             data.rnas = rnas;
<a name="l02309"></a>02309             data.prots = prots;
<a name="l02310"></a>02310             data.dntps = dntps;
<a name="l02311"></a>02311             data.ntps = ntps;
<a name="l02312"></a>02312             data.aminoAcids = aminoAcids;
<a name="l02313"></a>02313             data.damagedRnas = damagedRnas;
<a name="l02314"></a>02314             data.damagedProteins = damagedProteins;
<a name="l02315"></a>02315             data.antibiotics = antibiotics;
<a name="l02316"></a>02316             data.repInitDuration = repInitDuration;
<a name="l02317"></a>02317             data.repDuration = repDuration;
<a name="l02318"></a>02318             data.cytokinesisDuration = cytokinesisDuration;
<a name="l02319"></a>02319             data.massDoublingDuration = massDoublingDuration;
<a name="l02320"></a>02320             data.cellCycleDuration = cellCycleDuration;
<a name="l02321"></a>02321             data.cellWt = cellWt;
<a name="l02322"></a>02322             data.dnaWt = dnaWt;
<a name="l02323"></a>02323             data.rnaWt = rnaWt;
<a name="l02324"></a>02324             data.proteinWt = proteinWt;
<a name="l02325"></a>02325             data.terminalOrganelleWt = terminalOrganelleWt;
<a name="l02326"></a>02326             data.pinchedDiameter = pinchedDiameter;
<a name="l02327"></a>02327             data.totalLength = totalLength;
<a name="l02328"></a>02328             data.isBacteriumAdherent = isBacteriumAdherent;
<a name="l02329"></a>02329         end
<a name="l02330"></a>02330         
<a name="l02331"></a>02331         function nPlots = plotSingleGeneDeletion(data, classes, classLabels, plotRepresentativeCell, figHandle, plotIdx, colors)
<a name="l02332"></a>02332             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l02333"></a>02333             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l02334"></a>02334             
<a name="l02335"></a>02335             if nargin &lt; 7
<a name="l02336"></a>02336                 colors = SingleGeneDeletions.COLORS;
<a name="l02337"></a>02337             end
<a name="l02338"></a>02338             
<a name="l02339"></a>02339             maxTime = NaN;
<a name="l02340"></a>02340             for i = 1:numel(data)
<a name="l02341"></a>02341                 maxTime = max(maxTime, data{i}.time(end));
<a name="l02342"></a>02342             end
<a name="l02343"></a>02343             
<a name="l02344"></a>02344             growthDataNamesFields = {
<a name="l02345"></a>02345                 <span class="stringliteral">&#39;mass&#39;</span>                 {<span class="stringliteral">&#39;Mass&#39;</span> <span class="stringliteral">&#39;(fg)&#39;</span>}
<a name="l02346"></a>02346                 <span class="stringliteral">&#39;growth&#39;</span>               {<span class="stringliteral">&#39;Growth&#39;</span> <span class="stringliteral">&#39;(fg h^{-1})&#39;</span>}
<a name="l02347"></a>02347                 <span class="stringliteral">&#39;atpUsage&#39;</span>             {<span class="stringliteral">&#39;ATP&#39;</span> <span class="stringliteral">&#39;Usage&#39;</span>}
<a name="l02348"></a>02348                 <span class="stringliteral">&#39;gtpUsage&#39;</span>             {<span class="stringliteral">&#39;GTP&#39;</span> <span class="stringliteral">&#39;Usage&#39;</span>}
<a name="l02349"></a>02349                 <span class="stringliteral">&#39;ploidy&#39;</span>               {<span class="stringliteral">&#39;Chr&#39;</span> <span class="stringliteral">&#39;Copy No&#39;</span>}
<a name="l02350"></a>02350                 <span class="stringliteral">&#39;superhelicalDensity&#39;</span>  {<span class="stringliteral">&#39;Super-&#39;</span> <span class="stringliteral">&#39;helicity&#39;</span>}
<a name="l02351"></a>02351                 <span class="stringliteral">&#39;rnas&#39;</span>                 <span class="stringliteral">&#39;RNA&#39;</span>
<a name="l02352"></a>02352                 <span class="stringliteral">&#39;prots&#39;</span>                <span class="stringliteral">&#39;Protein&#39;</span>
<a name="l02353"></a>02353                 };
<a name="l02354"></a>02354             toxicDataNamesFields = {
<a name="l02355"></a>02355                 <span class="stringliteral">&#39;dntps&#39;</span>            <span class="stringliteral">&#39;dNTP&#39;</span>
<a name="l02356"></a>02356                 <span class="stringliteral">&#39;ntps&#39;</span>             <span class="stringliteral">&#39;NTP&#39;</span>
<a name="l02357"></a>02357                 <span class="stringliteral">&#39;aminoAcids&#39;</span>       {<span class="stringliteral">&#39;Amino&#39;</span> <span class="stringliteral">&#39;Acid&#39;</span>}
<a name="l02358"></a>02358                 <span class="stringliteral">&#39;damagedRnas&#39;</span>      {<span class="stringliteral">&#39;Damaged&#39;</span> <span class="stringliteral">&#39;RNA&#39;</span>}
<a name="l02359"></a>02359                 <span class="stringliteral">&#39;damagedProteins&#39;</span>  {<span class="stringliteral">&#39;Damaged&#39;</span> <span class="stringliteral">&#39;Protein&#39;</span>}
<a name="l02360"></a>02360                 <span class="stringliteral">&#39;antibiotics&#39;</span>      <span class="stringliteral">&#39;Antibiotics&#39;</span>
<a name="l02361"></a>02361                 };
<a name="l02362"></a>02362             phaseDataNamesFields = {
<a name="l02363"></a>02363                 <span class="stringliteral">&#39;repInitDuration&#39;</span>       {<span class="stringliteral">&#39;Replication&#39;</span> <span class="stringliteral">&#39;Initiation&#39;</span>}
<a name="l02364"></a>02364                 <span class="stringliteral">&#39;repDuration&#39;</span>           <span class="stringliteral">&#39;Replication&#39;</span>
<a name="l02365"></a>02365                 <span class="stringliteral">&#39;cytokinesisDuration&#39;</span>   <span class="stringliteral">&#39;Cytokinesis&#39;</span>
<a name="l02366"></a>02366                 <span class="stringliteral">&#39;massDoublingDuration&#39;</span>  <span class="stringliteral">&#39;Growth&#39;</span>
<a name="l02367"></a>02367                 <span class="stringliteral">&#39;cellCycleDuration&#39;</span>     <span class="stringliteral">&#39;Cell Cycle&#39;</span>
<a name="l02368"></a>02368                 };
<a name="l02369"></a>02369             
<a name="l02370"></a>02370             <span class="keywordflow">if</span> nargin &gt;= 6 &amp;&amp; ~isempty(plotIdx)
<a name="l02371"></a>02371                 for i = 1:size(growthDataNamesFields, 1)
<a name="l02372"></a>02372                     if iscell(growthDataNamesFields{i, 2})
<a name="l02373"></a>02373                         growthDataNamesFields{i, 2} = strjoin(<span class="charliteral">&#39; &#39;</span>, growthDataNamesFields{i, 2}{:});
<a name="l02374"></a>02374                     end
<a name="l02375"></a>02375                 end
<a name="l02376"></a>02376                 <span class="keywordflow">for</span> i = 1:size(toxicDataNamesFields, 1)
<a name="l02377"></a>02377                     if iscell(toxicDataNamesFields{i, 2})
<a name="l02378"></a>02378                         toxicDataNamesFields{i, 2} = strjoin(<span class="charliteral">&#39; &#39;</span>, toxicDataNamesFields{i, 2}{:});
<a name="l02379"></a>02379                     end
<a name="l02380"></a>02380                 end
<a name="l02381"></a>02381                 <span class="keywordflow">for</span> i = 1:size(phaseDataNamesFields, 1)
<a name="l02382"></a>02382                     if iscell(phaseDataNamesFields{i, 2})
<a name="l02383"></a>02383                         phaseDataNamesFields{i, 2} = strjoin(<span class="charliteral">&#39; &#39;</span>, phaseDataNamesFields{i, 2}{:});
<a name="l02384"></a>02384                     end
<a name="l02385"></a>02385                 end
<a name="l02386"></a>02386             end
<a name="l02387"></a>02387             
<a name="l02388"></a>02388             nPlots = ...
<a name="l02389"></a>02389                 + size(growthDataNamesFields, 1) ...
<a name="l02390"></a>02390                 + size(toxicDataNamesFields, 1) ...
<a name="l02391"></a>02391                 + size(phaseDataNamesFields, 1);
<a name="l02392"></a>02392             
<a name="l02393"></a>02393             
<a name="l02394"></a>02394             %% plot data
<a name="l02395"></a>02395             clf(figHandle);
<a name="l02396"></a>02396             <span class="keywordflow">if</span> nargin &gt;= 6 &amp;&amp; ~isempty(plotIdx)
<a name="l02397"></a>02397                 if plotIdx &lt;= size(growthDataNamesFields, 1) + size(toxicDataNamesFields, 1)
<a name="l02398"></a>02398                     [axesHandles, xAxesHandles] = PlotUtil.multiElementPlot(figHandle, {50; 50}, [0 maxTime], <span class="keyword">struct</span>(...
<a name="l02399"></a>02399                         <span class="stringliteral">&#39;colWidths&#39;</span>, [2.4 0.5], <span class="stringliteral">&#39;yAxesLabelWidths&#39;</span>, [0.14 0.01], <span class="stringliteral">&#39;position&#39;</span>, [0.02 0.32 0.95 0.6]));
<a name="l02400"></a>02400                     <span class="keyword">delete</span>(xAxesHandles{2});
<a name="l02401"></a>02401                 <span class="keywordflow">else</span>
<a name="l02402"></a>02402                     [axesHandles, xAxesHandles] = PlotUtil.multiElementPlot(figHandle, {50}, [0 maxTime], <span class="keyword">struct</span>(...
<a name="l02403"></a>02403                         <span class="stringliteral">&#39;yAxesLabelWidths&#39;</span>, 0.09, <span class="stringliteral">&#39;position&#39;</span>, [0.02 0.32 0.95 0.6]));
<a name="l02404"></a>02404                 end
<a name="l02405"></a>02405             <span class="keywordflow">else</span>
<a name="l02406"></a>02406                 axesSizes = {
<a name="l02407"></a>02407                     5 * ones(8, 1);   5 * ones(8, 1);
<a name="l02408"></a>02408                     5 * ones(6, 1);   5 * ones(6, 1);
<a name="l02409"></a>02409                     5 * ones(5, 1);
<a name="l02410"></a>02410                     };
<a name="l02411"></a>02411                 [axesHandles, xAxesHandles] = PlotUtil.multiElementPlot(figHandle, axesSizes, [0 maxTime], <span class="keyword">struct</span>(...
<a name="l02412"></a>02412                     <span class="stringliteral">&#39;colWidths&#39;</span>, [2.4 0.5 2.4 0.5 2], <span class="stringliteral">&#39;yAxesLabelWidths&#39;</span>, [0.14 0.01 0.14 0.01 0.09], <span class="stringliteral">&#39;position&#39;</span>, [0.02 0.32 0.95 0.6]));
<a name="l02413"></a>02413                 <span class="keyword">delete</span>(xAxesHandles{2});
<a name="l02414"></a>02414                 <span class="keyword">delete</span>(xAxesHandles{4});
<a name="l02415"></a>02415             end
<a name="l02416"></a>02416             
<a name="l02417"></a>02417             %% growth
<a name="l02418"></a>02418             <span class="keywordflow">if</span> nargin &gt;= 6 &amp;&amp; ~isempty(plotIdx) &amp;&amp; plotIdx &lt;= size(growthDataNamesFields, 1)
<a name="l02419"></a>02419                 SingleGeneDeletions.plotSingleGeneDeletionTemporalDynamics(...
<a name="l02420"></a>02420                     axesHandles{1}, axesHandles{2}, data, classes, classLabels, ...
<a name="l02421"></a>02421                     plotRepresentativeCell, growthDataNamesFields{plotIdx, :}, colors);
<a name="l02422"></a>02422             elseif nargin &lt; 6 || isempty(plotIdx)
<a name="l02423"></a>02423                 for i = 1:size(growthDataNamesFields, 1)
<a name="l02424"></a>02424                     SingleGeneDeletions.plotSingleGeneDeletionTemporalDynamics(...
<a name="l02425"></a>02425                         axesHandles{1}(i), axesHandles{2}(i), data, classes, classLabels, ...
<a name="l02426"></a>02426                         plotRepresentativeCell, growthDataNamesFields{i, :}, colors);
<a name="l02427"></a>02427                 end
<a name="l02428"></a>02428             end
<a name="l02429"></a>02429             
<a name="l02430"></a>02430             %% toxic build up
<a name="l02431"></a>02431             <span class="keywordflow">if</span> nargin &gt;= 6 &amp;&amp; ~isempty(plotIdx) &amp;&amp; plotIdx &gt; size(growthDataNamesFields, 1) &amp;&amp; plotIdx &lt;= size(growthDataNamesFields, 1) + size(toxicDataNamesFields, 1)
<a name="l02432"></a>02432                 tmp = plotIdx - size(growthDataNamesFields, 1);
<a name="l02433"></a>02433                 SingleGeneDeletions.plotSingleGeneDeletionTemporalDynamics(...
<a name="l02434"></a>02434                     axesHandles{1}, axesHandles{2}, data, classes, classLabels, ...
<a name="l02435"></a>02435                     plotRepresentativeCell, toxicDataNamesFields{tmp, :}, colors);
<a name="l02436"></a>02436             elseif nargin &lt; 6 || isempty(plotIdx)
<a name="l02437"></a>02437                 for i = 1:size(toxicDataNamesFields, 1)
<a name="l02438"></a>02438                     SingleGeneDeletions.plotSingleGeneDeletionTemporalDynamics(...
<a name="l02439"></a>02439                         axesHandles{3}(i), axesHandles{4}(i), data, classes, classLabels, ...
<a name="l02440"></a>02440                         plotRepresentativeCell, toxicDataNamesFields{i, :}, colors);
<a name="l02441"></a>02441                 end
<a name="l02442"></a>02442             end
<a name="l02443"></a>02443             
<a name="l02444"></a>02444             %% cell cycle phase durations
<a name="l02445"></a>02445             <span class="keywordflow">if</span> nargin &gt;= 6 &amp;&amp; ~isempty(plotIdx) &amp;&amp; plotIdx &gt; (size(growthDataNamesFields, 1) + size(toxicDataNamesFields, 1))
<a name="l02446"></a>02446                 tmp = plotIdx - size(growthDataNamesFields, 1) - size(toxicDataNamesFields, 1);
<a name="l02447"></a>02447                 SingleGeneDeletions.plotSingleGeneDeletionCellCyclePhaseHistogram(...
<a name="l02448"></a>02448                     axesHandles{1}, data, classes, classLabels, phaseDataNamesFields{tmp, :}, colors);
<a name="l02449"></a>02449             elseif nargin &lt; 6 || isempty(plotIdx)
<a name="l02450"></a>02450                 for i = 1:size(phaseDataNamesFields, 1)
<a name="l02451"></a>02451                     SingleGeneDeletions.plotSingleGeneDeletionCellCyclePhaseHistogram(...
<a name="l02452"></a>02452                         axesHandles{5}(i), data, classes, classLabels, phaseDataNamesFields{i, :}, colors);
<a name="l02453"></a>02453                 end
<a name="l02454"></a>02454             end
<a name="l02455"></a>02455             
<a name="l02456"></a>02456             %% formatting
<a name="l02457"></a>02457             tmp = [];
<a name="l02458"></a>02458             tmp2 = [];
<a name="l02459"></a>02459             <span class="keywordflow">for</span> i = 1:2:numel(axesHandles)
<a name="l02460"></a>02460                 tmp = [tmp; axesHandles{i}];
<a name="l02461"></a>02461                 tmp2 = [tmp2; xAxesHandles{i}];
<a name="l02462"></a>02462             end
<a name="l02463"></a>02463             
<a name="l02464"></a>02464             <span class="keywordflow">if</span> nargin &gt;= 6 &amp;&amp; ~isempty(plotIdx)
<a name="l02465"></a>02465                 set(tmp, &#39;FontSize&#39;, 10);
<a name="l02466"></a>02466                 set(tmp2, &#39;FontSize&#39;, 10);
<a name="l02467"></a>02467                 set(get(tmp2, &#39;xlabel&#39;), &#39;FontSize&#39;, 12);
<a name="l02468"></a>02468                 set(get(tmp, &#39;ylabel&#39;), &#39;FontSize&#39;, 12, &#39;Color&#39;, [0 0 0]);
<a name="l02469"></a>02469                 set(get(tmp, &#39;title&#39;), &#39;FontSize&#39;, 12);
<a name="l02470"></a>02470                 PlotUtil.alignYAxesLabels(axesHandles);
<a name="l02471"></a>02471                 axesHandles2 = PlotUtil.offsetYAxes(tmp, 0.02);
<a name="l02472"></a>02472                 h = [
<a name="l02473"></a>02473                     getappdata(tmp, &#39;YTickText&#39;)
<a name="l02474"></a>02474                     getappdata(axesHandles2(1), &#39;YTickText&#39;)
<a name="l02475"></a>02475                     ];
<a name="l02476"></a>02476                 set(h, &#39;FontSize&#39;, 10);
<a name="l02477"></a>02477             else
<a name="l02478"></a>02478                 set(tmp, &#39;FontSize&#39;, 6);
<a name="l02479"></a>02479                 set(tmp2, &#39;FontSize&#39;, 6);
<a name="l02480"></a>02480                 set(cell2mat(get(tmp2, &#39;xlabel&#39;)), &#39;FontSize&#39;, 8);
<a name="l02481"></a>02481                 set(cell2mat(get(tmp, &#39;ylabel&#39;)), &#39;FontSize&#39;, 8, &#39;Color&#39;, [0 0 0]);
<a name="l02482"></a>02482                 set(cell2mat(get(tmp, &#39;title&#39;)), &#39;FontSize&#39;, 8);
<a name="l02483"></a>02483                 PlotUtil.alignYAxesLabels(axesHandles);
<a name="l02484"></a>02484                 PlotUtil.offsetYAxes(axesHandles(1:2:end-1), 0.05);
<a name="l02485"></a>02485             end
<a name="l02486"></a>02486             
<a name="l02487"></a>02487             %% legend
<a name="l02488"></a>02488             [uClasses, uClassIdxs] = unique(classes);
<a name="l02489"></a>02489             h = zeros(size(uClasses));
<a name="l02490"></a>02490             nCols = max(5, ceil(numel(uClasses) / 5));
<a name="l02491"></a>02491             nRows = 5;
<a name="l02492"></a>02492             for i = 1:numel(uClasses)
<a name="l02493"></a>02493                 x = 0.11 + 0.78 / nCols * (ceil(i / nRows) - 1);
<a name="l02494"></a>02494                 y = 0.32 - 0.10 - 0.03 * (mod(i - 1, nRows) + 1);
<a name="l02495"></a>02495                 h(i) = annotation(figHandle, &#39;textarrow&#39;, x + [0 -0.025], y(1, [1 1]), ...
<a name="l02496"></a>02496                     &#39;HeadStyle&#39;, &#39;none&#39;, ...
<a name="l02497"></a>02497                     &#39;String&#39;, classLabels{uClassIdxs(i), 1}, ...
<a name="l02498"></a>02498                     <span class="stringliteral">&#39;FontSize&#39;</span>, 6, ...
<a name="l02499"></a>02499                     <span class="stringliteral">&#39;LineWidth&#39;</span>, 4, ...
<a name="l02500"></a>02500                     <span class="stringliteral">&#39;Color&#39;</span>, colors(uClasses(i), :), ...
<a name="l02501"></a>02501                     <span class="stringliteral">&#39;TextColor&#39;</span>, <span class="charliteral">&#39;k&#39;</span>);
<a name="l02502"></a>02502                 setappdata(h(i), <span class="stringliteral">&#39;class&#39;</span>, uClasses(i));
<a name="l02503"></a>02503                 setappdata(h(i), <span class="stringliteral">&#39;label&#39;</span>, classLabels(uClassIdxs(i), 1));
<a name="l02504"></a>02504                 <span class="keyword">set</span>(h(i), <span class="stringliteral">&#39;ButtonDownFcn&#39;</span>, @SingleGeneDeletions.plotSingleGeneDeletionCallback);
<a name="l02505"></a>02505             end
<a name="l02506"></a>02506             
<a name="l02507"></a>02507             setappdata(figHandle, <span class="stringliteral">&#39;legendEntries&#39;</span>, h);
<a name="l02508"></a>02508         end
<a name="l02509"></a>02509         
<a name="l02510"></a>02510         <span class="keyword">function</span> plotSingleGeneDeletionTemporalDynamics(dynamicsAxesHandle, histogramAxesHandle, data, classes, classLabels, plotRepresentativeCell, dataField, dataLabel, colors)
<a name="l02511"></a>02511             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l02512"></a>02512             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l02513"></a>02513             
<a name="l02514"></a>02514             %options
<a name="l02515"></a>02515             if nargin &lt; 9
<a name="l02516"></a>02516                 colors = SingleGeneDeletions.COLORS;
<a name="l02517"></a>02517             end
<a name="l02518"></a>02518             
<a name="l02519"></a>02519             %axes
<a name="l02520"></a>02520             cla(dynamicsAxesHandle);
<a name="l02521"></a>02521             cla(histogramAxesHandle);
<a name="l02522"></a>02522             hold(dynamicsAxesHandle, &#39;on&#39;);
<a name="l02523"></a>02523             hold(histogramAxesHandle, &#39;on&#39;);
<a name="l02524"></a>02524             
<a name="l02525"></a>02525             yRange = [NaN NaN];
<a name="l02526"></a>02526             maxTime = NaN;
<a name="l02527"></a>02527             for i = 1:numel(data)
<a name="l02528"></a>02528                 yRange(1) = min(yRange(1), min(data{i}.(dataField)(:)));
<a name="l02529"></a>02529                 yRange(2) = max(yRange(2), max(data{i}.(dataField)(:)));
<a name="l02530"></a>02530                 maxTime = max(maxTime, data{i}.time(end));
<a name="l02531"></a>02531             end
<a name="l02532"></a>02532             maxTime = min(maxTime, 20);
<a name="l02533"></a>02533             <span class="keywordflow">if</span> yRange(1) == yRange(2)
<a name="l02534"></a>02534                 yRange(1) = yRange(1) - sqrt(eps);
<a name="l02535"></a>02535                 yRange(2) = yRange(2) + sqrt(eps);
<a name="l02536"></a>02536             end
<a name="l02537"></a>02537             
<a name="l02538"></a>02538             simEndTimes = cell(size(data));
<a name="l02539"></a>02539             for i = 1:numel(data)
<a name="l02540"></a>02540                 simEndTimes{i} = zeros(size(data{i}.simEndTimes));
<a name="l02541"></a>02541                 <span class="keywordflow">for</span> j = 1:numel(data{i}.simEndTimes);
<a name="l02542"></a>02542                     simEndTimes{i}(j) = find(~isnan(data{i}.growth(:, j)), 1, <span class="stringliteral">&#39;last&#39;</span>);
<a name="l02543"></a>02543                 end
<a name="l02544"></a>02544             end
<a name="l02545"></a>02545             
<a name="l02546"></a>02546             %dynamics
<a name="l02547"></a>02547             <span class="keywordflow">for</span> i = 1:numel(data)
<a name="l02548"></a>02548                 if plotRepresentativeCell(i)
<a name="l02549"></a>02549                     medianTime = median(simEndTimes{i});
<a name="l02550"></a>02550                     [~, simIdx] = min(abs(medianTime - simEndTimes{i}));
<a name="l02551"></a>02551                 <span class="keywordflow">else</span>
<a name="l02552"></a>02552                     simIdx = 1:numel(simEndTimes{i});
<a name="l02553"></a>02553                 end
<a name="l02554"></a>02554                 xdata = data{i}.time;
<a name="l02555"></a>02555                 ydata = data{i}.(dataField)(:, simIdx);
<a name="l02556"></a>02556                 xdata = xdata(any(~isnan(ydata), 2), :);
<a name="l02557"></a>02557                 ydata = ydata(any(~isnan(ydata), 2), :);
<a name="l02558"></a>02558                 
<a name="l02559"></a>02559                 h = plot(dynamicsAxesHandle, xdata, ydata);
<a name="l02560"></a>02560                 <span class="keyword">set</span>(h, <span class="stringliteral">&#39;Color&#39;</span>, colors(classes(i), :));
<a name="l02561"></a>02561                 <span class="keywordflow">for</span> j = 1:numel(h)
<a name="l02562"></a>02562                     setappdata(h(j), &#39;class&#39;, i);
<a name="l02563"></a>02563                     setappdata(h(j), &#39;label&#39;, classLabels(i, :));
<a name="l02564"></a>02564                 end
<a name="l02565"></a>02565                 set(h, &#39;ButtonDownFcn&#39;, @SingleGeneDeletions.plotSingleGeneDeletionCallback);
<a name="l02566"></a>02566             end
<a name="l02567"></a>02567             
<a name="l02568"></a>02568             %marginal
<a name="l02569"></a>02569             edges = linspace(yRange(1), yRange(2), 20);
<a name="l02570"></a>02570             uClasses = unique(classes);
<a name="l02571"></a>02571             freq = zeros(numel(edges), numel(uClasses));
<a name="l02572"></a>02572             for i = 1:numel(data)
<a name="l02573"></a>02573                 tmp = data{i}.(dataField)(sub2ind(size(data{i}.(dataField)), simEndTimes{i}, (1:numel(simEndTimes{i}))<span class="stringliteral">&#39;));</span>
<a name="l02574"></a>02574 <span class="stringliteral">                freq(:, classes(i) == uClasses) = ...</span>
<a name="l02575"></a>02575 <span class="stringliteral">                    + freq(:, classes(i) == uClasses) ...</span>
<a name="l02576"></a>02576 <span class="stringliteral">                    + reshape(histc(tmp, edges), [], 1);</span>
<a name="l02577"></a>02577 <span class="stringliteral">            end</span>
<a name="l02578"></a>02578 <span class="stringliteral">            freq = freq ./ repmat(sum(freq, 1), [numel(edges) 1]);</span>
<a name="l02579"></a>02579 <span class="stringliteral">            edges = [edges(1);  edges(:) + diff(edges(1:2)) / 2;  edges(end) + diff(edges(1:2))];</span>
<a name="l02580"></a>02580 <span class="stringliteral">            h = plot(histogramAxesHandle, [zeros(1, numel(uClasses)); freq; zeros(1, numel(uClasses))], edges, &#39;</span>b<span class="stringliteral">&#39;);</span>
<a name="l02581"></a>02581 <span class="stringliteral">            </span>
<a name="l02582"></a>02582 <span class="stringliteral">            for i = 1:numel(uClasses)</span>
<a name="l02583"></a>02583 <span class="stringliteral">                set(h(i), &#39;</span>Color<span class="stringliteral">&#39;, colors(uClasses(i), :));</span>
<a name="l02584"></a>02584 <span class="stringliteral">                setappdata(h(i), &#39;</span><span class="keyword">class</span><span class="stringliteral">&#39;, uClasses(i));</span>
<a name="l02585"></a>02585 <span class="stringliteral">                setappdata(h(i), &#39;</span>label<span class="stringliteral">&#39;, classLabels(uClasses(i), 1));</span>
<a name="l02586"></a>02586 <span class="stringliteral">                set(h(i), &#39;</span>ButtonDownFcn<span class="stringliteral">&#39;, @SingleGeneDeletions.plotSingleGeneDeletionCallback);</span>
<a name="l02587"></a>02587 <span class="stringliteral">            end</span>
<a name="l02588"></a>02588 <span class="stringliteral">            </span>
<a name="l02589"></a>02589 <span class="stringliteral">            %axes</span>
<a name="l02590"></a>02590 <span class="stringliteral">            xlim(dynamicsAxesHandle, [0 maxTime]);</span>
<a name="l02591"></a>02591 <span class="stringliteral">            xlim(histogramAxesHandle, [0 max(1, max(freq(:)))]);</span>
<a name="l02592"></a>02592 <span class="stringliteral">            ylabel(dynamicsAxesHandle, dataLabel, &#39;</span>FontSize<span class="stringliteral">&#39;, 8);</span>
<a name="l02593"></a>02593 <span class="stringliteral">            </span>
<a name="l02594"></a>02594 <span class="stringliteral">            if any(yRange) &amp;&amp; range(yRange)</span>
<a name="l02595"></a>02595 <span class="stringliteral">                ylim(dynamicsAxesHandle, yRange);</span>
<a name="l02596"></a>02596 <span class="stringliteral">                ylim(histogramAxesHandle, yRange);</span>
<a name="l02597"></a>02597 <span class="stringliteral">                set(dynamicsAxesHandle, &#39;</span>YTick<span class="stringliteral">&#39;, yRange);</span>
<a name="l02598"></a>02598 <span class="stringliteral">                PlotUtil.formatYAxes(dynamicsAxesHandle, yRange(1), yRange(end));</span>
<a name="l02599"></a>02599 <span class="stringliteral">            end</span>
<a name="l02600"></a>02600 <span class="stringliteral">            </span>
<a name="l02601"></a>02601 <span class="stringliteral">            figHandle = get(dynamicsAxesHandle, &#39;</span>Parent<span class="stringliteral">&#39;);</span>
<a name="l02602"></a>02602 <span class="stringliteral">            </span>
<a name="l02603"></a>02603 <span class="stringliteral">            box(dynamicsAxesHandle, &#39;</span>off<span class="stringliteral">&#39;);</span>
<a name="l02604"></a>02604 <span class="stringliteral">            set(dynamicsAxesHandle, ...</span>
<a name="l02605"></a>02605 <span class="stringliteral">                &#39;</span>FontSize<span class="stringliteral">&#39;, 7, ...</span>
<a name="l02606"></a>02606 <span class="stringliteral">                &#39;</span>TickDir<span class="stringliteral">&#39;, &#39;</span>out<span class="stringliteral">&#39;, ...</span>
<a name="l02607"></a>02607 <span class="stringliteral">                &#39;</span>YMinorTick<span class="stringliteral">&#39;, &#39;</span>off<span class="stringliteral">&#39;, ...</span>
<a name="l02608"></a>02608 <span class="stringliteral">                &#39;</span>XTick<span class="stringliteral">&#39;, [], ...</span>
<a name="l02609"></a>02609 <span class="stringliteral">                &#39;</span>XColor<span class="stringliteral">&#39;, get(figHandle, &#39;</span>Color<span class="stringliteral">&#39;));</span>
<a name="l02610"></a>02610 <span class="stringliteral">            </span>
<a name="l02611"></a>02611 <span class="stringliteral">            box(histogramAxesHandle, &#39;</span>off<span class="stringliteral">&#39;);</span>
<a name="l02612"></a>02612 <span class="stringliteral">            set(histogramAxesHandle, ...</span>
<a name="l02613"></a>02613 <span class="stringliteral">                &#39;</span>Visible<span class="stringliteral">&#39;, &#39;</span>off<span class="stringliteral">&#39;, ...</span>
<a name="l02614"></a>02614 <span class="stringliteral">                &#39;</span>FontSize<span class="stringliteral">&#39;, 7, ...</span>
<a name="l02615"></a>02615 <span class="stringliteral">                &#39;</span>TickDir<span class="stringliteral">&#39;, &#39;</span>out<span class="stringliteral">&#39;, ...</span>
<a name="l02616"></a>02616 <span class="stringliteral">                &#39;</span>XMinorTick<span class="stringliteral">&#39;, &#39;</span>off<span class="stringliteral">&#39;, ...</span>
<a name="l02617"></a>02617 <span class="stringliteral">                &#39;</span>YMinorTick<span class="stringliteral">&#39;, &#39;</span>off<span class="stringliteral">&#39;, ...</span>
<a name="l02618"></a>02618 <span class="stringliteral">                &#39;</span>XTick<span class="stringliteral">&#39;, [], ...</span>
<a name="l02619"></a>02619 <span class="stringliteral">                &#39;</span>YTick<span class="stringliteral">&#39;, [], ...</span>
<a name="l02620"></a>02620 <span class="stringliteral">                &#39;</span>XColor<span class="stringliteral">&#39;, get(figHandle, &#39;</span>Color<span class="stringliteral">&#39;), ...</span>
<a name="l02621"></a>02621 <span class="stringliteral">                &#39;</span>YColor<span class="stringliteral">&#39;, get(figHandle, &#39;</span>Color<span class="stringliteral">&#39;));</span>
<a name="l02622"></a>02622 <span class="stringliteral">        end</span>
<a name="l02623"></a>02623 <span class="stringliteral">        </span>
<a name="l02624"></a>02624 <span class="stringliteral">        function plotSingleGeneDeletionCellCyclePhaseHistogram(axesHandle, data, classes, classLabels, dataField, dataLabel, colors)</span>
<a name="l02625"></a>02625 <span class="stringliteral">            import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;</span>
<a name="l02626"></a>02626 <span class="stringliteral">            import edu.stanford.covert.cell.sim.util.PlotUtil;</span>
<a name="l02627"></a>02627 <span class="stringliteral">            </span>
<a name="l02628"></a>02628 <span class="stringliteral">            if nargin &lt; 7</span>
<a name="l02629"></a>02629 <span class="stringliteral">                colors = SingleGeneDeletions.COLORS;</span>
<a name="l02630"></a>02630 <span class="stringliteral">            end</span>
<a name="l02631"></a>02631 <span class="stringliteral">            </span>
<a name="l02632"></a>02632 <span class="stringliteral">            cla(axesHandle);</span>
<a name="l02633"></a>02633 <span class="stringliteral">            </span>
<a name="l02634"></a>02634 <span class="stringliteral">            maxTime = NaN;</span>
<a name="l02635"></a>02635 <span class="stringliteral">            for i = 1:numel(data)</span>
<a name="l02636"></a>02636 <span class="stringliteral">                maxTime = max(maxTime, data{i}.time(end));</span>
<a name="l02637"></a>02637 <span class="stringliteral">            end</span>
<a name="l02638"></a>02638 <span class="stringliteral">            </span>
<a name="l02639"></a>02639 <span class="stringliteral">            edges = linspace(0, maxTime, 20);</span>
<a name="l02640"></a>02640 <span class="stringliteral">            </span>
<a name="l02641"></a>02641 <span class="stringliteral">            uClasses = unique(classes);</span>
<a name="l02642"></a>02642 <span class="stringliteral">            freq = zeros(numel(edges), numel(uClasses));</span>
<a name="l02643"></a>02643 <span class="stringliteral">            for i = 1:numel(data)</span>
<a name="l02644"></a>02644 <span class="stringliteral">                freq(:, classes(i) == uClasses) = ...</span>
<a name="l02645"></a>02645 <span class="stringliteral">                    + freq(:, classes(i) == uClasses) ...</span>
<a name="l02646"></a>02646 <span class="stringliteral">                    + reshape(histc(data{i}.(dataField), edges), [], 1);</span>
<a name="l02647"></a>02647 <span class="stringliteral">            end</span>
<a name="l02648"></a>02648 <span class="stringliteral">            freq = freq ./ repmat(sum(freq, 1), [numel(edges) 1]);</span>
<a name="l02649"></a>02649 <span class="stringliteral">            </span>
<a name="l02650"></a>02650 <span class="stringliteral">            edges = [edges(1);  edges(:) + diff(edges(1:2)) / 2;  edges(end) + diff(edges(1:2))];</span>
<a name="l02651"></a>02651 <span class="stringliteral">            h = plot(axesHandle, edges, [zeros(1, numel(uClasses)); freq; zeros(1, numel(uClasses))], &#39;</span>b<span class="stringliteral">&#39;);</span>
<a name="l02652"></a>02652 <span class="stringliteral">            for i = 1:numel(uClasses)</span>
<a name="l02653"></a>02653 <span class="stringliteral">                set(h(i), &#39;</span>Color<span class="stringliteral">&#39;, colors(uClasses(i), :));</span>
<a name="l02654"></a>02654 <span class="stringliteral">                setappdata(h(i), &#39;</span><span class="keyword">class</span><span class="stringliteral">&#39;, uClasses(i));</span>
<a name="l02655"></a>02655 <span class="stringliteral">                setappdata(h(i), &#39;</span>label<span class="stringliteral">&#39;, classLabels(uClasses(i), 1));</span>
<a name="l02656"></a>02656 <span class="stringliteral">                set(h(i), &#39;</span>ButtonDownFcn<span class="stringliteral">&#39;, @SingleGeneDeletions.plotSingleGeneDeletionCallback);</span>
<a name="l02657"></a>02657 <span class="stringliteral">            end</span>
<a name="l02658"></a>02658 <span class="stringliteral">            </span>
<a name="l02659"></a>02659 <span class="stringliteral">            xlim(axesHandle, [0 maxTime]);</span>
<a name="l02660"></a>02660 <span class="stringliteral">            box(axesHandle, &#39;</span>off<span class="stringliteral">&#39;);</span>
<a name="l02661"></a>02661 <span class="stringliteral">            set(axesHandle, ...</span>
<a name="l02662"></a>02662 <span class="stringliteral">                &#39;</span>FontSize<span class="stringliteral">&#39;, 7, ...</span>
<a name="l02663"></a>02663 <span class="stringliteral">                &#39;</span>TickDir<span class="stringliteral">&#39;, &#39;</span>out<span class="stringliteral">&#39;, ...</span>
<a name="l02664"></a>02664 <span class="stringliteral">                &#39;</span>XMinorTick<span class="stringliteral">&#39;, &#39;</span>off<span class="stringliteral">&#39;, ...</span>
<a name="l02665"></a>02665 <span class="stringliteral">                &#39;</span>YMinorTick<span class="stringliteral">&#39;, &#39;</span>off<span class="stringliteral">&#39;, ...</span>
<a name="l02666"></a>02666 <span class="stringliteral">                &#39;</span>XTick<span class="stringliteral">&#39;, [], ...</span>
<a name="l02667"></a>02667 <span class="stringliteral">                &#39;</span>YTick<span class="stringliteral">&#39;, [], ...</span>
<a name="l02668"></a>02668 <span class="stringliteral">                &#39;</span>XColor<span class="stringliteral">&#39;, get(get(axesHandle, &#39;</span>Parent<span class="stringliteral">&#39;), &#39;</span>Color<span class="stringliteral">&#39;), ...</span>
<a name="l02669"></a>02669 <span class="stringliteral">                &#39;</span>YColor<span class="stringliteral">&#39;, get(get(axesHandle, &#39;</span>Parent<span class="stringliteral">&#39;), &#39;</span>Color<span class="stringliteral">&#39;));</span>
<a name="l02670"></a>02670 <span class="stringliteral">            ylabel(axesHandle, [dataLabel {&#39;</span>Freq<span class="stringliteral">&#39;}], &#39;</span>FontSize<span class="stringliteral">&#39;, 8);</span>
<a name="l02671"></a>02671 <span class="stringliteral">        end</span>
<a name="l02672"></a>02672 <span class="stringliteral">        </span>
<a name="l02673"></a>02673 <span class="stringliteral">        function plotSingleGeneDeletionCallback(hObject, ~)</span>
<a name="l02674"></a>02674 <span class="stringliteral">            class = getappdata(hObject, &#39;</span><span class="keyword">class</span><span class="stringliteral">&#39;);</span>
<a name="l02675"></a>02675 <span class="stringliteral">            label = getappdata(hObject, &#39;</span>label<span class="stringliteral">&#39;);</span>
<a name="l02676"></a>02676 <span class="stringliteral">            </span>
<a name="l02677"></a>02677 <span class="stringliteral">            figHandle = get(get(hObject, &#39;</span>Parent<span class="stringliteral">&#39;), &#39;</span>Parent<span class="stringliteral">&#39;);</span>
<a name="l02678"></a>02678 <span class="stringliteral">            axesHandles = findobj(get(figHandle, &#39;</span>Children<span class="stringliteral">&#39;), &#39;</span>type<span class="stringliteral">&#39;, &#39;</span>axes<span class="stringliteral">&#39;);</span>
<a name="l02679"></a>02679 <span class="stringliteral">            for i = 1:numel(axesHandles)</span>
<a name="l02680"></a>02680 <span class="stringliteral">                lineHandles = findobj(get(axesHandles(i), &#39;</span>Children<span class="stringliteral">&#39;), &#39;</span>type<span class="stringliteral">&#39;, &#39;</span>line<span class="stringliteral">&#39;);</span>
<a name="l02681"></a>02681 <span class="stringliteral">                for j = 1:numel(lineHandles)</span>
<a name="l02682"></a>02682 <span class="stringliteral">                    tmpClass = getappdata(lineHandles(j), &#39;</span><span class="keyword">class</span><span class="stringliteral">&#39;);</span>
<a name="l02683"></a>02683 <span class="stringliteral">                    if ~isempty(tmpClass)</span>
<a name="l02684"></a>02684 <span class="stringliteral">                        if tmpClass == class</span>
<a name="l02685"></a>02685 <span class="stringliteral">                            if ~isequal(get(lineHandles(j), &#39;</span>MarkerEdgeColor<span class="stringliteral">&#39;), &#39;</span><span class="keyword">auto</span><span class="stringliteral">&#39;)</span>
<a name="l02686"></a>02686 <span class="stringliteral">                                set(lineHandles(j), &#39;</span>Color<span class="stringliteral">&#39;, get(lineHandles(j), &#39;</span>MarkerEdgeColor<span class="stringliteral">&#39;));</span>
<a name="l02687"></a>02687 <span class="stringliteral">                            end</span>
<a name="l02688"></a>02688 <span class="stringliteral">                            set(lineHandles(j), &#39;</span>LineWidth<span class="stringliteral">&#39;, 2);</span>
<a name="l02689"></a>02689 <span class="stringliteral">                            uistack(lineHandles(j), &#39;</span>top<span class="stringliteral">&#39;);</span>
<a name="l02690"></a>02690 <span class="stringliteral">                        else</span>
<a name="l02691"></a>02691 <span class="stringliteral">                            if isequal(get(lineHandles(j), &#39;</span>MarkerEdgeColor<span class="stringliteral">&#39;), &#39;</span><span class="keyword">auto</span><span class="stringliteral">&#39;)</span>
<a name="l02692"></a>02692 <span class="stringliteral">                                set(lineHandles(j), &#39;</span>MarkerEdgeColor<span class="stringliteral">&#39;, get(lineHandles(j), &#39;</span>Color<span class="stringliteral">&#39;));</span>
<a name="l02693"></a>02693 <span class="stringliteral">                            end</span>
<a name="l02694"></a>02694 <span class="stringliteral">                            set(lineHandles(j), &#39;</span>LineWidth<span class="stringliteral">&#39;, 1, &#39;</span>Color<span class="stringliteral">&#39;, [0.9 0.9 0.9]);</span>
<a name="l02695"></a>02695 <span class="stringliteral">                        end</span>
<a name="l02696"></a>02696 <span class="stringliteral">                    end</span>
<a name="l02697"></a>02697 <span class="stringliteral">                end</span>
<a name="l02698"></a>02698 <span class="stringliteral">            end</span>
<a name="l02699"></a>02699 <span class="stringliteral">            </span>
<a name="l02700"></a>02700 <span class="stringliteral">            legendEntries = getappdata(figHandle, &#39;</span>legendEntries<span class="stringliteral">&#39;);</span>
<a name="l02701"></a>02701 <span class="stringliteral">            for i = 1:numel(legendEntries)</span>
<a name="l02702"></a>02702 <span class="stringliteral">                tmpClass = getappdata(legendEntries(i), &#39;</span><span class="keyword">class</span><span class="stringliteral">&#39;);</span>
<a name="l02703"></a>02703 <span class="stringliteral">                if tmpClass == class</span>
<a name="l02704"></a>02704 <span class="stringliteral">                    if ~isequal(get(legendEntries(i), &#39;</span>TextEdgeColor<span class="stringliteral">&#39;), &#39;</span>none<span class="stringliteral">&#39;)</span>
<a name="l02705"></a>02705 <span class="stringliteral">                        set(legendEntries(i), &#39;</span>Color<span class="stringliteral">&#39;, get(legendEntries(i), &#39;</span>TextEdgeColor<span class="stringliteral">&#39;));</span>
<a name="l02706"></a>02706 <span class="stringliteral">                    end</span>
<a name="l02707"></a>02707 <span class="stringliteral">                    uistack(legendEntries(i), &#39;</span>top<span class="stringliteral">&#39;);</span>
<a name="l02708"></a>02708 <span class="stringliteral">                else</span>
<a name="l02709"></a>02709 <span class="stringliteral">                    if isequal(get(legendEntries(i), &#39;</span>TextEdgeColor<span class="stringliteral">&#39;), &#39;</span>none<span class="stringliteral">&#39;)</span>
<a name="l02710"></a>02710 <span class="stringliteral">                        set(legendEntries(i), &#39;</span>TextEdgeColor<span class="stringliteral">&#39;, get(legendEntries(i), &#39;</span>Color<span class="stringliteral">&#39;), &#39;</span>TextLineWidth<span class="stringliteral">&#39;, 0);</span>
<a name="l02711"></a>02711 <span class="stringliteral">                    end</span>
<a name="l02712"></a>02712 <span class="stringliteral">                    set(legendEntries(i), &#39;</span>Color<span class="stringliteral">&#39;, [0.9 0.9 0.9]);</span>
<a name="l02713"></a>02713 <span class="stringliteral">                end</span>
<a name="l02714"></a>02714 <span class="stringliteral">                set(legendEntries(i), &#39;</span>TextColor<span class="stringliteral">&#39;, &#39;</span>k<span class="stringliteral">&#39;);</span>
<a name="l02715"></a>02715 <span class="stringliteral">            end</span>
<a name="l02716"></a>02716 <span class="stringliteral">            </span>
<a name="l02717"></a>02717 <span class="stringliteral">            label = strjoin(&#39;</span> - &#39;, label{:});
<a name="l02718"></a>02718             label = strrep(label, <span class="stringliteral">&#39;{\Delta}&#39;</span>, <span class="keywordtype">char</span>(916));
<a name="l02719"></a>02719             label = strrep(label, <span class="charliteral">&#39;\_&#39;</span>, <span class="charliteral">&#39;_&#39;</span>);
<a name="l02720"></a>02720             disp([<span class="stringliteral">&#39;Selected: &#39;</span>, label]);
<a name="l02721"></a>02721         end
<a name="l02722"></a>02722         
<a name="l02723"></a>02723         <span class="keyword">function</span> [class, classLabel] = classifyDeletionStrain(geneID, wtData)
<a name="l02724"></a>02724             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l02725"></a>02725             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l02726"></a>02726             
<a name="l02727"></a>02727             baseDir = [SimulationDiskUtil.getBaseDir() filesep &#39;singleGeneDeletions&#39; filesep];
<a name="l02728"></a>02728             deletionData = load([baseDir geneID &#39;.mat&#39;]);
<a name="l02729"></a>02729             if nargin &lt; 2
<a name="l02730"></a>02730                 wtData = load([baseDir &#39;WT.mat&#39;]);
<a name="l02731"></a>02731             end
<a name="l02732"></a>02732             
<a name="l02733"></a>02733             nWtSims = numel(wtData.simEndTimes);
<a name="l02734"></a>02734             nDeletionSims = numel(deletionData.simEndTimes);
<a name="l02735"></a>02735             
<a name="l02736"></a>02736             cellCycleLength = min([wtData.simEndTimes; deletionData.simEndTimes]);
<a name="l02737"></a>02737             
<a name="l02738"></a>02738             wtStartTimes = 2 * ones(size(wtData.simEndTimes));
<a name="l02739"></a>02739             wtTauTimes = zeros(size(wtData.growth, 2), 1);
<a name="l02740"></a>02740             wtFinTimes = wtData.simEndTimes + 1;
<a name="l02741"></a>02741             deletionStartTimes = 101 * ones(size(deletionData.simEndTimes));
<a name="l02742"></a>02742             deletionTauTimes = zeros(size(deletionData.growth, 2), 1);
<a name="l02743"></a>02743             deletionFinTimes = deletionData.simEndTimes + 1;
<a name="l02744"></a>02744             for i = 1:nWtSims
<a name="l02745"></a>02745                 wtTauTimes(i) = find(~isnan(wtData.growth(1:cellCycleLength, i)), 1, &#39;last&#39;);
<a name="l02746"></a>02746             end
<a name="l02747"></a>02747             for i = 1:nDeletionSims
<a name="l02748"></a>02748                 deletionTauTimes(i) = find(~isnan(deletionData.growth(1:cellCycleLength, i)), 1, &#39;last&#39;);
<a name="l02749"></a>02749             end
<a name="l02750"></a>02750             
<a name="l02751"></a>02751             wtStartInds = sub2ind(size(wtData.growth), wtStartTimes&#39;, 1:nWtSims);
<a name="l02752"></a>02752             wtFinInds = sub2ind(size(wtData.growth), wtFinTimes&#39;, 1:nWtSims); %<span class="preprocessor">#ok&lt;NASGU&gt;</span>
<a name="l02753"></a>02753 <span class="preprocessor"></span>            wtTauInds = sub2ind(size(wtData.growth), wtTauTimes<span class="stringliteral">&#39;, 1:nWtSims);</span>
<a name="l02754"></a>02754 <span class="stringliteral">            deletionStartInds = sub2ind(size(deletionData.growth), deletionStartTimes&#39;</span>, 1:nDeletionSims);
<a name="l02755"></a>02755             deletionFinInds = sub2ind(size(deletionData.growth), deletionFinTimes<span class="stringliteral">&#39;, 1:nDeletionSims);</span>
<a name="l02756"></a>02756 <span class="stringliteral">            deletionTauInds = sub2ind(size(deletionData.growth), deletionTauTimes&#39;</span>, 1:nDeletionSims);
<a name="l02757"></a>02757             
<a name="l02758"></a>02758             wtTauGrowths = wtData.growth(wtTauInds);
<a name="l02759"></a>02759             deletionFinGrowths = deletionData.growth(deletionFinInds);
<a name="l02760"></a>02760             deletionTauGrowths = deletionData.growth(deletionTauInds);
<a name="l02761"></a>02761             deletionInitGrowths = deletionData.growth(deletionStartInds);
<a name="l02762"></a>02762             
<a name="l02763"></a>02763             <span class="keywordflow">if</span> ...
<a name="l02764"></a>02764                     median(deletionInitGrowths) &lt; 0.1 * median(wtData.growth(wtStartInds)) &amp;&amp; (...
<a name="l02765"></a>02765                     median(deletionData.damagedProteins(deletionFinInds)) &gt; max(100, 100 * median(wtData.damagedProteins(wtTauInds))) || ...
<a name="l02766"></a>02766                     median(deletionData.damagedRnas(deletionFinInds))     &gt; max(100, 100 * median(wtData.damagedRnas(wtTauInds)))     || ...
<a name="l02767"></a>02767                     median(deletionData.aminoAcids(deletionFinInds))      &gt; max(100, 100 * median(wtData.aminoAcids(wtTauInds)))      || ...
<a name="l02768"></a>02768                     median(deletionData.ntps(deletionFinInds))            &gt; max(100, 100 * median(wtData.ntps(wtTauInds)))               ...
<a name="l02769"></a>02769                     )
<a name="l02770"></a>02770                 <span class="keyword">class</span> = SingleGeneDeletions.DECOMPOSING;
<a name="l02771"></a>02771             elseif median(deletionInitGrowths) &lt; 0.1 * median(wtData.growth(wtStartInds))
<a name="l02772"></a>02772                 <span class="keyword">class</span> = SingleGeneDeletions.NON_GROWING;
<a name="l02773"></a>02773             elseif all(deletionFinGrowths &lt; deletionInitGrowths) &amp;&amp; all(deletionData.rnas(deletionTauInds) &lt; deletionData.rnas(deletionStartInds))
<a name="l02774"></a>02774                 <span class="keyword">class</span> = SingleGeneDeletions.DECAYING_GROWTH_NON_RNA_PROTEIN;
<a name="l02775"></a>02775             elseif all(deletionFinGrowths &lt; deletionInitGrowths) &amp;&amp; all(deletionData.prots(deletionTauInds) &lt; deletionData.prots(deletionStartInds))
<a name="l02776"></a>02776                 <span class="keyword">class</span> = SingleGeneDeletions.DECAYING_GROWTH_NON_PROTEIN;
<a name="l02777"></a>02777             elseif ...
<a name="l02778"></a>02778                     median(deletionData.damagedProteins(deletionFinInds)) &gt; max(100, 100 * median(wtData.damagedProteins(wtTauInds))) || ...
<a name="l02779"></a>02779                     median(deletionData.damagedRnas(deletionFinInds))     &gt; max(100, 100 * median(wtData.damagedRnas(wtTauInds)))     || ...
<a name="l02780"></a>02780                     median(deletionData.aminoAcids(deletionFinInds))      &gt; max(100, 100 * median(wtData.aminoAcids(wtTauInds)))      || ...
<a name="l02781"></a>02781                     median(deletionData.ntps(deletionFinInds))            &gt; max(100, 100 * median(wtData.ntps(wtTauInds)))            || ...
<a name="l02782"></a>02782                     median(deletionData.antibiotics(deletionFinInds))     &gt; max(100, 100 * median(wtData.antibiotics(wtTauInds)))
<a name="l02783"></a>02783                 class = SingleGeneDeletions.TOXIN_ACCUMULATION;
<a name="l02784"></a>02784             elseif ~any(deletionData.ploidy(:) &gt; 1)
<a name="l02785"></a>02785                 class = SingleGeneDeletions.NON_REPLICATIVE;
<a name="l02786"></a>02786             elseif median(deletionTauGrowths) &lt; 0.80 * median(wtTauGrowths) &amp;&amp; median(deletionTauGrowths) &gt; median(deletionInitGrowths)
<a name="l02787"></a>02787                 class = SingleGeneDeletions.SLOW_GROWING;
<a name="l02788"></a>02788             elseif ~any(deletionData.cytokinesisDuration(:))
<a name="l02789"></a>02789                 class = SingleGeneDeletions.NON_FISSIVE;
<a name="l02790"></a>02790             elseif ~any(deletionData.isBacteriumAdherent(2, :))
<a name="l02791"></a>02791                 class = SingleGeneDeletions.NO_TERMINAL_ORGANELLE;
<a name="l02792"></a>02792             elseif ismember(geneID, SingleGeneDeletions.nonPerpetuatingEssentialGenes)
<a name="l02793"></a>02793                 class = SingleGeneDeletions.NON_PERPETUATING;
<a name="l02794"></a>02794             else
<a name="l02795"></a>02795                 class = SingleGeneDeletions.NON_ESSENTIAL;
<a name="l02796"></a>02796             end
<a name="l02797"></a>02797             
<a name="l02798"></a>02798             classLabel = SingleGeneDeletions.DELETION_STRAIN_CLASSES{<span class="keyword">class</span>};
<a name="l02799"></a>02799         end
<a name="l02800"></a>02800     end
<a name="l02801"></a>02801     
<a name="l02802"></a>02802     %Analyze specific single gene deletion strains
<a name="l02803"></a>02803     methods (Static)
<a name="l02804"></a>02804         function figData = analyzeSingleGeneDeletionStrain_MG_210(figHandle, geneID, deletionData, wtData, figData)
<a name="l02805"></a>02805             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l02806"></a>02806             import edu.stanford.covert.cell.sim.util.CachedSimulationObjectUtil;
<a name="l02807"></a>02807             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l02808"></a>02808             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l02809"></a>02809             
<a name="l02810"></a>02810             %% constants
<a name="l02811"></a>02811             perturbations = struct;
<a name="l02812"></a>02812             perturbations.geneticKnockouts = {geneID};
<a name="l02813"></a>02813             
<a name="l02814"></a>02814             sim = CachedSimulationObjectUtil.load();
<a name="l02815"></a>02815             sim.applyOptions(<span class="stringliteral">&#39;lengthSec&#39;</span>, 0);
<a name="l02816"></a>02816             sim.applyOptions(perturbations);
<a name="l02817"></a>02817             
<a name="l02818"></a>02818             g = sim.gene;
<a name="l02819"></a>02819             mass = sim.state(<span class="stringliteral">&#39;Mass&#39;</span>);
<a name="l02820"></a>02820             r = sim.state(<span class="stringliteral">&#39;Rna&#39;</span>);
<a name="l02821"></a>02821             pm = sim.state(<span class="stringliteral">&#39;ProteinMonomer&#39;</span>);
<a name="l02822"></a>02822             pc = sim.state(<span class="stringliteral">&#39;ProteinComplex&#39;</span>);
<a name="l02823"></a>02823             mr = sim.state(<span class="stringliteral">&#39;MetabolicReaction&#39;</span>);
<a name="l02824"></a>02824             ppII = sim.process(<span class="stringliteral">&#39;ProteinProcessingII&#39;</span>);
<a name="l02825"></a>02825             
<a name="l02826"></a>02826             pcComp = sum(pc.proteinComplexComposition(g.mRNAIndexs, :, :), 3);
<a name="l02827"></a>02827             monIdxs = [ppII.lipoproteinMonomerIndexs; ppII.secretedMonomerIndexs];
<a name="l02828"></a>02828             unprocessedMonIdxs = ppII.unprocessedMonomerIndexs;
<a name="l02829"></a>02829             cpxIdxs = find(any(pcComp(monIdxs, :), 1));
<a name="l02830"></a>02830             
<a name="l02831"></a>02831             cellInitialDryWeight = mass.cellInitialDryWeight;
<a name="l02832"></a>02832             rnaExp = r.expression;
<a name="l02833"></a>02833             rnaDecayRates = r.decayRates;
<a name="l02834"></a>02834             monDecayRates = pm.decayRates;
<a name="l02835"></a>02835             cpxDecayRates = pc.decayRates;
<a name="l02836"></a>02836             
<a name="l02837"></a>02837             %% data
<a name="l02838"></a>02838             maxTime = NaN;
<a name="l02839"></a>02839             data = {deletionData, wtData};
<a name="l02840"></a>02840             <span class="keywordflow">for</span> i = 1:numel(data)
<a name="l02841"></a>02841                 maxTime = max(maxTime, data{i}.time(end));
<a name="l02842"></a>02842             end
<a name="l02843"></a>02843             
<a name="l02844"></a>02844             <span class="keywordflow">if</span> nargin &gt;= 5 &amp;&amp; ~isempty(figData)
<a name="l02845"></a>02845                 nSamples = figData.nSamples;
<a name="l02846"></a>02846                 nGenerations = figData.nGenerations;
<a name="l02847"></a>02847                 generations = figData.generations;
<a name="l02848"></a>02848             else
<a name="l02849"></a>02849                 nSamples = 20;
<a name="l02850"></a>02850                 nGenerations = 10;
<a name="l02851"></a>02851                 generations = 1:nGenerations;
<a name="l02852"></a>02852                 
<a name="l02853"></a>02853                 figData = struct;
<a name="l02854"></a>02854                 figData.data = cell(nGenerations, 1);
<a name="l02855"></a>02855                 figData.nSamples = nSamples;
<a name="l02856"></a>02856                 figData.nGenerations = nGenerations;
<a name="l02857"></a>02857                 figData.generations = generations;
<a name="l02858"></a>02858                 
<a name="l02859"></a>02859                 for i = 1:nGenerations
<a name="l02860"></a>02860                     growths = zeros(4, nSamples);
<a name="l02861"></a>02861                     for j = 1:5
<a name="l02862"></a>02862                         for k = 1:nSamples
<a name="l02863"></a>02863                             r.expression = rnaExp;
<a name="l02864"></a>02864                             r.decayRates = rnaDecayRates;
<a name="l02865"></a>02865                             pm.decayRates = monDecayRates;
<a name="l02866"></a>02866                             pc.decayRates = cpxDecayRates;
<a name="l02867"></a>02867                             mass.cellInitialDryWeight = cellInitialDryWeight * exp(log(2) * (j - 1) / 4);
<a name="l02868"></a>02868                             mr.initialGrowthFilterWidth = Inf;
<a name="l02869"></a>02869                             
<a name="l02870"></a>02870                             sim.applyOptions(&#39;seed&#39;, i * nGenerations + j * 5 +  k);
<a name="l02871"></a>02871                             sim.allocateMemoryForState(1);
<a name="l02872"></a>02872                             sim.initializeState();
<a name="l02873"></a>02873                             sim.applyPerturbations();
<a name="l02874"></a>02874                             
<a name="l02875"></a>02875                             mons = pm.counts;
<a name="l02876"></a>02876                             cpxs = pc.counts;
<a name="l02877"></a>02877                             
<a name="l02878"></a>02878                             pm.counts(pm.processedIIIndexs(monIdxs),    :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.processedIIIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02879"></a>02879                             pm.counts(pm.signalSequenceIndexs(monIdxs), :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.signalSequenceIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02880"></a>02880                             pm.counts(pm.foldedIndexs(monIdxs),         :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.foldedIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02881"></a>02881                             pm.counts(pm.matureIndexs(monIdxs),         :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.matureIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02882"></a>02882                             pm.counts(pm.inactivatedIndexs(monIdxs),    :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.inactivatedIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02883"></a>02883                             pm.counts(pm.boundIndexs(monIdxs),          :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.boundIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02884"></a>02884                             pm.counts(pm.misfoldedIndexs(monIdxs),      :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.misfoldedIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02885"></a>02885                             pm.counts(pm.damagedIndexs(monIdxs),        :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.damagedIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02886"></a>02886                             
<a name="l02887"></a>02887                             pc.counts(pc.nascentIndexs(cpxIdxs),     :) = pc.randStream.random(&#39;binomial&#39;, pc.counts(pc.nascentIndexs(cpxIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02888"></a>02888                             pc.counts(pc.matureIndexs(cpxIdxs),      :) = pc.randStream.random(&#39;binomial&#39;, pc.counts(pc.matureIndexs(cpxIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02889"></a>02889                             pc.counts(pc.inactivatedIndexs(cpxIdxs), :) = pc.randStream.random(&#39;binomial&#39;, pc.counts(pc.inactivatedIndexs(cpxIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02890"></a>02890                             pc.counts(pc.boundIndexs(cpxIdxs),       :) = pc.randStream.random(&#39;binomial&#39;, pc.counts(pc.boundIndexs(cpxIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02891"></a>02891                             pc.counts(pc.misfoldedIndexs(cpxIdxs),   :) = pc.randStream.random(&#39;binomial&#39;, pc.counts(pc.misfoldedIndexs(cpxIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02892"></a>02892                             pc.counts(pc.damagedIndexs(cpxIdxs),     :) = pc.randStream.random(&#39;binomial&#39;, pc.counts(pc.damagedIndexs(cpxIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l02893"></a>02893                             
<a name="l02894"></a>02894                             diffMons = ...
<a name="l02895"></a>02895                                 + mons(pm.processedIIIndexs,    :) - pm.counts(pm.processedIIIndexs, :) ...
<a name="l02896"></a>02896                                 + mons(pm.signalSequenceIndexs, :) - pm.counts(pm.signalSequenceIndexs, :) ...
<a name="l02897"></a>02897                                 + mons(pm.foldedIndexs,         :) - pm.counts(pm.foldedIndexs, :) ...
<a name="l02898"></a>02898                                 + mons(pm.matureIndexs,         :) - pm.counts(pm.matureIndexs, :) ...
<a name="l02899"></a>02899                                 + mons(pm.inactivatedIndexs,    :) - pm.counts(pm.inactivatedIndexs, :) ...
<a name="l02900"></a>02900                                 + mons(pm.boundIndexs,          :) - pm.counts(pm.boundIndexs, :) ...
<a name="l02901"></a>02901                                 + mons(pm.misfoldedIndexs,      :) - pm.counts(pm.misfoldedIndexs, :) ...
<a name="l02902"></a>02902                                 + mons(pm.damagedIndexs,        :) - pm.counts(pm.damagedIndexs, :);
<a name="l02903"></a>02903                             diffCpxs = ...
<a name="l02904"></a>02904                                 + cpxs(pc.nascentIndexs,     :) - pc.counts(pc.nascentIndexs, :) ...
<a name="l02905"></a>02905                                 + cpxs(pc.matureIndexs,      :) - pc.counts(pc.matureIndexs, :) ...
<a name="l02906"></a>02906                                 + cpxs(pc.inactivatedIndexs, :) - pc.counts(pc.inactivatedIndexs, :) ...
<a name="l02907"></a>02907                                 + cpxs(pc.boundIndexs,       :) - pc.counts(pc.boundIndexs, :) ...
<a name="l02908"></a>02908                                 + cpxs(pc.misfoldedIndexs,   :) - pc.counts(pc.misfoldedIndexs, :) ...
<a name="l02909"></a>02909                                 + cpxs(pc.damagedIndexs,     :) - pc.counts(pc.damagedIndexs, :);
<a name="l02910"></a>02910                             pm.counts(pm.processedIIndexs, :) = ...
<a name="l02911"></a>02911                                 + pm.counts(pm.processedIIndexs, :) ...
<a name="l02912"></a>02912                                 + diffMons;
<a name="l02913"></a>02913                             pm.counts(pm.processedIIndexs(monIdxs), :) = ...
<a name="l02914"></a>02914                                 + pm.counts(pm.processedIIndexs(monIdxs), :) ...
<a name="l02915"></a>02915                                 + pcComp(monIdxs, :) * diffCpxs;
<a name="l02916"></a>02916                             pm.counts(pm.matureIndexs(unprocessedMonIdxs), :) = ...
<a name="l02917"></a>02917                                 + pm.counts(pm.matureIndexs(unprocessedMonIdxs), :) ...
<a name="l02918"></a>02918                                 + pcComp(unprocessedMonIdxs, :) * diffCpxs;
<a name="l02919"></a>02919                             
<a name="l02920"></a>02920                             sim.evolveState();
<a name="l02921"></a>02921                             growths(j, k) = mr.growth;
<a name="l02922"></a>02922                         end
<a name="l02923"></a>02923                     end
<a name="l02924"></a>02924                     figData.data{i} = <span class="keyword">struct</span>;
<a name="l02925"></a>02925                     figData.data{i}.time = cumsum([ 0; log(2) ./ mean(growths(1:end-1, :), 2) .* exp(log(2) * (0:j-2)<span class="stringliteral">&#39;/4) / 4]) / 3600;</span>
<a name="l02926"></a>02926 <span class="stringliteral">                    figData.data{i}.growth = mean(growths, 2) * 3600 * cellInitialDryWeight / (1 - mass.fractionWetWeight) * 1e15;</span>
<a name="l02927"></a>02927 <span class="stringliteral">                    figData.data{i}.growths = growths * 3600 * cellInitialDryWeight / (1 - mass.fractionWetWeight) * 1e15;</span>
<a name="l02928"></a>02928 <span class="stringliteral">                    figData.data{i}.simEndTimes = j;</span>
<a name="l02929"></a>02929 <span class="stringliteral">                end</span>
<a name="l02930"></a>02930 <span class="stringliteral">            end</span>
<a name="l02931"></a>02931 <span class="stringliteral">            </span>
<a name="l02932"></a>02932 <span class="stringliteral">            %% plot data</span>
<a name="l02933"></a>02933 <span class="stringliteral">            clf(figHandle);</span>
<a name="l02934"></a>02934 <span class="stringliteral">            </span>
<a name="l02935"></a>02935 <span class="stringliteral">            options = struct;</span>
<a name="l02936"></a>02936 <span class="stringliteral">            options.colWidths = [2.4 0.5 2.4];</span>
<a name="l02937"></a>02937 <span class="stringliteral">            options.yAxesLabelWidths = [0.14 0.01 0.01];</span>
<a name="l02938"></a>02938 <span class="stringliteral">            options.xlabelStr = {&#39;</span>Time (h)<span class="stringliteral">&#39;, [], &#39;</span>Generation<span class="stringliteral">&#39;};</span>
<a name="l02939"></a>02939 <span class="stringliteral">            [axesHandles, xAxesHandles] = PlotUtil.multiElementPlot(figHandle, {50; 50; 50}, {[0 maxTime] [0 maxTime] generations([1 end])}, options);</span>
<a name="l02940"></a>02940 <span class="stringliteral">            delete(xAxesHandles{2});</span>
<a name="l02941"></a>02941 <span class="stringliteral">            </span>
<a name="l02942"></a>02942 <span class="stringliteral">            colors = PlotUtil.getRedGreenColorOrder(1:nGenerations);</span>
<a name="l02943"></a>02943 <span class="stringliteral">            colors = [</span>
<a name="l02944"></a>02944 <span class="stringliteral">                colors(1, :)</span>
<a name="l02945"></a>02945 <span class="stringliteral">                0 1 1</span>
<a name="l02946"></a>02946 <span class="stringliteral">                colors(1:end, :)</span>
<a name="l02947"></a>02947 <span class="stringliteral">                ];</span>
<a name="l02948"></a>02948 <span class="stringliteral">            classLabels = [</span>
<a name="l02949"></a>02949 <span class="stringliteral">                {&#39;</span>Generation 1 (Full Model)<span class="stringliteral">&#39;}</span>
<a name="l02950"></a>02950 <span class="stringliteral">                cellfun(@(i) [&#39;</span>Generation <span class="stringliteral">&#39; num2str(i)], num2cell((1:nGenerations)&#39;</span>), <span class="stringliteral">&#39;UniformOutput&#39;</span>, <span class="keyword">false</span>)
<a name="l02951"></a>02951                 {<span class="stringliteral">&#39;Wild-type&#39;</span>}
<a name="l02952"></a>02952                 ];
<a name="l02953"></a>02953             SingleGeneDeletions.plotSingleGeneDeletionTemporalDynamics(axesHandles{1}(1), axesHandles{2}(1), ...
<a name="l02954"></a>02954                 [data figData.data<span class="stringliteral">&#39;], 1:nGenerations+2, classLabels, [false; true; false(size(figData.data))], &#39;</span>growth<span class="stringliteral">&#39;, &#39;</span>Growth (fg h^{-1})&#39;, colors);
<a name="l02955"></a>02955             
<a name="l02956"></a>02956             axesHandle = axesHandles{3}(1);
<a name="l02957"></a>02957             growths = [];
<a name="l02958"></a>02958             groups = [];
<a name="l02959"></a>02959             <span class="keywordflow">for</span> i = 1:nGenerations
<a name="l02960"></a>02960                 growths = [growths figData.data{i}.growths(1, :)];
<a name="l02961"></a>02961                 groups = [groups repmat(generations(i), 1, nSamples)];
<a name="l02962"></a>02962             end
<a name="l02963"></a>02963             boxplot(growths, groups, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l02964"></a>02964             ylim(axesHandle, ylim(axesHandles{1}(1)));
<a name="l02965"></a>02965             <span class="keyword">set</span>(axesHandle, <span class="stringliteral">&#39;YTick&#39;</span>, []);
<a name="l02966"></a>02966         end
<a name="l02967"></a>02967         
<a name="l02968"></a>02968         %methionine aminopeptidase
<a name="l02969"></a>02969         <span class="keyword">function</span> figData = analyzeSingleGeneDeletionStrain_MG_172(figHandle, geneID, deletionData, wtData, figData)
<a name="l02970"></a>02970             import edu.stanford.covert.cell.sim.analysis.SingleGeneDeletions;
<a name="l02971"></a>02971             import edu.stanford.covert.cell.sim.util.CachedSimulationObjectUtil;
<a name="l02972"></a>02972             import edu.stanford.covert.cell.sim.util.PlotUtil;
<a name="l02973"></a>02973             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l02974"></a>02974             
<a name="l02975"></a>02975             %% constants
<a name="l02976"></a>02976             perturbations = struct;
<a name="l02977"></a>02977             perturbations.geneticKnockouts = {geneID};
<a name="l02978"></a>02978             
<a name="l02979"></a>02979             sim = CachedSimulationObjectUtil.load();
<a name="l02980"></a>02980             sim.applyOptions(<span class="stringliteral">&#39;lengthSec&#39;</span>, 0);
<a name="l02981"></a>02981             sim.applyOptions(perturbations);
<a name="l02982"></a>02982             
<a name="l02983"></a>02983             g = sim.gene;
<a name="l02984"></a>02984             mass = sim.state(<span class="stringliteral">&#39;Mass&#39;</span>);
<a name="l02985"></a>02985             r = sim.state(<span class="stringliteral">&#39;Rna&#39;</span>);
<a name="l02986"></a>02986             pm = sim.state(<span class="stringliteral">&#39;ProteinMonomer&#39;</span>);
<a name="l02987"></a>02987             pc = sim.state(<span class="stringliteral">&#39;ProteinComplex&#39;</span>);
<a name="l02988"></a>02988             mr = sim.state(<span class="stringliteral">&#39;MetabolicReaction&#39;</span>);
<a name="l02989"></a>02989             ppI = sim.process(<span class="stringliteral">&#39;ProteinProcessingI&#39;</span>);
<a name="l02990"></a>02990             met = sim.process(<span class="stringliteral">&#39;Metabolism&#39;</span>);
<a name="l02991"></a>02991             
<a name="l02992"></a>02992             sim.setForTest(<span class="stringliteral">&#39;processesInInitOrder&#39;</span>, sim.processesInInitOrder(~ismember(...
<a name="l02993"></a>02993                 cellfun(@(p) p.name, sim.processesInInitOrder, <span class="stringliteral">&#39;UniformOutput&#39;</span>, <span class="keyword">false</span>), {...
<a name="l02994"></a>02994                 <span class="stringliteral">&#39;Transcription&#39;</span>
<a name="l02995"></a>02995                 <span class="stringliteral">&#39;FtsZPolymerization&#39;</span>
<a name="l02996"></a>02996                 <span class="stringliteral">&#39;ChromosomeCondensation&#39;</span>
<a name="l02997"></a>02997                 <span class="stringliteral">&#39;Translation&#39;</span>
<a name="l02998"></a>02998                 <span class="stringliteral">&#39;DNASupercoiling&#39;</span>
<a name="l02999"></a>02999                 <span class="stringliteral">&#39;ReplicationInitiation&#39;</span>
<a name="l03000"></a>03000                 })));
<a name="l03001"></a>03001             
<a name="l03002"></a>03002             pcComp = sum(pc.proteinComplexComposition(g.mRNAIndexs, :, :), 3);
<a name="l03003"></a>03003             monIdxs = ppI.nascentMonomerNTerminalMethionineCleavages;
<a name="l03004"></a>03004             unprocessedMonIdxs = ~ppI.nascentMonomerNTerminalMethionineCleavages;
<a name="l03005"></a>03005             cpxIdxs = find(any(pcComp(monIdxs, :), 1));
<a name="l03006"></a>03006             
<a name="l03007"></a>03007             cellInitialDryWeight = mass.cellInitialDryWeight;
<a name="l03008"></a>03008             rnaExp = r.expression;
<a name="l03009"></a>03009             rnaDecayRates = r.decayRates;
<a name="l03010"></a>03010             monDecayRates = pm.decayRates;
<a name="l03011"></a>03011             cpxDecayRates = pc.decayRates;
<a name="l03012"></a>03012             
<a name="l03013"></a>03013             %% data
<a name="l03014"></a>03014             maxTime = NaN;
<a name="l03015"></a>03015             data = {deletionData, wtData};
<a name="l03016"></a>03016             <span class="keywordflow">for</span> i = 1:numel(data)
<a name="l03017"></a>03017                 maxTime = max(maxTime, data{i}.time(end));
<a name="l03018"></a>03018             end
<a name="l03019"></a>03019             
<a name="l03020"></a>03020             <span class="keywordflow">if</span> nargin &gt;= 5 &amp;&amp; ~isempty(figData)
<a name="l03021"></a>03021                 nSamples = figData.nSamples;
<a name="l03022"></a>03022                 nGenerations = figData.nGenerations;
<a name="l03023"></a>03023                 generations = figData.generations;
<a name="l03024"></a>03024             else
<a name="l03025"></a>03025                 nSamples = 20;
<a name="l03026"></a>03026                 nGenerations = 10;
<a name="l03027"></a>03027                 generations = 1:nGenerations;
<a name="l03028"></a>03028                 
<a name="l03029"></a>03029                 figData = struct;
<a name="l03030"></a>03030                 figData.data = cell(nGenerations, 1);
<a name="l03031"></a>03031                 figData.nSamples = nSamples;
<a name="l03032"></a>03032                 figData.nGenerations = nGenerations;
<a name="l03033"></a>03033                 figData.generations = generations;
<a name="l03034"></a>03034                 
<a name="l03035"></a>03035                 for i = 1:nGenerations
<a name="l03036"></a>03036                     growths = zeros(4, nSamples);
<a name="l03037"></a>03037                     for j = 1:5
<a name="l03038"></a>03038                         for k = 1:nSamples
<a name="l03039"></a>03039                             r.expression = rnaExp;
<a name="l03040"></a>03040                             r.decayRates = rnaDecayRates;
<a name="l03041"></a>03041                             pm.decayRates = monDecayRates;
<a name="l03042"></a>03042                             pc.decayRates = cpxDecayRates;
<a name="l03043"></a>03043                             mass.cellInitialDryWeight = cellInitialDryWeight * exp(log(2) * (j - 1) / 4);
<a name="l03044"></a>03044                             mr.initialGrowthFilterWidth = Inf;
<a name="l03045"></a>03045                                                         
<a name="l03046"></a>03046                             sim.applyOptions(&#39;seed&#39;, i * nGenerations + j * 5 +  k);
<a name="l03047"></a>03047                             sim.allocateMemoryForState(1);
<a name="l03048"></a>03048                             sim.initializeState();
<a name="l03049"></a>03049                             sim.applyPerturbations();
<a name="l03050"></a>03050                             
<a name="l03051"></a>03051                             mons = pm.counts;
<a name="l03052"></a>03052                             cpxs = pc.counts;
<a name="l03053"></a>03053                             
<a name="l03054"></a>03054                             pm.counts(pm.processedIIIndexs(monIdxs),    :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.processedIIIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03055"></a>03055                             pm.counts(pm.signalSequenceIndexs(monIdxs), :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.signalSequenceIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03056"></a>03056                             pm.counts(pm.foldedIndexs(monIdxs),         :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.foldedIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03057"></a>03057                             pm.counts(pm.matureIndexs(monIdxs),         :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.matureIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03058"></a>03058                             pm.counts(pm.inactivatedIndexs(monIdxs),    :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.inactivatedIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03059"></a>03059                             pm.counts(pm.boundIndexs(monIdxs),          :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.boundIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03060"></a>03060                             pm.counts(pm.misfoldedIndexs(monIdxs),      :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.misfoldedIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03061"></a>03061                             pm.counts(pm.damagedIndexs(monIdxs),        :) = pm.randStream.random(&#39;binomial&#39;, pm.counts(pm.damagedIndexs(monIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03062"></a>03062                             
<a name="l03063"></a>03063                             pc.counts(pc.nascentIndexs(cpxIdxs),     :) = pc.randStream.random(&#39;binomial&#39;, pc.counts(pc.nascentIndexs(cpxIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03064"></a>03064                             pc.counts(pc.matureIndexs(cpxIdxs),      :) = pc.randStream.random(&#39;binomial&#39;, pc.counts(pc.matureIndexs(cpxIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03065"></a>03065                             pc.counts(pc.inactivatedIndexs(cpxIdxs), :) = pc.randStream.random(&#39;binomial&#39;, pc.counts(pc.inactivatedIndexs(cpxIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03066"></a>03066                             pc.counts(pc.boundIndexs(cpxIdxs),       :) = pc.randStream.random(&#39;binomial&#39;, pc.counts(pc.boundIndexs(cpxIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03067"></a>03067                             pc.counts(pc.misfoldedIndexs(cpxIdxs),   :) = pc.randStream.random(&#39;binomial&#39;, pc.counts(pc.misfoldedIndexs(cpxIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03068"></a>03068                             pc.counts(pc.damagedIndexs(cpxIdxs),     :) = pc.randStream.random(&#39;binomial&#39;, pc.counts(pc.damagedIndexs(cpxIdxs), :), 1 / (2.^(generations(i) - 1)));
<a name="l03069"></a>03069                             
<a name="l03070"></a>03070                             diffMons = ...
<a name="l03071"></a>03071                                 + mons(pm.processedIIIndexs,    :) - pm.counts(pm.processedIIIndexs, :) ...
<a name="l03072"></a>03072                                 + mons(pm.signalSequenceIndexs, :) - pm.counts(pm.signalSequenceIndexs, :) ...
<a name="l03073"></a>03073                                 + mons(pm.foldedIndexs,         :) - pm.counts(pm.foldedIndexs, :) ...
<a name="l03074"></a>03074                                 + mons(pm.matureIndexs,         :) - pm.counts(pm.matureIndexs, :) ...
<a name="l03075"></a>03075                                 + mons(pm.inactivatedIndexs,    :) - pm.counts(pm.inactivatedIndexs, :) ...
<a name="l03076"></a>03076                                 + mons(pm.boundIndexs,          :) - pm.counts(pm.boundIndexs, :) ...
<a name="l03077"></a>03077                                 + mons(pm.misfoldedIndexs,      :) - pm.counts(pm.misfoldedIndexs, :) ...
<a name="l03078"></a>03078                                 + mons(pm.damagedIndexs,        :) - pm.counts(pm.damagedIndexs, :);
<a name="l03079"></a>03079                             diffCpxs = ...
<a name="l03080"></a>03080                                 + cpxs(pc.nascentIndexs,     :) - pc.counts(pc.nascentIndexs, :) ...
<a name="l03081"></a>03081                                 + cpxs(pc.matureIndexs,      :) - pc.counts(pc.matureIndexs, :) ...
<a name="l03082"></a>03082                                 + cpxs(pc.inactivatedIndexs, :) - pc.counts(pc.inactivatedIndexs, :) ...
<a name="l03083"></a>03083                                 + cpxs(pc.boundIndexs,       :) - pc.counts(pc.boundIndexs, :) ...
<a name="l03084"></a>03084                                 + cpxs(pc.misfoldedIndexs,   :) - pc.counts(pc.misfoldedIndexs, :) ...
<a name="l03085"></a>03085                                 + cpxs(pc.damagedIndexs,     :) - pc.counts(pc.damagedIndexs, :);
<a name="l03086"></a>03086                             pm.counts(pm.processedIIndexs, :) = ...
<a name="l03087"></a>03087                                 + pm.counts(pm.processedIIndexs, :) ...
<a name="l03088"></a>03088                                 + diffMons;
<a name="l03089"></a>03089                             pm.counts(pm.processedIIndexs(monIdxs), :) = ...
<a name="l03090"></a>03090                                 + pm.counts(pm.processedIIndexs(monIdxs), :) ...
<a name="l03091"></a>03091                                 + pcComp(monIdxs, :) * diffCpxs;
<a name="l03092"></a>03092                             pm.counts(pm.matureIndexs(unprocessedMonIdxs), :) = ...
<a name="l03093"></a>03093                                 + pm.counts(pm.matureIndexs(unprocessedMonIdxs), :) ...
<a name="l03094"></a>03094                                 + pcComp(unprocessedMonIdxs, :) * diffCpxs;
<a name="l03095"></a>03095                             
<a name="l03096"></a>03096                             processes = sim.processes;
<a name="l03097"></a>03097                             sim.setForTest(&#39;processes&#39;, {met});
<a name="l03098"></a>03098                             sim.evolveState();
<a name="l03099"></a>03099                             sim.setForTest(<span class="stringliteral">&#39;processes&#39;</span>, processes);
<a name="l03100"></a>03100                             
<a name="l03101"></a>03101                             growths(j, k) = mr.growth;
<a name="l03102"></a>03102                         end
<a name="l03103"></a>03103                     end
<a name="l03104"></a>03104                     figData.data{i} = <span class="keyword">struct</span>;
<a name="l03105"></a>03105                     figData.data{i}.time = cumsum([ 0; log(2) ./ mean(growths(1:end-1, :), 2) .* exp(log(2) * (0:j-2)<span class="stringliteral">&#39;/4) / 4]) / 3600;</span>
<a name="l03106"></a>03106 <span class="stringliteral">                    figData.data{i}.growth = mean(growths, 2) * 3600 * cellInitialDryWeight / (1 - mass.fractionWetWeight) * 1e15;</span>
<a name="l03107"></a>03107 <span class="stringliteral">                    figData.data{i}.growths = growths * 3600 * cellInitialDryWeight / (1 - mass.fractionWetWeight) * 1e15;</span>
<a name="l03108"></a>03108 <span class="stringliteral">                    figData.data{i}.simEndTimes = j;</span>
<a name="l03109"></a>03109 <span class="stringliteral">                end</span>
<a name="l03110"></a>03110 <span class="stringliteral">            end</span>
<a name="l03111"></a>03111 <span class="stringliteral">            </span>
<a name="l03112"></a>03112 <span class="stringliteral">            %% plot data</span>
<a name="l03113"></a>03113 <span class="stringliteral">            clf(figHandle);</span>
<a name="l03114"></a>03114 <span class="stringliteral">            </span>
<a name="l03115"></a>03115 <span class="stringliteral">            options = struct;</span>
<a name="l03116"></a>03116 <span class="stringliteral">            options.colWidths = [2.4 0.5 2.4];</span>
<a name="l03117"></a>03117 <span class="stringliteral">            options.yAxesLabelWidths = [0.14 0.01 0.01];</span>
<a name="l03118"></a>03118 <span class="stringliteral">            options.xlabelStr = {&#39;</span>Time (h)<span class="stringliteral">&#39;, [], &#39;</span>Generation<span class="stringliteral">&#39;};</span>
<a name="l03119"></a>03119 <span class="stringliteral">            [axesHandles, xAxesHandles] = PlotUtil.multiElementPlot(figHandle, {50; 50; 50}, {[0 maxTime] [0 maxTime] generations([1 end])}, options);</span>
<a name="l03120"></a>03120 <span class="stringliteral">            delete(xAxesHandles{2});</span>
<a name="l03121"></a>03121 <span class="stringliteral">            </span>
<a name="l03122"></a>03122 <span class="stringliteral">            colors = PlotUtil.getRedGreenColorOrder(1:nGenerations);</span>
<a name="l03123"></a>03123 <span class="stringliteral">            colors = [</span>
<a name="l03124"></a>03124 <span class="stringliteral">                colors(1, :)</span>
<a name="l03125"></a>03125 <span class="stringliteral">                0 1 1</span>
<a name="l03126"></a>03126 <span class="stringliteral">                colors(1:end, :)</span>
<a name="l03127"></a>03127 <span class="stringliteral">                ];</span>
<a name="l03128"></a>03128 <span class="stringliteral">            classLabels = [</span>
<a name="l03129"></a>03129 <span class="stringliteral">                {&#39;</span>Generation 1 (Full Model)<span class="stringliteral">&#39;}</span>
<a name="l03130"></a>03130 <span class="stringliteral">                cellfun(@(i) [&#39;</span>Generation <span class="stringliteral">&#39; num2str(i)], num2cell((1:nGenerations)&#39;</span>), <span class="stringliteral">&#39;UniformOutput&#39;</span>, <span class="keyword">false</span>)
<a name="l03131"></a>03131                 {<span class="stringliteral">&#39;Wild-type&#39;</span>}
<a name="l03132"></a>03132                 ];
<a name="l03133"></a>03133             SingleGeneDeletions.plotSingleGeneDeletionTemporalDynamics(axesHandles{1}(1), axesHandles{2}(1), ...
<a name="l03134"></a>03134                 [data figData.data<span class="stringliteral">&#39;], 1:nGenerations+2, classLabels, [false; true; false(size(figData.data))], &#39;</span>growth<span class="stringliteral">&#39;, &#39;</span>Growth (fg h^{-1})&#39;, colors);
<a name="l03135"></a>03135             
<a name="l03136"></a>03136             axesHandle = axesHandles{3}(1);
<a name="l03137"></a>03137             growths = [];
<a name="l03138"></a>03138             groups = [];
<a name="l03139"></a>03139             <span class="keywordflow">for</span> i = 1:nGenerations
<a name="l03140"></a>03140                 growths = [growths figData.data{i}.growths(1, :)];
<a name="l03141"></a>03141                 groups = [groups repmat(generations(i), 1, nSamples)];
<a name="l03142"></a>03142             end
<a name="l03143"></a>03143             boxplot(growths, groups, <span class="stringliteral">&#39;Parent&#39;</span>, axesHandle);
<a name="l03144"></a>03144             ylim(axesHandle, ylim(axesHandles{1}(1)));
<a name="l03145"></a>03145             <span class="keyword">set</span>(axesHandle, <span class="stringliteral">&#39;YTick&#39;</span>, []);
<a name="l03146"></a>03146         end
<a name="l03147"></a>03147     end
<a name="l03148"></a>03148     
<a name="l03149"></a>03149     %helper methods
<a name="l03150"></a>03150     methods (Static = <span class="keyword">true</span>)
<a name="l03151"></a>03151         function [deletionDoublingTimes, wtDoublingTime] = getExperimentalDoublingTimes(sim)
<a name="l03152"></a>03152             import edu.stanford.covert.cell.sim.util.CachedSimulationObjectUtil;
<a name="l03153"></a>03153             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
<a name="l03154"></a>03154             
<a name="l03155"></a>03155             if nargin &lt; 1
<a name="l03156"></a>03156                 sim = CachedSimulationObjectUtil.load();
<a name="l03157"></a>03157             end
<a name="l03158"></a>03158             g = sim.gene;
<a name="l03159"></a>03159             
<a name="l03160"></a>03160             %read data
<a name="l03161"></a>03161             [~, ~, raw] = xlsread(&#39;data/singleGeneDeletions.xls&#39;, &#39;Doubling Time&#39;, &#39;A1:AA100&#39;, &#39;basic&#39;);
<a name="l03162"></a>03162             colLabels = raw(2, :);
<a name="l03163"></a>03163             strainIDs = raw(3:end, strcmp(colLabels, &#39;ID&#39;));
<a name="l03164"></a>03164             strainMeanDoublingTimes = cell2mat(raw(3:end, strcmp(colLabels, &#39;Mean (h)&#39;)));
<a name="l03165"></a>03165             strainStdDoublingTimes = cell2mat(raw(3:end, strcmp(colLabels, &#39;Standard Deviation (h)&#39;)));
<a name="l03166"></a>03166             strainNumReplicateDoublingTimes = cell2mat(raw(3:end, strcmp(colLabels, &#39;No. Replicates&#39;)));
<a name="l03167"></a>03167             
<a name="l03168"></a>03168             %wild-type growth rate
<a name="l03169"></a>03169             wtDoublingTime = NaN(1, 3);
<a name="l03170"></a>03170             wtDoublingTime(1, 1) = strainMeanDoublingTimes(ismember(strainIDs, &#39;WT&#39;));
<a name="l03171"></a>03171             wtDoublingTime(1, 2) = strainStdDoublingTimes(ismember(strainIDs, &#39;WT&#39;));
<a name="l03172"></a>03172             wtDoublingTime(1, 3) = strainNumReplicateDoublingTimes(ismember(strainIDs, &#39;WT&#39;));
<a name="l03173"></a>03173             
<a name="l03174"></a>03174             %deletion growth rates
<a name="l03175"></a>03175             deletionDoublingTimes = NaN(size(g.wholeCellModelIDs, 1), 3);
<a name="l03176"></a>03176             
<a name="l03177"></a>03177             deletionDoublingTimes(strcmp(g.essential, &#39;Y&#39;), 1) = 0;
<a name="l03178"></a>03178             deletionDoublingTimes(strcmp(g.essential, &#39;Y&#39;), 2) = NaN;
<a name="l03179"></a>03179             deletionDoublingTimes(strcmp(g.essential, &#39;Y&#39;), 3) = 0;
<a name="l03180"></a>03180             
<a name="l03181"></a>03181             [tfs, idxs] = ismember(strainIDs, g.wholeCellModelIDs);
<a name="l03182"></a>03182             deletionDoublingTimes(idxs(tfs), 1) = strainMeanDoublingTimes(tfs);
<a name="l03183"></a>03183             deletionDoublingTimes(idxs(tfs), 2) = strainStdDoublingTimes(tfs);
<a name="l03184"></a>03184             deletionDoublingTimes(idxs(tfs), 3) = strainNumReplicateDoublingTimes(tfs);
<a name="l03185"></a>03185             deletionDoublingTimes(isnan(deletionDoublingTimes(:, 1)), 2) = wtDoublingTime(1, 2);
<a name="l03186"></a>03186             deletionDoublingTimes(isnan(deletionDoublingTimes(:, 1)), 3) = 0;
<a name="l03187"></a>03187             deletionDoublingTimes(isnan(deletionDoublingTimes(:, 1)), 1) = wtDoublingTime(1, 1);
<a name="l03188"></a>03188         end
<a name="l03189"></a>03189         
<a name="l03190"></a>03190         function [tfs, molecules, processes] = getGeneImplementations(sim)
<a name="l03191"></a>03191             g = sim.gene;
<a name="l03192"></a>03192             
<a name="l03193"></a>03193             tfs = false(size(g.wholeCellModelIDs));
<a name="l03194"></a>03194             molecules = repmat({{}}, size(g.wholeCellModelIDs));
<a name="l03195"></a>03195             processes = repmat({{}}, size(g.wholeCellModelIDs));
<a name="l03196"></a>03196             
<a name="l03197"></a>03197             <span class="keywordflow">for</span> i = 1:length(sim.processes)
<a name="l03198"></a>03198                 m = sim.processes{i};
<a name="l03199"></a>03199                 
<a name="l03200"></a>03200                 %stimuli
<a name="l03201"></a>03201                 stimuliGeneComposition = m.stimuliGeneComposition();
<a name="l03202"></a>03202                 <span class="keywordflow">for</span> j = 1:length(sim.gene.wholeCellModelIDs)
<a name="l03203"></a>03203                     for k = 1:length(m.stimuliWholeCellModelIDs)
<a name="l03204"></a>03204                         if ~stimuliGeneComposition(j, k)
<a name="l03205"></a>03205                             continue;
<a name="l03206"></a>03206                         end
<a name="l03207"></a>03207                         
<a name="l03208"></a>03208                         tfs(j) = true;
<a name="l03209"></a>03209                         molecules{j} = [molecules{j}; m.stimuliWholeCellModelIDs(k)];
<a name="l03210"></a>03210                         processes{j} = [processes{j}; m.wholeCellModelID];
<a name="l03211"></a>03211                     end
<a name="l03212"></a>03212                 end
<a name="l03213"></a>03213                 
<a name="l03214"></a>03214                 %substrates
<a name="l03215"></a>03215                 substrateGeneComposition = m.substrateGeneComposition();
<a name="l03216"></a>03216                 <span class="keywordflow">for</span> j = 1:length(sim.gene.wholeCellModelIDs)
<a name="l03217"></a>03217                     for k = 1:length(m.substrateWholeCellModelIDs)
<a name="l03218"></a>03218                         if ~substrateGeneComposition(j, k)
<a name="l03219"></a>03219                             continue;
<a name="l03220"></a>03220                         end
<a name="l03221"></a>03221                         
<a name="l03222"></a>03222                         tfs(j) = true;
<a name="l03223"></a>03223                         molecules{j} = [molecules{j}; m.substrateWholeCellModelIDs(k)];
<a name="l03224"></a>03224                         processes{j} = [processes{j}; m.wholeCellModelID];
<a name="l03225"></a>03225                     end
<a name="l03226"></a>03226                 end
<a name="l03227"></a>03227                 
<a name="l03228"></a>03228                 %enzymes
<a name="l03229"></a>03229                 enzymeGeneComposition = m.enzymeGeneComposition();
<a name="l03230"></a>03230                 <span class="keywordflow">for</span> j = 1:length(sim.gene.wholeCellModelIDs)
<a name="l03231"></a>03231                     for k = 1:length(m.enzymeWholeCellModelIDs)
<a name="l03232"></a>03232                         if ~enzymeGeneComposition(j, k)
<a name="l03233"></a>03233                             continue;
<a name="l03234"></a>03234                         end
<a name="l03235"></a>03235                         
<a name="l03236"></a>03236                         tfs(j) = true;
<a name="l03237"></a>03237                         molecules{j} = [molecules{j}; m.enzymeWholeCellModelIDs(k)];
<a name="l03238"></a>03238                         processes{j} = [processes{j}; m.wholeCellModelID];
<a name="l03239"></a>03239                     end
<a name="l03240"></a>03240                 end
<a name="l03241"></a>03241             end
<a name="l03242"></a>03242         end
<a name="l03243"></a>03243     end
<a name="l03244"></a>03244 end
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="_single_gene_deletions_8m.html">SingleGeneDeletions.m</a>      </li>

    <li class="footer">Generated on Wed Feb 8 2012 21:42:32 for Whole Cell Simulation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
