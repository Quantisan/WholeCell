<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of KnowledgeBase</title>
  <meta name="keywords" content="KnowledgeBase">
  <meta name="description" content="Defines a knowledge base">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../../../../index.html">Home</a> &gt;  <a href="../../../../../../index.html">simulation</a> &gt; <a href="#">src</a> &gt; <a href="#">+edu</a> &gt; <a href="#">+stanford</a> &gt; <a href="#">+covert</a> &gt; <a href="#">+cell</a> &gt; <a href="index.html">+kb</a> &gt; KnowledgeBase.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../../../../index.html"><img alt="<" border="0" src="../../../../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for simulation/src/+edu/+stanford/+covert/+cell/+kb&nbsp;<img alt=">" border="0" src="../../../../../../../right.png"></a></td></tr></table>-->

<h1>KnowledgeBase
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../../../../up.png"></a></h2>
<div class="box"><strong>Defines a knowledge base</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Defines a knowledge base

 Author: Jonathan Karr
 Affilitation: Covert Lab, Department of Bioengineering, Stanford University
 Last updated: 9/17/2009</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../../../../matlabicon.gif)">
<li><a href="KnowledgeBase.html" class="code" title="">KnowledgeBase</a>	Defines a knowledge base</li><li><a href="tRNA.html" class="code" title="">tRNA</a>	Defines a tRNA polymer</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../../../../matlabicon.gif)">
<li><a href="KnowledgeBase.html" class="code" title="">KnowledgeBase</a>	Defines a knowledge base</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../../../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../../../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function this = KnowledgeBase(database, wid)</a></li><li><a href="#_sub2" class="code">function value = get.biomassComposition(this)</a></li><li><a href="#_sub3" class="code">function value = get.geneComposition(this)</a></li><li><a href="#_sub4" class="code">function value = get.probRNAPolBinding(this)</a></li><li><a href="#_sub5" class="code">function value = get.geneticCodeCodons(this)</a></li><li><a href="#_sub6" class="code">function value = get.geneticCodeTRNAs(this)</a></li><li><a href="#_sub7" class="code">function value = get.geneticCodeAminoAcids(this)</a></li><li><a href="#_sub8" class="code">function value = get.geneticCodeStartCodons(this)</a></li><li><a href="#_sub9" class="code">function value = get.geneticCodeStartTRNAs(this)</a></li><li><a href="#_sub10" class="code">function value = get.geneticCodeStartAminoAcids(this)</a></li><li><a href="#_sub11" class="code">function value = get.geneticCodeTRNAAminoacylation(this)</a></li><li><a href="#_sub12" class="code">function value = get.nascentRNAs(this)</a></li><li><a href="#_sub13" class="code">function value = get.intergenicRNAs(this)</a></li><li><a href="#_sub14" class="code">function value = get.processedRNAs(this)</a></li><li><a href="#_sub15" class="code">function value = get.matureRNAs(this)</a></li><li><a href="#_sub16" class="code">function value = get.aminoacylatedRNAs(this)</a></li><li><a href="#_sub17" class="code">function value = get.transcriptionUnitComposition_Genes(this)</a></li><li><a href="#_sub18" class="code">function value = get.transcriptionUnitComposition_IntergenicRNAs(this)</a></li><li><a href="#_sub19" class="code">function value = get.transcriptionUnitComposition_ProcessedRNAs(this)</a></li><li><a href="#_sub20" class="code">function value = get.processedRNAComposition_Genes(this)</a></li><li><a href="#_sub21" class="code">function value = get.proteinMonomerTRNASequences(this)</a></li><li><a href="#_sub22" class="code">function [tRNASequences, aaSequences] = computeTRNASequences(this, dnaSequences, findStartCodon)</a></li><li><a href="#_sub23" class="code">function value = get.proteinMonomerTRNACounts(this)</a></li><li><a href="#_sub24" class="code">function value = get.proteinMonomerCompartments(this)</a></li><li><a href="#_sub25" class="code">function value = get.proteinMonomerComposition(this)</a></li><li><a href="#_sub26" class="code">function value = get.proteinMonomerNTerminalMethionineCleavages(this)</a></li><li><a href="#_sub27" class="code">function value = get.proteinMonomerSignalSequenceBaseCounts(this)</a></li><li><a href="#_sub28" class="code">function value = get.proteinMonomerSignalSequenceMolecularWeights(this)</a></li><li><a href="#_sub29" class="code">function value = get.proteinProstheticGroupMatrix(this)</a></li><li><a href="#_sub30" class="code">function value = get.proteinChaperoneMatrix(this)</a></li><li><a href="#_sub31" class="code">function value = get.proteinComplexRNAComposition(this)</a></li><li><a href="#_sub32" class="code">function value = get.proteinComplexMonomerComposition(this)</a></li><li><a href="#_sub33" class="code">function value = get.proteinComplexComplexComposition(this)</a></li><li><a href="#_sub34" class="code">function value = get.proteinComplexAllRNAComposition(this)</a></li><li><a href="#_sub35" class="code">function value = get.proteinComplexAllMonomerComposition(this)</a></li><li><a href="#_sub36" class="code">function value = get.proteinComplexCompartments(this)</a></li><li><a href="#_sub37" class="code">function value = get.reactionStimuliStoichiometryMatrix(this)</a></li><li><a href="#_sub38" class="code">function value = get.reactionMetaboliteStoichiometryMatrix(this)</a></li><li><a href="#_sub39" class="code">function value = get.reactionRNAStoichiometryMatrix(this)</a></li><li><a href="#_sub40" class="code">function value = get.reactionProteinMonomerStoichiometryMatrix(this)</a></li><li><a href="#_sub41" class="code">function value = get.reactionProteinComplexStoichiometryMatrix(this)</a></li><li><a href="#_sub42" class="code">function value = get.reactionModificationMatrix(this)</a></li><li><a href="#_sub43" class="code">function value = get.reactionBounds(this)</a></li><li><a href="#_sub44" class="code">function value = get.enzymeBounds(this)</a></li><li><a href="#_sub45" class="code">function bound = enzymeBound(~, vmax, vmaxUnits, enzymeMolecularWeight)</a></li><li><a href="#_sub46" class="code">function value = get.reactionCatalysisMatrix(this)</a></li><li><a href="#_sub47" class="code">function value = get.reactionCoenzymeMatrix(this)</a></li><li><a href="#_sub48" class="code">function value = get.maxGeneLength(this)</a></li><li><a href="#_sub49" class="code">function value = get.maxTranscriptionUnitLength(this)</a></li><li><a href="#_sub50" class="code">function value = get.maxGeneExpression(this)</a></li><li><a href="#_sub51" class="code">function value = get.maxTranscriptionUnitExpression(this)</a></li><li><a href="#_sub52" class="code">function loadFromKnowledgeBase(this, database)</a></li><li><a href="#_sub53" class="code">function linkObjects(this, database, objectName1, objectName2, options)</a></li><li><a href="#_sub54" class="code">function computeDependentProperties(this)</a></li><li><a href="#_sub55" class="code">function delete(this)</a></li><li><a href="#_sub56" class="code">function deleteLinks(this)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% Defines a knowledge base</span>
0002 <span class="comment">%</span>
0003 <span class="comment">% Author: Jonathan Karr</span>
0004 <span class="comment">% Affilitation: Covert Lab, Department of Bioengineering, Stanford University</span>
0005 <span class="comment">% Last updated: 9/17/2009</span>
0006 classdef <a href="KnowledgeBase.html" class="code" title="">KnowledgeBase</a> &lt; edu.stanford.covert.cell.kb.KnowledgeBaseObject
0007     properties
0008         version
0009         investigator
0010         taxonomy
0011         translationTable
0012 
0013         parameters         = edu.stanford.covert.cell.kb.Parameter.empty(0,0);
0014         processes          = edu.stanford.covert.cell.kb.Process.empty(0,0);
0015         states             = edu.stanford.covert.cell.kb.State.empty(0,0);
0016         compartments       = edu.stanford.covert.cell.kb.Compartment.empty(0,0);
0017         metabolites        = edu.stanford.covert.cell.kb.Metabolite.empty(0,0);
0018         genome             = edu.stanford.covert.cell.kb.Genome.empty(0,0);
0019         genes              = edu.stanford.covert.cell.kb.Gene.empty(0,0);
0020         transcriptionUnits = edu.stanford.covert.cell.kb.TranscriptionUnit.empty(0,0);
0021         genomeFeatures     = edu.stanford.covert.cell.kb.GenomeFeature.empty(0,0);
0022         proteinMonomers    = edu.stanford.covert.cell.kb.ProteinMonomer.empty(0,0);
0023         proteinComplexs    = edu.stanford.covert.cell.kb.ProteinComplex.empty(0,0);
0024         reactions          = edu.stanford.covert.cell.kb.Reaction.empty(0,0);
0025         pathways           = edu.stanford.covert.cell.kb.Pathway.empty(0,0);
0026         stimulis           = edu.stanford.covert.cell.kb.Stimuli.empty(0,0);
0027         notes              = edu.stanford.covert.cell.kb.Note.empty(0,0);
0028 
0029         maxAvgMetConc
0030         maxAvgRxnFlux
0031     <span class="keyword">end</span>
0032 
0033     properties (Constant = true)
0034         cytosolCompartmentWholeCellModelIDs                   = {<span class="string">'c'</span>};
0035         chromosomeCompartmentWholeCellModelIDs                = {<span class="string">'d'</span>};
0036         membraneCompartmentWholeCellModelIDs                  = {<span class="string">'m'</span>};
0037         terminalOrganelleCytosolCompartmentWholeCellModelIDs  = {<span class="string">'tc'</span>};
0038         terminalOrganelleMembraneCompartmentWholeCellModelIDs = {<span class="string">'tm'</span>};
0039         extracellularCompartmentWholeCellModelIDs             = {<span class="string">'e'</span>};
0040     <span class="keyword">end</span>
0041 
0042     <span class="comment">%computed properties</span>
0043     properties (SetAccess = protected)
0044         numProcesses
0045         numStates
0046         numParameters
0047         numCompartments
0048         numMetabolites
0049         numGenes
0050         numTranscriptionUnits
0051         numGenomeFeatures
0052         numProteinMonomers
0053         numProteinComplexs
0054         numReactions
0055         numPathways
0056         numStimulis
0057         numNotes
0058         numReferences
0059 
0060         cytosolCompartmentIndexs
0061         chromosomeCompartmentIndexs
0062         membraneCompartmentIndexs
0063         terminalOrganelleCytosolCompartmentIndexs
0064         terminalOrganelleMembraneCompartmentIndexs
0065         extracellularCompartmentIndexs
0066         cellularCompartmentIndexs
0067 
0068         waterIndexs
0069         hydrogenIndexs
0070         dnmpIndexs
0071         nmpIndexs
0072         modifiedNMPIndexs
0073         aminoAcidIndexs
0074         cysteineIndexs
0075         methionineIndexs
0076         fmethionineIndexs
0077         modifiedAminoAcidIndexs
0078         diacylglycerolCysteineIndexs
0079 
0080         mRNAGenes
0081         rRNAGenes
0082         sRNAGenes
0083         tRNAGenes
0084 
0085         ribosomalRRNAIndexs
0086   
0087         metaboliteMolecularWeights
0088   
0089         biomassComposition
0090 
0091         geneComposition        
0092         probRNAPolBinding
0093 
0094         geneticCodeCodons
0095         geneticCodeTRNAs
0096         geneticCodeAminoAcids
0097         geneticCodeStartCodons
0098         geneticCodeStartTRNAs
0099         geneticCodeStartAminoAcids
0100         geneticCodeTRNAAminoacylation
0101         
0102         nascentRNAs
0103         intergenicRNAs
0104         processedRNAs        
0105         matureRNAs        
0106         aminoacylatedRNAs
0107         transcriptionUnitComposition_Genes
0108         transcriptionUnitComposition_IntergenicRNAs
0109         transcriptionUnitComposition_ProcessedRNAs
0110         processedRNAComposition_Genes
0111 
0112         proteinMonomerTRNASequences
0113         proteinMonomerTRNACounts
0114         proteinMonomerCompartments
0115         proteinMonomerComposition
0116         proteinMonomerNTerminalMethionineCleavages
0117         proteinMonomerSignalSequenceBaseCounts
0118         proteinMonomerSignalSequenceMolecularWeights
0119         proteinProstheticGroupMatrix
0120         proteinChaperoneMatrix
0121         proteinComplexRNAComposition
0122         proteinComplexMonomerComposition
0123         proteinComplexComplexComposition
0124         proteinComplexAllRNAComposition
0125         proteinComplexAllMonomerComposition
0126         proteinComplexCompartments
0127 
0128         reactionStimuliStoichiometryMatrix
0129         reactionMetaboliteStoichiometryMatrix
0130         reactionRNAStoichiometryMatrix
0131         reactionProteinMonomerStoichiometryMatrix
0132         reactionProteinComplexStoichiometryMatrix
0133         reactionModifiedProteinStoichiometryMatrix
0134         reactionModificationMatrix
0135         reactionBounds
0136         enzymeBounds
0137         reactionCatalysisMatrix
0138         reactionCoenzymeMatrix
0139 
0140         maxGeneLength
0141         maxTranscriptionUnitLength
0142         maxGeneExpression
0143         maxTranscriptionUnitExpression
0144     <span class="keyword">end</span>
0145 
0146     methods
0147         <a name="_sub0" href="#_subfunctions" class="code">function this = KnowledgeBase(database, wid)</a>
0148             <span class="keyword">if</span> ~exist(<span class="string">'wid'</span>, <span class="string">'var'</span>)
0149                 wid = edu.stanford.covert.cell.kb.KnowledgeBaseUtil.selectLatestKnowledgeBase(database);
0150             <span class="keyword">end</span>
0151             this.wid = wid;
0152             this.loadFromKnowledgeBase(database);
0153             this.computeDependentProperties();
0154         <span class="keyword">end</span>
0155 
0156         <span class="comment">%% biomass composition</span>
0157         <span class="comment">%metabolite composition of biomass</span>
0158         <a name="_sub1" href="#_subfunctions" class="code">function value = get.biomassComposition(this)</a>
0159             <span class="comment">%retrieve</span>
0160             <span class="keyword">if</span> ~isempty(this.biomassComposition)
0161                 value = this.biomassComposition;
0162                 <span class="keyword">return</span>;
0163             <span class="keyword">end</span>
0164             
0165             <span class="comment">%calculate</span>
0166             value = zeros(this.numMetabolites,this.numCompartments);
0167             <span class="keyword">for</span> i = 1:this.numMetabolites
0168                 <span class="keyword">if</span> ~isempty(this.metabolites(i).biomassCompartments)
0169                     value(i,[this.metabolites(i).biomassCompartments.idx]) = <span class="keyword">...</span>
0170                         this.metabolites(i).biomassCoefficients;
0171                 <span class="keyword">end</span>
0172             <span class="keyword">end</span>
0173             value = -value;
0174             
0175             <span class="comment">%store</span>
0176             this.biomassComposition = value;
0177         <span class="keyword">end</span>
0178 
0179         <span class="comment">%% genes</span>
0180         <span class="comment">%metabolite composition of genes</span>
0181         <a name="_sub2" href="#_subfunctions" class="code">function value = get.geneComposition(this)</a>
0182             <span class="comment">%retrieve</span>
0183             <span class="keyword">if</span> ~isempty(this.geneComposition)
0184                 value = this.geneComposition;
0185                 <span class="keyword">return</span>;
0186             <span class="keyword">end</span>
0187             
0188             <span class="comment">%calculate</span>
0189             value = reshape([this.genes.baseCount],[],length(this.genes))';
0190             
0191             <span class="comment">%store</span>
0192             this.geneComposition = value;
0193         <span class="keyword">end</span>       
0194 
0195         <span class="comment">%% transcription</span>
0196         <span class="comment">%probability of RNA polymerase binding to transcription units</span>
0197         <a name="_sub3" href="#_subfunctions" class="code">function value = get.probRNAPolBinding(this)</a>
0198             <span class="comment">%retrieve</span>
0199             <span class="keyword">if</span> ~isempty(this.probRNAPolBinding)
0200                 value = this.probRNAPolBinding;
0201                 <span class="keyword">return</span>;
0202             <span class="keyword">end</span>
0203             
0204             <span class="comment">%calculate</span>
0205             synthesisRates = reshape([this.transcriptionUnits.synthesisRate], [], this.numTranscriptionUnits)';
0206             value = synthesisRates ./ repmat(sum(synthesisRates), this.numTranscriptionUnits, 1);
0207             
0208             <span class="comment">%store</span>
0209             this.probRNAPolBinding = value;
0210         <span class="keyword">end</span>
0211 
0212         <span class="comment">%% genetic code</span>
0213         <a name="_sub4" href="#_subfunctions" class="code">function value = get.geneticCodeCodons(this)</a>
0214             <span class="comment">%retrieve</span>
0215             <span class="keyword">if</span> ~isempty(this.geneticCodeCodons)
0216                 value = this.geneticCodeCodons;
0217                 <span class="keyword">return</span>;
0218             <span class="keyword">end</span>
0219             
0220             <span class="comment">%calculate</span>
0221             value = {};
0222             <span class="keyword">for</span> i = 1:length(this.tRNAGenes)
0223                 <span class="keyword">if</span> this.tRNAGenes(i).startCodon; <span class="keyword">continue</span>; <span class="keyword">end</span>;
0224                 value = [value this.tRNAGenes(i).codons]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0225             <span class="keyword">end</span>
0226             
0227             <span class="comment">%store</span>
0228             this.geneticCodeCodons = value;
0229         <span class="keyword">end</span>
0230 
0231         <a name="_sub5" href="#_subfunctions" class="code">function value = get.geneticCodeTRNAs(this)</a>
0232             <span class="comment">%retrieve</span>
0233             <span class="keyword">if</span> ~isempty(this.geneticCodeTRNAs)
0234                 value = this.geneticCodeTRNAs;
0235                 <span class="keyword">return</span>;
0236             <span class="keyword">end</span>
0237             
0238             <span class="comment">%calculate</span>
0239             value=[];
0240             <span class="keyword">for</span> i=1:length(this.tRNAGenes)
0241                 <span class="keyword">if</span> this.tRNAGenes(i).startCodon; <span class="keyword">continue</span>; <span class="keyword">end</span>;
0242                 value = [value; repmat(i,length(this.tRNAGenes(i).codons), 1)]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0243             <span class="keyword">end</span>
0244             
0245             <span class="comment">%store</span>
0246             this.geneticCodeTRNAs = value;
0247         <span class="keyword">end</span>
0248 
0249         <a name="_sub6" href="#_subfunctions" class="code">function value = get.geneticCodeAminoAcids(this)</a>
0250             <span class="comment">%retrieve</span>
0251             <span class="keyword">if</span> ~isempty(this.geneticCodeAminoAcids)
0252                 value = this.geneticCodeAminoAcids;
0253                 <span class="keyword">return</span>;
0254             <span class="keyword">end</span>
0255             
0256             <span class="comment">%calculate</span>
0257             value={};
0258             <span class="keyword">for</span> i=1:length(this.tRNAGenes)
0259                 <span class="keyword">if</span> this.tRNAGenes(i).startCodon; <span class="keyword">continue</span>; <span class="keyword">end</span>;
0260                 <span class="keyword">for</span> j=1:length(this.tRNAGenes(i).codons)
0261                     value{end + 1} = this.tRNAGenes(i).aminoAcid.wholeCellModelID; <span class="comment">%#ok&lt;AGROW&gt;</span>
0262                 <span class="keyword">end</span>
0263             <span class="keyword">end</span>
0264             
0265             <span class="comment">%store</span>
0266             this.geneticCodeAminoAcids = value;
0267         <span class="keyword">end</span>
0268 
0269         <a name="_sub7" href="#_subfunctions" class="code">function value = get.geneticCodeStartCodons(this)</a>
0270             <span class="comment">%retrieve</span>
0271             <span class="keyword">if</span> ~isempty(this.geneticCodeStartCodons)
0272                 value = this.geneticCodeStartCodons;
0273                 <span class="keyword">return</span>;
0274             <span class="keyword">end</span>
0275             
0276             <span class="comment">%calculate</span>
0277             value={};
0278             <span class="keyword">for</span> i=1:length(this.tRNAGenes)
0279                 <span class="keyword">if</span> ~this.tRNAGenes(i).startCodon; <span class="keyword">continue</span>; <span class="keyword">end</span>;
0280                 value = [value this.tRNAGenes(i).codons]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0281             <span class="keyword">end</span>
0282             
0283             <span class="comment">%store</span>
0284             this.geneticCodeStartCodons = value;
0285         <span class="keyword">end</span>
0286 
0287         <a name="_sub8" href="#_subfunctions" class="code">function value = get.geneticCodeStartTRNAs(this)</a>
0288             <span class="comment">%retrieve</span>
0289             <span class="keyword">if</span> ~isempty(this.geneticCodeStartTRNAs)
0290                 value = this.geneticCodeStartTRNAs;
0291                 <span class="keyword">return</span>;
0292             <span class="keyword">end</span>
0293             
0294             <span class="comment">%calculate</span>
0295             value=[];
0296             <span class="keyword">for</span> i=1:length(this.tRNAGenes)
0297                 <span class="keyword">if</span> ~this.tRNAGenes(i).startCodon; <span class="keyword">continue</span>; <span class="keyword">end</span>;
0298                 value = [value; repmat(i, length(this.tRNAGenes(i).codons), 1)]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0299             <span class="keyword">end</span>
0300             
0301             <span class="comment">%store</span>
0302             this.geneticCodeStartTRNAs = value;
0303         <span class="keyword">end</span>
0304 
0305         <a name="_sub9" href="#_subfunctions" class="code">function value = get.geneticCodeStartAminoAcids(this)</a>
0306             <span class="comment">%retrieve</span>
0307             <span class="keyword">if</span> ~isempty(this.geneticCodeStartAminoAcids)
0308                 value = this.geneticCodeStartAminoAcids;
0309                 <span class="keyword">return</span>;
0310             <span class="keyword">end</span>
0311             
0312             <span class="comment">%calculate</span>
0313             value={};
0314             <span class="keyword">for</span> i=1:length(this.tRNAGenes)
0315                 <span class="keyword">if</span> ~this.tRNAGenes(i).startCodon; <span class="keyword">continue</span>; <span class="keyword">end</span>;
0316                 <span class="keyword">for</span> j=1:length(this.tRNAGenes(i).codons)
0317                     value{end + 1} = this.tRNAGenes(i).aminoAcid.wholeCellModelID; <span class="comment">%#ok&lt;AGROW&gt;</span>
0318                 <span class="keyword">end</span>
0319             <span class="keyword">end</span>
0320             
0321             <span class="comment">%store</span>
0322             this.geneticCodeStartAminoAcids = value;
0323         <span class="keyword">end</span>
0324 
0325         <a name="_sub10" href="#_subfunctions" class="code">function value = get.geneticCodeTRNAAminoacylation(this)</a>
0326             <span class="comment">%retrieve</span>
0327             <span class="keyword">if</span> ~isempty(this.geneticCodeTRNAAminoacylation)
0328                 value = this.geneticCodeTRNAAminoacylation;
0329                 <span class="keyword">return</span>;
0330             <span class="keyword">end</span>
0331             
0332             <span class="comment">%calculate</span>
0333             value = zeros(length(this.aminoAcidIndexs), length(this.tRNAGenes), this.numCompartments);
0334             <span class="keyword">for</span> i = 1:length(this.tRNAGenes)
0335                 value(this.tRNAGenes(i).aminoAcid.idx == this.aminoAcidIndexs, i, this.cytosolCompartmentIndexs) = 1;
0336             <span class="keyword">end</span>
0337             
0338             <span class="comment">%store</span>
0339             this.geneticCodeTRNAAminoacylation = value;
0340         <span class="keyword">end</span>
0341         
0342         <span class="comment">%% RNAs - nascent, intergenic, processed, mature, aminoacylated</span>
0343         <a name="_sub11" href="#_subfunctions" class="code">function value = get.nascentRNAs(this)</a>
0344             <span class="comment">%retrieve</span>
0345             <span class="keyword">if</span> ~isempty(this.nascentRNAs)
0346                 value = this.nascentRNAs;
0347                 <span class="keyword">return</span>;
0348             <span class="keyword">end</span>
0349             
0350             <span class="comment">%calculate</span>
0351             value = struct();
0352             value.wholeCellModelIDs = {this.transcriptionUnits.wholeCellModelID}';
0353             value.names             = {this.transcriptionUnits.name}';
0354             value.sequences         = {this.transcriptionUnits.sequence}';
0355             value.lengths           = [this.transcriptionUnits.sequenceLength]';
0356             value.baseCounts        = reshape([this.transcriptionUnits.baseCount], [], this.numTranscriptionUnits)';
0357             value.decayReactions    = reshape([this.transcriptionUnits.decayReaction], [], this.numTranscriptionUnits)';
0358             value.molecularWeights  = [this.transcriptionUnits.molecularWeight]';
0359             value.halfLives         = [this.transcriptionUnits.halfLife]';
0360             
0361             <span class="comment">%store</span>
0362             this.nascentRNAs = value;
0363         <span class="keyword">end</span>
0364         
0365         <a name="_sub12" href="#_subfunctions" class="code">function value = get.intergenicRNAs(this)</a>
0366             <span class="comment">%retrieve</span>
0367             <span class="keyword">if</span> ~isempty(this.intergenicRNAs)
0368                 value = this.intergenicRNAs;
0369                 <span class="keyword">return</span>;
0370             <span class="keyword">end</span>
0371             
0372             <span class="comment">%calculate</span>
0373             value = struct();
0374             value.wholeCellModelIDs = cell(0, 1);
0375             value.names             = cell(0, 1);
0376             value.sequences         = cell(0, 1);
0377             value.lengths           = zeros(0, 1);
0378             value.baseCounts        = zeros(0, this.numMetabolites);
0379             value.decayReactions    = zeros(0, this.numMetabolites);
0380             value.molecularWeights  = zeros(0, 1);
0381             value.halfLives         = zeros(0, 1);
0382             
0383             <span class="keyword">for</span> i=1:this.numTranscriptionUnits
0384                 numIntergenicSequences = numel(this.transcriptionUnits(i).intergenicSequences);
0385                 
0386                 value.wholeCellModelIDs = [value.wholeCellModelIDs; repmat({this.transcriptionUnits(i).wholeCellModelID}, numIntergenicSequences, 1)];
0387                 value.names             = [value.names;             repmat({this.transcriptionUnits(i).name}, numIntergenicSequences, 1)];
0388                 value.sequences         = [value.sequences;         this.transcriptionUnits(i).intergenicSequences];
0389                 value.lengths           = [value.lengths;           this.transcriptionUnits(i).intergenicSequenceLengths];
0390                 value.baseCounts        = [value.baseCounts;        this.transcriptionUnits(i).intergenicSequenceBaseCounts];
0391                 value.decayReactions    = [value.decayReactions;    this.transcriptionUnits(i).intergenicSequenceDecayReactions];
0392                 value.molecularWeights  = [value.molecularWeights;  this.transcriptionUnits(i).intergenicSequenceMolecularWeights];
0393                 value.halfLives         = [value.halfLives;         this.transcriptionUnits(i).intergenicSequenceHalfLives];
0394             <span class="keyword">end</span>
0395             
0396             <span class="comment">%store</span>
0397             this.intergenicRNAs = value;
0398         <span class="keyword">end</span>
0399         
0400         <a name="_sub13" href="#_subfunctions" class="code">function value = get.processedRNAs(this)</a>
0401             <span class="comment">%retrieve</span>
0402             <span class="keyword">if</span> ~isempty(this.processedRNAs)
0403                 value = this.processedRNAs;
0404                 <span class="keyword">return</span>;
0405             <span class="keyword">end</span>
0406             
0407             <span class="comment">%calculate</span>
0408             value = struct();
0409             value.wholeCellModelIDs = cell(0, 1);
0410             value.names             = cell(0, 1);
0411             value.sequences         = cell(0, 1);
0412             value.lengths           = zeros(0, 1);
0413             value.baseCounts        = zeros(0, this.numMetabolites);
0414             value.decayReactions    = zeros(0, this.numMetabolites);
0415             value.molecularWeights  = zeros(0, 1);
0416             value.halfLives         = zeros(0, 1);
0417             
0418             <span class="keyword">for</span> i=1:this.numTranscriptionUnits
0419                 <span class="keyword">if</span> strcmp(this.transcriptionUnits(i).type,<span class="string">'mRNA'</span>)
0420                     value.wholeCellModelIDs = [value.wholeCellModelIDs; this.transcriptionUnits(i).wholeCellModelID];
0421                     value.names             = [value.names;             this.transcriptionUnits(i).name];
0422                     value.sequences         = [value.sequences;         this.transcriptionUnits(i).sequence];
0423                     value.lengths           = [value.lengths;           this.transcriptionUnits(i).sequenceLength];
0424                     value.baseCounts        = [value.baseCounts;        this.transcriptionUnits(i).baseCount];
0425                     value.decayReactions    = [value.decayReactions;    this.transcriptionUnits(i).decayReaction];
0426                     value.molecularWeights  = [value.molecularWeights;  this.transcriptionUnits(i).molecularWeight];
0427                     value.halfLives         = [value.halfLives;         this.transcriptionUnits(i).halfLife];
0428                 <span class="keyword">else</span>
0429                     numProcessedSequences = numel(this.transcriptionUnits(i).genes);
0430                     
0431                     value.wholeCellModelIDs = [value.wholeCellModelIDs; {this.transcriptionUnits(i).genes.wholeCellModelID}'];
0432                     value.names             = [value.names;             {this.transcriptionUnits(i).genes.name}'];
0433                     value.sequences         = [value.sequences;         {this.transcriptionUnits(i).genes.sequence}'];
0434                     value.lengths           = [value.lengths;           [this.transcriptionUnits(i).genes.sequenceLength]'];
0435                     value.baseCounts        = [value.baseCounts;        reshape([this.transcriptionUnits(i).genes.baseCount], [], numProcessedSequences)'];
0436                     value.decayReactions    = [value.decayReactions;    reshape([this.transcriptionUnits(i).genes.decayReaction], [], numProcessedSequences)'];
0437                     value.molecularWeights  = [value.molecularWeights;  [this.transcriptionUnits(i).genes.molecularWeight]'];
0438                     value.halfLives         = [value.halfLives;         [this.transcriptionUnits(i).genes.halfLife]'];
0439                 <span class="keyword">end</span>
0440             <span class="keyword">end</span>
0441             
0442             <span class="comment">%store</span>
0443             this.processedRNAs = value;
0444         <span class="keyword">end</span>
0445         
0446         <a name="_sub14" href="#_subfunctions" class="code">function value = get.matureRNAs(this)</a>
0447             <span class="comment">%retrieve</span>
0448             <span class="keyword">if</span> ~isempty(this.matureRNAs)
0449                 value = this.matureRNAs;
0450                 <span class="keyword">return</span>;
0451             <span class="keyword">end</span>
0452             
0453             <span class="comment">%calculate</span>
0454             value = struct();
0455             value.wholeCellModelIDs = cell(0, 1);
0456             value.names             = cell(0, 1);
0457             value.sequences         = cell(0, 1);
0458             value.lengths           = zeros(0, 1);
0459             value.baseCounts        = zeros(0, this.numMetabolites);
0460             value.decayReactions    = zeros(0, this.numMetabolites);
0461             value.molecularWeights  = zeros(0, 1);
0462             value.halfLives         = zeros(0, 1);
0463             
0464             <span class="keyword">for</span> i=1:this.numTranscriptionUnits
0465                 <span class="keyword">if</span> strcmp(this.transcriptionUnits(i).type,<span class="string">'mRNA'</span>)
0466                     value.wholeCellModelIDs = [value.wholeCellModelIDs; this.transcriptionUnits(i).wholeCellModelID];
0467                     value.names             = [value.names;             this.transcriptionUnits(i).name];
0468                     value.sequences         = [value.sequences;         this.transcriptionUnits(i).sequence];
0469                     value.lengths           = [value.lengths;           this.transcriptionUnits(i).sequenceLength];
0470                     value.baseCounts        = [value.baseCounts;        this.transcriptionUnits(i).baseCount];
0471                     value.decayReactions    = [value.decayReactions;    this.transcriptionUnits(i).decayReaction];
0472                     value.molecularWeights  = [value.molecularWeights;  this.transcriptionUnits(i).molecularWeight];
0473                     value.halfLives         = [value.halfLives;         this.transcriptionUnits(i).halfLife];
0474                 <span class="keyword">else</span>
0475                     numProcessedSequences = numel(this.transcriptionUnits(i).genes);
0476                     
0477                     value.wholeCellModelIDs = [value.wholeCellModelIDs; {this.transcriptionUnits(i).genes.wholeCellModelID}'];
0478                     value.names             = [value.names;             {this.transcriptionUnits(i).genes.name}'];
0479                     value.sequences         = [value.sequences;         {this.transcriptionUnits(i).genes.sequence}'];
0480                     value.lengths           = [value.lengths;           [this.transcriptionUnits(i).genes.sequenceLength]'];
0481                     value.baseCounts        = [value.baseCounts;        reshape([this.transcriptionUnits(i).genes.matureBaseCount], [], numProcessedSequences)'];
0482                     value.decayReactions    = [value.decayReactions;    reshape([this.transcriptionUnits(i).genes.matureDecayReaction], [], numProcessedSequences)'];
0483                     value.molecularWeights  = [value.molecularWeights;  [this.transcriptionUnits(i).genes.matureMolecularWeight]'];
0484                     value.halfLives         = [value.halfLives;         [this.transcriptionUnits(i).genes.halfLife]'];
0485                 <span class="keyword">end</span>
0486             <span class="keyword">end</span>
0487             
0488             <span class="comment">%store</span>
0489             this.matureRNAs = value;
0490         <span class="keyword">end</span>
0491         
0492         <a name="_sub15" href="#_subfunctions" class="code">function value = get.aminoacylatedRNAs(this)</a>
0493             <span class="comment">%retrieve</span>
0494             <span class="keyword">if</span> ~isempty(this.aminoacylatedRNAs)
0495                 value = this.aminoacylatedRNAs;
0496                 <span class="keyword">return</span>;
0497             <span class="keyword">end</span>
0498             
0499             <span class="comment">%calculate</span>
0500             value = struct();
0501             value.wholeCellModelIDs = cell(0, 1);
0502             value.names             = cell(0, 1);
0503             value.sequences         = cell(0, 1);
0504             value.lengths           = zeros(0, 1);
0505             value.baseCounts        = zeros(0, this.numMetabolites);
0506             value.decayReactions    = zeros(0, this.numMetabolites);
0507             value.molecularWeights  = zeros(0, 1);
0508             value.halfLives         = zeros(0, 1);
0509             
0510             <span class="keyword">for</span> i=1:this.numTranscriptionUnits
0511                 <span class="keyword">if</span> strcmp(this.transcriptionUnits(i).type,<span class="string">'mRNA'</span>)
0512                     value.wholeCellModelIDs = [value.wholeCellModelIDs; this.transcriptionUnits(i).wholeCellModelID];
0513                     value.names             = [value.names;             this.transcriptionUnits(i).name];
0514                     value.sequences         = [value.sequences;         this.transcriptionUnits(i).sequence];
0515                     value.lengths           = [value.lengths;           this.transcriptionUnits(i).sequenceLength];
0516                     value.baseCounts        = [value.baseCounts;        this.transcriptionUnits(i).baseCount];
0517                     value.decayReactions    = [value.decayReactions;    this.transcriptionUnits(i).decayReaction];
0518                     value.molecularWeights  = [value.molecularWeights;  this.transcriptionUnits(i).molecularWeight];
0519                     value.halfLives         = [value.halfLives;         this.transcriptionUnits(i).halfLife];
0520                 <span class="keyword">else</span>
0521                     numProcessedSequences = numel(this.transcriptionUnits(i).genes);
0522                     
0523                     value.wholeCellModelIDs = [value.wholeCellModelIDs; {this.transcriptionUnits(i).genes.wholeCellModelID}'];
0524                     value.names             = [value.names;             {this.transcriptionUnits(i).genes.name}'];
0525                     value.sequences         = [value.sequences;         {this.transcriptionUnits(i).genes.sequence}'];
0526                     value.lengths           = [value.lengths;           [this.transcriptionUnits(i).genes.sequenceLength]'];
0527                     value.baseCounts        = [value.baseCounts;        reshape([this.transcriptionUnits(i).genes.aminoacylatedBaseCount], [], numProcessedSequences)'];
0528                     value.decayReactions    = [value.decayReactions;    reshape([this.transcriptionUnits(i).genes.aminoacylatedDecayReaction], [], numProcessedSequences)'];
0529                     value.molecularWeights  = [value.molecularWeights;  [this.transcriptionUnits(i).genes.aminoacylatedMolecularWeight]'];
0530                     value.halfLives         = [value.halfLives;         [this.transcriptionUnits(i).genes.halfLife]'];
0531                 <span class="keyword">end</span>
0532             <span class="keyword">end</span>
0533             
0534             <span class="comment">%store</span>
0535             this.aminoacylatedRNAs = value;
0536         <span class="keyword">end</span>
0537         
0538         <span class="comment">%transcription unit composition</span>
0539         <a name="_sub16" href="#_subfunctions" class="code">function value = get.transcriptionUnitComposition_Genes(this)</a>
0540             <span class="comment">%retrieve</span>
0541             <span class="keyword">if</span> ~isempty(this.transcriptionUnitComposition_Genes)
0542                 value = this.transcriptionUnitComposition_Genes;
0543                 <span class="keyword">return</span>;
0544             <span class="keyword">end</span>
0545             
0546             <span class="comment">%calculate</span>
0547             value = zeros(this.numGenes,this.numTranscriptionUnits,this.numCompartments);
0548             <span class="keyword">for</span> i = 1:length(this.transcriptionUnits)
0549                 genes = [this.transcriptionUnits(i).genes];
0550                 compartments = [this.transcriptionUnits(i).geneCompartments];
0551                 <span class="keyword">for</span> j=1:length(genes)
0552                     value(genes(j).idx, i, compartments(j).idx)=1;
0553                 <span class="keyword">end</span>
0554             <span class="keyword">end</span>
0555             
0556             <span class="comment">%store</span>
0557             this.transcriptionUnitComposition_Genes = value;
0558         <span class="keyword">end</span>
0559         
0560         <a name="_sub17" href="#_subfunctions" class="code">function value = get.transcriptionUnitComposition_IntergenicRNAs(this)</a>
0561             <span class="comment">%retrieve</span>
0562             <span class="keyword">if</span> ~isempty(this.transcriptionUnitComposition_IntergenicRNAs)
0563                 value = this.transcriptionUnitComposition_IntergenicRNAs;
0564                 <span class="keyword">return</span>;
0565             <span class="keyword">end</span>
0566             
0567             <span class="comment">%calculate</span>
0568             value = zeros(0, this.numTranscriptionUnits, this.numCompartments);
0569             
0570             <span class="keyword">for</span> i=1:this.numTranscriptionUnits
0571                 numIntergenicSequences = numel(this.transcriptionUnits(i).intergenicSequences);
0572                 
0573                 value = [value; zeros(numIntergenicSequences, this.numTranscriptionUnits, this.numCompartments)]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0574                 value(end-numIntergenicSequences+1:<span class="keyword">end</span>, <span class="keyword">...</span>
0575                     this.transcriptionUnits(i).idx, <span class="keyword">...</span>
0576                     this.transcriptionUnits(i).compartment.idx) = 1;
0577             <span class="keyword">end</span>
0578             
0579             <span class="comment">%store</span>
0580             this.transcriptionUnitComposition_IntergenicRNAs = value;
0581         <span class="keyword">end</span>
0582         
0583         <a name="_sub18" href="#_subfunctions" class="code">function value = get.transcriptionUnitComposition_ProcessedRNAs(this)</a>
0584             <span class="comment">%retrieve</span>
0585             <span class="keyword">if</span> ~isempty(this.transcriptionUnitComposition_ProcessedRNAs)
0586                 value = this.transcriptionUnitComposition_ProcessedRNAs;
0587                 <span class="keyword">return</span>;
0588             <span class="keyword">end</span>
0589             
0590             <span class="comment">%calculate</span>
0591             value = zeros(0, this.numTranscriptionUnits, this.numCompartments);
0592             
0593             <span class="keyword">for</span> i=1:this.numTranscriptionUnits
0594                 <span class="keyword">if</span> strcmp(this.transcriptionUnits(i).type,<span class="string">'mRNA'</span>)
0595                     numProcessedSequences = 1;
0596                 <span class="keyword">else</span>
0597                     numProcessedSequences = numel(this.transcriptionUnits(i).genes);
0598                 <span class="keyword">end</span>
0599                 
0600                 value = [value; zeros(numProcessedSequences, this.numTranscriptionUnits, this.numCompartments)]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0601                 value(end-numProcessedSequences+1:<span class="keyword">end</span>, <span class="keyword">...</span>
0602                     this.transcriptionUnits(i).idx, <span class="keyword">...</span>
0603                     this.transcriptionUnits(i).compartment.idx) = 1;
0604             <span class="keyword">end</span>
0605             
0606             <span class="comment">%store</span>
0607             this.transcriptionUnitComposition_ProcessedRNAs = value;
0608         <span class="keyword">end</span>
0609         
0610         <a name="_sub19" href="#_subfunctions" class="code">function value = get.processedRNAComposition_Genes(this)</a>
0611             <span class="comment">%retrieve</span>
0612             <span class="keyword">if</span> ~isempty(this.processedRNAComposition_Genes)
0613                 value = this.processedRNAComposition_Genes;
0614                 <span class="keyword">return</span>;
0615             <span class="keyword">end</span>
0616             
0617             <span class="comment">%calculate</span>
0618             value = zeros(this.numGenes, 0, this.numCompartments);
0619             
0620             <span class="keyword">for</span> i=1:this.numTranscriptionUnits
0621                 <span class="keyword">if</span> strcmp(this.transcriptionUnits(i).type,<span class="string">'mRNA'</span>)
0622                     value = [value zeros(this.numGenes, 1, this.numCompartments)]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0623                     value([this.transcriptionUnits(i).genes.idx], <span class="keyword">end</span>, this.transcriptionUnits(i).compartment.idx) = 1;
0624                 <span class="keyword">else</span>
0625                     numProcessedSequences = numel(this.transcriptionUnits(i).genes);
0626                     
0627                     value = [value zeros(this.numGenes, numProcessedSequences, this.numCompartments)]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0628                     value([this.transcriptionUnits(i).genes.idx], end-numProcessedSequences+1:<span class="keyword">end</span>, this.transcriptionUnits(i).compartment.idx) = eye(numProcessedSequences);
0629                 <span class="keyword">end</span>
0630             <span class="keyword">end</span>
0631             
0632             <span class="comment">%store</span>
0633             this.processedRNAComposition_Genes = value;
0634         <span class="keyword">end</span>
0635 
0636         <span class="comment">%% proteins</span>
0637         <span class="comment">% Converts DNA sequences to tRNA sequences using genetic code.</span>
0638         <span class="comment">% For each DNA sequence</span>
0639         <span class="comment">% 1. Identify first start codon, record correspoding tRNA</span>
0640         <span class="comment">% 2. Store tRNA of successive codons until stop codon or end of sequence is</span>
0641         <span class="comment">%    reached</span>
0642         <a name="_sub20" href="#_subfunctions" class="code">function value = get.proteinMonomerTRNASequences(this)</a>
0643             <span class="comment">%retrieve</span>
0644             <span class="keyword">if</span> ~isempty(this.proteinMonomerTRNASequences)
0645                 value = this.proteinMonomerTRNASequences;
0646                 <span class="keyword">return</span>;
0647             <span class="keyword">end</span>
0648             
0649             <span class="comment">%calculate</span>
0650             genes = [this.proteinMonomers.gene]; <span class="comment">%#ok&lt;*PROP&gt;</span>
0651             dnaSequences = {genes.dnaSequence}'; <span class="comment">%#ok&lt;*PROP&gt;</span>
0652             value = this.computeTRNASequences(dnaSequences);
0653             
0654             <span class="comment">%store</span>
0655             this.proteinMonomerTRNASequences = value;
0656         <span class="keyword">end</span>
0657 
0658         <a name="_sub21" href="#_subfunctions" class="code">function [tRNASequences, aaSequences] = computeTRNASequences(this, dnaSequences, findStartCodon)</a>
0659             <span class="comment">%options</span>
0660             <span class="keyword">if</span> ~exist(<span class="string">'findStartCodon'</span>, <span class="string">'var'</span>)
0661                 findStartCodon = true;
0662             <span class="keyword">end</span>
0663 
0664             <span class="comment">%tRNA sequence, protein lengths</span>
0665             tRNASequences = cell(size(dnaSequences));        <span class="comment">%tRNA sequences of each protein-coding gene</span>
0666             aaSequences   = cell(size(dnaSequences));        <span class="comment">%aa sequences of each protein-coding gene</span>
0667 
0668             geneticCodeCodons          = this.geneticCodeCodons;          <span class="comment">%DNA sequence of codons</span>
0669             geneticCodeTRNAs           = this.geneticCodeTRNAs;           <span class="comment">%index of tRNA within tRNAGenes corresponding to each codon</span>
0670             geneticCodeAminoAcids      = this.geneticCodeAminoAcids;      <span class="comment">%index of AA within tRNAGenes corresponding to each start codon</span>
0671             geneticCodeStartCodons     = this.geneticCodeStartCodons;     <span class="comment">%DNA sequence of start codons</span>
0672             geneticCodeStartTRNAs      = this.geneticCodeStartTRNAs;      <span class="comment">%index of tRNA within tRNAGenes corresponding to each start codon</span>
0673             geneticCodeStartAminoAcids = this.geneticCodeStartAminoAcids; <span class="comment">%index of AA within tRNAGenes corresponding to each start codon</span>
0674 
0675             <span class="comment">%convert nucleic acids sequences to tRNA sequences</span>
0676             <span class="keyword">for</span> i = 1:length(dnaSequences)
0677                 sequence = dnaSequences{i};
0678                 tRNASequence = zeros(floor(length(sequence)/3),1);
0679                 aaSequence = cell(floor(length(sequence)/3),1);
0680 
0681                 startCodonPosition = -2; <span class="comment">%position of first base of start codon within sequence</span>
0682                 <span class="keyword">if</span> findStartCodon
0683                     <span class="comment">%Start codon</span>
0684                     <span class="comment">%1. Step along sequence until first start codon</span>
0685                     <span class="comment">%2. Store tRNA corresponding to first start codon</span>
0686                     <span class="keyword">for</span> j=1:length(sequence)-2
0687                         <a href="tRNA.html" class="code" title="">tRNA</a>=geneticCodeStartTRNAs(strcmp(geneticCodeStartCodons, sequence(j:j+2)));  <span class="comment">%index of tRNA within tRNAGenes</span>
0688                         <span class="keyword">if</span> ~isempty(<a href="tRNA.html" class="code" title="">tRNA</a>)
0689                             tRNASequence(1) = <a href="tRNA.html" class="code" title="">tRNA</a>;
0690                             aaSequence{1} = geneticCodeStartAminoAcids{strcmp(geneticCodeStartCodons, sequence(j:j+2))};
0691                             startCodonPosition=j;
0692                             <span class="keyword">break</span>;
0693                         <span class="keyword">end</span>
0694                     <span class="keyword">end</span>
0695 
0696                     <span class="keyword">if</span> startCodonPosition == -2
0697                         throw(MException(<span class="string">'KnowledgeBase:computeTRNASequences'</span>,<span class="string">'No start codon found'</span>));
0698                     <span class="keyword">end</span>
0699                 <span class="keyword">end</span>
0700 
0701                 <span class="comment">%Non-start codons</span>
0702                 <span class="comment">%1. Step along sequence until stop codon or the end of the sequence</span>
0703                 <span class="comment">%2. Store tRNA corresponding to each codon</span>
0704                 endCodonPosition = startCodonPosition; <span class="comment">%position of first base of last protein-coding codon within sequence</span>
0705                 <span class="keyword">for</span> j = startCodonPosition+3:3:length(sequence)-2
0706                     <a href="tRNA.html" class="code" title="">tRNA</a> = geneticCodeTRNAs(strcmp(geneticCodeCodons, sequence(j:j+2)));
0707                     <span class="keyword">if</span> ~isempty(<a href="tRNA.html" class="code" title="">tRNA</a>)
0708                         endCodonPosition=j;
0709                     <span class="keyword">else</span>
0710                         <span class="keyword">break</span>;
0711                     <span class="keyword">end</span>
0712                     tRNASequence((j-startCodonPosition)/3+findStartCodon) = <a href="tRNA.html" class="code" title="">tRNA</a>;
0713                     aaSequence{(j-startCodonPosition)/3+findStartCodon} = geneticCodeAminoAcids{strcmp(geneticCodeCodons, sequence(j:j+2))};
0714                 <span class="keyword">end</span>
0715                 proteinLength = (endCodonPosition-startCodonPosition)/3+findStartCodon;
0716                 tRNASequences{i} = tRNASequence(1:proteinLength);
0717                 aaSequences{i} = aaSequence(1:proteinLength);
0718             <span class="keyword">end</span>
0719         <span class="keyword">end</span>
0720 
0721         <a name="_sub22" href="#_subfunctions" class="code">function value = get.proteinMonomerTRNACounts(this)</a>
0722             <span class="comment">%retrieve</span>
0723             <span class="keyword">if</span> ~isempty(this.proteinMonomerTRNACounts)
0724                 value = this.proteinMonomerTRNACounts;
0725                 <span class="keyword">return</span>;
0726             <span class="keyword">end</span>
0727             
0728             <span class="comment">%calculate</span>
0729             monomerTRNASequences = this.proteinMonomerTRNASequences;
0730             value = zeros(length(this.proteinMonomers), length(this.tRNAGenes));
0731 
0732             <span class="keyword">for</span> i = 1:length(this.proteinMonomers)
0733                 value(i, :) = histc(monomerTRNASequences{i}, 1:length(this.tRNAGenes));
0734             <span class="keyword">end</span>
0735             
0736             <span class="comment">%store</span>
0737             this.proteinMonomerTRNACounts = value;
0738         <span class="keyword">end</span>
0739 
0740         <a name="_sub23" href="#_subfunctions" class="code">function value = get.proteinMonomerCompartments(this)</a>
0741             <span class="comment">%retrieve</span>
0742             <span class="keyword">if</span> ~isempty(this.proteinMonomerCompartments)
0743                 value = this.proteinMonomerCompartments;
0744                 <span class="keyword">return</span>;
0745             <span class="keyword">end</span>
0746             
0747             <span class="comment">%calculate</span>
0748             monomerCompartments = [this.proteinMonomers.compartment];
0749             value = [monomerCompartments.idx]';
0750             
0751             <span class="comment">%store</span>
0752             this.proteinMonomerCompartments = value;
0753         <span class="keyword">end</span>
0754 
0755         <span class="comment">%base composition of protein monomers (amino acids)</span>
0756         <a name="_sub24" href="#_subfunctions" class="code">function value = get.proteinMonomerComposition(this)</a>
0757             <span class="comment">%retrieve</span>
0758             <span class="keyword">if</span> ~isempty(this.proteinMonomerComposition)
0759                 value = this.proteinMonomerComposition;
0760                 <span class="keyword">return</span>;
0761             <span class="keyword">end</span>
0762             
0763             <span class="comment">%calculate</span>
0764             value = reshape([this.proteinMonomers.baseCount], [], this.numProteinMonomers)';
0765             
0766             <span class="comment">%store</span>
0767             this.proteinMonomerComposition = value;
0768         <span class="keyword">end</span>
0769 
0770         <a name="_sub25" href="#_subfunctions" class="code">function value = get.proteinMonomerNTerminalMethionineCleavages(this)</a>
0771             <span class="comment">%retrieve</span>
0772             <span class="keyword">if</span> ~isempty(this.proteinMonomerNTerminalMethionineCleavages)
0773                 value = this.proteinMonomerNTerminalMethionineCleavages;
0774                 <span class="keyword">return</span>;
0775             <span class="keyword">end</span>
0776             
0777             <span class="comment">%calculate</span>
0778             value = [this.proteinMonomers.nTerminalMethionineCleavage]';
0779             
0780             <span class="comment">%store</span>
0781             this.proteinMonomerNTerminalMethionineCleavages = value;
0782         <span class="keyword">end</span>
0783 
0784         <a name="_sub26" href="#_subfunctions" class="code">function value = get.proteinMonomerSignalSequenceBaseCounts(this)</a>
0785             <span class="comment">%retrieve</span>
0786             <span class="keyword">if</span> ~isempty(this.proteinMonomerSignalSequenceBaseCounts)
0787                 value = this.proteinMonomerSignalSequenceBaseCounts;
0788                 <span class="keyword">return</span>;
0789             <span class="keyword">end</span>
0790             
0791             <span class="comment">%calculate</span>
0792             value = reshape([this.proteinMonomers.signalSequenceBaseCount], [], this.numProteinMonomers)';
0793             
0794             <span class="comment">%store</span>
0795             this.proteinMonomerSignalSequenceBaseCounts = value;
0796         <span class="keyword">end</span>
0797 
0798         <a name="_sub27" href="#_subfunctions" class="code">function value = get.proteinMonomerSignalSequenceMolecularWeights(this)</a>
0799             <span class="comment">%retrieve</span>
0800             <span class="keyword">if</span> ~isempty(this.proteinMonomerSignalSequenceMolecularWeights)
0801                 value = this.proteinMonomerSignalSequenceMolecularWeights;
0802                 <span class="keyword">return</span>;
0803             <span class="keyword">end</span>
0804             
0805             <span class="comment">%calculate</span>
0806             value = [this.proteinMonomers.signalSequenceMolecularWeight]';
0807             
0808             <span class="comment">%store</span>
0809             this.proteinMonomerSignalSequenceMolecularWeights = value;
0810         <span class="keyword">end</span>
0811 
0812         <a name="_sub28" href="#_subfunctions" class="code">function value = get.proteinProstheticGroupMatrix(this)</a>
0813             <span class="comment">%retrieve</span>
0814             <span class="keyword">if</span> ~isempty(this.proteinProstheticGroupMatrix)
0815                 value = this.proteinProstheticGroupMatrix;
0816                 <span class="keyword">return</span>;
0817             <span class="keyword">end</span>
0818             
0819             <span class="comment">%calculate</span>
0820             value=zeros(this.numProteinMonomers + this.numProteinComplexs, this.numMetabolites, this.numCompartments);
0821 
0822             <span class="keyword">for</span> i=1:this.numProteinMonomers
0823                 prostheticGroups = this.proteinMonomers(i).prostheticGroups;
0824                 compartments     = this.proteinMonomers(i).prostheticGroupCompartments;
0825                 coefficients     = [this.proteinMonomers(i).prostheticGroupCoefficients];
0826                 <span class="keyword">for</span> j=1:length(prostheticGroups)
0827                     value(i,prostheticGroups(j).idx,compartments(j).idx) = coefficients(j);
0828                 <span class="keyword">end</span>
0829             <span class="keyword">end</span>
0830 
0831             <span class="keyword">for</span> i=1:this.numProteinComplexs
0832                 prostheticGroups = this.proteinComplexs(i).prostheticGroups;
0833                 compartments     = this.proteinComplexs(i).prostheticGroupCompartments;
0834                 coefficients     = [this.proteinComplexs(i).prostheticGroupCoefficients];
0835                 <span class="keyword">for</span> j=1:length(prostheticGroups)
0836                     value(i + this.numProteinMonomers,prostheticGroups(j).idx,compartments(j).idx) = coefficients(j);
0837                 <span class="keyword">end</span>
0838             <span class="keyword">end</span>
0839             
0840             <span class="comment">%store</span>
0841             this.proteinProstheticGroupMatrix = value;
0842         <span class="keyword">end</span>
0843 
0844         <a name="_sub29" href="#_subfunctions" class="code">function value = get.proteinChaperoneMatrix(this)</a>
0845             <span class="comment">%retrieve</span>
0846             <span class="keyword">if</span> ~isempty(this.proteinChaperoneMatrix)
0847                 value = this.proteinChaperoneMatrix;
0848                 <span class="keyword">return</span>;
0849             <span class="keyword">end</span>
0850             
0851             <span class="comment">%calculate</span>
0852             value = zeros(this.numProteinMonomers + this.numProteinComplexs, <span class="keyword">...</span>
0853                 this.numProteinMonomers + this.numProteinComplexs, <span class="keyword">...</span>
0854                 this.numCompartments);
0855 
0856             <span class="keyword">for</span> i=1:this.numProteinMonomers
0857                 substrates   = this.proteinMonomers(i).chaperoneSubstrates;
0858                 compartments = this.proteinMonomers(i).chaperoneCompartments;
0859                 coefficients = [this.proteinMonomers(i).chaperoneCoefficients];
0860                 <span class="keyword">for</span> j=1:length(substrates)
0861                     <span class="keyword">if</span> isa(substrates(j),<span class="string">'edu.stanford.covert.cell.kb.ProteinMonomer'</span>)
0862                         value(i,substrates(j).idx,compartments(j).idx) = coefficients(j);
0863                     <span class="keyword">else</span>
0864                         value(i,substrates(j).idx+this.numProteinMonomers,compartments(j).idx) = coefficients(j);
0865                     <span class="keyword">end</span>
0866                 <span class="keyword">end</span>
0867             <span class="keyword">end</span>
0868 
0869             <span class="keyword">for</span> i=1:this.numProteinComplexs
0870                 substrates   = this.proteinComplexs(i).chaperoneSubstrates;
0871                 compartments = this.proteinComplexs(i).chaperoneCompartments;
0872                 coefficients = [this.proteinComplexs(i).chaperoneCoefficients];
0873                 <span class="keyword">for</span> j=1:length(substrates)
0874                     <span class="keyword">if</span> isa(substrates(j),<span class="string">'edu.stanford.covert.cell.kb.ProteinMonomer'</span>)
0875                         value(i+this.numProteinMonomers,substrates(j).idx,compartments(j).idx) = coefficients(j);
0876                     <span class="keyword">else</span>
0877                         value(i+this.numProteinMonomers,substrates(j).idx+this.numProteinMonomers,compartments(j).idx) = coefficients(j);
0878                     <span class="keyword">end</span>
0879                 <span class="keyword">end</span>
0880             <span class="keyword">end</span>
0881             
0882             <span class="comment">%store</span>
0883             this.proteinChaperoneMatrix = value;
0884         <span class="keyword">end</span>
0885 
0886         <span class="comment">%protein complex RNA composition (immediate children on</span>
0887         <span class="comment">%composition tree)</span>
0888         <a name="_sub30" href="#_subfunctions" class="code">function value = get.proteinComplexRNAComposition(this)</a>
0889             <span class="comment">%retrieve</span>
0890             <span class="keyword">if</span> ~isempty(this.proteinComplexRNAComposition)
0891                 value = this.proteinComplexRNAComposition;
0892                 <span class="keyword">return</span>;
0893             <span class="keyword">end</span>
0894             
0895             <span class="comment">%calculate</span>
0896             value=zeros(this.numGenes,this.numProteinComplexs,this.numCompartments);
0897             <span class="keyword">for</span> i=1:this.numProteinComplexs
0898                 <span class="keyword">if</span> isempty(this.proteinComplexs(i).rnas); <span class="keyword">continue</span>; <span class="keyword">end</span>;
0899                 genes        = [this.proteinComplexs(i).rnas];
0900                 compartments = [this.proteinComplexs(i).rnaCompartments.idx];
0901                 coefficients = this.proteinComplexs(i).rnaCoefficients;
0902 
0903                 <span class="keyword">for</span> j=1:length(genes)
0904                     value(genes(j).idx, i, compartments(j)) = coefficients(j);
0905                 <span class="keyword">end</span>
0906             <span class="keyword">end</span>
0907             
0908             <span class="comment">%store</span>
0909             this.proteinComplexRNAComposition = value;
0910         <span class="keyword">end</span>
0911 
0912         <span class="comment">%protein complex protein monomer composition (immediate children on</span>
0913         <span class="comment">%composition tree)</span>
0914         <a name="_sub31" href="#_subfunctions" class="code">function value = get.proteinComplexMonomerComposition(this)</a>
0915             <span class="comment">%retrieve</span>
0916             <span class="keyword">if</span> ~isempty(this.proteinComplexMonomerComposition)
0917                 value = this.proteinComplexMonomerComposition;
0918                 <span class="keyword">return</span>;
0919             <span class="keyword">end</span>
0920             
0921             <span class="comment">%calculate</span>
0922             value = zeros(this.numGenes,this.numProteinComplexs,this.numCompartments);
0923             <span class="keyword">for</span> i = 1:this.numProteinComplexs
0924                 <span class="keyword">if</span> isempty(this.proteinComplexs(i).proteinMonomers); <span class="keyword">continue</span>; <span class="keyword">end</span>;
0925                 genes        = [this.proteinComplexs(i).proteinMonomers.gene];
0926                 compartments = [this.proteinComplexs(i).proteinMonomerCompartments.idx];
0927                 coefficients = this.proteinComplexs(i).proteinMonomerCoefficients;
0928 
0929                 <span class="keyword">for</span> j = 1:length(genes)
0930                     value(genes(j).idx, i, compartments(j)) = coefficients(j);
0931                 <span class="keyword">end</span>
0932             <span class="keyword">end</span>
0933             
0934             <span class="comment">%store</span>
0935             this.proteinComplexMonomerComposition = value;
0936         <span class="keyword">end</span>
0937 
0938         <span class="comment">%protein complex protein complex composition (immediate children on</span>
0939         <span class="comment">%composition tree)</span>
0940         <a name="_sub32" href="#_subfunctions" class="code">function value = get.proteinComplexComplexComposition(this)</a>
0941             <span class="comment">%retrieve</span>
0942             <span class="keyword">if</span> ~isempty(this.proteinComplexComplexComposition)
0943                 value = this.proteinComplexComplexComposition;
0944                 <span class="keyword">return</span>;
0945             <span class="keyword">end</span>
0946             
0947             <span class="comment">%calculate</span>
0948             value = zeros(this.numProteinComplexs, this.numProteinComplexs, this.numCompartments);
0949             <span class="keyword">for</span> i = 1:this.numProteinComplexs
0950                 <span class="keyword">if</span> isempty(this.proteinComplexs(i).proteinComplexs); <span class="keyword">continue</span>; <span class="keyword">end</span>;
0951                 complexs     = [this.proteinComplexs(i).proteinComplexs];
0952                 compartments = [this.proteinComplexs(i).proteinComplexCompartments.idx];
0953                 coefficients = this.proteinComplexs(i).proteinComplexCoefficients;
0954 
0955                 <span class="keyword">for</span> j=1:length(complexs)
0956                     value(complexs(j).idx, i, compartments(j)) = coefficients(j);
0957                 <span class="keyword">end</span>
0958             <span class="keyword">end</span>
0959             
0960             <span class="comment">%store</span>
0961             this.proteinComplexComplexComposition = value;
0962         <span class="keyword">end</span>
0963 
0964         <span class="comment">%protein complex RNA composition (leaves of composition tree)</span>
0965         <a name="_sub33" href="#_subfunctions" class="code">function value = get.proteinComplexAllRNAComposition(this)</a>
0966             <span class="comment">%retrieve</span>
0967             <span class="keyword">if</span> ~isempty(this.proteinComplexAllRNAComposition)
0968                 value = this.proteinComplexAllRNAComposition;
0969                 <span class="keyword">return</span>;
0970             <span class="keyword">end</span>
0971             
0972             <span class="comment">%calculate</span>
0973             value = reshape([this.proteinComplexs.rnaComposition], this.numGenes, this.numProteinComplexs, this.numCompartments);
0974             
0975             <span class="comment">%store</span>
0976             this.proteinComplexAllRNAComposition = value;
0977         <span class="keyword">end</span>
0978 
0979         <span class="comment">%protein complex protein monomer composition (leaves of composition</span>
0980         <span class="comment">%tree)</span>
0981         <a name="_sub34" href="#_subfunctions" class="code">function value = get.proteinComplexAllMonomerComposition(this)</a>
0982             <span class="comment">%retrieve</span>
0983             <span class="keyword">if</span> ~isempty(this.proteinComplexAllMonomerComposition)
0984                 value = this.proteinComplexAllMonomerComposition;
0985                 <span class="keyword">return</span>;
0986             <span class="keyword">end</span>
0987             
0988             <span class="comment">%calculate</span>
0989             value = reshape([this.proteinComplexs.proteinMonomerComposition], <span class="keyword">...</span>
0990                 this.numProteinMonomers, this.numProteinComplexs, this.numCompartments);
0991                         
0992             <span class="comment">%store</span>
0993             this.proteinComplexAllMonomerComposition = value;
0994         <span class="keyword">end</span>
0995 
0996         <a name="_sub35" href="#_subfunctions" class="code">function value = get.proteinComplexCompartments(this)</a>
0997             <span class="comment">%retrieve</span>
0998             <span class="keyword">if</span> ~isempty(this.proteinComplexCompartments)
0999                 value = this.proteinComplexCompartments;
1000                 <span class="keyword">return</span>;
1001             <span class="keyword">end</span>
1002             
1003             <span class="comment">%calculate</span>
1004             complexCompartments = [this.proteinComplexs.compartment];
1005             value = [complexCompartments.idx]';
1006             
1007             <span class="comment">%store</span>
1008             this.proteinComplexCompartments = value;
1009         <span class="keyword">end</span>
1010 
1011         <span class="comment">%% reactions</span>
1012         <a name="_sub36" href="#_subfunctions" class="code">function value = get.reactionStimuliStoichiometryMatrix(this)</a>
1013             <span class="comment">%retrieve</span>
1014             <span class="keyword">if</span> ~isempty(this.reactionStimuliStoichiometryMatrix)
1015                 value = this.reactionStimuliStoichiometryMatrix;
1016                 <span class="keyword">return</span>;
1017             <span class="keyword">end</span>
1018             
1019             <span class="comment">%calculate</span>
1020             value = zeros(this.numStimulis, this.numReactions, this.numCompartments);
1021 
1022             <span class="keyword">for</span> i = 1:this.numReactions
1023                 <span class="keyword">if</span> isempty(this.reactions(i).stimulis); <span class="keyword">continue</span>; <span class="keyword">end</span>;
1024 
1025                 stimulis  = [this.reactions(i).stimulis.idx];
1026                 compartments = [this.reactions(i).stimuliCompartments.idx];
1027                 coefficients = this.reactions(i).stimuliCoefficients;
1028 
1029                 <span class="keyword">for</span> j = 1:length(stimulis);
1030                     value(stimulis(j), i, compartments(j)) = coefficients(j);
1031                 <span class="keyword">end</span>
1032             <span class="keyword">end</span>
1033             
1034             <span class="comment">%store</span>
1035             this.reactionStimuliStoichiometryMatrix = value;
1036         <span class="keyword">end</span>
1037 
1038         <a name="_sub37" href="#_subfunctions" class="code">function value = get.reactionMetaboliteStoichiometryMatrix(this)</a>
1039             <span class="comment">%retrieve</span>
1040             <span class="keyword">if</span> ~isempty(this.reactionMetaboliteStoichiometryMatrix)
1041                 value = this.reactionMetaboliteStoichiometryMatrix;
1042                 <span class="keyword">return</span>;
1043             <span class="keyword">end</span>
1044             
1045             <span class="comment">%calculate</span>
1046             value = zeros(this.numMetabolites, this.numReactions, this.numCompartments);
1047 
1048             <span class="keyword">for</span> i = 1:this.numReactions
1049                 <span class="keyword">if</span> isempty(this.reactions(i).metabolites); <span class="keyword">continue</span>; <span class="keyword">end</span>;
1050 
1051                 metabolites  = [this.reactions(i).metabolites.idx];
1052                 compartments = [this.reactions(i).metaboliteCompartments.idx];
1053                 coefficients = this.reactions(i).metaboliteCoefficients;
1054 
1055                 <span class="keyword">for</span> j = 1:length(metabolites);
1056                     value(metabolites(j), i, compartments(j)) = coefficients(j);
1057                 <span class="keyword">end</span>
1058             <span class="keyword">end</span>
1059             
1060             <span class="comment">%store</span>
1061             this.reactionMetaboliteStoichiometryMatrix = value;
1062         <span class="keyword">end</span>
1063 
1064         <a name="_sub38" href="#_subfunctions" class="code">function value = get.reactionRNAStoichiometryMatrix(this)</a>
1065             <span class="comment">%retrieve</span>
1066             <span class="keyword">if</span> ~isempty(this.reactionRNAStoichiometryMatrix)
1067                 value = this.reactionRNAStoichiometryMatrix;
1068                 <span class="keyword">return</span>;
1069             <span class="keyword">end</span>
1070             
1071             <span class="comment">%calculate</span>
1072             value = zeros(this.numTranscriptionUnits, this.numReactions, this.numCompartments);
1073 
1074             <span class="keyword">for</span> i=1:this.numReactions
1075                 <span class="keyword">if</span> isempty(this.reactions(i).rnas); <span class="keyword">continue</span>; <span class="keyword">end</span>;
1076 
1077                 rnas  = [this.reactions(i).rnas.idx];
1078                 compartments = [this.reactions(i).rnaCompartments.idx];
1079                 coefficients = this.reactions(i).rnaCoefficients;
1080 
1081                 <span class="keyword">for</span> j=1:length(rnas);
1082                     value(rnas(j), i, compartments(j))=coefficients(j);
1083                 <span class="keyword">end</span>
1084             <span class="keyword">end</span>
1085             
1086             <span class="comment">%store</span>
1087             this.reactionRNAStoichiometryMatrix = value;
1088         <span class="keyword">end</span>
1089 
1090         <a name="_sub39" href="#_subfunctions" class="code">function value = get.reactionProteinMonomerStoichiometryMatrix(this)</a>
1091             <span class="comment">%retrieve</span>
1092             <span class="keyword">if</span> ~isempty(this.reactionProteinMonomerStoichiometryMatrix)
1093                 value = this.reactionProteinMonomerStoichiometryMatrix;
1094                 <span class="keyword">return</span>;
1095             <span class="keyword">end</span>
1096             
1097             <span class="comment">%calculate</span>
1098             value = zeros(this.numProteinMonomers, this.numReactions, this.numCompartments);
1099 
1100             <span class="keyword">for</span> i = 1:this.numReactions
1101                 <span class="keyword">if</span> isempty(this.reactions(i).proteinMonomers); <span class="keyword">continue</span>; <span class="keyword">end</span>;
1102 
1103                 proteinMonomers  = [this.reactions(i).proteinMonomers.idx];
1104                 compartments = [this.reactions(i).proteinMonomerCompartments.idx];
1105                 coefficients = this.reactions(i).proteinMonomerCoefficients;
1106 
1107                 <span class="keyword">for</span> j = 1:length(proteinMonomers);
1108                     value(proteinMonomers(j), i, compartments(j)) = coefficients(j);
1109                 <span class="keyword">end</span>
1110             <span class="keyword">end</span>
1111             
1112             <span class="comment">%store</span>
1113             this.reactionProteinMonomerStoichiometryMatrix = value;
1114         <span class="keyword">end</span>
1115 
1116         <a name="_sub40" href="#_subfunctions" class="code">function value = get.reactionProteinComplexStoichiometryMatrix(this)</a>
1117             <span class="comment">%retrieve</span>
1118             <span class="keyword">if</span> ~isempty(this.reactionProteinComplexStoichiometryMatrix)
1119                 value = this.reactionProteinComplexStoichiometryMatrix;
1120                 <span class="keyword">return</span>;
1121             <span class="keyword">end</span>
1122             
1123             <span class="comment">%calculate</span>
1124             value = zeros(this.numProteinComplexs, this.numReactions, this.numCompartments);
1125 
1126             <span class="keyword">for</span> i = 1:this.numReactions
1127                 <span class="keyword">if</span> isempty(this.reactions(i).proteinComplexs); <span class="keyword">continue</span>; <span class="keyword">end</span>;
1128 
1129                 proteinComplexs  = [this.reactions(i).proteinComplexs.idx];
1130                 compartments = [this.reactions(i).proteinComplexCompartments.idx];
1131                 coefficients = this.reactions(i).proteinComplexCoefficients;
1132 
1133                 <span class="keyword">for</span> j=1:length(proteinComplexs);
1134                     value(proteinComplexs(j), i, compartments(j)) = coefficients(j);
1135                 <span class="keyword">end</span>
1136             <span class="keyword">end</span>
1137             
1138             <span class="comment">%store</span>
1139             this.reactionProteinComplexStoichiometryMatrix = value;
1140         <span class="keyword">end</span>
1141 
1142         <a name="_sub41" href="#_subfunctions" class="code">function value = get.reactionModificationMatrix(this)</a>
1143             <span class="comment">%retrieve</span>
1144             <span class="keyword">if</span> ~isempty(this.reactionModificationMatrix)
1145                 value = this.reactionModificationMatrix;
1146                 <span class="keyword">return</span>;
1147             <span class="keyword">end</span>
1148             
1149             <span class="comment">%calculate</span>
1150             value = zeros(this.numReactions, this.numGenes, this.numCompartments);
1151             <span class="keyword">for</span> i = 1:this.numReactions
1152                 modifications = this.reactions(i).stableModifications;
1153                 compartments = this.reactions(i).stableModificationCompartments;
1154                 positions = this.reactions(i).stableModificationPositions;
1155                 <span class="keyword">for</span> j=1:length(modifications)
1156                     <span class="keyword">if</span> isa(modifications(j),<span class="string">'edu.stanford.covert.cell.kb.ProteinMonomer'</span>)
1157                         value(i, modifications(j).gene.idx, compartments(j).idx) = positions(j);
1158                     <span class="keyword">else</span>
1159                         value(i, modifications(j).idx, compartments(j).idx) = positions(j);
1160                     <span class="keyword">end</span>
1161                 <span class="keyword">end</span>
1162             <span class="keyword">end</span>
1163             
1164             <span class="comment">%store</span>
1165             this.reactionModificationMatrix = value;
1166         <span class="keyword">end</span>
1167 
1168         <span class="comment">%converts units to one of:</span>
1169         <span class="comment">% - reactions/(gram dry biomass)/s</span>
1170         <span class="comment">% - reactions/s</span>
1171         <a name="_sub42" href="#_subfunctions" class="code">function value = get.reactionBounds(this)</a>
1172             <span class="comment">%retrieve</span>
1173             <span class="keyword">if</span> ~isempty(this.reactionBounds)
1174                 value = this.reactionBounds;
1175                 <span class="keyword">return</span>;
1176             <span class="keyword">end</span>
1177             
1178             <span class="comment">%calculate</span>
1179             import edu.stanford.covert.util.ConstantUtil;
1180             value = [[this.reactions.lowerBound]' [this.reactions.upperBound]'];
1181 
1182             boundUnits = {this.reactions.boundUnits};
1183             value(strcmp(boundUnits,<span class="string">'mmol/gDCW/h'</span>),:)   = value(strcmp(boundUnits,<span class="string">'mmol/gDCW/h'</span>),:) / ConstantUtil.secondsPerHour * (ConstantUtil.nAvogadro/1000);
1184             value(strcmp(boundUnits,<span class="string">'dimensionless'</span>),:) = 0;
1185             
1186             <span class="comment">%store</span>
1187             this.reactionBounds = value;
1188         <span class="keyword">end</span>
1189 
1190         <span class="comment">%reactions/enzyme/s</span>
1191         <a name="_sub43" href="#_subfunctions" class="code">function value = get.enzymeBounds(this)</a>
1192             import edu.stanford.covert.util.ConstantUtil;
1193             
1194             <span class="comment">%retrieve</span>
1195             <span class="keyword">if</span> ~isempty(this.enzymeBounds)
1196                 value = this.enzymeBounds;
1197                 <span class="keyword">return</span>;
1198             <span class="keyword">end</span>
1199             
1200             <span class="comment">%calculate</span>
1201 
1202             value = repmat([-Inf Inf],length(this.reactions),1);
1203 
1204             <span class="keyword">for</span> i = 1:length(this.reactions)
1205                 reaction = this.reactions(i);
1206                 enzymes = reaction.enzymes;
1207                 <span class="keyword">if</span> isempty(enzymes); <span class="keyword">continue</span>; <span class="keyword">end</span>;
1208                 <span class="keyword">switch</span> this.reactions(i).direction
1209                     <span class="keyword">case</span> <span class="string">'F'</span>
1210                         value(i,2) = this.enzymeBound(reaction.vmaxForward, reaction.vmaxUnitsForward, enzymes.molecularWeight);
1211                     <span class="keyword">case</span> <span class="string">'B'</span>
1212                         value(i,1) = -this.enzymeBound(reaction.vmaxBackward, reaction.vmaxUnitsBackward, enzymes.molecularWeight);
1213                     <span class="keyword">case</span> <span class="string">'R'</span>
1214                         value(i,1) = -this.enzymeBound(reaction.vmaxBackward, reaction.vmaxUnitsBackward, enzymes.molecularWeight);
1215                         value(i,2) = this.enzymeBound(reaction.vmaxForward, reaction.vmaxUnitsForward, enzymes.molecularWeight);
1216                 <span class="keyword">end</span>
1217             <span class="keyword">end</span>
1218 
1219             value = value / ConstantUtil.secondsPerMinute;
1220             
1221             <span class="comment">%store</span>
1222             this.enzymeBounds = value;
1223         <span class="keyword">end</span>
1224 
1225         <span class="comment">%units: 1/min</span>
1226         <a name="_sub44" href="#_subfunctions" class="code">function bound = enzymeBound(~, vmax, vmaxUnits, enzymeMolecularWeight)</a>
1227             <span class="keyword">if</span> isnan(vmax) || vmax == 0
1228                 bound=Inf;
1229                 <span class="keyword">return</span>;
1230             <span class="keyword">end</span>
1231 
1232             <span class="keyword">switch</span> vmaxUnits
1233                 <span class="keyword">case</span> <span class="string">'1/min'</span>
1234                     bound = vmax;
1235                 <span class="keyword">case</span> <span class="string">'U/mg'</span>
1236                     bound = vmax * enzymeMolecularWeight * 1e-3;
1237                 <span class="keyword">otherwise</span>
1238                     fprintf(<span class="string">'Error: incompatible units %s\n'</span>, vmaxUnits);
1239                     bound = Inf;
1240             <span class="keyword">end</span>
1241         <span class="keyword">end</span>
1242 
1243         <a name="_sub45" href="#_subfunctions" class="code">function value = get.reactionCatalysisMatrix(this)</a>
1244             <span class="comment">%retrieve</span>
1245             <span class="keyword">if</span> ~isempty(this.reactionCatalysisMatrix)
1246                 value = this.reactionCatalysisMatrix;
1247                 <span class="keyword">return</span>;
1248             <span class="keyword">end</span>
1249             
1250             <span class="comment">%calculate</span>
1251             value = zeros(length(this.reactions), this.numProteinMonomers + this.numProteinComplexs, this.numCompartments);
1252             <span class="keyword">for</span> i=1:length(this.reactions)
1253                 enzyme = this.reactions(i).enzymes;
1254                 <span class="keyword">if</span> isempty(enzyme); <span class="keyword">continue</span>; <span class="keyword">end</span>;
1255                 <span class="keyword">if</span> isa(enzyme,<span class="string">'edu.stanford.covert.cell.kb.ProteinMonomer'</span>);
1256                     value(i,enzyme.idx, this.reactions(i).enzymeCompartments.idx) = 1;
1257                 <span class="keyword">else</span>
1258                     value(i,enzyme.idx + this.numProteinMonomers, this.reactions(i).enzymeCompartments.idx) = 1;
1259                 <span class="keyword">end</span>
1260             <span class="keyword">end</span>
1261             
1262             <span class="comment">%store</span>
1263             this.reactionCatalysisMatrix = value;
1264         <span class="keyword">end</span>
1265 
1266         <a name="_sub46" href="#_subfunctions" class="code">function value = get.reactionCoenzymeMatrix(this)</a>
1267             <span class="comment">%retrieve</span>
1268             <span class="keyword">if</span> ~isempty(this.reactionCoenzymeMatrix)
1269                 value = this.reactionCoenzymeMatrix;
1270                 <span class="keyword">return</span>;
1271             <span class="keyword">end</span>
1272             
1273             <span class="comment">%calculate</span>
1274             value = zeros(this.numReactions,this.numMetabolites,this.numCompartments);
1275             <span class="keyword">for</span> i = 1:this.numReactions
1276                 coenzymes = this.reactions(i).coenzymes;
1277                 coenzymeCompartments = this.reactions(i).coenzymeCompartments;
1278                 coenzymeCoefficients = this.reactions(i).coenzymeCoefficients;
1279                 <span class="keyword">for</span> j=1:length(coenzymes)
1280                     value(i,coenzymes(j).idx,coenzymeCompartments(j).idx) = coenzymeCoefficients(j);
1281                 <span class="keyword">end</span>
1282             <span class="keyword">end</span>
1283             
1284             <span class="comment">%store</span>
1285             this.reactionCoenzymeMatrix = value;
1286         <span class="keyword">end</span>
1287 
1288         <span class="comment">%% statistics</span>
1289         <a name="_sub47" href="#_subfunctions" class="code">function value = get.maxGeneLength(this)</a>
1290             <span class="comment">%retrieve</span>
1291             <span class="keyword">if</span> ~isempty(this.maxGeneLength)
1292                 value = this.maxGeneLength;
1293                 <span class="keyword">return</span>;
1294             <span class="keyword">end</span>
1295             
1296             <span class="comment">%calculate</span>
1297             value = max([this.genes.sequenceLength]);
1298             
1299             <span class="comment">%store</span>
1300             this.maxGeneLength = value;
1301         <span class="keyword">end</span>
1302 
1303         <a name="_sub48" href="#_subfunctions" class="code">function value = get.maxTranscriptionUnitLength(this)</a>
1304             <span class="comment">%retrieve</span>
1305             <span class="keyword">if</span> ~isempty(this.maxTranscriptionUnitLength)
1306                 value = this.maxTranscriptionUnitLength;
1307                 <span class="keyword">return</span>;
1308             <span class="keyword">end</span>
1309             
1310             <span class="comment">%calculate</span>
1311             value = max([this.transcriptionUnits.sequenceLength]);
1312             
1313             <span class="comment">%store</span>
1314             this.maxTranscriptionUnitLength = value;
1315         <span class="keyword">end</span>
1316 
1317         <a name="_sub49" href="#_subfunctions" class="code">function value = get.maxGeneExpression(this)</a>
1318             <span class="comment">%retrieve</span>
1319             <span class="keyword">if</span> ~isempty(this.maxGeneExpression)
1320                 value = this.maxGeneExpression;
1321                 <span class="keyword">return</span>;
1322             <span class="keyword">end</span>
1323             
1324             <span class="comment">%calculate</span>
1325             value = reshape([this.genes.expression],[],this.numGenes)';
1326             
1327             <span class="comment">%store</span>
1328             this.maxGeneExpression = value;
1329         <span class="keyword">end</span>
1330 
1331         <a name="_sub50" href="#_subfunctions" class="code">function value = get.maxTranscriptionUnitExpression(this)</a>
1332             <span class="comment">%retrieve</span>
1333             <span class="keyword">if</span> ~isempty(this.maxTranscriptionUnitExpression)
1334                 value = this.maxTranscriptionUnitExpression;
1335                 <span class="keyword">return</span>;
1336             <span class="keyword">end</span>
1337             
1338             <span class="comment">%calculate</span>
1339             value = reshape([this.transcriptionUnits.expression], [], this.numTranscriptionUnits)';
1340             
1341             <span class="comment">%store</span>
1342             this.maxTranscriptionUnitExpression = value;
1343         <span class="keyword">end</span>
1344     <span class="keyword">end</span>
1345 
1346     methods (Access = protected)
1347         <a name="_sub51" href="#_subfunctions" class="code">function loadFromKnowledgeBase(this, database)                      </a>
1348             <span class="comment">%summary</span>
1349             database.setNullValue(0);
1350             database.prepareStatement(<span class="string">'CALL get_knowledgebase(&quot;{Si}&quot;)'</span>, this.wid);
1351             data = database.query();
1352             this.wholeCellModelID = data.WholeCellModelID{1};
1353             this.version = data.Version{1};
1354             this.investigator = data.Investigator{1};
1355             this.name = data.Name{1};
1356             this.taxonomy = data.Taxonomy{1};
1357             this.translationTable = data.TranslationTable;
1358 
1359             <span class="comment">%statistics</span>
1360             this.maxAvgMetConc = data.MaxAvgMetConc;
1361             this.maxAvgRxnFlux = data.MaxAvgRxnFlux;
1362 
1363             <span class="comment">%% create objects</span>
1364 
1365             <span class="comment">%processes</span>
1366             database.setNullValue(0);
1367             database.prepareStatement(<span class="string">'CALL get_processs(&quot;{Si}&quot;,null)'</span>, this.wid);
1368             data = database.query();
1369             this.processes = edu.stanford.covert.cell.kb.Process(<span class="keyword">...</span>
1370                 this, data.WID, data.WholeCellModelID, data.Name, <span class="keyword">...</span>
1371                 data.InitializationOrder, data.EvaluationOrder, data.Class);
1372             
1373             <span class="comment">%states</span>
1374             database.setNullValue(0);
1375             database.prepareStatement(<span class="string">'CALL get_states(&quot;{Si}&quot;,null)'</span>, this.wid);
1376             data = database.query();
1377             this.states = edu.stanford.covert.cell.kb.State(<span class="keyword">...</span>
1378                 this, data.WID, data.WholeCellModelID, data.Name, <span class="keyword">...</span>
1379                 data.Class);
1380 
1381             <span class="comment">%parameters</span>
1382             database.setNullValue(0);
1383             database.prepareStatement(<span class="string">'CALL get_parameters(&quot;{Si}&quot;,null)'</span>, this.wid);
1384             data = database.query();
1385             this.parameters = edu.stanford.covert.cell.kb.Parameter(<span class="keyword">...</span>
1386                 this, data.WID, data.WholeCellModelID, data.Name, <span class="keyword">...</span>
1387                 data.Index, data.DefaultValue, data.Units, strcmp(data.ExperimentallyConstrained,<span class="string">'Y'</span>));
1388 
1389             <span class="comment">%compartments</span>
1390             database.setNullValue(0);
1391             database.prepareStatement(<span class="string">'CALL get_compartments(&quot;{Si}&quot;,null)'</span>, this.wid);
1392             data = database.query();
1393             this.compartments = edu.stanford.covert.cell.kb.Compartment(<span class="keyword">...</span>
1394                 this, data.WID, data.WholeCellModelID, data.Name);
1395 
1396             <span class="comment">%metabolites</span>
1397             database.setNullValue(NaN);
1398             database.prepareStatement(<span class="string">'CALL get_metabolites(&quot;{Si}&quot;,null)'</span>, this.wid);
1399             data = database.query();
1400             this.metabolites = edu.stanford.covert.cell.kb.Metabolite(<span class="keyword">...</span>
1401                 this, data.WID, data.WholeCellModelID, data.Name, data.TraditionalName, data.IUPACName, <span class="keyword">...</span>
1402                 data.Category, data.Subcategory, <span class="keyword">...</span>
1403                 data.EmpiricalFormula, data.Smiles, data.Charge, strcmp(data.Hydrophobic, <span class="string">'Y'</span>), <span class="keyword">...</span>
1404                 data.pKa, data.pI, data.logP, data.logD, data.Volume, data.MolecularWeightCalc, <span class="keyword">...</span>
1405                 data.ExchangeLowerBound, data.ExchangeUpperBound);
1406 
1407             <span class="comment">%genome</span>
1408             database.setNullValue(0);
1409             database.prepareStatement(<span class="string">'CALL get_genome(&quot;{Si}&quot;,null)'</span>, this.wid);
1410             data = database.query();
1411             this.genome = edu.stanford.covert.cell.kb.Genome(<span class="keyword">...</span>
1412                 this, data.WID,[],[],<span class="keyword">...</span>
1413                 data.Topology,data.Sequence);
1414 
1415             <span class="comment">%genes</span>
1416             database.setNullValue(0);
1417             database.prepareStatement(<span class="string">'CALL get_genes(&quot;{Si}&quot;,null)'</span>, this.wid);
1418             data = database.query();
1419             this.genes = edu.stanford.covert.cell.kb.Gene(<span class="keyword">...</span>
1420                 this, data.WID, data.WholeCellModelID, data.Name, <span class="keyword">...</span>
1421                 data.Symbol, data.Synonyms, data.Type, strcmp(data.StartCodon,<span class="string">'Y'</span>), data.Codons, data.Coordinate, <span class="keyword">...</span>
1422                 data.Length, strcmp(data.Direction,<span class="string">'forward'</span>), <span class="keyword">...</span>
1423                 data.Essential, data.HalfLifeExp, <span class="keyword">...</span>
1424                 [data.Expression, data.ExpressionColdShock, data.ExpressionHeatShock]);
1425 
1426             <span class="comment">%transcriptionUnits</span>
1427             database.setNullValue(0);
1428             database.prepareStatement(<span class="string">'CALL get_transcriptionunits(&quot;{Si}&quot;,null)'</span>, this.wid);
1429             data = database.query();
1430             this.transcriptionUnits = edu.stanford.covert.cell.kb.TranscriptionUnit(<span class="keyword">...</span>
1431                 this, data.WID, data.WholeCellModelID, data.Name, <span class="keyword">...</span>
1432                 data.Promoter35Coordinate, data.Promoter35Length,<span class="keyword">...</span>
1433                 data.Promoter10Coordinate, data.Promoter10Length,<span class="keyword">...</span>
1434                 data.TSSCoordinate);
1435 
1436             <span class="comment">%genomeFeatures</span>
1437             database.setNullValue(0);
1438             database.prepareStatement(<span class="string">'CALL get_genomefeatures(&quot;{Si}&quot;,null)'</span>, this.wid);
1439             data = database.query();
1440             this.genomeFeatures = edu.stanford.covert.cell.kb.GenomeFeature(<span class="keyword">...</span>
1441                 this, data.WID, data.WholeCellModelID, data.Name, <span class="keyword">...</span>
1442                 data.Type, data.Subtype, data.Coordinate, data.Length, strcmp(data.Direction,<span class="string">'forward'</span>));
1443 
1444             <span class="comment">%proteinMonomers</span>
1445             database.setNullValue(0);
1446             database.prepareStatement(<span class="string">'CALL get_proteinmonomers(&quot;{Si}&quot;,null)'</span>, this.wid);
1447             data = database.query();
1448             this.proteinMonomers = edu.stanford.covert.cell.kb.ProteinMonomer(<span class="keyword">...</span>
1449                 this, data.WID, data.WholeCellModelID, data.Name, <span class="keyword">...</span>
1450                 data.Topology, data.ActiveSite, data.MetalBindingSite, data.DNAFootprint, data.DNAFootprintBindingStrandedness, data.DNAFootprintRegionStrandedness, data.MolecularInteraction, <span class="keyword">...</span>
1451                 data.ChemicalRegulation, data.Subsystem, data.GeneralClassification, data.ProteaseClassification, <span class="keyword">...</span>
1452                 data.TransporterClassification, <span class="keyword">...</span>
1453                 strcmp(data.NTerminalMethionineCleavage,<span class="string">'Y'</span>), data.SignalSequenceType, data.SignalSequenceLocation, data.SignalSequenceLength, <span class="keyword">...</span>
1454                 data.ActivationRule);
1455 
1456             <span class="comment">%proteinComplexs</span>
1457             database.setNullValue(0);
1458             database.prepareStatement(<span class="string">'CALL get_proteincomplexs(&quot;{Si}&quot;,null)'</span>, this.wid);
1459             data = database.query();
1460             this.proteinComplexs = edu.stanford.covert.cell.kb.ProteinComplex(<span class="keyword">...</span>
1461                 this, data.WID, data.WholeCellModelID, data.Name, <span class="keyword">...</span>
1462                 data.DNAFootprint, data.DNAFootprintBindingStrandedness, data.DNAFootprintRegionStrandedness, data.MolecularInteraction, data.ChemicalRegulation, <span class="keyword">...</span>
1463                 data.Subsystem, data.GeneralClassification, data.ProteaseClassification, <span class="keyword">...</span>
1464                 data.TransporterClassification, <span class="keyword">...</span>
1465                 data.ActivationRule, data.DisulfideBonds);
1466 
1467             <span class="comment">%reactions</span>
1468             database.setNullValue(0);
1469             database.prepareStatement(<span class="string">'CALL get_reactions(&quot;{Si}&quot;,null)'</span>, this.wid);
1470             data = database.query();
1471             this.reactions = edu.stanford.covert.cell.kb.Reaction(<span class="keyword">...</span>
1472                 this, data.WID, data.WholeCellModelID, data.Name, data.Type, <span class="keyword">...</span>
1473                 data.ECNumber, data.Spontaneous, data.Direction, data.DeltaG, data.Keq, <span class="keyword">...</span>
1474                 data.RateLawForward, data.KmForward, data.VmaxExpForward, data.VmaxExpUnitForward, <span class="keyword">...</span>
1475                 data.RateLawBackward, data.KmBackward, data.VmaxExpBackward, data.VmaxExpUnitBackward, <span class="keyword">...</span>
1476                 data.OptimalpH, data.OptimalTemp, <span class="keyword">...</span>
1477                 data.Activators, data.Inhibitors, <span class="keyword">...</span>
1478                 data.LowerBound, data.UpperBound, data.BoundUnits);
1479 
1480             <span class="comment">%pathways</span>
1481             database.setNullValue(0);
1482             database.prepareStatement(<span class="string">'CALL get_pathways(&quot;{Si}&quot;,null)'</span>, this.wid);
1483             data = database.query();
1484             this.pathways = edu.stanford.covert.cell.kb.Pathway(<span class="keyword">...</span>
1485                 this, data.WID, data.WholeCellModelID, data.Name);
1486 
1487             <span class="comment">%stimuli</span>
1488             database.setNullValue(0);
1489             database.prepareStatement(<span class="string">'CALL get_stimulis(&quot;{Si}&quot;,null)'</span>, this.wid);
1490             data = database.query();
1491             this.stimulis = edu.stanford.covert.cell.kb.Stimuli(<span class="keyword">...</span>
1492                 this, data.WID, data.WholeCellModelID, data.Name);
1493 
1494             <span class="comment">%notes</span>
1495             database.setNullValue(0);
1496             database.prepareStatement(<span class="string">'CALL get_notes(&quot;{Si}&quot;,null)'</span>, this.wid);
1497             data = database.query();
1498             this.notes = edu.stanford.covert.cell.kb.Note(<span class="keyword">...</span>
1499                 this, data.WID, data.WholeCellModelID, []);
1500 
1501             <span class="comment">%references</span>
1502             database.setNullValue(0);
1503             database.prepareStatement(<span class="string">'CALL get_references(&quot;{Si}&quot;,null)'</span>, this.wid);
1504             data = database.query();
1505             this.references = edu.stanford.covert.cell.kb.Reference(<span class="keyword">...</span>
1506                 this, data.WID, data.WholeCellModelID, [], <span class="keyword">...</span>
1507                 data.Type, data.PMID, data.ISBN, <span class="keyword">...</span>
1508                 data.Authors, data.Editors, data.Year, data.Title, data.Publication, data.Volume, data.Issue, data.Pages, <span class="keyword">...</span>
1509                 data.Publisher, data.URL, data.Citations);
1510 
1511             <span class="comment">%% link objects together</span>
1512             <span class="comment">%parameters-processes, states, reactions, molecules</span>
1513             this.linkObjects(database, <span class="string">'process'</span>, <span class="string">'parameter'</span>, struct(<span class="keyword">...</span>
1514                 <span class="string">'sqlProcedure'</span>, <span class="string">'get_processs_parameters'</span>));
1515             this.linkObjects(database, <span class="string">'state'</span>, <span class="string">'parameter'</span>, struct(<span class="keyword">...</span>
1516                 <span class="string">'field2'</span>, <span class="string">'state'</span>));
1517             this.linkObjects(database, <span class="string">'reaction'</span>, <span class="string">'parameter'</span>, struct(<span class="keyword">...</span>
1518                 <span class="string">'field2'</span>, <span class="string">'reactions'</span>));
1519             this.linkObjects(database, <span class="string">'proteinMonomer'</span>, <span class="string">'parameter'</span>, struct(<span class="keyword">...</span>
1520                 <span class="string">'field2'</span>, <span class="string">'proteinMonomers'</span>));
1521             this.linkObjects(database, <span class="string">'proteinComplex'</span>, <span class="string">'parameter'</span>, struct(<span class="keyword">...</span>
1522                 <span class="string">'field2'</span>, <span class="string">'proteinComplexs'</span>));
1523 
1524             <span class="comment">%genome</span>
1525             this.genome.genes = this.genes;
1526             this.genome.transcriptionUnits = this.transcriptionUnits;
1527             this.genome.features = this.genomeFeatures;
1528             <span class="keyword">for</span> i = 1:size(this.genes,1)
1529                 this.genes(i).genome = this.genome;
1530             <span class="keyword">end</span>
1531             <span class="keyword">for</span> i = 1:size(this.transcriptionUnits,1)
1532                 this.transcriptionUnits(i).genome = this.genome;
1533             <span class="keyword">end</span>
1534             <span class="keyword">for</span> i = 1:size(this.genomeFeatures,1)
1535                 this.genomeFeatures(i).genome = this.genome;
1536             <span class="keyword">end</span>
1537 
1538             <span class="comment">%compartments</span>
1539             this.linkObjects(database,<span class="string">'gene'</span>,<span class="string">'compartment'</span>,struct(<span class="keyword">...</span>
1540                 <span class="string">'field1'</span>,<span class="string">'compartment'</span>));
1541             this.linkObjects(database,<span class="string">'transcriptionUnit'</span>,<span class="string">'compartment'</span>,struct(<span class="keyword">...</span>
1542                 <span class="string">'field1'</span>,<span class="string">'compartment'</span>));
1543             this.linkObjects(database,<span class="string">'proteinMonomer'</span>,<span class="string">'compartment'</span>,struct(<span class="keyword">...</span>
1544                 <span class="string">'field1'</span>,<span class="string">'compartment'</span>));
1545             this.linkObjects(database,<span class="string">'proteinComplex'</span>,<span class="string">'compartment'</span>,struct(<span class="keyword">...</span>
1546                 <span class="string">'field1'</span>,<span class="string">'compartment'</span>));
1547 
1548             <span class="comment">%prosthetic groups</span>
1549             this.linkObjects(database,<span class="string">'proteinMonomer'</span>,<span class="string">'metabolite'</span>,struct(<span class="keyword">...</span>
1550                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteinmonomers_prostheticgroups'</span>,<span class="keyword">...</span>
1551                 <span class="string">'field1'</span>, <span class="string">'prostheticGroups'</span>, <span class="keyword">...</span>
1552                 <span class="string">'field2'</span>, <span class="string">''</span>,<span class="keyword">...</span>
1553                 <span class="string">'compartmentName'</span>, <span class="string">'MetaboliteCompartmentIdx'</span>,<span class="keyword">...</span>
1554                 <span class="string">'compartmentField1'</span>, <span class="string">'prostheticGroupCompartments'</span>,<span class="keyword">...</span>
1555                 <span class="string">'compartmentField2'</span>, <span class="string">''</span>,<span class="keyword">...</span>
1556                 <span class="string">'weightName'</span>, <span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1557                 <span class="string">'weightField1'</span>, <span class="string">'prostheticGroupCoefficients'</span>,<span class="keyword">...</span>
1558                 <span class="string">'weightField2'</span>, <span class="string">''</span>,<span class="keyword">...</span>
1559                 <span class="string">'nanValue'</span>,NaN));
1560             this.linkObjects(database,<span class="string">'proteinComplex'</span>,<span class="string">'metabolite'</span>,struct(<span class="keyword">...</span>
1561                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteincomplexs_prostheticgroups'</span>,<span class="keyword">...</span>
1562                 <span class="string">'field1'</span>, <span class="string">'prostheticGroups'</span>, <span class="keyword">...</span>
1563                 <span class="string">'field2'</span>, <span class="string">''</span>,<span class="keyword">...</span>
1564                 <span class="string">'compartmentName'</span>, <span class="string">'MetaboliteCompartmentIdx'</span>,<span class="keyword">...</span>
1565                 <span class="string">'compartmentField1'</span>, <span class="string">'prostheticGroupCompartments'</span>,<span class="keyword">...</span>
1566                 <span class="string">'compartmentField2'</span>, <span class="string">''</span>,<span class="keyword">...</span>
1567                 <span class="string">'weightName'</span>, <span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1568                 <span class="string">'weightField1'</span>, <span class="string">'prostheticGroupCoefficients'</span>,<span class="keyword">...</span>
1569                 <span class="string">'weightField2'</span>, <span class="string">''</span>,<span class="keyword">...</span>
1570                 <span class="string">'nanValue'</span>,NaN));
1571 
1572             <span class="comment">%chaperones</span>
1573             this.linkObjects(database,<span class="string">'proteinMonomer'</span>,<span class="string">'proteinMonomer'</span>,struct(<span class="keyword">...</span>
1574                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteinmonomers_proteinmonomerchaperones'</span>,<span class="keyword">...</span>
1575                 <span class="string">'name2'</span>,<span class="string">'ProteinMonomerChaperoneIdx'</span>,<span class="keyword">...</span>
1576                 <span class="string">'field1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1577                 <span class="string">'field2'</span>,<span class="string">'chaperoneSubstrates'</span>,<span class="keyword">...</span>
1578                 <span class="string">'compartmentName'</span>,<span class="string">'ProteinMonomerChaperoneCompartmentIdx'</span>,<span class="keyword">...</span>
1579                 <span class="string">'compartmentField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1580                 <span class="string">'compartmentField2'</span>,<span class="string">'chaperoneCompartments'</span>,<span class="keyword">...</span>
1581                 <span class="string">'weightName'</span>,<span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1582                 <span class="string">'weightField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1583                 <span class="string">'weightField2'</span>,<span class="string">'chaperoneCoefficients'</span>));
1584             <span class="comment">%this.linkObjects(database,'proteinComplex','proteinMonomer',struct(...</span>
1585             <span class="comment">%    'sqlProcedure','get_proteincomplexs_proteinmonomerchaperones',...</span>
1586             <span class="comment">%    'name2','ProteinMonomerChaperoneIdx',...</span>
1587             <span class="comment">%    'field1',''...</span>
1588             <span class="comment">%    'field2','chaperoneSubstrates',...</span>
1589             <span class="comment">%    'compartmentName','ProteinMonomerChaperoneCompartmentIdx',...</span>
1590             <span class="comment">%    'comparatmentField1','',...</span>
1591             <span class="comment">%    'comparatmentField2','chaperoneCompartments',...</span>
1592             <span class="comment">%    'weightName','Coefficient',...</span>
1593             <span class="comment">%    'weightField1','',...</span>
1594             <span class="comment">%    'weightField2','chaperoneCoefficients'));</span>
1595             this.linkObjects(database,<span class="string">'proteinMonomer'</span>,<span class="string">'proteinComplex'</span>,struct(<span class="keyword">...</span>
1596                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteinmonomers_proteincomplexchaperones'</span>,<span class="keyword">...</span>
1597                 <span class="string">'name2'</span>,<span class="string">'ProteinComplexChaperoneIdx'</span>,<span class="keyword">...</span>
1598                 <span class="string">'field1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1599                 <span class="string">'field2'</span>,<span class="string">'chaperoneSubstrates'</span>,<span class="keyword">...</span>
1600                 <span class="string">'compartmentName'</span>,<span class="string">'ProteinComplexChaperoneCompartmentIdx'</span>,<span class="keyword">...</span>
1601                 <span class="string">'compartmentField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1602                 <span class="string">'compartmentField2'</span>,<span class="string">'chaperoneCompartments'</span>,<span class="keyword">...</span>
1603                 <span class="string">'weightName'</span>,<span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1604                 <span class="string">'weightField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1605                 <span class="string">'weightField2'</span>,<span class="string">'chaperoneCoefficients'</span>));
1606             <span class="comment">%this.linkObjects(database,'proteinComplex','proteinComplex',struct(...</span>
1607             <span class="comment">%    'sqlProcedure','get_proteincomplexs_proteincomplexchaperones',...</span>
1608             <span class="comment">%    'name2','ProteinComplexChaperoneIdx',...</span>
1609             <span class="comment">%    'field1',''...</span>
1610             <span class="comment">%    'field2','chaperoneSubstrates',...</span>
1611             <span class="comment">%    'compartmentName','ProteinComplexChaperoneCompartmentIdx',...</span>
1612             <span class="comment">%    'comparatmentField1','',...</span>
1613             <span class="comment">%    'comparatmentField2','chaperoneCompartments',...</span>
1614             <span class="comment">%    'weightName','Coefficient',...</span>
1615             <span class="comment">%    'weightField1','',...</span>
1616             <span class="comment">%    'weightField2','chaperoneCoefficients'));</span>
1617 
1618             <span class="comment">%coenzymes</span>
1619             this.linkObjects(database,<span class="string">'reaction'</span>,<span class="string">'metabolite'</span>,struct(<span class="keyword">...</span>
1620                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_reactions_coenzymes'</span>,<span class="keyword">...</span>
1621                 <span class="string">'field1'</span>,<span class="string">'coenzymes'</span>,<span class="keyword">...</span>
1622                 <span class="string">'field2'</span>,<span class="string">'coenzymeReactions'</span>,<span class="keyword">...</span>
1623                 <span class="string">'compartmentName'</span>,<span class="string">'MetaboliteCompartmentIdx'</span>,<span class="keyword">...</span>
1624                 <span class="string">'compartmentField1'</span>,<span class="string">'coenzymeCompartments'</span>,<span class="keyword">...</span>
1625                 <span class="string">'compartmentField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1626                 <span class="string">'weightName'</span>,<span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1627                 <span class="string">'weightField1'</span>,<span class="string">'coenzymeCoefficients'</span>,<span class="keyword">...</span>
1628                 <span class="string">'weightField2'</span>,<span class="string">''</span>));
1629 
1630             <span class="comment">%stable modifications</span>
1631             this.linkObjects(database,<span class="string">'reaction'</span>,<span class="string">'gene'</span>,struct(<span class="keyword">...</span>
1632                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_reactions_stablernamodifications'</span>,<span class="keyword">...</span>
1633                 <span class="string">'field1'</span>,<span class="string">'stableModifications'</span>,<span class="keyword">...</span>
1634                 <span class="string">'field2'</span>,<span class="string">'stableModificationReactions'</span>,<span class="keyword">...</span>
1635                 <span class="string">'compartmentName'</span>,<span class="string">'GeneCompartmentIdx'</span>,<span class="keyword">...</span>
1636                 <span class="string">'compartmentField1'</span>,<span class="string">'stableModificationCompartments'</span>,<span class="keyword">...</span>
1637                 <span class="string">'compartmentField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1638                 <span class="string">'weightName'</span>,<span class="string">'Position'</span>,<span class="keyword">...</span>
1639                 <span class="string">'weightField1'</span>,<span class="string">'stableModificationPositions'</span>,<span class="keyword">...</span>
1640                 <span class="string">'weightField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1641                 <span class="string">'nanValue'</span>,NaN));
1642             this.linkObjects(database,<span class="string">'reaction'</span>,<span class="string">'proteinMonomer'</span>,struct(<span class="keyword">...</span>
1643                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_reactions_stableproteinmonomermodifications'</span>,<span class="keyword">...</span>
1644                 <span class="string">'field1'</span>,<span class="string">'stableModifications'</span>,<span class="keyword">...</span>
1645                 <span class="string">'field2'</span>,<span class="string">'stableModificationReactions'</span>,<span class="keyword">...</span>
1646                 <span class="string">'compartmentName'</span>,<span class="string">'ProteinMonomerCompartmentIdx'</span>,<span class="keyword">...</span>
1647                 <span class="string">'compartmentField1'</span>,<span class="string">'stableModificationCompartments'</span>,<span class="keyword">...</span>
1648                 <span class="string">'compartmentField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1649                 <span class="string">'weightName'</span>,<span class="string">'Position'</span>,<span class="keyword">...</span>
1650                 <span class="string">'weightField1'</span>,<span class="string">'stableModificationPositions'</span>,<span class="keyword">...</span>
1651                 <span class="string">'weightField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1652                 <span class="string">'nanValue'</span>,NaN));
1653 
1654             <span class="comment">%tRNA aminoacylation</span>
1655             this.linkObjects(database,<span class="string">'gene'</span>,<span class="string">'metabolite'</span>,struct(<span class="keyword">...</span>
1656                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_genes_aminoacids'</span>,<span class="keyword">...</span>
1657                 <span class="string">'field1'</span>,<span class="string">'aminoAcid'</span>,<span class="keyword">...</span>
1658                 <span class="string">'field2'</span>,<span class="string">''</span>));
1659 
1660             <span class="comment">%transcription unit composition</span>
1661             this.linkObjects(database,<span class="string">'gene'</span>,<span class="string">'transcriptionUnit'</span>,struct(<span class="keyword">...</span>
1662                 <span class="string">'compartmentName'</span>,<span class="string">'GeneCompartmentIdx'</span>,<span class="keyword">...</span>
1663                 <span class="string">'compartmentField2'</span>,<span class="string">'geneCompartments'</span>));
1664 
1665             <span class="comment">%gene-&gt;protein monomer</span>
1666             this.linkObjects(database,<span class="string">'gene'</span>,<span class="string">'proteinMonomer'</span>,struct(<span class="keyword">...</span>
1667                 <span class="string">'field2'</span>,<span class="string">'gene'</span>,<span class="keyword">...</span>
1668                 <span class="string">'compartmentName'</span>,<span class="string">'GeneCompartmentIdx'</span>,<span class="keyword">...</span>
1669                 <span class="string">'compartmentField2'</span>,<span class="string">'geneCompartments'</span>));
1670 
1671             <span class="comment">%protein complex composition</span>
1672             this.linkObjects(database,<span class="string">'metabolite'</span>,<span class="string">'proteinComplex'</span>,struct(<span class="keyword">...</span><span class="comment">  </span>
1673                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_metabolites_proteincomplexs'</span>,<span class="keyword">...</span>
1674                 <span class="string">'name1'</span>,<span class="string">'MetaboliteIdx'</span>,<span class="keyword">...</span>
1675                 <span class="string">'name2'</span>,<span class="string">'ProteinComplexIdx'</span>,<span class="keyword">...</span>
1676                 <span class="string">'field1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1677                 <span class="string">'field2'</span>,<span class="string">'metabolites'</span>,<span class="keyword">...</span>
1678                 <span class="string">'compartmentName'</span>,<span class="string">'MetaboliteCompartmentIdx'</span>,<span class="keyword">...</span><span class="comment">                </span>
1679                 <span class="string">'compartmentField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1680                 <span class="string">'compartmentField2'</span>,<span class="string">'metaboliteCompartments'</span>,<span class="keyword">...</span>
1681                 <span class="string">'weightName'</span>,<span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1682                 <span class="string">'weightField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1683                 <span class="string">'weightField2'</span>,<span class="string">'metaboliteCoefficients'</span>));
1684             this.linkObjects(database,<span class="string">'gene'</span>,<span class="string">'proteinComplex'</span>,struct(<span class="keyword">...</span>
1685                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_rnasubunits_proteincomplexs'</span>,<span class="keyword">...</span>
1686                 <span class="string">'name1'</span>,<span class="string">'RNASubunitIdx'</span>,<span class="keyword">...</span>
1687                 <span class="string">'name2'</span>,<span class="string">'ProteinComplexIdx'</span>,<span class="keyword">...</span>
1688                 <span class="string">'field1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1689                 <span class="string">'field2'</span>,<span class="string">'rnas'</span>,<span class="keyword">...</span>
1690                 <span class="string">'weightName'</span>,<span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1691                 <span class="string">'weightField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1692                 <span class="string">'weightField2'</span>,<span class="string">'rnaCoefficients'</span>,<span class="keyword">...</span>
1693                 <span class="string">'compartmentName'</span>,<span class="string">'RNASubunitCompartmentIdx'</span>,<span class="keyword">...</span>
1694                 <span class="string">'compartmentField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1695                 <span class="string">'compartmentField2'</span>,<span class="string">'rnaCompartments'</span>));
1696             this.linkObjects(database,<span class="string">'proteinMonomer'</span>,<span class="string">'proteinComplex'</span>,struct(<span class="keyword">...</span>
1697                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteinmonomersubunits_proteincomplexs'</span>,<span class="keyword">...</span>
1698                 <span class="string">'weightName'</span>,<span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1699                 <span class="string">'weightField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1700                 <span class="string">'weightField2'</span>,<span class="string">'proteinMonomerCoefficients'</span>,<span class="keyword">...</span>
1701                 <span class="string">'compartmentName'</span>,<span class="string">'ProteinMonomerCompartmentIdx'</span>,<span class="keyword">...</span>
1702                 <span class="string">'compartmentField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1703                 <span class="string">'compartmentField2'</span>,<span class="string">'proteinMonomerCompartments'</span>));
1704             this.linkObjects(database,<span class="string">'proteinComplex'</span>,<span class="string">'proteinComplex'</span>,struct(<span class="keyword">...</span>
1705                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteincomplexsubunits_proteincomplexs'</span>,<span class="keyword">...</span>
1706                 <span class="string">'name1'</span>,<span class="string">'ProteinComplexSubunitIdx'</span>,<span class="keyword">...</span>
1707                 <span class="string">'name2'</span>,<span class="string">'ProteinComplexIdx'</span>,<span class="keyword">...</span>
1708                 <span class="string">'field1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1709                 <span class="string">'field2'</span>,<span class="string">'proteinComplexs'</span>,<span class="keyword">...</span>
1710                 <span class="string">'weightName'</span>,<span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1711                 <span class="string">'weightField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1712                 <span class="string">'weightField2'</span>,<span class="string">'proteinComplexCoefficients'</span>,<span class="keyword">...</span>
1713                 <span class="string">'compartmentName'</span>,<span class="string">'ProteinComplexSubunitCompartmentIdx'</span>,<span class="keyword">...</span>
1714                 <span class="string">'compartmentField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1715                 <span class="string">'compartmentField2'</span>,<span class="string">'proteinComplexCompartments'</span>));
1716 
1717             <span class="comment">%reaction catalysis</span>
1718             this.linkObjects(database,<span class="string">'proteinMonomer'</span>,<span class="string">'reaction'</span>,struct(<span class="keyword">...</span>
1719                 <span class="string">'field2'</span>,<span class="string">'enzymes'</span>,<span class="keyword">...</span>
1720                 <span class="string">'compartmentName'</span>,<span class="string">'ProteinMonomerCompartmentIdx'</span>,<span class="keyword">...</span>
1721                 <span class="string">'compartmentField2'</span>,<span class="string">'enzymeCompartments'</span>));
1722             this.linkObjects(database,<span class="string">'proteinComplex'</span>,<span class="string">'reaction'</span>,struct(<span class="keyword">...</span>
1723                 <span class="string">'field2'</span>,<span class="string">'enzymes'</span>,<span class="keyword">...</span>
1724                 <span class="string">'compartmentName'</span>,<span class="string">'ProteinComplexCompartmentIdx'</span>,<span class="keyword">...</span>
1725                 <span class="string">'compartmentField2'</span>,<span class="string">'enzymeCompartments'</span>));
1726 
1727             <span class="comment">%reaction stoichiometry</span>
1728             this.linkObjects(database,<span class="string">'stimuli'</span>,<span class="string">'reaction'</span>,struct(<span class="keyword">...</span>
1729                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_stimulireactantproducts_reactions'</span>,<span class="keyword">...</span>
1730                 <span class="string">'name1'</span>,<span class="string">'StimulusIdx'</span>,<span class="keyword">...</span>
1731                 <span class="string">'name2'</span>,<span class="string">'ReactionIdx'</span>,<span class="keyword">...</span>
1732                 <span class="string">'field1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1733                 <span class="string">'field2'</span>,<span class="string">'stimulis'</span>,<span class="keyword">...</span>
1734                 <span class="string">'weightName'</span>,<span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1735                 <span class="string">'weightField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1736                 <span class="string">'weightField2'</span>,<span class="string">'stimuliCoefficients'</span>,<span class="keyword">...</span>
1737                 <span class="string">'compartmentName'</span>,<span class="string">'StimulusCompartmentIdx'</span>,<span class="keyword">...</span>
1738                 <span class="string">'compartmentField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1739                 <span class="string">'compartmentField2'</span>,<span class="string">'stimuliCompartments'</span>));
1740             this.linkObjects(database,<span class="string">'metabolite'</span>,<span class="string">'reaction'</span>,struct(<span class="keyword">...</span>
1741                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_metabolitereactantproducts_reactions'</span>,<span class="keyword">...</span>
1742                 <span class="string">'weightName'</span>,<span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1743                 <span class="string">'weightField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1744                 <span class="string">'weightField2'</span>,<span class="string">'metaboliteCoefficients'</span>,<span class="keyword">...</span>
1745                 <span class="string">'compartmentName'</span>,<span class="string">'MetaboliteCompartmentIdx'</span>,<span class="keyword">...</span>
1746                 <span class="string">'compartmentField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1747                 <span class="string">'compartmentField2'</span>,<span class="string">'metaboliteCompartments'</span>));
1748             this.linkObjects(database,<span class="string">'transcriptionUnit'</span>,<span class="string">'reaction'</span>,struct(<span class="keyword">...</span>
1749                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_transcriptionunitreactantproducts_reactions'</span>,<span class="keyword">...</span>
1750                 <span class="string">'name1'</span>,<span class="string">'TranscriptionUnitIdx'</span>,<span class="keyword">...</span>
1751                 <span class="string">'name2'</span>,<span class="string">'ReactionIdx'</span>,<span class="keyword">...</span>
1752                 <span class="string">'field1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1753                 <span class="string">'field2'</span>,<span class="string">'rnas'</span>,<span class="keyword">...</span>
1754                 <span class="string">'weightName'</span>,<span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1755                 <span class="string">'weightField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1756                 <span class="string">'weightField2'</span>,<span class="string">'rnaCoefficients'</span>,<span class="keyword">...</span>
1757                 <span class="string">'compartmentName'</span>,<span class="string">'CompartmentIdx'</span>,<span class="keyword">...</span>
1758                 <span class="string">'compartmentField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1759                 <span class="string">'compartmentField2'</span>,<span class="string">'rnaCompartments'</span>));
1760             this.linkObjects(database,<span class="string">'proteinMonomer'</span>,<span class="string">'reaction'</span>,struct(<span class="keyword">...</span>
1761                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteinmonomerreactantproducts_reactions'</span>,<span class="keyword">...</span>
1762                 <span class="string">'name1'</span>,<span class="string">'MonomerIdx'</span>,<span class="keyword">...</span>
1763                 <span class="string">'name2'</span>,<span class="string">'ReactionIdx'</span>,<span class="keyword">...</span>
1764                 <span class="string">'field1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1765                 <span class="string">'field2'</span>,<span class="string">'proteinMonomers'</span>,<span class="keyword">...</span>
1766                 <span class="string">'weightName'</span>,<span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1767                 <span class="string">'weightField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1768                 <span class="string">'weightField2'</span>,<span class="string">'proteinMonomerCoefficients'</span>,<span class="keyword">...</span>
1769                 <span class="string">'compartmentName'</span>,<span class="string">'CompartmentIdx'</span>,<span class="keyword">...</span>
1770                 <span class="string">'compartmentField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1771                 <span class="string">'compartmentField2'</span>,<span class="string">'proteinMonomerCompartments'</span>));
1772             this.linkObjects(database,<span class="string">'proteinComplex'</span>,<span class="string">'reaction'</span>,struct(<span class="keyword">...</span>
1773                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteincomplexreactantproducts_reactions'</span>,<span class="keyword">...</span>
1774                 <span class="string">'name1'</span>,<span class="string">'ComplexIdx'</span>,<span class="keyword">...</span>
1775                 <span class="string">'name2'</span>,<span class="string">'ReactionIdx'</span>,<span class="keyword">...</span>
1776                 <span class="string">'field1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1777                 <span class="string">'field2'</span>,<span class="string">'proteinComplexs'</span>,<span class="keyword">...</span>
1778                 <span class="string">'weightName'</span>,<span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1779                 <span class="string">'weightField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1780                 <span class="string">'weightField2'</span>,<span class="string">'proteinComplexCoefficients'</span>,<span class="keyword">...</span>
1781                 <span class="string">'compartmentName'</span>,<span class="string">'CompartmentIdx'</span>,<span class="keyword">...</span>
1782                 <span class="string">'compartmentField1'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1783                 <span class="string">'compartmentField2'</span>,<span class="string">'proteinComplexCompartments'</span>));
1784 
1785             <span class="comment">%transcription unit - transcription factor</span>
1786             this.linkObjects(database,<span class="string">'transcriptionUnit'</span>,<span class="string">'proteinMonomer'</span>,struct(<span class="keyword">...</span>
1787                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_transcriptionunits_transcriptionfactorproteinmonomers'</span>,<span class="keyword">...</span>
1788                 <span class="string">'field1'</span>,<span class="string">'transcriptionFactorProteinMonomers'</span>,<span class="keyword">...</span>
1789                 <span class="string">'field2'</span>,<span class="string">'regulatedTranscriptionUnits'</span>,<span class="keyword">...</span>
1790                 <span class="string">'weightName'</span>,<span class="string">'Affinity'</span>,<span class="keyword">...</span>
1791                 <span class="string">'weightField1'</span>,<span class="string">'transcriptionFactorProteinMonomerAffinitys'</span>,<span class="keyword">...</span>
1792                 <span class="string">'weightField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1793                 <span class="string">'weight2Name'</span>,<span class="string">'Activity'</span>,<span class="keyword">...</span>
1794                 <span class="string">'weight2Field1'</span>,<span class="string">'transcriptionFactorProteinMonomerActivitys'</span>,<span class="keyword">...</span>
1795                 <span class="string">'weight2Field2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1796                 <span class="string">'weight3Name'</span>,<span class="string">'Condition'</span>,<span class="keyword">...</span>
1797                 <span class="string">'weight3Field1'</span>,<span class="string">'transcriptionFactorProteinMonomerConditions'</span>,<span class="keyword">...</span>
1798                 <span class="string">'weight3Field2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1799                 <span class="string">'weight4Name'</span>,<span class="string">'BindingSiteStartCoordinate'</span>,<span class="keyword">...</span>
1800                 <span class="string">'weight4Field1'</span>,<span class="string">'transcriptionFactorProteinMonomerBindingSiteStartCoordinates'</span>,<span class="keyword">...</span>
1801                 <span class="string">'weight4Field2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1802                 <span class="string">'weight5Name'</span>,<span class="string">'BindingSiteLength'</span>,<span class="keyword">...</span>
1803                 <span class="string">'weight5Field1'</span>,<span class="string">'transcriptionFactorProteinMonomerBindingSiteLengths'</span>,<span class="keyword">...</span>
1804                 <span class="string">'weight5Field2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1805                 <span class="string">'weight6Name'</span>,<span class="string">'BindingSiteDirection'</span>,<span class="keyword">...</span>
1806                 <span class="string">'weight6Field1'</span>,<span class="string">'transcriptionFactorProteinMonomerBindingSiteDirections'</span>,<span class="keyword">...</span>
1807                 <span class="string">'weight6Field2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1808                 <span class="string">'compartmentName'</span>,<span class="string">'ProteinMonomerCompartmentIdx'</span>,<span class="keyword">...</span>
1809                 <span class="string">'compartmentField1'</span>,<span class="string">'transcriptionFactorProteinMonomerCompartments'</span>,<span class="keyword">...</span>
1810                 <span class="string">'compartmentField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1811                 <span class="string">'nanValue'</span>,NaN));
1812             this.linkObjects(database,<span class="string">'transcriptionUnit'</span>,<span class="string">'proteinComplex'</span>,struct(<span class="keyword">...</span>
1813                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_transcriptionunits_transcriptionfactorproteincomplexs'</span>,<span class="keyword">...</span>
1814                 <span class="string">'field1'</span>,<span class="string">'transcriptionFactorProteinComplexs'</span>,<span class="keyword">...</span>
1815                 <span class="string">'field2'</span>,<span class="string">'regulatedTranscriptionUnits'</span>,<span class="keyword">...</span>
1816                 <span class="string">'weightName'</span>,<span class="string">'Affinity'</span>,<span class="keyword">...</span>
1817                 <span class="string">'weightField1'</span>,<span class="string">'transcriptionFactorProteinComplexAffinitys'</span>,<span class="keyword">...</span>
1818                 <span class="string">'weightField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1819                 <span class="string">'weight2Name'</span>,<span class="string">'Activity'</span>,<span class="keyword">...</span>
1820                 <span class="string">'weight2Field1'</span>,<span class="string">'transcriptionFactorProteinComplexActivitys'</span>,<span class="keyword">...</span>
1821                 <span class="string">'weight2Field2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1822                 <span class="string">'weight3Name'</span>,<span class="string">'Condition'</span>,<span class="keyword">...</span>
1823                 <span class="string">'weight3Field1'</span>,<span class="string">'transcriptionFactorProteinComplexConditions'</span>,<span class="keyword">...</span>
1824                 <span class="string">'weight3Field2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1825                 <span class="string">'weight4Name'</span>,<span class="string">'BindingSiteStartCoordinate'</span>,<span class="keyword">...</span>
1826                 <span class="string">'weight4Field1'</span>,<span class="string">'transcriptionFactorProteinComplexBindingSiteStartCoordinates'</span>,<span class="keyword">...</span>
1827                 <span class="string">'weight4Field2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1828                 <span class="string">'weight5Name'</span>,<span class="string">'BindingSiteLength'</span>,<span class="keyword">...</span>
1829                 <span class="string">'weight5Field1'</span>,<span class="string">'transcriptionFactorProteinComplexBindingSiteLengths'</span>,<span class="keyword">...</span>
1830                 <span class="string">'weight5Field2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1831                 <span class="string">'weight6Name'</span>,<span class="string">'BindingSiteDirection'</span>,<span class="keyword">...</span>
1832                 <span class="string">'weight6Field1'</span>,<span class="string">'transcriptionFactorProteinComplexBindingSiteDirections'</span>,<span class="keyword">...</span>
1833                 <span class="string">'weight6Field2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1834                 <span class="string">'compartmentName'</span>,<span class="string">'ProteinComplexCompartmentIdx'</span>,<span class="keyword">...</span>
1835                 <span class="string">'compartmentField1'</span>,<span class="string">'transcriptionFactorProteinComplexCompartments'</span>,<span class="keyword">...</span>
1836                 <span class="string">'compartmentField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1837                 <span class="string">'nanValue'</span>,NaN));
1838 
1839             <span class="comment">%protein - stimuli</span>
1840             this.linkObjects(database,<span class="string">'proteinMonomer'</span>,<span class="string">'stimuli'</span>,struct(<span class="keyword">...</span>
1841                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteinactivations_proteinmonomers_stimulis'</span>,<span class="keyword">...</span>
1842                 <span class="string">'name2'</span>,<span class="string">'StimulusRegulatorIdx'</span>,<span class="keyword">...</span>
1843                 <span class="string">'field1'</span>,<span class="string">'stimuliRegulators'</span>,<span class="keyword">...</span>
1844                 <span class="string">'field2'</span>,<span class="string">'regulatedProteinMonomers'</span>));
1845             this.linkObjects(database,<span class="string">'proteinComplex'</span>,<span class="string">'stimuli'</span>,struct(<span class="keyword">...</span>
1846                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteinactivations_proteincomplexs_stimulis'</span>,<span class="keyword">...</span>
1847                 <span class="string">'name2'</span>,<span class="string">'StimulusRegulatorIdx'</span>,<span class="keyword">...</span>
1848                 <span class="string">'field1'</span>,<span class="string">'stimuliRegulators'</span>,<span class="keyword">...</span>
1849                 <span class="string">'field2'</span>,<span class="string">'regulatedProteinComplexs'</span>));
1850 
1851             this.linkObjects(database,<span class="string">'proteinMonomer'</span>,<span class="string">'metabolite'</span>,struct(<span class="keyword">...</span>
1852                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteinactivations_proteinmonomers_metabolites'</span>,<span class="keyword">...</span>
1853                 <span class="string">'name2'</span>,<span class="string">'MetaboliteRegulatorIdx'</span>,<span class="keyword">...</span>
1854                 <span class="string">'field1'</span>,<span class="string">'metaboliteRegulators'</span>,<span class="keyword">...</span>
1855                 <span class="string">'field2'</span>,<span class="string">'regulatedProteinMonomers'</span>));
1856             this.linkObjects(database,<span class="string">'proteinComplex'</span>,<span class="string">'metabolite'</span>,struct(<span class="keyword">...</span>
1857                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteinactivations_proteincomplexs_metabolites'</span>,<span class="keyword">...</span>
1858                 <span class="string">'name2'</span>,<span class="string">'MetaboliteRegulatorIdx'</span>,<span class="keyword">...</span>
1859                 <span class="string">'field1'</span>,<span class="string">'metaboliteRegulators'</span>,<span class="keyword">...</span>
1860                 <span class="string">'field2'</span>,<span class="string">'regulatedProteinComplexs'</span>));
1861 
1862             this.linkObjects(database,<span class="string">'proteinMonomer'</span>,<span class="string">'proteinMonomer'</span>,struct(<span class="keyword">...</span>
1863                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteinactivations_proteinmonomers_proteinmonomers'</span>,<span class="keyword">...</span>
1864                 <span class="string">'name2'</span>,<span class="string">'ProteinMonomerRegulatorIdx'</span>,<span class="keyword">...</span>
1865                 <span class="string">'field1'</span>,<span class="string">'proteinMonomerRegulators'</span>,<span class="keyword">...</span>
1866                 <span class="string">'field2'</span>,<span class="string">'regulatedProteinMonomers'</span>));
1867             this.linkObjects(database,<span class="string">'proteinComplex'</span>,<span class="string">'proteinMonomer'</span>,struct(<span class="keyword">...</span>
1868                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteinactivations_proteincomplexs_proteinmonomers'</span>,<span class="keyword">...</span>
1869                 <span class="string">'name2'</span>,<span class="string">'ProteinMonomerRegulatorIdx'</span>,<span class="keyword">...</span>
1870                 <span class="string">'field1'</span>,<span class="string">'proteinMonomerRegulators'</span>,<span class="keyword">...</span>
1871                 <span class="string">'field2'</span>,<span class="string">'regulatedProteinComplexs'</span>));
1872 
1873             this.linkObjects(database,<span class="string">'proteinMonomer'</span>,<span class="string">'proteinComplex'</span>,struct(<span class="keyword">...</span>
1874                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteinactivations_proteinmonomers_proteincomplexs'</span>,<span class="keyword">...</span>
1875                 <span class="string">'name2'</span>,<span class="string">'ProteinComplexRegulatorIdx'</span>,<span class="keyword">...</span>
1876                 <span class="string">'field1'</span>,<span class="string">'proteinComplexRegulators'</span>,<span class="keyword">...</span>
1877                 <span class="string">'field2'</span>,<span class="string">'regulatedProteinMonomers'</span>));
1878             this.linkObjects(database,<span class="string">'proteinComplex'</span>,<span class="string">'proteinComplex'</span>,struct(<span class="keyword">...</span>
1879                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteinactivations_proteincomplexs_proteincomplexs'</span>,<span class="keyword">...</span>
1880                 <span class="string">'name2'</span>,<span class="string">'ProteinComplexRegulatorIdx'</span>,<span class="keyword">...</span>
1881                 <span class="string">'field1'</span>,<span class="string">'proteinComplexRegulators'</span>,<span class="keyword">...</span>
1882                 <span class="string">'field2'</span>,<span class="string">'regulatedProteinComplexs'</span>));
1883 
1884             <span class="comment">%biomass composition</span>
1885             this.linkObjects(database,<span class="string">'metabolite'</span>,<span class="string">'compartment'</span>,struct(<span class="keyword">...</span>
1886                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_metabolites_biomasscompositions'</span>,<span class="keyword">...</span>
1887                 <span class="string">'field1'</span>,<span class="string">'biomassCompartments'</span>,<span class="keyword">...</span>
1888                 <span class="string">'field2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1889                 <span class="string">'weightName'</span>,<span class="string">'Coefficient'</span>,<span class="keyword">...</span>
1890                 <span class="string">'weightField1'</span>,<span class="string">'biomassCoefficients'</span>,<span class="keyword">...</span>
1891                 <span class="string">'weightField2'</span>,<span class="string">''</span>));
1892 
1893             <span class="comment">%media composition</span>
1894             this.linkObjects(database,<span class="string">'metabolite'</span>,<span class="string">'compartment'</span>,struct(<span class="keyword">...</span>
1895                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_metabolites_mediacomponents'</span>,<span class="keyword">...</span>
1896                 <span class="string">'field1'</span>,<span class="string">'mediaCompartments'</span>,<span class="keyword">...</span>
1897                 <span class="string">'field2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1898                 <span class="string">'weightName'</span>,<span class="string">'Concentration'</span>,<span class="keyword">...</span>
1899                 <span class="string">'weightField1'</span>,<span class="string">'mediaConcentrations'</span>,<span class="keyword">...</span>
1900                 <span class="string">'weightField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1901                 <span class="string">'initialTimeName'</span>,<span class="string">'InitialTime'</span>,<span class="keyword">...</span>
1902                 <span class="string">'initialTimeField1'</span>,<span class="string">'mediaInitialTimes'</span>,<span class="keyword">...</span>
1903                 <span class="string">'initialTimeField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1904                 <span class="string">'finalTimeName'</span>,<span class="string">'FinalTime'</span>,<span class="keyword">...</span>
1905                 <span class="string">'finalTimeField1'</span>,<span class="string">'mediaFinalTimes'</span>,<span class="keyword">...</span>
1906                 <span class="string">'finalTimeField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1907                 <span class="string">'nanValue'</span>,Inf));
1908 
1909             <span class="comment">%stimuli values</span>
1910             this.linkObjects(database,<span class="string">'stimuli'</span>,<span class="string">'compartment'</span>,struct(<span class="keyword">...</span>
1911                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_stimulis_values'</span>,<span class="keyword">...</span>
1912                 <span class="string">'field1'</span>,<span class="string">'compartments'</span>,<span class="keyword">...</span>
1913                 <span class="string">'field2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1914                 <span class="string">'weightName'</span>,<span class="string">'Value'</span>,<span class="keyword">...</span>
1915                 <span class="string">'weightField1'</span>,<span class="string">'values'</span>,<span class="keyword">...</span>
1916                 <span class="string">'weightField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1917                 <span class="string">'initialTimeName'</span>,<span class="string">'InitialTime'</span>,<span class="keyword">...</span>
1918                 <span class="string">'initialTimeField1'</span>,<span class="string">'initialTimes'</span>,<span class="keyword">...</span>
1919                 <span class="string">'initialTimeField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1920                 <span class="string">'finalTimeName'</span>,<span class="string">'FinalTime'</span>,<span class="keyword">...</span>
1921                 <span class="string">'finalTimeField1'</span>,<span class="string">'finalTimes'</span>,<span class="keyword">...</span>
1922                 <span class="string">'finalTimeField2'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1923                 <span class="string">'nanValue'</span>,Inf));
1924 
1925             <span class="comment">%reactions-process, state</span>
1926             this.linkObjects(database,<span class="string">'reaction'</span>,<span class="string">'process'</span>,struct(<span class="keyword">...</span>
1927                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_reactions_processs'</span>));
1928             this.linkObjects(database,<span class="string">'reaction'</span>,<span class="string">'state'</span>,struct(<span class="keyword">...</span>
1929                 <span class="string">'field1'</span>,<span class="string">'state'</span>));
1930 
1931             <span class="comment">%complexes-process</span>
1932             this.linkObjects(database,<span class="string">'proteinComplex'</span>,<span class="string">'process'</span>,struct(<span class="keyword">...</span>
1933                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_proteincomplexs_processs'</span>,<span class="keyword">...</span>
1934                 <span class="string">'field1'</span>,<span class="string">'complexFormationProcess'</span>,<span class="keyword">...</span>
1935                 <span class="string">'field2'</span>,<span class="string">''</span>));
1936 
1937             <span class="comment">%reactions-pathways</span>
1938             this.linkObjects(database,<span class="string">'reaction'</span>,<span class="string">'pathway'</span>);
1939 
1940             <span class="comment">%references</span>
1941             this.linkObjects(database,<span class="string">'parameter'</span>,<span class="string">'reference'</span>);
1942             this.linkObjects(database,<span class="string">'process'</span>,<span class="string">'reference'</span>, struct(<span class="keyword">...</span>
1943                 <span class="string">'sqlProcedure'</span>,<span class="string">'get_processs_references'</span>));
1944             this.linkObjects(database,<span class="string">'state'</span>,<span class="string">'reference'</span>);
1945             this.linkObjects(database,<span class="string">'compartment'</span>,<span class="string">'reference'</span>);
1946             this.linkObjects(database,<span class="string">'metabolite'</span>,<span class="string">'reference'</span>);
1947             this.linkObjects(database,<span class="string">'gene'</span>,<span class="string">'reference'</span>);
1948             this.linkObjects(database,<span class="string">'transcriptionUnit'</span>,<span class="string">'reference'</span>);
1949             this.linkObjects(database,<span class="string">'genomeFeature'</span>,<span class="string">'reference'</span>);
1950             this.linkObjects(database,<span class="string">'proteinMonomer'</span>,<span class="string">'reference'</span>);
1951             this.linkObjects(database,<span class="string">'proteinComplex'</span>,<span class="string">'reference'</span>);
1952             this.linkObjects(database,<span class="string">'reaction'</span>,<span class="string">'reference'</span>);
1953             this.linkObjects(database,<span class="string">'pathway'</span>,<span class="string">'reference'</span>);
1954             this.linkObjects(database,<span class="string">'stimuli'</span>,<span class="string">'reference'</span>);
1955             this.linkObjects(database,<span class="string">'note'</span>,<span class="string">'reference'</span>);
1956         <span class="keyword">end</span>
1957 
1958         <a name="_sub52" href="#_subfunctions" class="code">function linkObjects(this, database, objectName1, objectName2, options)</a>
1959             <span class="comment">%process options</span>
1960             <span class="keyword">if</span> ~exist(<span class="string">'options'</span>, <span class="string">'var'</span>) || ~isstruct(options)
1961                 options = struct;
1962             <span class="keyword">end</span>
1963 
1964             <span class="keyword">if</span> isfield(options, <span class="string">'nanValue'</span>)
1965                 nanValue = options.nanValue;
1966             <span class="keyword">else</span>
1967                 nanValue = 0;
1968             <span class="keyword">end</span>
1969 
1970             <span class="keyword">if</span> isfield(options, <span class="string">'name1'</span>)
1971                 name1 = options.name1;
1972             <span class="keyword">else</span>
1973                 name1 = [upper(objectName1(1)) objectName1(2:end) <span class="string">'Idx'</span>];
1974             <span class="keyword">end</span>
1975             <span class="keyword">if</span> isfield(options, <span class="string">'name2'</span>)
1976                 name2 = options.name2;
1977             <span class="keyword">else</span>
1978                 name2 = [upper(objectName2(1)) objectName2(2:end) <span class="string">'Idx'</span>];
1979             <span class="keyword">end</span>
1980             
1981             <span class="keyword">if</span> objectName1(end) == <span class="string">'s'</span>
1982                 objectName1 = [objectName1 <span class="string">'es'</span>];
1983             <span class="keyword">else</span>
1984                 objectName1 = [objectName1 <span class="string">'s'</span>];
1985             <span class="keyword">end</span>
1986             <span class="keyword">if</span> objectName2(end) == <span class="string">'s'</span>
1987                 objectName2 = [objectName2 <span class="string">'es'</span>];
1988             <span class="keyword">else</span>
1989                 objectName2 = [objectName2 <span class="string">'s'</span>];
1990             <span class="keyword">end</span>
1991 
1992             <span class="keyword">if</span> isfield(options, <span class="string">'field1'</span>)
1993                 field1 = options.field1;
1994             <span class="keyword">else</span>
1995                 field1 = objectName2;
1996             <span class="keyword">end</span>
1997             <span class="keyword">if</span> isfield(options, <span class="string">'field2'</span>)
1998                 field2 = options.field2;
1999             <span class="keyword">else</span>
2000                 field2 = objectName1;
2001             <span class="keyword">end</span>
2002 
2003             <span class="keyword">if</span> isfield(options, <span class="string">'sqlProcedure'</span>)
2004                 sqlProcedure = options.sqlProcedure;
2005             <span class="keyword">else</span>
2006                 sqlProcedure = sprintf(<span class="string">'get_%s_%s'</span>, objectName1, objectName2);
2007             <span class="keyword">end</span>
2008 
2009             database.setNullValue(nanValue);
2010             database.prepareStatement(sprintf(<span class="string">'call %s(%d,null)'</span>, sqlProcedure, this.wid));
2011             data = database.query();
2012             objects1 = this.(objectName1);
2013             objects2 = this.(objectName2);
2014 
2015             data1 = data.(name1);
2016             data2 = data.(name2);
2017             <span class="keyword">if</span> isfield(options, <span class="string">'compartmentName'</span>)
2018                 compartmentData = data.(options.compartmentName);
2019             <span class="keyword">end</span>
2020             <span class="keyword">if</span> isfield(options, <span class="string">'weightName'</span>)
2021                 weights = data.(options.weightName);
2022             <span class="keyword">end</span>
2023             <span class="keyword">if</span> isfield(options, <span class="string">'weight2Name'</span>)
2024                 weight2s = data.(options.weight2Name);
2025             <span class="keyword">end</span>
2026             <span class="keyword">if</span> isfield(options, <span class="string">'weight3Name'</span>)
2027                 weight3s = data.(options.weight3Name);
2028             <span class="keyword">end</span>
2029             <span class="keyword">if</span> isfield(options, <span class="string">'weight4Name'</span>)
2030                 weight4s = data.(options.weight4Name);
2031             <span class="keyword">end</span>
2032             <span class="keyword">if</span> isfield(options, <span class="string">'weight5Name'</span>)
2033                 weight5s = data.(options.weight5Name);
2034             <span class="keyword">end</span>
2035             <span class="keyword">if</span> isfield(options, <span class="string">'weight6Name'</span>)
2036                 weight6s = data.(options.weight6Name);
2037             <span class="keyword">end</span>
2038             <span class="keyword">if</span> isfield(options, <span class="string">'initialTimeName'</span>)
2039                 initialTimes = data.(options.initialTimeName);
2040             <span class="keyword">end</span>
2041             <span class="keyword">if</span> isfield(options, <span class="string">'finalTimeName'</span>)
2042                 finalTimes = data.(options.finalTimeName);
2043             <span class="keyword">end</span>
2044 
2045             <span class="keyword">for</span> j=1:length(objects1)
2046                 <span class="keyword">if</span> isempty(findprop(objects1(j),field1)); <span class="keyword">continue</span>; <span class="keyword">end</span>;
2047                 <span class="keyword">if</span> ~isempty(objects1(j).(field1)); <span class="keyword">continue</span>; <span class="keyword">end</span>;
2048                 objects1(j).(field1) = objects2(data2(data1 == j));
2049                 <span class="keyword">if</span> isfield(options,<span class="string">'compartmentName'</span>) &amp;&amp; isfield(options,<span class="string">'compartmentField1'</span>) &amp;&amp; ~isempty(options.compartmentField1)
2050                     objects1(j).(options.compartmentField1) = this.compartments(compartmentData(data1 == j));
2051                 <span class="keyword">end</span>
2052                 <span class="keyword">if</span> isfield(options,<span class="string">'weightName'</span>) &amp;&amp; isfield(options,<span class="string">'weightField1'</span>) &amp;&amp; ~isempty(options.weightField1)
2053                     objects1(j).(options.weightField1) = weights(data1 == j);
2054                 <span class="keyword">end</span>
2055                 <span class="keyword">if</span> isfield(options,<span class="string">'weight2Name'</span>) &amp;&amp; isfield(options,<span class="string">'weight2Field1'</span>) &amp;&amp; ~isempty(options.weight2Field1)                  
2056                     objects1(j).(options.weight2Field1) = weight2s(data1 == j);
2057                 <span class="keyword">end</span>
2058                 <span class="keyword">if</span> isfield(options,<span class="string">'weight3Name'</span>) &amp;&amp; isfield(options,<span class="string">'weight3Field1'</span>) &amp;&amp; ~isempty(options.weight3Field1)       
2059                     objects1(j).(options.weight3Field1) = weight3s(data1 == j);
2060                 <span class="keyword">end</span>
2061                 <span class="keyword">if</span> isfield(options,<span class="string">'weight4Name'</span>) &amp;&amp; isfield(options,<span class="string">'weight4Field1'</span>) &amp;&amp; ~isempty(options.weight4Field1)       
2062                     objects1(j).(options.weight4Field1) = weight4s(data1 == j);
2063                 <span class="keyword">end</span>
2064                 <span class="keyword">if</span> isfield(options,<span class="string">'weight5Name'</span>) &amp;&amp; isfield(options,<span class="string">'weight5Field1'</span>) &amp;&amp; ~isempty(options.weight5Field1)       
2065                     objects1(j).(options.weight5Field1) = weight5s(data1 == j);
2066                 <span class="keyword">end</span>
2067                 <span class="keyword">if</span> isfield(options,<span class="string">'weight6Name'</span>) &amp;&amp; isfield(options,<span class="string">'weight6Field1'</span>) &amp;&amp; ~isempty(options.weight6Field1)       
2068                     objects1(j).(options.weight6Field1) = weight6s(data1 == j);
2069                 <span class="keyword">end</span>
2070                 <span class="keyword">if</span> isfield(options,<span class="string">'initialTimeName'</span>) &amp;&amp; isfield(options,<span class="string">'initialTimeField1'</span>) &amp;&amp; ~isempty(options.initialTimeField1)
2071                     objects1(j).(options.initialTimeField1) = initialTimes(data1 == j);
2072                 <span class="keyword">end</span>
2073                 <span class="keyword">if</span> isfield(options,<span class="string">'finalTimeName'</span>) &amp;&amp; isfield(options,<span class="string">'finalTimeField1'</span>) &amp;&amp; ~isempty(options.finalTimeField1)
2074                     objects1(j).(options.finalTimeField1) = finalTimes(data1 == j);
2075                 <span class="keyword">end</span>
2076             <span class="keyword">end</span>
2077 
2078             <span class="keyword">for</span> j = 1:length(objects2)
2079                 <span class="keyword">if</span> isempty(findprop(objects2(j),field2)); <span class="keyword">continue</span>; <span class="keyword">end</span>;
2080                 <span class="keyword">if</span> ~isempty(objects2(j).(field2)); <span class="keyword">continue</span>; <span class="keyword">end</span>;
2081                 objects2(j).(field2) = objects1(data1(data2 == j));
2082                 <span class="keyword">if</span> isfield(options,<span class="string">'compartmentName'</span>) &amp;&amp; isfield(options,<span class="string">'compartmentField2'</span>) &amp;&amp; ~isempty(options.compartmentField2)
2083                     objects2(j).(options.compartmentField2) = this.compartments(compartmentData(data2 == j));
2084                 <span class="keyword">end</span>
2085                 <span class="keyword">if</span> isfield(options,<span class="string">'weightName'</span>) &amp;&amp; isfield(options,<span class="string">'weightField2'</span>) &amp;&amp; ~isempty(options.weightField2)
2086                     objects2(j).(options.weightField2) = weights(data2 == j);
2087                 <span class="keyword">end</span>
2088                 <span class="keyword">if</span> isfield(options,<span class="string">'weight2Name'</span>) &amp;&amp; isfield(options,<span class="string">'weight2Field2'</span>) &amp;&amp; ~isempty(options.weight2Field2)
2089                     objects2(j).(options.weight2Field2) = weight2s(data2 == j);
2090                 <span class="keyword">end</span>
2091                 <span class="keyword">if</span> isfield(options,<span class="string">'weight3Name'</span>) &amp;&amp; isfield(options,<span class="string">'weight3Field2'</span>) &amp;&amp; ~isempty(options.weight3Field2)
2092                     objects2(j).(options.weight3Field2) = weight3s(data2 == j);
2093                 <span class="keyword">end</span>
2094                 <span class="keyword">if</span> isfield(options,<span class="string">'weight4Name'</span>) &amp;&amp; isfield(options,<span class="string">'weight4Field2'</span>) &amp;&amp; ~isempty(options.weight4Field2)
2095                     objects2(j).(options.weight4Field2) = weight4s(data2 == j);
2096                 <span class="keyword">end</span>
2097                 <span class="keyword">if</span> isfield(options,<span class="string">'weight5Name'</span>) &amp;&amp; isfield(options,<span class="string">'weight5Field2'</span>) &amp;&amp; ~isempty(options.weight5Field2)
2098                     objects2(j).(options.weight5Field2) = weight5s(data2 == j);
2099                 <span class="keyword">end</span>
2100                 <span class="keyword">if</span> isfield(options,<span class="string">'weight6Name'</span>) &amp;&amp; isfield(options,<span class="string">'weight6Field2'</span>) &amp;&amp; ~isempty(options.weight6Field2)
2101                     objects2(j).(options.weight6Field2) = weight6s(data2 == j);
2102                 <span class="keyword">end</span>
2103                 <span class="keyword">if</span> isfield(options,<span class="string">'initialTimeName'</span>) &amp;&amp; isfield(options,<span class="string">'initialTimeField2'</span>) &amp;&amp; ~isempty(options.initialTimeField2)
2104                     objects2(j).(options.initialTimeField2) = initialTimes(data2 == j);
2105                 <span class="keyword">end</span>
2106                 <span class="keyword">if</span> isfield(options,<span class="string">'finalTimeName'</span>) &amp;&amp; isfield(options,<span class="string">'finalTimeField2'</span>) &amp;&amp; ~isempty(options.finalTimeField2)
2107                     objects2(j).(options.finalTimeField2) = finalTimes(data2 == j);
2108                 <span class="keyword">end</span>
2109             <span class="keyword">end</span>
2110         <span class="keyword">end</span>
2111     <span class="keyword">end</span>
2112 
2113     methods
2114         <span class="comment">%compute dependent properties of metabolites, RNAs, proteins</span>
2115         <span class="comment">%- indices</span>
2116         <span class="comment">%- base counts</span>
2117         <span class="comment">%- molecular weight</span>
2118         <a name="_sub53" href="#_subfunctions" class="code">function computeDependentProperties(this)            </a>
2119             <span class="comment">%% cardinalities</span>
2120             this.numProcesses          = numel(this.processes);
2121             this.numStates             = numel(this.states);
2122             this.numParameters         = numel(this.parameters);
2123             this.numCompartments       = numel(this.compartments);
2124             this.numMetabolites        = numel(this.metabolites);
2125             this.numGenes              = numel(this.genes);
2126             this.numTranscriptionUnits = numel(this.transcriptionUnits);
2127             this.numGenomeFeatures     = numel(this.genomeFeatures);
2128             this.numProteinMonomers    = numel(this.proteinMonomers);
2129             this.numProteinComplexs    = numel(this.proteinComplexs);
2130             this.numReactions          = numel(this.reactions);
2131             this.numPathways           = numel(this.pathways);
2132             this.numStimulis           = numel(this.stimulis);
2133             this.numNotes              = numel(this.notes);
2134             this.numReferences         = numel(this.references);
2135             
2136             <span class="comment">%% indices</span>
2137             <span class="comment">%compartments</span>
2138             wholeCellModelIDs = {this.compartments.wholeCellModelID};
2139             [~,this.cytosolCompartmentIndexs]                   = ismember(this.cytosolCompartmentWholeCellModelIDs, wholeCellModelIDs);
2140             [~,this.chromosomeCompartmentIndexs]                = ismember(this.chromosomeCompartmentWholeCellModelIDs, wholeCellModelIDs);
2141             [~,this.membraneCompartmentIndexs]                  = ismember(this.membraneCompartmentWholeCellModelIDs, wholeCellModelIDs);
2142             [~,this.terminalOrganelleCytosolCompartmentIndexs]  = ismember(this.terminalOrganelleCytosolCompartmentWholeCellModelIDs, wholeCellModelIDs);
2143             [~,this.terminalOrganelleMembraneCompartmentIndexs] = ismember(this.terminalOrganelleMembraneCompartmentWholeCellModelIDs, wholeCellModelIDs);
2144             [~,this.extracellularCompartmentIndexs]             = ismember(this.extracellularCompartmentWholeCellModelIDs, wholeCellModelIDs);
2145             this.cellularCompartmentIndexs                      = setdiff((1:this.numCompartments)', this.extracellularCompartmentIndexs);
2146 
2147             <span class="comment">%metabolites</span>
2148             wholeCellModelIDs = {this.metabolites.wholeCellModelID}';
2149             [~, this.waterIndexs]                       = ismember({<span class="string">'H2O'</span>}, wholeCellModelIDs);
2150             [~, this.hydrogenIndexs]                    = ismember({<span class="string">'H'</span>}, wholeCellModelIDs);
2151             [~, this.dnmpIndexs]                        = ismember({<span class="string">'DAMP'</span>;<span class="string">'DCMP'</span>;<span class="string">'DGMP'</span>;<span class="string">'DTMP'</span>}, wholeCellModelIDs);
2152             [~, this.nmpIndexs]                         = ismember({<span class="string">'AMP'</span>;<span class="string">'CMP'</span>;<span class="string">'GMP'</span>;<span class="string">'UMP'</span>}, wholeCellModelIDs);
2153             [~, this.modifiedNMPIndexs]                 = ismember({<span class="string">'PSIURIMP'</span>;<span class="string">'m5CMP'</span>;<span class="string">'m62AMP'</span>;<span class="string">'m2GMP'</span>;<span class="string">'m7GMP'</span>;<span class="string">'GmMP'</span>;<span class="string">'UmMP'</span>;<span class="string">'s2UMP'</span>;<span class="string">'m1GMP'</span>;<span class="string">'k2CMP'</span>;<span class="string">'s4UMP'</span>;<span class="string">'cmnm5s2UMP'</span>;<span class="string">'m6A MP'</span>}, wholeCellModelIDs);
2154             [~, this.aminoAcidIndexs]                   = ismember({<span class="string">'ALA'</span>; <span class="string">'ARG'</span>; <span class="string">'ASN'</span>; <span class="string">'ASP'</span>; <span class="string">'CYS'</span>; <span class="string">'GLN'</span>; <span class="string">'GLU'</span>; <span class="string">'GLY'</span>; <span class="string">'HIS'</span>; <span class="string">'ILE'</span>; <span class="string">'LEU'</span>; <span class="string">'LYS'</span>; <span class="string">'MET'</span>; <span class="string">'PHE'</span>; <span class="string">'PRO'</span>; <span class="string">'SER'</span>; <span class="string">'THR'</span>; <span class="string">'TRP'</span>; <span class="string">'TYR'</span>; <span class="string">'VAL'</span>; <span class="string">'FMET'</span>}, wholeCellModelIDs);
2155             [~, this.cysteineIndexs]                    = ismember({<span class="string">'CYS'</span>}, wholeCellModelIDs);
2156             [~, this.methionineIndexs]                  = ismember({<span class="string">'MET'</span>}, wholeCellModelIDs);
2157             [~, this.fmethionineIndexs]                 = ismember({<span class="string">'FMET'</span>}, wholeCellModelIDs);
2158             [~, this.modifiedAminoAcidIndexs]           = ismember({<span class="string">'diacylglycerolCys'</span>;<span class="string">'LIPOYLLYS'</span>; <span class="string">'pSER'</span>; <span class="string">'pTHR'</span>; <span class="string">'pTYR'</span>}, wholeCellModelIDs);
2159             [~, this.diacylglycerolCysteineIndexs]      = ismember({<span class="string">'diacylglycerolCys'</span>}, wholeCellModelIDs);
2160 
2161             <span class="comment">%genes</span>
2162             this.mRNAGenes = findobj(this.genes, <span class="string">'type'</span>, <span class="string">'mRNA'</span>);
2163             this.rRNAGenes = findobj(this.genes, <span class="string">'type'</span>, <span class="string">'rRNA'</span>);
2164             this.sRNAGenes = findobj(this.genes, <span class="string">'type'</span>, <span class="string">'sRNA'</span>);
2165             this.tRNAGenes = findobj(this.genes, <span class="string">'type'</span>, <span class="string">'tRNA'</span>);
2166 
2167             <span class="comment">%RNAs</span>
2168             names = {this.genes.name}';
2169             [~,this.ribosomalRRNAIndexs] = ismember({<span class="string">'5S ribosomal rRNA'</span>;<span class="string">'16S ribosomal rRNA'</span>;<span class="string">'23S ribosomal rRNA'</span>}, names);
2170             
2171             <span class="comment">%% other dependent properties</span>
2172             <span class="comment">%metabolites</span>
2173             this.metaboliteMolecularWeights  = [this.metabolites.molecularWeight]';
2174         <span class="keyword">end</span>
2175 
2176         <a name="_sub54" href="#_subfunctions" class="code">function delete(this)</a>
2177             <span class="comment">%deletes pointers between objects</span>
2178             <span class="comment">%(MATLAB seems to have difficulty clearing objects when these</span>
2179             <span class="comment">%links are present. By manually removing the links, we improve</span>
2180             <span class="comment">%the run time of deleting instances of this object to 10-15s)</span>
2181             this.deleteLinks();
2182 
2183             <span class="comment">%super class delete method</span>
2184             this.delete@edu.stanford.covert.cell.kb.KnowledgeBaseObject();
2185         <span class="keyword">end</span>
2186 
2187         <span class="comment">%deletes pointers between objects</span>
2188         <a name="_sub55" href="#_subfunctions" class="code">function deleteLinks(this)</a>
2189             this.parameters.deleteLinks();
2190             this.processes.deleteLinks();
2191             this.states.deleteLinks();
2192             this.compartments.deleteLinks();
2193             this.metabolites.deleteLinks();
2194             this.genome.deleteLinks();
2195             this.genes.deleteLinks();
2196             this.transcriptionUnits.deleteLinks();
2197             this.genomeFeatures.deleteLinks();
2198             this.proteinMonomers.deleteLinks();
2199             this.proteinComplexs.deleteLinks();
2200             this.reactions.deleteLinks();
2201             this.pathways.deleteLinks();
2202             this.stimulis.deleteLinks();
2203             this.notes.deleteLinks();
2204 
2205             <a href="#_sub56" class="code" title="subfunction deleteLinks(this)">deleteLinks</a>@edu.stanford.covert.cell.kb.KnowledgeBaseObject(this);
2206         <span class="keyword">end</span>
2207     <span class="keyword">end</span>
2208 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 19-Jul-2012 18:32:13 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>