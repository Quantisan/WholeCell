<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of SummaryLogger</title>
  <meta name="keywords" content="SummaryLogger">
  <meta name="description" content="Summary simulation logger. Implements simulation logger interface.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../../../../../index.html">Home</a> &gt;  <a href="../../../../../../../index.html">simulation</a> &gt; <a href="#">src</a> &gt; <a href="#">+edu</a> &gt; <a href="#">+stanford</a> &gt; <a href="#">+covert</a> &gt; <a href="#">+cell</a> &gt; <a href="../index.html">+sim</a> &gt; <a href="index.html">+util</a> &gt; SummaryLogger.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../../../../../index.html"><img alt="<" border="0" src="../../../../../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for simulation/src/+edu/+stanford/+covert/+cell/+sim/+util&nbsp;<img alt=">" border="0" src="../../../../../../../../right.png"></a></td></tr></table>-->

<h1>SummaryLogger
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../../../../../up.png"></a></h2>
<div class="box"><strong>Summary simulation logger. Implements simulation logger interface.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../../../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">Summary simulation logger. Implements simulation logger interface.

 Author: Jonathan Karr, jkarr@stanford.edu
 Affilitation: Covert Lab, Department of Bioengineering, Stanford University
 Last updated: 1/10/2011</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../../../../../matlabicon.gif)">
<li><a href="SummaryLogger.html" class="code" title="">SummaryLogger</a>	Summary simulation logger. Implements simulation logger interface.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../../../../../matlabicon.gif)">
<li><a href="SummaryLogger.html" class="code" title="">SummaryLogger</a>	Summary simulation logger. Implements simulation logger interface.</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../../../../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../../../../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function this = SummaryLogger(stepSizeSec, verbosity, outputDirectory)</a></li><li><a href="#_sub2" class="code">function setOptions(this, options)</a></li><li><a href="#_sub3" class="code">function this = initialize(this, sim)</a></li><li><a href="#_sub4" class="code">function this = append(this, sim)</a></li><li><a href="#_sub5" class="code">function appendHelper(this, i, sim)</a></li><li><a href="#_sub6" class="code">function this = finalize(this, sim)</a></li><li><a href="#_sub7" class="code">function this = save(this)</a></li><li><a href="#_sub8" class="code">function initializePrint(this)</a></li><li><a href="#_sub9" class="code">function print(this, i)</a></li><li><a href="#_sub10" class="code">function finalizePrint(this)</a></li><li><a href="#_sub11" class="code">function initializePlot(this)</a></li><li><a href="#_sub12" class="code">function plot(this, ~)</a></li><li><a href="#_sub13" class="code">function [simStats] = summarizeSimulations(baseDir)</a></li><li><a href="#_sub14" class="code">function simStats = getSimulationStatistics(baseDir, selectedSimulations)</a></li><li><a href="#_sub15" class="code">function value = formatColNames()</a></li><li><a href="#_sub16" class="code">function value = formatStats(stats)</a></li><li><a href="#_sub17" class="code">function value = formatState(summary, idx)</a></li><li><a href="#_sub18" class="code">function summary = getSummaryReport(simStats)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%Summary simulation logger. Implements simulation logger interface.</span>
0002 <span class="comment">%</span>
0003 <span class="comment">% Author: Jonathan Karr, jkarr@stanford.edu</span>
0004 <span class="comment">% Affilitation: Covert Lab, Department of Bioengineering, Stanford University</span>
0005 <span class="comment">% Last updated: 1/10/2011</span>
0006 classdef <a href="SummaryLogger.html" class="code" title="">SummaryLogger</a> &lt; edu.stanford.covert.cell.sim.util.Logger
0007     <span class="comment">%options</span>
0008     properties (Access = protected)
0009         stepSizeSec
0010         verbosity
0011         outputDirectory
0012     <span class="keyword">end</span>
0013     
0014     <span class="comment">%stored data</span>
0015     properties (SetAccess = protected)
0016         log
0017         figureHandle
0018     <span class="keyword">end</span>
0019     
0020     properties (Access = protected)
0021         timer
0022     <span class="keyword">end</span>
0023     
0024     <span class="comment">%indices into simulation states, processes</span>
0025     properties (Access = protected)
0026         stateIndex_time
0027         stateIndex_mass
0028         stateIndex_rna
0029         stateIndex_metabolite
0030         stateIndex_monomer
0031         stateIndex_complex
0032         stateIndex_metabolicReaction
0033         stateIndex_chromosome
0034         stateIndex_geometry
0035         stateIndex_ftsZRing
0036         
0037         processIndex_transcription
0038         processIndex_translation
0039         processIndex_replicationInitiation
0040         processIndex_replication
0041         processIndex_ftsZPolymerization
0042     <span class="keyword">end</span>
0043     
0044     properties(Constant = true)
0045         SIM_STATUS_DIDNT_START = -3;
0046         SIM_STATUS_STILL_RUNNING = -2;
0047         SIM_STATUS_TERMINATED_WITH_ERROR = -1;
0048         SIM_STATUS_COMPLETED_WITH_DIVISION = 0;
0049         SIM_STATUS_COMPLETED_WITHOUT_DIVISION = 1;
0050         
0051         SIM_STATUS_INDEX_STATUS = 1;
0052         SIM_STATUS_INDEX_REP_INIT_TIME = 2;
0053         SIM_STATUS_INDEX_INIT_REP_TIME = 3;
0054         SIM_STATUS_INDEX_REP_TIME = 4;
0055         SIM_STATUS_INDEX_CYTOKINESIS_TIME = 5;
0056         SIM_STATUS_INDEX_INIT_GROWTH = 6;
0057         SIM_STATUS_INDEX_FIN_GROWTH = 7;
0058         SIM_STATUS_INDEX_CUM_GROWTH = 8;
0059         SIM_STATUS_INDEX_FIN_MASS = 9;
0060         SIM_STATUS_INDEX_INIT_MASS = 10;
0061         SIM_STATUS_INDEX_MASS_DOUBLING_TIME = 11;
0062     <span class="keyword">end</span>
0063     
0064     <span class="comment">%ids</span>
0065     properties
0066         ntpWholeCellModelIDs
0067         aaWholeCellModelIDs
0068     <span class="keyword">end</span>
0069     
0070     methods
0071         <a name="_sub0" href="#_subfunctions" class="code">function this = SummaryLogger(stepSizeSec, verbosity, outputDirectory)</a>
0072             <span class="keyword">if</span> nargin &gt;= 1
0073                 this.stepSizeSec = stepSizeSec;
0074             <span class="keyword">else</span>
0075                 this.stepSizeSec = 1;
0076             <span class="keyword">end</span>
0077             
0078             <span class="keyword">if</span> nargin &gt;= 2
0079                 this.verbosity = verbosity;
0080             <span class="keyword">else</span>
0081                 this.verbosity = 2;
0082             <span class="keyword">end</span>
0083             
0084             <span class="keyword">if</span> nargin &gt;= 3
0085                 this.outputDirectory = outputDirectory;
0086             <span class="keyword">else</span>
0087                 this.outputDirectory = [];
0088             <span class="keyword">end</span>
0089         <span class="keyword">end</span>
0090     <span class="keyword">end</span>
0091     
0092     methods
0093         <a name="_sub1" href="#_subfunctions" class="code">function setOptions(this, options)</a>
0094             metaClass = metaclass(this);
0095             fields = intersect(fieldnames(options), cellfun(@(x) x.Name, metaClass.Properties, <span class="string">'UniformOutput'</span>,false));
0096             <span class="keyword">for</span> i = 1:numel(fields)
0097                 this.(fields{i}) = options.(fields{i});
0098             <span class="keyword">end</span>
0099         <span class="keyword">end</span>
0100         
0101         <span class="comment">%Allocates space for small summary stats gathered after each segment.</span>
0102         <a name="_sub2" href="#_subfunctions" class="code">function this = initialize(this, sim)</a>
0103             <span class="comment">%indices</span>
0104             this.stateIndex_time = sim.stateIndex(<span class="string">'Time'</span>);
0105             this.stateIndex_mass = sim.stateIndex(<span class="string">'Mass'</span>);
0106             this.stateIndex_rna = sim.stateIndex(<span class="string">'Rna'</span>);
0107             this.stateIndex_metabolite = sim.stateIndex(<span class="string">'Metabolite'</span>);
0108             this.stateIndex_monomer = sim.stateIndex(<span class="string">'ProteinMonomer'</span>);
0109             this.stateIndex_complex = sim.stateIndex(<span class="string">'ProteinComplex'</span>);
0110             this.stateIndex_metabolicReaction = sim.stateIndex(<span class="string">'MetabolicReaction'</span>);
0111             this.stateIndex_chromosome = sim.stateIndex(<span class="string">'Chromosome'</span>);
0112             this.stateIndex_geometry = sim.stateIndex(<span class="string">'Geometry'</span>);
0113             this.stateIndex_ftsZRing = sim.stateIndex(<span class="string">'FtsZRing'</span>);
0114             
0115             this.processIndex_transcription = sim.processIndex(<span class="string">'Transcription'</span>);
0116             this.processIndex_translation = sim.processIndex(<span class="string">'Translation'</span>);
0117             this.processIndex_replicationInitiation = sim.processIndex(<span class="string">'ReplicationInitiation'</span>);
0118             this.processIndex_replication = sim.processIndex(<span class="string">'Replication'</span>);
0119             this.processIndex_ftsZPolymerization = sim.processIndex(<span class="string">'FtsZPolymerization'</span>);
0120             
0121             <span class="comment">%ids</span>
0122             this.ntpWholeCellModelIDs = sim.state(<span class="string">'Metabolite'</span>).wholeCellModelIDs(sim.state(<span class="string">'Metabolite'</span>).ntpIndexs);
0123             this.aaWholeCellModelIDs = sim.state(<span class="string">'Metabolite'</span>).wholeCellModelIDs(sim.state(<span class="string">'Metabolite'</span>).aminoAcidIndexs);
0124             
0125             <span class="comment">%initialize timer</span>
0126             this.timer = tic;
0127             
0128             <span class="comment">%allocate memory</span>
0129             nSeg = sim.lengthSec / this.stepSizeSec + 1;
0130             validateattributes(nSeg, {<span class="string">'numeric'</span>}, {<span class="string">'real'</span>, <span class="string">'positive'</span>, <span class="string">'integer'</span>});
0131             
0132             this.log = struct();
0133             this.log.runTime               = zeros(1, nSeg, <span class="string">'double'</span>);         <span class="comment">%run time of simulation</span>
0134             this.log.growth                = zeros(1, nSeg, <span class="string">'double'</span>);         <span class="comment">%growth rate</span>
0135             this.log.mass                  = zeros(1, nSeg, <span class="string">'double'</span>);         <span class="comment">%cell mass</span>
0136             this.log.time                  = 0:this.stepSizeSec:sim.lengthSec; <span class="comment">%time (seconds)</span>
0137             this.log.metabolites           = zeros(13, nSeg, <span class="string">'int32'</span>);         <span class="comment">%total numbers of ATP, ADP, AMP</span>
0138             this.log.metaboliteUsages      = zeros(2, nSeg, <span class="string">'int32'</span>);         <span class="comment">%total numbers of ATP, ADP, AMP</span>
0139             this.log.metaboliteProductions = zeros(2, nSeg, <span class="string">'int32'</span>);         <span class="comment">%total numbers of ATP, ADP, AMP</span>
0140             this.log.rnas                  = zeros(7, nSeg, <span class="string">'int32'</span>);          <span class="comment">%total numbers of RNA; mature mRNA, rRNA, sRNA, tRNA</span>
0141             this.log.proteins              = zeros(7, nSeg, <span class="string">'int32'</span>);          <span class="comment">%total number of protein monomers and complexes</span>
0142             this.log.rnaPolymerases        = zeros(1, nSeg, <span class="string">'int16'</span>);          <span class="comment">%total number of RNA polymerases</span>
0143             this.log.ribosomes             = zeros(1, nSeg, <span class="string">'int16'</span>);          <span class="comment">%total number of ribosomes</span>
0144             this.log.supercoiled           = zeros(2, nSeg, <span class="string">'double'</span>);         <span class="comment">%number of supercoiled regions</span>
0145             this.log.dnaA                  = zeros(2, nSeg, <span class="string">'int16'</span>);          <span class="comment">%numbers of free and total DnaA monomers</span>
0146             this.log.dnaAFunctionalBoxes   = zeros(5, nSeg, <span class="string">'int8'</span>);           <span class="comment">%polymerization status of R1-5 functional DnaA boxes</span>
0147             this.log.replisome             = zeros(6, nSeg, <span class="string">'int32'</span>);          <span class="comment">%positions of helicase and leading and lagging polymerases</span>
0148             this.log.ftsZ                  = zeros(2, nSeg, <span class="string">'int16'</span>);          <span class="comment">%numbers of free and total FtsZ monomers</span>
0149             this.log.ftsZRing              = zeros(4, nSeg, <span class="string">'int32'</span>);          <span class="comment">%size of FtsZ ring</span>
0150             this.log.pinchedDiameter       = zeros(1, nSeg, <span class="string">'double'</span>);         <span class="comment">%pinched diameter</span>
0151             this.log.ploidy                = zeros(1, nSeg, <span class="string">'double'</span>);         <span class="comment">%ploidy (genetic content--should range from 1 to 2)</span>
0152             
0153             <span class="comment">%initialize print, plot</span>
0154             this.initializePrint();
0155             this.initializePlot();
0156             
0157             <span class="comment">%append log</span>
0158             this.append(sim);
0159         <span class="keyword">end</span>
0160         
0161         <span class="comment">%Appends a summary of the current state at a specific index.</span>
0162         <a name="_sub3" href="#_subfunctions" class="code">function this = append(this, sim)</a>
0163             t = sim.states{this.stateIndex_time};
0164             i = t.values / this.stepSizeSec + 1;
0165             <span class="keyword">if</span> mod(i, 1) ~= 0
0166                 <span class="keyword">return</span>;
0167             <span class="keyword">end</span>
0168             
0169             <span class="comment">%append log</span>
0170             this.appendHelper(i, sim);
0171             
0172             <span class="comment">%print and plot</span>
0173             this.print(i);
0174             this.plot(i);
0175         <span class="keyword">end</span>
0176         
0177         <a name="_sub4" href="#_subfunctions" class="code">function appendHelper(this, i, sim)</a>
0178             <span class="comment">%references</span>
0179             t = sim.states{this.stateIndex_time};
0180             mass = sim.states{this.stateIndex_mass};
0181             r = sim.states{this.stateIndex_rna};
0182             m = sim.states{this.stateIndex_metabolite};
0183             pm = sim.states{this.stateIndex_monomer};
0184             pc = sim.states{this.stateIndex_complex};
0185             mr = sim.states{this.stateIndex_metabolicReaction};
0186             c = sim.states{this.stateIndex_chromosome};
0187             geometry = sim.states{this.stateIndex_geometry};
0188             ftsZRing = sim.states{this.stateIndex_ftsZRing};
0189             
0190             <span class="comment">%indices</span>
0191             iCytosol = sim.compartment.cytosolIndexs;
0192             iMembrane = sim.compartment.membraneIndexs;
0193             
0194             <span class="comment">%append</span>
0195             this.log.runTime(1, i) = toc(this.timer); this.timer = tic;
0196             this.log.time(1, i) = t.values;
0197             
0198             this.log.mass(1, i) = sum(mass.cellDry) / mass.cellInitialDryWeight;
0199             this.log.growth(1, i) = mr.growth;
0200             
0201             this.log.metabolites(1, i) = sum(m.counts(m.atpIndexs, iCytosol));
0202             this.log.metabolites(2, i) = sum(m.counts(m.adpIndexs, iCytosol));
0203             this.log.metabolites(3, i) = sum(m.counts(m.ampIndexs, iCytosol));
0204             this.log.metabolites(4, i) = sum(m.counts(m.ntpIndexs, iCytosol));
0205             [this.log.metabolites(5, i), this.log.metabolites(6, i)] = min(m.counts(m.ntpIndexs, iCytosol));
0206             this.log.metabolites(7, i) = sum(m.counts(m.aminoAcidIndexs(1:20), iCytosol));
0207             [this.log.metabolites(8, i), this.log.metabolites(9, i)] = min(m.counts(m.aminoAcidIndexs(1:20), iCytosol));
0208             this.log.metabolites(10,i) = sum(m.counts(m.lipidIndexs, iMembrane));
0209             this.log.metabolites(11,i) = sum(m.counts(m.carbohydrateIndexs, iCytosol));
0210             this.log.metabolites(12,i) = sum(m.counts(m.dntpIndexs, iCytosol));
0211             this.log.metabolites(13,i) = sum(m.counts(m.antibioticIndexs, iCytosol));
0212             
0213             <span class="keyword">if</span> ~isempty(m.processUsages)
0214                 tmp1 = m.processUsages(sub2ind(size(m.counts), m.ntpIndexs(1), iCytosol), :);
0215                 tmp2 = m.processUsages(sub2ind(size(m.counts), m.ntpIndexs(3), iCytosol), :);
0216                 this.log.metaboliteUsages(1, i) = sum(max(0, -tmp1), 2);
0217                 this.log.metaboliteUsages(2, i) = sum(max(0, -tmp2), 2);
0218                 this.log.metaboliteProductions(1, i) = sum(max(0, tmp1), 2);
0219                 this.log.metaboliteProductions(2, i) = sum(max(0, tmp2), 2);
0220             <span class="keyword">end</span>
0221             
0222             this.log.rnas(1, i) = sum(r.counts(:));
0223             this.log.rnas(2, i) = sum(<span class="keyword">...</span>
0224                 + r.counts(r.matureIndexs(r.matureMRNAIndexs), iCytosol)<span class="keyword">...</span>
0225                 + r.counts(r.misfoldedIndexs(r.matureMRNAIndexs), iCytosol)<span class="keyword">...</span>
0226                 + r.counts(r.damagedIndexs(r.matureMRNAIndexs), iCytosol)<span class="keyword">...</span>
0227                 );
0228             this.log.rnas(3, i) = sum(<span class="keyword">...</span>
0229                 + r.counts(r.matureIndexs(r.matureRRNAIndexs), iCytosol)<span class="keyword">...</span>
0230                 + r.counts(r.misfoldedIndexs(r.matureRRNAIndexs), iCytosol)<span class="keyword">...</span>
0231                 + r.counts(r.damagedIndexs(r.matureRRNAIndexs), iCytosol)<span class="keyword">...</span>
0232                 );
0233             this.log.rnas(4, i) = sum(<span class="keyword">...</span>
0234                 + r.counts(r.matureIndexs(r.matureSRNAIndexs), iCytosol) <span class="keyword">...</span>
0235                 + r.counts(r.boundIndexs(r.matureSRNAIndexs), iCytosol) <span class="keyword">...</span>
0236                 + r.counts(r.aminoacylatedIndexs(r.matureSRNAIndexs), iCytosol) <span class="keyword">...</span>
0237                 + r.counts(r.misfoldedIndexs(r.matureSRNAIndexs), iCytosol) <span class="keyword">...</span>
0238                 + r.counts(r.damagedIndexs(r.matureSRNAIndexs), iCytosol) <span class="keyword">...</span>
0239                 );
0240             this.log.rnas(5, i) = sum(<span class="keyword">...</span>
0241                 + r.counts(r.matureIndexs(r.matureTRNAIndexs), iCytosol) <span class="keyword">...</span>
0242                 + r.counts(r.aminoacylatedIndexs(r.matureTRNAIndexs), iCytosol) <span class="keyword">...</span>
0243                 + r.counts(r.misfoldedIndexs(r.matureTRNAIndexs), iCytosol) <span class="keyword">...</span>
0244                 + r.counts(r.damagedIndexs(r.matureTRNAIndexs), iCytosol) <span class="keyword">...</span>
0245                 );
0246             this.log.rnas(6, i) = this.log.rnas(1, i) - sum(this.log.rnas(2:5, i));
0247             this.log.rnas(7, i) = sum(r.counts(r.damagedIndexs, iCytosol));
0248             
0249             this.log.proteins(1, i) = sum(pm.counts(:));
0250             this.log.proteins(2, i) = sum(sum(<span class="keyword">...</span>
0251                 + pm.counts(pm.matureIndexs, :) <span class="keyword">...</span>
0252                 + pm.counts(pm.boundIndexs, :) <span class="keyword">...</span>
0253                 + pm.counts(pm.inactivatedIndexs, :) <span class="keyword">...</span>
0254                 + pm.counts(pm.damagedIndexs, :) <span class="keyword">...</span>
0255                 + pm.counts(pm.misfoldedIndexs, :) <span class="keyword">...</span>
0256                 ));
0257             this.log.proteins(3, i) = this.log.proteins(1, i) - this.log.proteins(2, i);
0258             this.log.proteins(4, i) = sum(pc.counts(:));
0259             this.log.proteins(5, i) = sum(sum(<span class="keyword">...</span>
0260                 + pc.counts(pc.matureIndexs, :) <span class="keyword">...</span>
0261                 + pc.counts(pc.boundIndexs, :) <span class="keyword">...</span>
0262                 + pc.counts(pc.inactivatedIndexs, :) <span class="keyword">...</span>
0263                 + pc.counts(pc.damagedIndexs, :) <span class="keyword">...</span>
0264                 + pc.counts(pc.misfoldedIndexs, :) <span class="keyword">...</span>
0265                 ));
0266             this.log.proteins(6, i) = this.log.proteins(4, i) - this.log.proteins(5, i);
0267             this.log.proteins(7, i) = <span class="keyword">...</span>
0268                 + sum(sum(pm.counts(pm.damagedIndexs, :))) <span class="keyword">...</span>
0269                 + sum(sum(pc.counts(pc.damagedIndexs, :)));
0270             
0271             <span class="keyword">if</span> this.processIndex_transcription
0272                 transcription = sim.processes{this.processIndex_transcription};                           
0273                 this.log.rnaPolymerases(1, i) = <span class="keyword">...</span>
0274                     + transcription.enzymes(transcription.enzymeIndexs_rnaPolymerase) <span class="keyword">...</span>
0275                     + transcription.enzymes(transcription.enzymeIndexs_rnaPolymeraseHoloenzyme) <span class="keyword">...</span>
0276                     + transcription.boundEnzymes(transcription.enzymeIndexs_rnaPolymerase) <span class="keyword">...</span>
0277                     + transcription.boundEnzymes(transcription.enzymeIndexs_rnaPolymeraseHoloenzyme);
0278             <span class="keyword">end</span>
0279             
0280             <span class="keyword">if</span> this.processIndex_translation
0281                 translation = sim.processes{this.processIndex_translation};
0282                 this.log.ribosomes(1, i) = <span class="keyword">...</span>
0283                     + translation.enzymes(translation.enzymeIndexs_ribosome30S) <span class="keyword">...</span>
0284                     + translation.enzymes(translation.enzymeIndexs_ribosome30SIF3) <span class="keyword">...</span>
0285                     + translation.enzymes(translation.enzymeIndexs_ribosome50S) <span class="keyword">...</span>
0286                     + translation.enzymes(translation.enzymeIndexs_ribosome70S) <span class="keyword">...</span>
0287                     + translation.boundEnzymes(translation.enzymeIndexs_ribosome30S) <span class="keyword">...</span>
0288                     + translation.boundEnzymes(translation.enzymeIndexs_ribosome30SIF3) <span class="keyword">...</span>
0289                     + translation.boundEnzymes(translation.enzymeIndexs_ribosome50S) <span class="keyword">...</span>
0290                     + translation.boundEnzymes(translation.enzymeIndexs_ribosome70S);
0291             <span class="keyword">end</span>
0292             
0293             this.log.supercoiled(1, i) = collapse(c.supercoiled) / 2;
0294             this.log.supercoiled(2, i) = (collapse(c.linkingNumbers) - collapse(c.polymerizedRegions)/c.relaxedBasesPerTurn) / (collapse(c.polymerizedRegions)/c.relaxedBasesPerTurn);
0295             
0296             <span class="keyword">if</span> this.processIndex_replicationInitiation
0297                 repInit = sim.processes{this.processIndex_replicationInitiation};
0298                 
0299                 this.log.dnaA(:, i) = [
0300                     repInit.enzymes(repInit.enzymeIndexs_DnaA_1mer_ATP)
0301                     [1 1:7 1:7] * (<span class="keyword">...</span>
0302                     + repInit.enzymes([repInit.enzymeIndexs_DnaA; repInit.enzymeIndexs_DnaA_Nmer_ATP; repInit.enzymeIndexs_DnaA_Nmer_ADP]) <span class="keyword">...</span>
0303                     + repInit.boundEnzymes([repInit.enzymeIndexs_DnaA; repInit.enzymeIndexs_DnaA_Nmer_ATP; repInit.enzymeIndexs_DnaA_Nmer_ADP]) <span class="keyword">...</span>
0304                     )];
0305                 dnaAPol = [
0306                     repInit.calculateDnaAR1234Polymerization()
0307                     repInit.calcuateIsDnaAR5Occupied()
0308                     ];
0309                 this.log.dnaAFunctionalBoxes(:, i) = dnaAPol(:, 1);
0310             <span class="keyword">end</span>
0311             <span class="keyword">if</span> this.processIndex_replication
0312                 rep = sim.processes{this.processIndex_replication};
0313                 
0314                 this.log.replisome(:, i) = [
0315                     rep.helicasePosition rep.leadingPosition rep.laggingPosition
0316                     ];
0317             <span class="keyword">end</span>
0318             
0319             this.log.ploidy(1,i) = c.ploidy;
0320             
0321             <span class="keyword">if</span> this.processIndex_ftsZPolymerization
0322                 ftsZPol = sim.processes{this.processIndex_ftsZPolymerization};
0323                 
0324                 freeFtsZMonomers = ftsZPol.enzymes(ftsZPol.enzymeIndexs_FtsZ);
0325                 totFtsZMonomers = <span class="keyword">...</span>
0326                     + ftsZPol.enzymes(ftsZPol.enzymeIndexs_FtsZ) <span class="keyword">...</span>
0327                     + ftsZPol.enzymes(ftsZPol.enzymeIndexs_FtsZ_GDP) <span class="keyword">...</span>
0328                     + ftsZPol.enzymes(ftsZPol.enzymeIndexs_FtsZ_activated)' * (1:9)' <span class="keyword">...</span>
0329                     + ftsZPol.boundEnzymes(ftsZPol.enzymeIndexs_FtsZ) <span class="keyword">...</span>
0330                     + ftsZPol.boundEnzymes(ftsZPol.enzymeIndexs_FtsZ_GDP) <span class="keyword">...</span>
0331                     + ftsZPol.boundEnzymes(ftsZPol.enzymeIndexs_FtsZ_activated)' * (1:9)';
0332                 this.log.ftsZ(:, i) = [
0333                     freeFtsZMonomers
0334                     totFtsZMonomers
0335                     ];
0336             <span class="keyword">end</span>
0337             this.log.ftsZRing(:, i) = [
0338                 ftsZRing.numEdgesOneStraight
0339                 ftsZRing.numEdgesTwoStraight
0340                 ftsZRing.numEdgesTwoBent
0341                 ftsZRing.numResidualBent
0342                 ];
0343             this.log.pinchedDiameter(1, i) = geometry.pinchedDiameter;
0344         <span class="keyword">end</span>
0345         
0346         <a name="_sub5" href="#_subfunctions" class="code">function this = finalize(this, sim)</a>
0347             t = sim.states{this.stateIndex_time};
0348             tmpi = t.values / this.stepSizeSec + 1;
0349             i = ceil(tmpi);
0350             
0351             <span class="comment">%trim log</span>
0352             fields = fieldnames(this.log);
0353             <span class="keyword">for</span> j = 1:numel(fields)
0354                 this.log.(fields{j}) = this.log.(fields{j})(:, 1:i);
0355             <span class="keyword">end</span>
0356             
0357             <span class="comment">%append</span>
0358             this.appendHelper(i, sim);
0359             
0360             <span class="comment">%print and plot</span>
0361             <span class="keyword">if</span> rem(tmpi, 1) ~= 0
0362                 this.print(i);
0363             <span class="keyword">end</span>
0364             this.finalizePrint();
0365             this.plot(i);
0366             
0367             <span class="comment">%save</span>
0368             this.save();
0369         <span class="keyword">end</span>
0370         
0371         <a name="_sub6" href="#_subfunctions" class="code">function this = save(this)</a>
0372             <span class="keyword">if</span> isempty(this.outputDirectory)
0373                 <span class="keyword">return</span>;
0374             <span class="keyword">end</span>
0375             
0376             log = this.log; <span class="comment">%#ok&lt;PROP,NASGU&gt;</span>
0377             <a href="#_sub7" class="code" title="subfunction this = save(this)">save</a>([this.outputDirectory filesep <span class="string">'summary.mat'</span>], <span class="string">'-struct'</span>, <span class="string">'log'</span>);
0378             
0379             <span class="keyword">if</span> this.verbosity &gt; 1
0380                 <span class="keyword">try</span>
0381                     saveas(this.figureHandle, [this.outputDirectory filesep <span class="string">'summary.pdf'</span>]);
0382                 <span class="keyword">catch</span> exception
0383                     warning(<span class="string">'WholeCell:warning'</span>, <span class="string">'Summary figure could not be saved: %s.'</span>, exception.message);
0384                 <span class="keyword">end</span>
0385             <span class="keyword">end</span>
0386         <span class="keyword">end</span>
0387     <span class="keyword">end</span>
0388     
0389     methods (Access = protected)
0390         <a name="_sub7" href="#_subfunctions" class="code">function initializePrint(this)</a>
0391             <span class="keyword">if</span> this.verbosity &lt;= 0
0392                 <span class="keyword">return</span>;
0393             <span class="keyword">end</span>
0394             
0395             fprintf(<span class="string">'%-5s %-3s %-4s %-10s %-89s %-29s %-11s %-11s %-3s %-7s %-9s %-41s %-6s %-7s %-11s %-10s\n'</span>, <span class="keyword">...</span>
0396                 <span class="string">''</span>, <span class="keyword">...</span>
0397                 <span class="string">''</span>, <span class="keyword">...</span>
0398                 <span class="string">''</span>, <span class="keyword">...</span>
0399                 <span class="string">''</span>, <span class="keyword">...</span>
0400                 <span class="string">'Metabolites'</span>,<span class="keyword">...</span>
0401                 <span class="string">'RNAs'</span>, <span class="keyword">...</span>
0402                 <span class="string">'Monomers'</span>, <span class="string">'Complexes'</span>, <span class="keyword">...</span>
0403                 <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="keyword">...</span>
0404                 <span class="string">'Replisome'</span>, <span class="keyword">...</span>
0405                 <span class="string">''</span>, <span class="keyword">...</span>
0406                 <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span> <span class="keyword">...</span>
0407                 );
0408             fprintf(<span class="string">'%-5s %-3s %-4s %-10s %-89s %-29s %-11s %-11s %-3s %-7s %-9s %-41s %-6s %-7s %-11s %-10s\n'</span>, <span class="keyword">...</span>
0409                 <span class="string">''</span>, <span class="keyword">...</span>
0410                 <span class="string">''</span>, <span class="keyword">...</span>
0411                 <span class="string">''</span>, <span class="keyword">...</span>
0412                 <span class="string">''</span>, <span class="keyword">...</span>
0413                 repmat(<span class="string">'='</span>, 1, 89),<span class="keyword">...</span>
0414                 repmat(<span class="string">'='</span>, 1, 29), <span class="keyword">...</span>
0415                 repmat(<span class="string">'='</span>, 1, 11), repmat(<span class="string">'='</span>, 1, 11), <span class="keyword">...</span>
0416                 <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="keyword">...</span>
0417                 repmat(<span class="string">'='</span>, 1, 41), <span class="keyword">...</span>
0418                 <span class="string">''</span>, <span class="keyword">...</span>
0419                 <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span> <span class="keyword">...</span>
0420                 );
0421             fprintf(<span class="string">'%-5s %-3s %-4s %-10s %-8s %-8s %-8s %-8s %-9s %-8s %-9s %-8s %-15s %-4s %-4s %-4s %-4s %-4s %-4s %-5s %-5s %-5s %-5s %-3s %-7s %-9s %-13s %-13s %-13s %-6s %-7s %-11s %-10s\n'</span>,<span class="keyword">...</span>
0422                 <span class="string">'Time'</span>, <span class="keyword">...</span>
0423                 <span class="string">'RT'</span>, <span class="keyword">...</span>
0424                 <span class="string">'Mass'</span>, <span class="keyword">...</span>
0425                 <span class="string">'Growth'</span>, <span class="keyword">...</span>
0426                 <span class="string">'ATP'</span>, <span class="string">'ADP'</span>, <span class="string">'AMP'</span>, <span class="string">'NTPs'</span>, <span class="string">'Min NTP'</span>, <span class="string">'AAs'</span>, <span class="string">'Min AA'</span>, <span class="string">'Lipids'</span>, <span class="string">'Polysaccharides'</span>, <span class="keyword">...</span>
0427                 <span class="string">'Tot'</span>, <span class="string">'Nasc'</span>, <span class="string">'mRNA'</span>, <span class="string">'rRNA'</span>, <span class="string">'sRNA'</span>, <span class="string">'tRNA'</span>, <span class="keyword">...</span>
0428                 <span class="string">'Nasct'</span>, <span class="string">'Matur'</span>, <span class="string">'Nasct'</span>, <span class="string">'Matur'</span>, <span class="keyword">...</span>
0429                 <span class="string">'Sup'</span>, <span class="string">'DnaA'</span>, <span class="string">'R1-5'</span>, <span class="keyword">...</span>
0430                 <span class="string">'Helicase Pos'</span>, <span class="string">'Leading Pos'</span>, <span class="string">'Lagging Pos'</span>, <span class="keyword">...</span>
0431                 <span class="string">'Ploidy'</span>, <span class="keyword">...</span>
0432                 <span class="string">'FtsZ'</span>, <span class="string">'FtsZ Ring'</span>, <span class="string">'Pinch Diam'</span> <span class="keyword">...</span>
0433                 );
0434             fprintf(<span class="string">'%-5s %-3s %-4s %-10s %-8s %-8s %-8s %-8s %-9s %-8s %-9s %-8s %-15s %-4s %-4s %-4s %-4s %-4s %-4s %-5s %-5s %-5s %-5s %-3s %-7s %-9s %-13s %-13s %-13s %-6s %-7s %-11s %-10s\n'</span>,<span class="keyword">...</span>
0435                 repmat(<span class="string">'='</span>, 1, 5), <span class="keyword">...</span>
0436                 repmat(<span class="string">'='</span>, 1, 3), <span class="keyword">...</span>
0437                 repmat(<span class="string">'='</span>, 1, 4), <span class="keyword">...</span>
0438                 repmat(<span class="string">'='</span>, 1, 10), <span class="keyword">...</span>
0439                 repmat(<span class="string">'='</span>, 1, 8), repmat(<span class="string">'='</span>, 1, 8), repmat(<span class="string">'='</span>, 1, 8), repmat(<span class="string">'='</span>, 1, 8), repmat(<span class="string">'='</span>, 1, 9), repmat(<span class="string">'='</span>, 1, 8), repmat(<span class="string">'='</span>, 1, 9), repmat(<span class="string">'='</span>, 1, 8), repmat(<span class="string">'='</span>, 1, 15), <span class="keyword">...</span>
0440                 repmat(<span class="string">'='</span>, 1, 4), repmat(<span class="string">'='</span>, 1, 4), repmat(<span class="string">'='</span>, 1, 4), repmat(<span class="string">'='</span>, 1, 4), repmat(<span class="string">'='</span>, 1, 4), repmat(<span class="string">'='</span>, 1, 4), <span class="keyword">...</span>
0441                 repmat(<span class="string">'='</span>, 1, 5), repmat(<span class="string">'='</span>, 1, 5), repmat(<span class="string">'='</span>, 1, 5), repmat(<span class="string">'='</span>, 1, 5), <span class="keyword">...</span>
0442                 repmat(<span class="string">'='</span>, 1, 3), repmat(<span class="string">'='</span>, 1, 7), repmat(<span class="string">'='</span>, 1, 9), <span class="keyword">...</span>
0443                 repmat(<span class="string">'='</span>, 1, 13), repmat(<span class="string">'='</span>, 1, 13), repmat(<span class="string">'='</span>, 1, 13), <span class="keyword">...</span>
0444                 repmat(<span class="string">'='</span>, 1,6), <span class="keyword">...</span>
0445                 repmat(<span class="string">'='</span>, 1, 7), repmat(<span class="string">'='</span>, 1, 11), repmat(<span class="string">'='</span>, 1, 10) <span class="keyword">...</span>
0446                 );
0447         <span class="keyword">end</span>
0448         
0449         <a name="_sub8" href="#_subfunctions" class="code">function print(this, i)</a>
0450             <span class="keyword">if</span> this.verbosity &lt;= 0
0451                 <span class="keyword">return</span>;
0452             <span class="keyword">end</span>
0453             
0454             <span class="keyword">if</span> ispc
0455                 format = <span class="string">'%5d %3.0f %4.2f %5.3e %8d %8d %8d %8d %5d %3s %8d %5d %3s %8d %15d %4d %4d %4d %4d %4d %4d %5d %5d %5d %5d %3d %3d %3d %d %d %d %d %d %6d %6d %6d %6d %6d %6d %6.3f %3d %3d %2d %2d %2d %2d %5.3e\n'</span>;
0456             <span class="keyword">else</span>
0457                 format = <span class="string">'%5d %3.0f %4.2f %6.3e %8d %8d %8d %8d %5d %3s %8d %5d %3s %8d %15d %4d %4d %4d %4d %4d %4d %5d %5d %5d %5d %3d %3d %3d %d %d %d %d %d %6d %6d %6d %6d %6d %6d %6.3f %3d %3d %2d %2d %2d %2d %6.3e\n'</span>;
0458             <span class="keyword">end</span>
0459             fprintf(format,<span class="keyword">...</span>
0460                 this.log.time(1, i),<span class="keyword">...</span>
0461                 this.log.runTime(1, i), <span class="keyword">...</span>
0462                 this.log.mass(1, i), <span class="keyword">...</span>
0463                 this.log.growth(1, i), <span class="keyword">...</span>
0464                 this.log.metabolites(1, i),<span class="keyword">...</span>
0465                 this.log.metabolites(2, i),<span class="keyword">...</span>
0466                 this.log.metabolites(3, i),<span class="keyword">...</span>
0467                 this.log.metabolites(4, i),<span class="keyword">...</span>
0468                 this.log.metabolites(5, i),<span class="keyword">...</span>
0469                 this.ntpWholeCellModelIDs{this.log.metabolites(6, i)},<span class="keyword">...</span>
0470                 this.log.metabolites(7, i),<span class="keyword">...</span>
0471                 this.log.metabolites(8, i),<span class="keyword">...</span>
0472                 this.aaWholeCellModelIDs{this.log.metabolites(9, i)},<span class="keyword">...</span>
0473                 this.log.metabolites(10,i),<span class="keyword">...</span>
0474                 this.log.metabolites(11,i),<span class="keyword">...</span>
0475                 this.log.rnas(1, i),<span class="keyword">...</span>
0476                 this.log.rnas(6, i),<span class="keyword">...</span>
0477                 this.log.rnas(2, i),<span class="keyword">...</span>
0478                 this.log.rnas(3, i),<span class="keyword">...</span>
0479                 this.log.rnas(4, i),<span class="keyword">...</span>
0480                 this.log.rnas(5, i),<span class="keyword">...</span>
0481                 this.log.proteins(3, i),<span class="keyword">...</span>
0482                 this.log.proteins(2, i),<span class="keyword">...</span>
0483                 this.log.proteins(6, i),<span class="keyword">...</span>
0484                 this.log.proteins(5, i),<span class="keyword">...</span>
0485                 this.log.supercoiled(1, i), <span class="keyword">...</span>
0486                 this.log.dnaA(1, i), <span class="keyword">...</span>
0487                 this.log.dnaA(2, i), <span class="keyword">...</span>
0488                 this.log.dnaAFunctionalBoxes(1, i), <span class="keyword">...</span>
0489                 this.log.dnaAFunctionalBoxes(2, i), <span class="keyword">...</span>
0490                 this.log.dnaAFunctionalBoxes(3, i), <span class="keyword">...</span>
0491                 this.log.dnaAFunctionalBoxes(4, i), <span class="keyword">...</span>
0492                 this.log.dnaAFunctionalBoxes(5, i), <span class="keyword">...</span>
0493                 this.log.replisome(1, i), <span class="keyword">...</span>
0494                 this.log.replisome(2, i), <span class="keyword">...</span>
0495                 this.log.replisome(3, i), <span class="keyword">...</span>
0496                 this.log.replisome(4, i), <span class="keyword">...</span>
0497                 this.log.replisome(5, i), <span class="keyword">...</span>
0498                 this.log.replisome(6, i), <span class="keyword">...</span>
0499                 this.log.ploidy(1,i), <span class="keyword">...</span>
0500                 this.log.ftsZ(1, i), <span class="keyword">...</span>
0501                 this.log.ftsZ(2, i), <span class="keyword">...</span>
0502                 this.log.ftsZRing(1, i), <span class="keyword">...</span>
0503                 this.log.ftsZRing(2, i), <span class="keyword">...</span>
0504                 this.log.ftsZRing(3, i), <span class="keyword">...</span>
0505                 this.log.ftsZRing(4, i), <span class="keyword">...</span>
0506                 this.log.pinchedDiameter(1, i) <span class="keyword">...</span>
0507                 );
0508         <span class="keyword">end</span>
0509         
0510         <a name="_sub9" href="#_subfunctions" class="code">function finalizePrint(this)</a>
0511             <span class="keyword">if</span> this.verbosity &lt;= 0
0512                 <span class="keyword">return</span>;
0513             <span class="keyword">end</span>
0514             
0515             fprintf(<span class="string">'Total simulation time: %d s\n'</span>, this.log.time(1, end));
0516             fprintf(<span class="string">'Total runtime: %.3f s\n'</span>, sum(this.log.runTime));
0517             fprintf(<span class="string">'\n'</span>);
0518         <span class="keyword">end</span>
0519         
0520         <a name="_sub10" href="#_subfunctions" class="code">function initializePlot(this)</a>
0521             <span class="keyword">if</span> this.verbosity &lt;= 1
0522                 <span class="keyword">return</span>;
0523             <span class="keyword">end</span>
0524             
0525             <span class="comment">%create new figure</span>
0526             this.figureHandle = figure();
0527         <span class="keyword">end</span>
0528         
0529         <span class="comment">%Plot progress of evolution of state of organism.</span>
0530         <a name="_sub11" href="#_subfunctions" class="code">function plot(this, ~)</a>
0531             <span class="keyword">if</span> this.verbosity &lt;= 1
0532                 <span class="keyword">return</span>;
0533             <span class="keyword">end</span>
0534             
0535             <span class="comment">%run time</span>
0536             axesHandle = subplot(2, 4, 1, <span class="string">'Parent'</span>, this.figureHandle);
0537             <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(axesHandle, 0:numel(this.log.time)-1, this.log.runTime/60);
0538             title(axesHandle, <span class="string">'Runtime'</span>)
0539             xlabel(axesHandle, <span class="string">'Segment'</span>);
0540             ylabel(axesHandle, <span class="string">'Run Time (m)'</span>);
0541             xlim(axesHandle, [0 numel(this.log.time)-1]);
0542             
0543             <span class="comment">%metabolites</span>
0544             axesHandle = subplot(2, 4, 2, <span class="string">'Parent'</span>, this.figureHandle);
0545             h = <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(axesHandle, this.log.time / 3600, this.log.metabolites([1 2 3 4 5 7 8], :)');
0546             title(axesHandle, <span class="string">'Metabolites'</span>)
0547             xlabel(axesHandle, <span class="string">'Time (h)'</span>);
0548             ylabel(axesHandle, <span class="string">'Metabolites'</span>);
0549             xlim(axesHandle, [0 this.log.time(end)] / 3600);
0550             legend(h, {<span class="string">'ATP'</span>, <span class="string">'ADP'</span>, <span class="string">'AMP'</span>, <span class="string">'Tot NTPs'</span>, <span class="string">'Min NTP'</span>, <span class="string">'Tot AAs'</span>, <span class="string">'Min AA'</span>});
0551             
0552             <span class="comment">%RNAs</span>
0553             axesHandle = subplot(2, 4, 3, <span class="string">'Parent'</span>, this.figureHandle);
0554             h = <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(axesHandle, this.log.time / 3600, this.log.rnas([1 6 2 3 4 5], :)');
0555             title(axesHandle, <span class="string">'RNA'</span>)
0556             xlabel(axesHandle, <span class="string">'Time (h)'</span>);
0557             ylabel(axesHandle, <span class="string">'RNA'</span>);
0558             xlim(axesHandle, [0 this.log.time(end)] / 3600);
0559             legend(h, {<span class="string">'Total'</span>, <span class="string">'Nascent'</span>, <span class="string">'mRNA'</span>, <span class="string">'rRNA'</span>, <span class="string">'sRNA'</span>, <span class="string">'tRNA'</span>});
0560             
0561             <span class="comment">%proteins</span>
0562             axesHandle = subplot(2, 4, 4, <span class="string">'Parent'</span>, this.figureHandle);
0563             h = <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(axesHandle, this.log.time/3600, this.log.proteins([1 3 2 4 6 5], :)');
0564             title(axesHandle, <span class="string">'Protein'</span>)
0565             xlabel(axesHandle, <span class="string">'Time (h)'</span>);
0566             ylabel(axesHandle, <span class="string">'Protein'</span>);
0567             xlim(axesHandle, [0 this.log.time(end)]/3600);
0568             legend(h, {<span class="string">'Total Monomers'</span>, <span class="string">'Nascent Monomers'</span>, <span class="string">'Mature Monomers'</span>, <span class="string">'Total Complexes'</span>, <span class="string">'Nascent Complexes'</span>, <span class="string">'Mature Complexes'</span>});
0569             
0570             <span class="comment">%Supercoiled</span>
0571             axesHandle = subplot(2, 4, 5, <span class="string">'Parent'</span>, this.figureHandle);
0572             <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(axesHandle, this.log.time/3600, this.log.supercoiled(1, :)');
0573             title(axesHandle, <span class="string">'Supercoiled'</span>)
0574             xlabel(axesHandle, <span class="string">'Time (h)'</span>);
0575             ylabel(axesHandle, <span class="string">'No. Supercoiled Regions'</span>);
0576             xlim(axesHandle, [0 this.log.time(end)]/3600);
0577             
0578             <span class="comment">%DnaA</span>
0579             axesHandle = subplot(2, 4, 6, <span class="string">'Parent'</span>, this.figureHandle);
0580             h = <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(axesHandle, this.log.time/3600, [this.log.dnaA/max(1, this.log.dnaA(1,1)); int16(this.log.dnaAFunctionalBoxes)]');
0581             title(axesHandle, <span class="string">'DnaA'</span>)
0582             xlabel(axesHandle, <span class="string">'Time (h)'</span>);
0583             ylabel(axesHandle, <span class="string">'DnaA Count'</span>);
0584             xlim(axesHandle, [0 this.log.time(end)]/3600);
0585             legend(h, {<span class="string">'Free DnaA-ATP'</span>, <span class="string">'Total DnaA'</span>, <span class="string">'R1'</span>, <span class="string">'R2'</span>, <span class="string">'R3'</span>, <span class="string">'R4'</span>, <span class="string">'R5'</span>});
0586             
0587             <span class="comment">%Replisome</span>
0588             axesHandle = subplot(2, 4, 7, <span class="string">'Parent'</span>, this.figureHandle);
0589             h = <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(axesHandle, this.log.time/3600, this.log.replisome');
0590             title(axesHandle, <span class="string">'Replisome'</span>)
0591             xlabel(axesHandle, <span class="string">'Time (h)'</span>);
0592             ylabel(axesHandle, <span class="string">'Position'</span>);
0593             xlim(axesHandle, [0 this.log.time(end)]/3600);
0594             legend(h, {<span class="string">'Helicase-1'</span>, <span class="string">'Helicase-2'</span>, <span class="string">'Leading-1'</span>, <span class="string">'Leading-2'</span>, <span class="string">'Lagging-1'</span>, <span class="string">'Lagging-2'</span>});
0595             
0596             <span class="comment">%FtsZ</span>
0597             axesHandle = subplot(2, 4, 8, <span class="string">'Parent'</span>, this.figureHandle);
0598             h = <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(axesHandle, this.log.time/3600, [double(this.log.ftsZ/this.log.ftsZ(1, 1)); double(this.log.ftsZRing); this.log.pinchedDiameter/this.log.pinchedDiameter(1)]');
0599             title(axesHandle, <span class="string">'FtsZ'</span>)
0600             xlabel(axesHandle, <span class="string">'Time (h)'</span>);
0601             ylabel(axesHandle, <span class="string">'FtsZ'</span>);
0602             xlim(axesHandle, [0 this.log.time(end)]/3600);
0603             legend(h, {<span class="string">'Free FtsZ-GTP'</span>, <span class="string">'Total FtsZ'</span>, <span class="string">'Ring-1strt'</span>, <span class="string">'Ring-1bent'</span>, <span class="string">'Ring-2strt'</span>, <span class="string">'Ring-2 bent'</span>, <span class="string">'Pinched Diameter'</span>});
0604             
0605             <span class="comment">%force display of figures</span>
0606             drawnow;
0607         <span class="keyword">end</span>
0608     <span class="keyword">end</span>
0609     
0610     <span class="comment">% Analyzes summary output of a batch of simulations. Stores analysis in mat file.</span>
0611     methods (Static = true)
0612         <a name="_sub12" href="#_subfunctions" class="code">function [simStats] = summarizeSimulations(baseDir)</a>
0613             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
0614             import edu.stanford.covert.cell.sim.util.SummaryLogger;
0615             
0616             simStats = SummaryLogger.getSimulationStatistics(baseDir);
0617             
0618             nSimulations = size(simStats, 1);
0619             
0620             summaryFileName = [baseDir filesep <span class="string">'summary.html'</span>];
0621             stateFileName = [baseDir filesep <span class="string">'initialAndFinalStates.html'</span>];
0622             errorFileName = [baseDir filesep <span class="string">'errors.html'</span>];
0623             
0624             <span class="comment">%% calc statistics</span>
0625             stateFid = fopen(stateFileName, <span class="string">'w'</span>);
0626             errorFid = fopen(errorFileName, <span class="string">'w'</span>);
0627             fprintf(stateFid, <span class="string">'&lt;html&gt;\n&lt;head&gt;\n'</span>);
0628             fprintf(stateFid, <span class="string">'&lt;style type=&quot;text/css&quot;&gt;\n'</span>);
0629             fprintf(stateFid, <span class="string">'  table.states {width:12000px;}\n'</span>);
0630             fprintf(stateFid, <span class="string">'  table.states thead tr th, table.states tbody tr td{width:auto;padding-left:10px;}\n'</span>);
0631             fprintf(stateFid, <span class="string">'  table.states thead tr th:first-child, table.states tbody tr td:first-child{width:auto;padding-left:0px;}\n'</span>);
0632             fprintf(stateFid, <span class="string">'  table.states thead tr:first-child th {border-top:1px solid black;}\n'</span>);
0633             fprintf(stateFid, <span class="string">'  table.states thead tr:last-child th {border-bottom:1px solid black;}\n'</span>);
0634             fprintf(stateFid, <span class="string">'  table.states tbody tr:last-child td {border-bottom:1px solid black;}\n'</span>);
0635             fprintf(stateFid, <span class="string">'  table.states tr th:first-child, table.states tr td:first-child {border-right:1px solid black}\n'</span>);
0636             fprintf(stateFid, <span class="string">'  table.states thead tr:last-child th:nth-child(%d), table.states tbody tr td:nth-child(%d) {border-right:1px solid black}\n'</span>, 1+6, 1+6);
0637             fprintf(stateFid, <span class="string">'  table.states thead tr:last-child th:nth-child(%d), table.states tbody tr td:nth-child(%d) {border-right:1px solid black}\n'</span>, 1+6+48, 1+6+48);
0638             fprintf(stateFid, <span class="string">'  table.states thead tr th:first-child, table.states tbody tr td:first-child {border-left:1px solid black}\n'</span>);
0639             fprintf(stateFid, <span class="string">'  table.states thead tr th:last-child, table.states tbody tr td:last-child {border-right:1px solid black}\n'</span>);
0640             fprintf(stateFid, <span class="string">'  table.states thead tr th {background-color: #CCCCCC;}\n'</span>);
0641             fprintf(stateFid, <span class="string">'  table.states tbody tr:nth-child(even) td {background-color: #DDDDDD;}\n'</span>);
0642             fprintf(stateFid, <span class="string">'  table.states tbody tr:nth-child(odd) td {background-color: #EEEEEE;}\n'</span>);
0643             fprintf(stateFid, <span class="string">'&lt;/style&gt;\n'</span>);
0644             fprintf(stateFid, <span class="string">'&lt;/head&gt;\n'</span>);
0645             fprintf(stateFid, <span class="string">'&lt;body&gt;\n&lt;table class=&quot;states&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;\n&lt;thead&gt;\n%s\n&lt;/thead&gt;'</span>, SummaryLogger.formatColNames());
0646             fprintf(errorFid, <span class="string">'&lt;html&gt;\n&lt;body&gt;\n'</span>);
0647             <span class="keyword">for</span> i = 1:nSimulations
0648                 <span class="comment">%calc simulation status</span>
0649                 <span class="keyword">if</span> ~exist(sprintf(<span class="string">'%s/%d/state-0.mat'</span>, baseDir, i), <span class="string">'file'</span>)
0650                 <span class="keyword">elseif</span> ~exist(sprintf(<span class="string">'%s/%d/err.mat'</span>, baseDir, i), <span class="string">'file'</span>) &amp;&amp; ~exist(sprintf(<span class="string">'%s/%d/summary.mat'</span>, baseDir, i), <span class="string">'file'</span>)
0651                 <span class="keyword">elseif</span> exist(sprintf(<span class="string">'%s/%d/err.mat'</span>, baseDir, i), <span class="string">'file'</span>)
0652                     tmpFid = fopen(sprintf(<span class="string">'%s/%d/err.log'</span>, baseDir, i), <span class="string">'r'</span>);
0653                     error = reshape(fread(tmpFid, <span class="string">'*char'</span>), 1, []);
0654                     error = strrep(error, sprintf(<span class="string">'\n\n\n\n'</span>), sprintf(<span class="string">'\n'</span>));
0655                     error = strrep(error, sprintf(<span class="string">'\n\n'</span>), sprintf(<span class="string">'\n'</span>));
0656                     fclose(tmpFid);
0657                     fprintf(errorFid, <span class="string">'&lt;p&gt;\n&lt;b&gt;Simulation #%d&lt;/b&gt;&lt;br/&gt;\n&lt;pre&gt;\n%s\n&lt;/pre&gt;\n&lt;/p&gt;\n'</span>, i, error);
0658                 <span class="keyword">else</span>
0659                     summary = load(sprintf(<span class="string">'%s/%d/summary.mat'</span>, baseDir, i));
0660                 <span class="keyword">end</span>
0661                 
0662                 <span class="keyword">if</span> simStats(i, SummaryLogger.SIM_STATUS_INDEX_STATUS) &gt;= 0
0663                     fprintf(stateFid, <span class="string">'&lt;tr&gt;\n&lt;td&gt;%d&lt;/td&gt;\n%s\n%s\n%s\n&lt;/tr&gt;\n'</span>, i, SummaryLogger.formatStats(simStats(i, :)), SummaryLogger.formatState(summary, 1), SummaryLogger.formatState(summary, numel(summary.time)));
0664                 <span class="keyword">else</span>
0665                     fprintf(stateFid, <span class="string">'&lt;tr&gt;\n&lt;td&gt;%d&lt;/td&gt;\n%s\n%s\n%s\n&lt;/tr&gt;\n'</span>, i, SummaryLogger.formatStats(simStats(i, :)), SummaryLogger.formatState(), SummaryLogger.formatState());
0666                 <span class="keyword">end</span>
0667             <span class="keyword">end</span>
0668             fprintf(stateFid, <span class="string">'&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n'</span>);
0669             fprintf(errorFid, <span class="string">'&lt;/body&gt;\n&lt;/html&gt;\n'</span>);
0670             fclose(stateFid);
0671             fclose(errorFid);
0672             
0673             <span class="keyword">if</span> ~any(simStats(:, SummaryLogger.SIM_STATUS_INDEX_STATUS) == -1)
0674                 errorFid = fopen(errorFileName, <span class="string">'w'</span>);
0675                 fprintf(errorFid, <span class="string">'&lt;html&gt;\n&lt;body&gt;\n'</span>);
0676                 fprintf(errorFid, <span class="string">'No run-time errors were encountered.\n'</span>);
0677                 fprintf(errorFid, <span class="string">'&lt;/body&gt;\n&lt;/html&gt;\n'</span>);
0678                 fclose(errorFid);
0679             <span class="keyword">end</span>
0680             
0681             fid = fopen(summaryFileName, <span class="string">'w'</span>);
0682             fwrite(fid, SummaryLogger.getSummaryReport(simStats));
0683             fclose(fid);
0684             
0685             <span class="comment">%% plot</span>
0686             figHandle = figure();
0687             
0688             <span class="comment">%initial vs. cumulative growth</span>
0689             <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(simStats(:, SummaryLogger.SIM_STATUS_INDEX_INIT_GROWTH)'*3600, <span class="keyword">...</span>
0690                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_CUM_GROWTH)', <span class="string">'.'</span>);
0691             xlabel(<span class="string">'Initial growth rate (cell/h)'</span>);
0692             ylabel(<span class="string">'Cumulative growth rate (cell)'</span>);
0693             saveas(gcf, [baseDir filesep <span class="string">'initialVsCumulativeGrowth.pdf'</span>]);
0694             
0695             <span class="comment">%replication initiation time vs replication, cytokinesis times</span>
0696             h = <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME)' / 3600, [<span class="keyword">...</span>
0697                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_TIME) <span class="keyword">...</span>
0698                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_CYTOKINESIS_TIME)]'/ 3600, <span class="string">'.'</span>);
0699             xlabel(<span class="string">'Replication Initiation Time (h)'</span>);
0700             ylabel(<span class="string">'Time (h)'</span>);
0701             legend(h, {<span class="string">'Replication'</span>, <span class="string">'Cytokinesis'</span>});
0702             saveas(gcf, [baseDir filesep <span class="string">'cellCyclePhaseLengths.pdf'</span>]);
0703             
0704             <span class="comment">%replication initiation duration vs replication, cytokinesis</span>
0705             <span class="comment">%durations</span>
0706             h = <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME)' / 3600, [<span class="keyword">...</span>
0707                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_TIME)-simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME) <span class="keyword">...</span>
0708                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_CYTOKINESIS_TIME)-simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_TIME)]'/ 3600, <span class="string">'.'</span>);
0709             xlabel(<span class="string">'Replication Initiation Time (h)'</span>);
0710             ylabel(<span class="string">'Duration (h)'</span>);
0711             legend(h, {<span class="string">'Replication'</span>, <span class="string">'Cytokinesis'</span>});
0712             saveas(gcf, [baseDir filesep <span class="string">'cellCyclePhaseDurations.pdf'</span>]);
0713             
0714             <span class="comment">%initial growth rate vs replication initiation, replication,</span>
0715             <span class="comment">%cytokinesis times</span>
0716             h = <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(simStats(:, SummaryLogger.SIM_STATUS_INDEX_INIT_GROWTH)'*3600, [<span class="keyword">...</span>
0717                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME) <span class="keyword">...</span>
0718                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_TIME) <span class="keyword">...</span>
0719                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_CYTOKINESIS_TIME)]'/ 3600, <span class="string">'.'</span>);
0720             xlabel(<span class="string">'Initial growth rate (cell/h)'</span>);
0721             ylabel(<span class="string">'Time (h)'</span>);
0722             legend(h, {<span class="string">'Replication initiation'</span>, <span class="string">'Replication'</span>, <span class="string">'Cytokinesis'</span>});
0723             saveas(gcf, [baseDir filesep <span class="string">'initialGrowthVsCellCyclePhaseTimes.pdf'</span>]);
0724             
0725             <span class="comment">%cumulative growth vs replication initiation, replication,</span>
0726             <span class="comment">%cytokinesis times</span>
0727             h = <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(simStats(:, SummaryLogger.SIM_STATUS_INDEX_CUM_GROWTH), [<span class="keyword">...</span>
0728                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME) <span class="keyword">...</span>
0729                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_TIME) simStats(:, SummaryLogger.SIM_STATUS_INDEX_CYTOKINESIS_TIME)]'/ 3600, <span class="string">'.'</span>);
0730             xlabel(<span class="string">'Cumulative growth rate (cell)'</span>);
0731             ylabel(<span class="string">'Time (h)'</span>);
0732             legend(h, {<span class="string">'Replication initiation'</span>, <span class="string">'Replication'</span>, <span class="string">'Cytokinesis'</span>});
0733             saveas(gcf, [baseDir filesep <span class="string">'cumulativeGrowthVsCellCyclePhaseTimes.pdf'</span>]);
0734             
0735             <span class="comment">%initial growth rate vs replication initiation, replication,</span>
0736             <span class="comment">%cytokinesis durations</span>
0737             h = <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(simStats(:, SummaryLogger.SIM_STATUS_INDEX_INIT_GROWTH)'*3600, [<span class="keyword">...</span>
0738                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME) <span class="keyword">...</span><span class="comment">.</span>
0739                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_TIME)-simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME) <span class="keyword">...</span>
0740                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_CYTOKINESIS_TIME)-simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_TIME)]'/ 3600, <span class="string">'.'</span>);
0741             xlabel(<span class="string">'Initial growth rate (cell/h)'</span>);
0742             ylabel(<span class="string">'Duration (h)'</span>);
0743             legend(h, {<span class="string">'Replication initiation'</span>, <span class="string">'Replication'</span>, <span class="string">'Cytokinesis'</span>});
0744             saveas(gcf, [baseDir filesep <span class="string">'initialGrowthVsCellCyclePhaseDurations.pdf'</span>]);
0745             
0746             <span class="comment">%cumulative growth vs replication initiation, replication,</span>
0747             <span class="comment">%cytokinesis durations</span>
0748             h = <a href="#_sub12" class="code" title="subfunction plot(this, ~)">plot</a>(simStats(:, SummaryLogger.SIM_STATUS_INDEX_CUM_GROWTH), [<span class="keyword">...</span>
0749                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME) <span class="keyword">...</span>
0750                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_TIME)-simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME) <span class="keyword">...</span>
0751                 simStats(:, SummaryLogger.SIM_STATUS_INDEX_CYTOKINESIS_TIME)-simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_TIME)]'/ 3600, <span class="string">'.'</span>);
0752             xlabel(<span class="string">'Cumulative growth rate (cell)'</span>);
0753             ylabel(<span class="string">'Duration (h)'</span>);
0754             legend(h, {<span class="string">'Replication initiation'</span>, <span class="string">'Replication'</span>, <span class="string">'Cytokinesis'</span>});
0755             saveas(gcf, [baseDir filesep <span class="string">'cumulativeGrowthVsCellCyclePhaseDurations.pdf'</span>]);
0756             
0757             close(figHandle);
0758         <span class="keyword">end</span>
0759         
0760         <a name="_sub13" href="#_subfunctions" class="code">function simStats = getSimulationStatistics(baseDir, selectedSimulations)</a>
0761             import edu.stanford.covert.cell.sim.util.SimulationDiskUtil;
0762             import edu.stanford.covert.cell.sim.util.SummaryLogger;
0763             
0764             <span class="keyword">if</span> nargin &lt; 2
0765                 selectedSimulations = 1:SimulationDiskUtil.getNumSimulations(baseDir);
0766             <span class="keyword">end</span>
0767             
0768             nSimulations = numel(selectedSimulations);
0769             
0770             <span class="comment">%% calc statistics</span>
0771             simStats = NaN(nSimulations, 11);
0772             <span class="keyword">for</span> j = 1:nSimulations
0773                 i = selectedSimulations(j);
0774                 
0775                 <span class="comment">%calc simulation status</span>
0776                 <span class="keyword">if</span> ~exist(sprintf(<span class="string">'%s/%d/state-0.mat'</span>, baseDir, i), <span class="string">'file'</span>)
0777                     simStats(j, SummaryLogger.SIM_STATUS_INDEX_STATUS) = SummaryLogger.SIM_STATUS_DIDNT_START;
0778                 <span class="keyword">elseif</span> ~exist(sprintf(<span class="string">'%s/%d/err.mat'</span>, baseDir, i), <span class="string">'file'</span>) &amp;&amp; ~exist(sprintf(<span class="string">'%s/%d/summary.mat'</span>, baseDir, i), <span class="string">'file'</span>)
0779                     simStats(j, SummaryLogger.SIM_STATUS_INDEX_STATUS) = SummaryLogger.SIM_STATUS_STILL_RUNNING;
0780                 <span class="keyword">elseif</span> exist(sprintf(<span class="string">'%s/%d/err.mat'</span>, baseDir, i), <span class="string">'file'</span>)
0781                     simStats(j, SummaryLogger.SIM_STATUS_INDEX_STATUS) = SummaryLogger.SIM_STATUS_TERMINATED_WITH_ERROR;
0782                 <span class="keyword">else</span>
0783                     summary = load(sprintf(<span class="string">'%s/%d/summary.mat'</span>, baseDir, i), <span class="string">'time'</span>, <span class="string">'mass'</span>, <span class="string">'growth'</span>, <span class="string">'dnaAFunctionalBoxes'</span>, <span class="string">'replisome'</span>, <span class="string">'pinchedDiameter'</span>);
0784                     <span class="keyword">if</span> summary.pinchedDiameter(end) == 0
0785                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_STATUS) = SummaryLogger.SIM_STATUS_COMPLETED_WITH_DIVISION;
0786                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_CYTOKINESIS_TIME) = summary.time(end);
0787                     <span class="keyword">else</span>
0788                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_STATUS) = SummaryLogger.SIM_STATUS_COMPLETED_WITHOUT_DIVISION;
0789                     <span class="keyword">end</span>
0790                     
0791                     <span class="comment">%calc simulation statistics</span>
0792                     idx = find(all(summary.dnaAFunctionalBoxes == repmat([7; 7; 7; 7; 1], 1, numel(summary.time)), 1), 1, <span class="string">'first'</span>);
0793                     <span class="keyword">if</span> ~isempty(idx)
0794                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME) = summary.time(idx);
0795                     <span class="keyword">end</span>
0796                     
0797                     idx = find(any(summary.replisome, 1), 1, <span class="string">'first'</span>);
0798                     <span class="keyword">if</span> ~isempty(idx)
0799                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_INIT_REP_TIME) = summary.time(idx);
0800                     <span class="keyword">end</span>
0801                     simStats(j, SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME) = min(<span class="keyword">...</span>
0802                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME), <span class="keyword">...</span>
0803                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_INIT_REP_TIME));
0804                     
0805                     idx = find(any(summary.replisome, 1), 1, <span class="string">'last'</span>)+1;
0806                     <span class="keyword">if</span> ~isempty(idx) &amp;&amp; idx &lt;= size(summary.time, 2)
0807                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_REP_TIME) = summary.time(idx);
0808                     <span class="keyword">end</span>
0809                     
0810                     simStats(j, SummaryLogger.SIM_STATUS_INDEX_INIT_GROWTH) = summary.growth(1);
0811                     cellCycleLength = 9.0 * 3600;
0812                     idx = find(summary.time &gt; cellCycleLength, 1, <span class="string">'first'</span>);
0813                     <span class="keyword">if</span> ~isempty(idx)
0814                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_FIN_GROWTH) = summary.growth(idx);
0815                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_CUM_GROWTH) = diff(summary.time(1:2)) * sum(summary.growth(1:idx));
0816                     <span class="keyword">else</span>
0817                         f = (2 - 1) / (exp(log(2) * summary.time(end) / cellCycleLength) - 1); <span class="comment">%#ok&lt;CPROP,PROP&gt;</span>
0818                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_FIN_GROWTH) = f * summary.growth(end);
0819                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_CUM_GROWTH) = f * diff(summary.time(1:2)) * sum(summary.growth);
0820                     <span class="keyword">end</span>
0821                     
0822                     idx = find(summary.mass &gt; 2 * summary.mass(1), 1, <span class="string">'first'</span>);
0823                     <span class="keyword">if</span> ~isempty(idx)
0824                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_MASS_DOUBLING_TIME) = summary.time(idx-1);
0825                     <span class="keyword">else</span>
0826                         simStats(j, SummaryLogger.SIM_STATUS_INDEX_MASS_DOUBLING_TIME) = <span class="keyword">...</span>
0827                             cellCycleLength / log(2) * log(2 / summary.mass(end)) + summary.time(end); <span class="comment">%#ok&lt;CPROP,PROP&gt;</span>
0828                     <span class="keyword">end</span>
0829                     
0830                     simStats(j, SummaryLogger.SIM_STATUS_INDEX_FIN_MASS) = summary.mass(end);
0831                     simStats(j, SummaryLogger.SIM_STATUS_INDEX_INIT_MASS) = summary.mass(1);
0832                 <span class="keyword">end</span>
0833             <span class="keyword">end</span>
0834         <span class="keyword">end</span>
0835         
0836         <a name="_sub14" href="#_subfunctions" class="code">function value = formatColNames()</a>
0837             stateColNames = {
0838                 <span class="string">'Time'</span>
0839                 <span class="string">'Growth'</span>
0840                 <span class="string">'Mass'</span>
0841                 <span class="string">'ATP'</span>
0842                 <span class="string">'ADP'</span>
0843                 <span class="string">'AMP'</span>
0844                 <span class="string">'Total NTPs'</span>
0845                 <span class="string">'Min NTP'</span>
0846                 <span class="string">'Min NTP'</span>
0847                 <span class="string">'Total AAs'</span>
0848                 <span class="string">'Min AA'</span>
0849                 <span class="string">'Min AA'</span>
0850                 <span class="string">'Total Lipids'</span>
0851                 <span class="string">'Total Carbohydrates'</span>
0852                 <span class="string">'Total RNA'</span>
0853                 <span class="string">'Total mature mRNA'</span>
0854                 <span class="string">'Total mature rRNA'</span>
0855                 <span class="string">'Total mature sRNA'</span>
0856                 <span class="string">'Total mature tRNA'</span>
0857                 <span class="string">'Total immature RNA'</span>
0858                 <span class="string">'Total Monomers'</span>
0859                 <span class="string">'Total Mature Monomers'</span>
0860                 <span class="string">'Total Immature Monomers'</span>
0861                 <span class="string">'Total Complexs'</span>
0862                 <span class="string">'Total Mature Complexs'</span>
0863                 <span class="string">'Total Immature Complexs'</span>
0864                 <span class="string">'Supercoiled'</span>
0865                 <span class="string">'Free'</span>
0866                 <span class="string">'Total'</span>
0867                 <span class="string">'R1'</span>
0868                 <span class="string">'R2'</span>
0869                 <span class="string">'R3'</span>
0870                 <span class="string">'R4'</span>
0871                 <span class="string">'R5'</span>
0872                 <span class="string">'Helicase Position - 1'</span>
0873                 <span class="string">'Helicase Position - 2'</span>
0874                 <span class="string">'Leading Polymerase Position - 1'</span>
0875                 <span class="string">'Leading Polymerase Position - 2'</span>
0876                 <span class="string">'Lagging Polymerase Position - 2'</span>
0877                 <span class="string">'Lagging Polymerase Position - 2'</span>
0878                 <span class="string">'Ploidy'</span>
0879                 <span class="string">'Free'</span>
0880                 <span class="string">'Total'</span>
0881                 <span class="string">'One straight'</span>
0882                 <span class="string">'One bent'</span>
0883                 <span class="string">'Two straight'</span>
0884                 <span class="string">'Residual'</span>
0885                 <span class="string">'Pinched Diameter'</span>
0886                 };
0887             colNames = [{
0888                 <span class="string">'Simulation'</span>
0889                 <span class="string">'Status'</span>
0890                 <span class="string">'Replication initiation time'</span>
0891                 <span class="string">'Initiation of replication time'</span>
0892                 <span class="string">'Replication time'</span>
0893                 <span class="string">'Cytokinesis time'</span>
0894                 <span class="string">'Cumulative growth'</span>
0895                 };
0896                 stateColNames; stateColNames];
0897             
0898             value = [];
0899             
0900             value = [value sprintf(<span class="string">'&lt;tr&gt;\n'</span>)];
0901             value = [value sprintf(<span class="string">'&lt;th&gt;&amp;nbsp;&lt;/th&gt;\n'</span>)];
0902             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;6&quot;&gt;%s&lt;/th&gt;\n'</span>, <span class="string">'Summary'</span>)];
0903             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, numel(stateColNames), <span class="string">'Initial State'</span>)];
0904             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, numel(stateColNames), <span class="string">'Final State'</span>)];
0905             value = [value sprintf(<span class="string">'&lt;/tr&gt;\n'</span>)];
0906             
0907             value = [value sprintf(<span class="string">'&lt;tr&gt;\n'</span>)];
0908             value = [value sprintf(<span class="string">'&lt;th&gt;&amp;nbsp;&lt;/th&gt;\n'</span>)];
0909             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;6&quot;&gt;%s&lt;/th&gt;\n'</span>, <span class="string">'&amp;nbsp;'</span>)];
0910             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 1, <span class="string">'&amp;nbsp;'</span>)]; <span class="comment">%Time</span>
0911             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 1, <span class="string">'&amp;nbsp;'</span>)]; <span class="comment">%Growth</span>
0912             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 1, <span class="string">'&amp;nbsp;'</span>)]; <span class="comment">%Mass</span>
0913             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 11, <span class="string">'Metabolite'</span>)];
0914             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 6, <span class="string">'RNA'</span>)];
0915             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 6, <span class="string">'Protein'</span>)];
0916             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 1, <span class="string">'&amp;nbsp;'</span>)]; <span class="comment">%Supercoiled</span>
0917             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 2, <span class="string">'DnaA'</span>)];
0918             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 5, <span class="string">'Functional DnaA Boxes'</span>)];
0919             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 6, <span class="string">'Replisome'</span>)];
0920             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 1, <span class="string">'&amp;nbsp;'</span>)]; <span class="comment">%ploidy</span>
0921             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 2, <span class="string">'FtsZ'</span>)];
0922             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 4, <span class="string">'FtsZ Ring'</span>)];
0923             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 1, <span class="string">'&amp;nbsp;'</span>)]; <span class="comment">%Pinched Diameter</span>
0924             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 1, <span class="string">'&amp;nbsp;'</span>)]; <span class="comment">%Time</span>
0925             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 1, <span class="string">'&amp;nbsp;'</span>)]; <span class="comment">%Growth</span>
0926             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 1, <span class="string">'&amp;nbsp;'</span>)]; <span class="comment">%Mass</span>
0927             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 11, <span class="string">'Metabolite'</span>)];
0928             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 6, <span class="string">'RNA'</span>)];
0929             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 6, <span class="string">'Protein'</span>)];
0930             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 1, <span class="string">'&amp;nbsp;'</span>)]; <span class="comment">%Supercoiled</span>
0931             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 2, <span class="string">'DnaA'</span>)];
0932             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 5, <span class="string">'Functional DnaA Boxes'</span>)];
0933             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 6, <span class="string">'Replisome'</span>)];
0934             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 1, <span class="string">'&amp;nbsp;'</span>)]; <span class="comment">%ploidy</span>
0935             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 2, <span class="string">'FtsZ'</span>)];
0936             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 4, <span class="string">'FtsZ Ring'</span>)];
0937             value = [value sprintf(<span class="string">'&lt;th colspan=&quot;%d&quot;&gt;%s&lt;/th&gt;\n'</span>, 1, <span class="string">'&amp;nbsp;'</span>)]; <span class="comment">%Pinched Diameter</span>
0938             value = [value sprintf(<span class="string">'&lt;/tr&gt;\n'</span>)];
0939             
0940             value = [value sprintf(<span class="string">'&lt;tr&gt;\n'</span>)];
0941             <span class="keyword">for</span> i = 1:numel(colNames)
0942                 value = [value sprintf(<span class="string">'&lt;th&gt;%s&lt;/th&gt;\n'</span>, colNames{i})]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0943             <span class="keyword">end</span>
0944             value = [value sprintf(<span class="string">'&lt;/tr&gt;\n'</span>)];
0945         <span class="keyword">end</span>
0946         
0947         <a name="_sub15" href="#_subfunctions" class="code">function value = formatStats(stats)</a>
0948             import edu.stanford.covert.cell.sim.util.SummaryLogger;
0949             
0950             <span class="keyword">switch</span> stats(SummaryLogger.SIM_STATUS_INDEX_STATUS)
0951                 <span class="keyword">case</span> -3, status = <span class="string">'Not yet started'</span>;
0952                 <span class="keyword">case</span> -2, status = <span class="string">'Not yet terminated'</span>;
0953                 <span class="keyword">case</span> -1, status = <span class="string">'Terminated with error'</span>;
0954                 <span class="keyword">case</span> 0, status = <span class="string">'Terminated with division'</span>;
0955                 <span class="keyword">case</span> 1, status = <span class="string">'Terminated without division'</span>;
0956             <span class="keyword">end</span>
0957             value = sprintf(<span class="string">'&lt;td&gt;%s&lt;/td&gt;\n'</span>, status);
0958             
0959             <span class="keyword">if</span> ~isnan(stats(SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME))
0960                 value = [value sprintf(<span class="string">'&lt;td&gt;%d&lt;/td&gt;\n'</span>, stats(SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME))];
0961             <span class="keyword">else</span>
0962                 value = [value sprintf(<span class="string">'&lt;td&gt;&amp;nbsp;&lt;/td&gt;\n'</span>)];
0963             <span class="keyword">end</span>
0964             
0965             <span class="keyword">if</span> ~isnan(stats(SummaryLogger.SIM_STATUS_INDEX_INIT_REP_TIME))
0966                 value = [value sprintf(<span class="string">'&lt;td&gt;%d&lt;/td&gt;\n'</span>, stats(SummaryLogger.SIM_STATUS_INDEX_INIT_REP_TIME))];
0967             <span class="keyword">else</span>
0968                 value = [value sprintf(<span class="string">'&lt;td&gt;&amp;nbsp;&lt;/td&gt;\n'</span>)];
0969             <span class="keyword">end</span>
0970             
0971             <span class="keyword">if</span> ~isnan(stats(SummaryLogger.SIM_STATUS_INDEX_REP_TIME))
0972                 value = [value sprintf(<span class="string">'&lt;td&gt;%d&lt;/td&gt;\n'</span>, stats(SummaryLogger.SIM_STATUS_INDEX_REP_TIME))];
0973             <span class="keyword">else</span>
0974                 value = [value sprintf(<span class="string">'&lt;td&gt;&amp;nbsp;&lt;/td&gt;\n'</span>)];
0975             <span class="keyword">end</span>
0976             
0977             <span class="keyword">if</span> ~isnan(stats(SummaryLogger.SIM_STATUS_INDEX_CYTOKINESIS_TIME))
0978                 value = [value sprintf(<span class="string">'&lt;td&gt;%d&lt;/td&gt;\n'</span>, stats(SummaryLogger.SIM_STATUS_INDEX_CYTOKINESIS_TIME))];
0979             <span class="keyword">else</span>
0980                 value = [value sprintf(<span class="string">'&lt;td&gt;&amp;nbsp;&lt;/td&gt;\n'</span>)];
0981             <span class="keyword">end</span>
0982             
0983             <span class="keyword">if</span> ~isnan(stats(SummaryLogger.SIM_STATUS_INDEX_CUM_GROWTH))
0984                 value = [value sprintf(<span class="string">'&lt;td&gt;%e&lt;/td&gt;\n'</span>, stats(SummaryLogger.SIM_STATUS_INDEX_CUM_GROWTH))];
0985             <span class="keyword">else</span>
0986                 value = [value sprintf(<span class="string">'&lt;td&gt;&amp;nbsp;&lt;/td&gt;\n'</span>)];
0987             <span class="keyword">end</span>
0988         <span class="keyword">end</span>
0989                 
0990         <a name="_sub16" href="#_subfunctions" class="code">function value = formatState(summary, idx)</a>
0991             fields = {
0992                 <span class="string">'time'</span> 1
0993                 <span class="string">'growth'</span> 1
0994                 <span class="string">'mass'</span> 1
0995                 <span class="string">'metabolites'</span> 11
0996                 <span class="string">'rnas'</span> 6
0997                 <span class="string">'proteins'</span> 6
0998                 <span class="string">'supercoiled'</span> 1
0999                 <span class="string">'dnaA'</span> 2
1000                 <span class="string">'dnaAFunctionalBoxes'</span> 5
1001                 <span class="string">'replisome'</span> 6
1002                 <span class="string">'ploidy'</span> 1
1003                 <span class="string">'ftsZ'</span> 2
1004                 <span class="string">'ftsZRing'</span> 4
1005                 <span class="string">'pinchedDiameter'</span> 1
1006                 };
1007             value = [];
1008             <span class="keyword">for</span> i = 1:size(fields, 1)                
1009                 <span class="keyword">for</span> j = 1:fields{i, 2}
1010                     <span class="keyword">if</span> nargin == 0 || ~isfield(summary, fields{i, 1}) || j &gt; size(summary.(fields{i, 1}), 1)
1011                         value = [value sprintf(<span class="string">'&lt;td&gt;&amp;nbsp;&lt;/td&gt;\n'</span>)]; <span class="comment">%#ok&lt;AGROW&gt;</span>
1012                     <span class="keyword">elseif</span> summary.(fields{i, 1})(j, idx) == ceil(summary.(fields{i, 1})(j, idx))
1013                         value = [value sprintf(<span class="string">'&lt;td&gt;%d&lt;/td&gt;\n'</span>, summary.(fields{i, 1})(j, idx))]; <span class="comment">%#ok&lt;AGROW&gt;</span>
1014                     <span class="keyword">else</span>
1015                         value = [value sprintf(<span class="string">'&lt;td&gt;%e&lt;/td&gt;\n'</span>, summary.(fields{i, 1})(j, idx))]; <span class="comment">%#ok&lt;AGROW&gt;</span>
1016                     <span class="keyword">end</span>
1017                 <span class="keyword">end</span>
1018             <span class="keyword">end</span>
1019         <span class="keyword">end</span>
1020         
1021         <span class="comment">%% build summary report</span>
1022         <a name="_sub17" href="#_subfunctions" class="code">function summary = getSummaryReport(simStats)</a>
1023             import edu.stanford.covert.cell.sim.util.SummaryLogger;
1024             
1025             nSimulations = size(simStats, 1);
1026             nTerminatedWithDivision = sum(simStats(:, SummaryLogger.SIM_STATUS_INDEX_STATUS) == 0);
1027             nTerminatedWithoutDivision = sum(simStats(:, SummaryLogger.SIM_STATUS_INDEX_STATUS) == 1);
1028             nTerminatedWithError = sum(simStats(:, SummaryLogger.SIM_STATUS_INDEX_STATUS) == -1);
1029             nNotYetTerminated = sum(simStats(:, SummaryLogger.SIM_STATUS_INDEX_STATUS) == -2);
1030             nNotYetStarted = sum(simStats(:, SummaryLogger.SIM_STATUS_INDEX_STATUS) == -3);
1031             repInitTimes = simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_INIT_TIME) / 3600;
1032             initRepTimes = simStats(:, SummaryLogger.SIM_STATUS_INDEX_INIT_REP_TIME) / 3600;
1033             repTimes = simStats(:, SummaryLogger.SIM_STATUS_INDEX_REP_TIME) / 3600;
1034             cytTimes = simStats(:, SummaryLogger.SIM_STATUS_INDEX_CYTOKINESIS_TIME) / 3600;
1035             initGrowths = simStats(:, SummaryLogger.SIM_STATUS_INDEX_INIT_GROWTH) * 3600;
1036             finGrowths = simStats(:, SummaryLogger.SIM_STATUS_INDEX_FIN_GROWTH) * 3600;
1037             cumGrowths = simStats(:, SummaryLogger.SIM_STATUS_INDEX_CUM_GROWTH);
1038             initMass = simStats(:, SummaryLogger.SIM_STATUS_INDEX_INIT_MASS);
1039             finMass = simStats(:, SummaryLogger.SIM_STATUS_INDEX_FIN_MASS);
1040             
1041             <span class="comment">%styles</span>
1042             summary = [];
1043             summary = [summary sprintf(<span class="string">'&lt;html&gt;\n'</span>)];
1044             summary = [summary sprintf(<span class="string">'&lt;head&gt;\n'</span>)];
1045             summary = [summary sprintf(<span class="string">'&lt;style type=&quot;text/css&quot;&gt;\n'</span>)];
1046             summary = [summary sprintf(<span class="string">'  table.summary tr th {text-align:left; width:400px;}\n'</span>)];
1047             summary = [summary sprintf(<span class="string">'  table.summary tr td {text-align:right; padding-left:10px}\n'</span>)];
1048             summary = [summary sprintf(<span class="string">'&lt;/style&gt;\n'</span>)];
1049             summary = [summary sprintf(<span class="string">'&lt;/head&gt;\n'</span>)];
1050             summary = [summary sprintf(<span class="string">'&lt;body&gt;\n'</span>)];
1051             
1052             <span class="comment">%status</span>
1053             summary = [summary sprintf(<span class="string">'&lt;table class=&quot;summary&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;\n'</span>)];
1054             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%d&lt;/td&gt;&lt;td&gt;%5.1f%%&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'No. simulations'</span>, nSimulations, 100)];
1055             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%d&lt;/td&gt;&lt;td&gt;%5.1f%%&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Terminated with division'</span>, nTerminatedWithDivision, nTerminatedWithDivision/nSimulations*100)];
1056             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%d&lt;/td&gt;&lt;td&gt;%5.1f%%&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Terminated without division'</span>,nTerminatedWithoutDivision, nTerminatedWithoutDivision/nSimulations*100)];
1057             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%d&lt;/td&gt;&lt;td&gt;%5.1f%%&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Terminated with error'</span>, nTerminatedWithError, nTerminatedWithError/nSimulations*100)];
1058             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%d&lt;/td&gt;&lt;td&gt;%5.1f%%&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Not yet terminated'</span>, nNotYetTerminated, nNotYetTerminated/nSimulations*100)];
1059             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%d&lt;/td&gt;&lt;td&gt;%5.1f%%&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Not yet started'</span>, nNotYetStarted, nNotYetStarted/nSimulations*100)];
1060             summary = [summary sprintf(<span class="string">'&lt;/table&gt;\n&lt;br/&gt;\n'</span>)];
1061             
1062             <span class="comment">%times</span>
1063             meanMassDoublingTime = 9.0 / nanmean(cumGrowths);
1064             stdMassDoublingTime = sqrt(9.0 / nanmean(cumGrowths)) * nanstd(cumGrowths);
1065             summary = [summary sprintf(<span class="string">'&lt;table class=&quot;summary&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;\n'</span>)];
1066             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.1f &amp;plusmn; %5.1f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Mass doubling time (h)'</span>, meanMassDoublingTime, stdMassDoublingTime)];
1067             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.1f &amp;plusmn; %5.1f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Cell cycle length (h)'</span>, nanmean(cytTimes), nanstd(cytTimes))];
1068             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.1f &amp;plusmn; %5.1f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Replication initiation time (h)'</span>, nanmean(repInitTimes), nanstd(repInitTimes))];
1069             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.1f &amp;plusmn; %5.1f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Initiation of replication time (h)'</span>, nanmean(initRepTimes), nanstd(initRepTimes))];
1070             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.1f &amp;plusmn; %5.1f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Replication time (h)'</span>, nanmean(repTimes), nanstd(repTimes))];
1071             summary = [summary sprintf(<span class="string">'&lt;/table&gt;\n&lt;br/&gt;\n'</span>)];
1072             
1073             <span class="comment">%durations</span>
1074             summary = [summary sprintf(<span class="string">'&lt;table class=&quot;summary&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;\n'</span>)];
1075             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.1f &amp;plusmn; %5.1f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Replication initiation duration (h)'</span>, <span class="keyword">...</span>
1076                 nanmean(repInitTimes), nanstd(repInitTimes))];
1077             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.1f &amp;plusmn; %5.1f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Replication initiation-replisome formation duration (h)'</span>, <span class="keyword">...</span>
1078                 nanmean(initRepTimes - repInitTimes), nanstd(initRepTimes - repInitTimes))];
1079             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.1f &amp;plusmn; %5.1f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Replication duration (h)'</span>, <span class="keyword">...</span>
1080                 nanmean(repTimes - initRepTimes), nanstd(repTimes - initRepTimes))];
1081             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.1f &amp;plusmn; %5.1f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Cytokinesis duration (h)'</span>, <span class="keyword">...</span>
1082                 nanmean(cytTimes - repTimes), nanstd(cytTimes - repTimes))];
1083             summary = [summary sprintf(<span class="string">'&lt;/table&gt;\n&lt;br/&gt;\n'</span>)];
1084             
1085             <span class="comment">%growth</span>
1086             summary = [summary sprintf(<span class="string">'&lt;table class=&quot;summary&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;\n'</span>)];
1087             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.3f &amp;plusmn; %5.3f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Growth at t==0 (1/cells/h)'</span>, <span class="keyword">...</span>
1088                 nanmean(initGrowths), nanstd(initGrowths))];
1089             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.3f &amp;plusmn; %5.3f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Growth at t==&amp;tau; (1/cells/h)'</span>, <span class="keyword">...</span>
1090                 nanmean(finGrowths), nanstd(finGrowths))];
1091             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.3f &amp;plusmn; %5.3f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Cumulative Growth over &amp;tau; (1/cells)'</span>, <span class="keyword">...</span>
1092                 nanmean(cumGrowths), nanstd(cumGrowths))];
1093             summary = [summary sprintf(<span class="string">'&lt;/table&gt;\n&lt;br/&gt;\n'</span>)];
1094             
1095             <span class="comment">%mass</span>
1096             summary = [summary sprintf(<span class="string">'&lt;table class=&quot;summary&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;\n'</span>)];
1097             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.3f &amp;plusmn; %5.3f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Mean Mass at t==0 (cells)'</span>, <span class="keyword">...</span>
1098                 nanmean(initMass), nanstd(initMass))];
1099             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.3f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Median Mass at t==0; (cells)'</span>, <span class="keyword">...</span>
1100                 nanmedian(initMass))];
1101             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.3f &amp;plusmn; %5.3f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Mass Mass at t==&amp;tau; (cells)'</span>, <span class="keyword">...</span>
1102                 nanmean(finMass), nanstd(finMass))];
1103             summary = [summary sprintf(<span class="string">'&lt;tr&gt;&lt;th&gt;%s&lt;/th&gt;&lt;td&gt;%5.3f&lt;/td&gt;&lt;/tr&gt;\n'</span>, <span class="string">'Median at t==&amp;tau; (cells)'</span>, <span class="keyword">...</span>
1104                 nanmedian(finMass))];
1105             summary = [summary sprintf(<span class="string">'&lt;/table&gt;\n'</span>)];
1106             
1107             summary = [summary sprintf(<span class="string">'&lt;/body&gt;\n'</span>)];
1108             summary = [summary sprintf(<span class="string">'&lt;/html&gt;\n'</span>)];
1109         <span class="keyword">end</span>
1110     <span class="keyword">end</span>
1111 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 19-Jul-2012 18:32:13 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>